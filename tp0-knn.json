{"version":3,"kind":"Notebook","sha256":"66168375435012306b94367ce6b413e7695e848f6c9fba596509db2cc052f74a","slug":"tp0-knn","location":"/exercises/tp0_knn.ipynb","dependencies":[],"frontmatter":{"title":"TP0: Les k plus proches voisins","content_includes_title":false,"kernelspec":{"name":"python3","display_name":"Python 3","language":"python"},"authors":[{"nameParsed":{"literal":"Pierre-Luc Bacon","given":"Pierre-Luc","family":"Bacon"},"name":"Pierre-Luc Bacon","id":"contributors-myst-generated-uid-0"}],"github":"https://github.com/pierrelux/mlbook","math":{"\\E":{"macro":"\\mathbb{E}"},"\\Var":{"macro":"\\mathrm{Var}"},"\\Cov":{"macro":"\\mathrm{Cov}"},"\\Prob":{"macro":"\\mathbb{P}"},"\\R":{"macro":"\\mathbb{R}"},"\\N":{"macro":"\\mathbb{N}"},"\\Loss":{"macro":"\\mathcal{L}"},"\\Risk":{"macro":"\\mathcal{R}"},"\\Hypothesis":{"macro":"\\mathcal{H}"},"\\Data":{"macro":"\\mathcal{D}"},"\\indicator":{"macro":"\\mathbb{1}"},"\\defeq":{"macro":"\\triangleq"},"\\mathds":{"macro":"\\mathbb"},"\\hdots":{"macro":"\\cdots"}},"numbering":{"title":{"offset":1}},"source_url":"https://github.com/pierrelux/mlbook/blob/main/exercises/tp0_knn.ipynb","edit_url":"https://github.com/pierrelux/mlbook/edit/main/exercises/tp0_knn.ipynb","thumbnail":"/mlbook/build/7e2db436150c38a00650f96925aa5581.svg","exports":[{"format":"ipynb","filename":"tp0_knn.ipynb","url":"/mlbook/build/tp0_knn-e6fae0c38060427c3caaf3c9b5bafd1b.ipynb"}]},"widgets":{},"mdast":{"type":"root","children":[{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"strong","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"IFT6390 - Fondements de l’apprentissage machine","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"nku5Z3qSqn"}],"key":"BZrDciOuqN"}],"key":"isHxVHwRfn"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"link","url":"https://colab.research.google.com/github/pierrelux/mlbook/blob/main/exercises/tp0_knn.ipynb","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"image","url":"/mlbook/build/7e2db436150c38a00650f96925aa5581.svg","alt":"Open In Colab","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"sBwOTolEDe","urlSource":"https://colab.research.google.com/assets/colab-badge.svg"}],"urlSource":"https://colab.research.google.com/github/pierrelux/mlbook/blob/main/exercises/tp0_knn.ipynb","key":"fvHhNiNFn4"}],"key":"aqgndzxxLQ"},{"type":"paragraph","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"Ce notebook accompagne le ","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"I50zQdD3uN"},{"type":"link","url":"https://pierrelux.github.io/mlbook/drafts/knn","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"Chapitre 1: Methodes non parametriques","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"Ri7F74j4pr"}],"urlSource":"https://pierrelux.github.io/mlbook/drafts/knn","key":"IxVMI3SLaW"},{"type":"text","value":".","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"UksmQGF7L3"}],"key":"gE2CuBrhjM"},{"type":"heading","depth":2,"position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"Objectifs","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"tCtMHhTlmv"}],"identifier":"objectifs","label":"Objectifs","html_id":"objectifs","implicit":true,"key":"q9Nf1ipZjh"},{"type":"paragraph","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"A la fin de ce TP, vous serez en mesure de:","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"xmWNcZlOuY"}],"key":"jccRb27Cg3"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":12,"column":1},"end":{"line":16,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Comprendre l’algorithme des k plus proches voisins (k-ppv)","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"Zak4Wgn3db"}],"key":"UohMpMuCp1"}],"key":"TzltpFTYqc"},{"type":"listItem","spread":true,"position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Observer l’effet du parametre k sur les predictions","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"ctR7SGeVQO"}],"key":"gRU0II4loK"}],"key":"wbSOoir8gy"},{"type":"listItem","spread":true,"position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Comparer differentes fonctions de distance","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"eo3YGsLFIX"}],"key":"P1sEK8TTWZ"}],"key":"byhZqlm4Wv"},{"type":"listItem","spread":true,"position":{"start":{"line":15,"column":1},"end":{"line":16,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Apprecier l’importance de la normalisation des donnees","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"gQ9p9XMr5n"}],"key":"ybrGTNJ6nA"}],"key":"KaLjIPiWPA"}],"key":"Rue9SHsjjO"},{"type":"thematicBreak","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"oI9bYFE4LW"}],"key":"byctZVzN9M"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Partie 0: Configuration","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"XV8ydQmSgL"}],"identifier":"partie-0-configuration","label":"Partie 0: Configuration","html_id":"partie-0-configuration","implicit":true,"key":"vOc2zEMlND"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Executez cette cellule pour importer les bibliotheques necessaires.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"gKoEy0cEW5"}],"key":"MkQJ4u4ras"}],"key":"mmWUwu8Pcq"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"import numpy as np\nimport matplotlib.pyplot as plt\nfrom matplotlib.colors import ListedColormap\n\n# Pour de jolis graphiques\nplt.rcParams['figure.figsize'] = (8, 5)\nplt.rcParams['font.size'] = 12\n\nprint(\"Configuration terminee!\")","key":"Qe3z1c6OCa"},{"type":"outputs","id":"_z_P26Pju88mi2KVJGECR","children":[{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"Configuration terminee!\n"},"key":"sYkhVnoxvQ"}],"key":"tmLs2UpK65"}],"key":"e35HCQLuYq"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Partie 1: L’algorithme k-ppv","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Ou6UQY4gU6"}],"identifier":"partie-1-lalgorithme-k-ppv","label":"Partie 1: L’algorithme k-ppv","html_id":"partie-1-lalgorithme-k-ppv","implicit":true,"key":"mAlbncrc05"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"L’idee des k plus proches voisins est simple: pour classifier un nouveau point, on regarde les ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"WdlKeA7lDi"},{"type":"inlineMath","value":"k","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>k</mi></mrow><annotation encoding=\"application/x-tex\">k</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span></span></span></span>","key":"GjIDWIuyO3"},{"type":"text","value":" points d’entrainement les plus proches et on prend un vote majoritaire.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"ye1smix3tn"}],"key":"xSTWyAjDv4"},{"type":"heading","depth":3,"position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Les donnees","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"kJGsVrvX5s"}],"identifier":"les-donnees","label":"Les donnees","html_id":"les-donnees","implicit":true,"key":"sKWpxNnFTU"},{"type":"paragraph","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"Commencons par generer un jeu de donnees de classification 2D.","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"IwFk9JpKoF"}],"key":"o0FqnUpil8"}],"key":"mBymEJMR15"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Generation de donnees de classification\nnp.random.seed(42)\nn_per_class = 15\n\n# Classe 0: groupe autour de (-1, -1)\nX0 = np.random.randn(n_per_class, 2) * 0.6 + np.array([-1, -1])\n# Classe 1: groupe autour de (1, 1)\nX1 = np.random.randn(n_per_class, 2) * 0.6 + np.array([1, 1])\n\nX_train = np.vstack([X0, X1])\ny_train = np.array([0] * n_per_class + [1] * n_per_class)\n\nprint(f\"Nombre de points: {len(X_train)}\")\nprint(f\"Classes: {np.unique(y_train)}\")","key":"K4MgNM5A9r"},{"type":"outputs","id":"f8zAVpjpuvb7G55A53KF_","children":[{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"Nombre de points: 30\nClasses: [0 1]\n"},"key":"Q4CpKAif2k"}],"key":"sO2rRmqtGI"}],"key":"VxFmGYfOS2"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Visualisation des donnees\nplt.figure(figsize=(7, 6))\nplt.scatter(X_train[y_train == 0, 0], X_train[y_train == 0, 1], \n           c='C0', s=60, label='Classe 0', edgecolors='k', linewidths=0.5)\nplt.scatter(X_train[y_train == 1, 0], X_train[y_train == 1, 1], \n           c='C1', s=60, label='Classe 1', edgecolors='k', linewidths=0.5)\nplt.xlabel('$x_1$')\nplt.ylabel('$x_2$')\nplt.legend()\nplt.title('Donnees d\\'entrainement')\nplt.axis('equal')\nplt.grid(True, alpha=0.3)\nplt.show()","key":"dAWSsTbSi0"},{"type":"outputs","id":"JUm9gZ2CB1042wpFNttvf","children":[{"type":"output","children":[],"jupyter_data":{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"<Figure size 700x600 with 1 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"afb328f42911717142a430799494ceac","path":"/mlbook/build/afb328f42911717142a430799494ceac.png"}}},"key":"YZKTInYB9F"}],"key":"T2LDjl9LzF"}],"key":"NBLLFCouzI"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Visualiser les k voisins","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Kzdr9Yg7oW"}],"identifier":"visualiser-les-k-voisins","label":"Visualiser les k voisins","html_id":"visualiser-les-k-voisins","implicit":true,"key":"F8bRBayP5i"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Pour un point requete, identifions ses ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"SphfTOxNF1"},{"type":"inlineMath","value":"k","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>k</mi></mrow><annotation encoding=\"application/x-tex\">k</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span></span></span></span>","key":"WLd8VnQRqu"},{"type":"text","value":" plus proches voisins.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"ZvIh7JQINS"}],"key":"tnAAXrMsAY"}],"key":"aFIsfihkkK"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Point requete\nx_query = np.array([0.3, 0.2])\nk = 5\n\n# Calcul des distances euclidiennes\ndistances = np.sqrt(np.sum((X_train - x_query)**2, axis=1))\n\n# Indices des k plus proches\nk_nearest_idx = np.argsort(distances)[:k]\n\nprint(f\"Point requete: {x_query}\")\nprint(f\"\\nLes {k} plus proches voisins:\")\nfor i, idx in enumerate(k_nearest_idx):\n    print(f\"  Voisin {i+1}: point {idx}, distance = {distances[idx]:.3f}, classe = {y_train[idx]}\")","key":"tAF7IpLJLk"},{"type":"outputs","id":"lKYw-yHaC6BADWDoIw1cW","children":[{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"Point requete: [0.3 0.2]\n\nLes 5 plus proches voisins:\n  Voisin 1: point 22, distance = 0.413, classe = 1\n  Voisin 2: point 28, distance = 0.645, classe = 1\n  Voisin 3: point 16, distance = 0.711, classe = 1\n  Voisin 4: point 3, distance = 0.819, classe = 0\n  Voisin 5: point 21, distance = 0.884, classe = 1\n"},"key":"qsQ2IYczqZ"}],"key":"zugwk01JYI"}],"key":"DeAcZCfjiz"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Visualisation des k voisins\nfig, ax = plt.subplots(figsize=(7, 6))\n\n# Points d'entrainement\nax.scatter(X_train[y_train == 0, 0], X_train[y_train == 0, 1], \n           c='C0', s=60, label='Classe 0', zorder=2)\nax.scatter(X_train[y_train == 1, 0], X_train[y_train == 1, 1], \n           c='C1', s=60, label='Classe 1', zorder=2)\n\n# Lignes vers les k voisins et cercles autour\nfor idx in k_nearest_idx:\n    ax.plot([x_query[0], X_train[idx, 0]], [x_query[1], X_train[idx, 1]], \n            'k--', alpha=0.4, linewidth=1, zorder=1)\n    ax.scatter(X_train[idx, 0], X_train[idx, 1], \n               s=150, facecolors='none', edgecolors='black', linewidths=2, zorder=3)\n\n# Point requete\nax.scatter(x_query[0], x_query[1], c='red', s=120, marker='*', \n           label='Requete', zorder=4)\n\n# Compter les votes\nvotes = y_train[k_nearest_idx]\nn_class0 = np.sum(votes == 0)\nn_class1 = np.sum(votes == 1)\nprediction = 0 if n_class0 > n_class1 else 1\n\nax.set_xlabel('$x_1$')\nax.set_ylabel('$x_2$')\nax.legend(loc='upper left')\nax.set_title(f'$k = {k}$: votes = [{n_class0} classe 0, {n_class1} classe 1] -> prediction: classe {prediction}')\nax.set_aspect('equal')\nax.grid(True, alpha=0.3)\nplt.tight_layout()\nplt.show()","key":"H198pSwV4M"},{"type":"outputs","id":"et2zpllHW5087HgyBoR3S","children":[{"type":"output","children":[],"jupyter_data":{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"<Figure size 700x600 with 1 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"704f4e8170edbc7022532c9850590032","path":"/mlbook/build/704f4e8170edbc7022532c9850590032.png"}}},"key":"wSXnXAorVH"}],"key":"v7Y9IgZ2gK"}],"key":"k12iSgGEXJ"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Exercice: Implementer le vote majoritaire","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"sIz0Y04yrb"}],"identifier":"exercice-implementer-le-vote-majoritaire","label":"Exercice: Implementer le vote majoritaire","html_id":"exercice-implementer-le-vote-majoritaire","implicit":true,"key":"WrEWs8PrMz"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Completez la fonction ci-dessous pour compter les votes et predire la classe.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"NXupnV2WhJ"}],"key":"IpQsPksN1e"}],"key":"ei2u3AbXQM"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"def knn_predict(X_train, y_train, x_query, k):\n    \"\"\"\n    Predit la classe d'un point en utilisant les k plus proches voisins.\n    \n    Parametres:\n        X_train: array (N, d) - points d'entrainement\n        y_train: array (N,) - etiquettes (0 ou 1)\n        x_query: array (d,) - point a classifier\n        k: int - nombre de voisins\n    \n    Retourne:\n        prediction: int (0 ou 1)\n    \"\"\"\n    # TODO: Calculer les distances euclidiennes de x_query a tous les points\n    distances = None  # A completer\n    \n    # TODO: Trouver les indices des k plus proches voisins\n    k_nearest_idx = None  # A completer\n    \n    # TODO: Recuperer les etiquettes des k voisins\n    k_labels = None  # A completer\n    \n    # TODO: Vote majoritaire (retourner 0 ou 1)\n    prediction = None  # A completer\n    \n    return prediction\n\n# Test de votre fonction\ntest_pred = knn_predict(X_train, y_train, x_query, k=5)\nprint(f\"Prediction pour {x_query}: classe {test_pred}\")","key":"ZMbHRACcPU"},{"type":"outputs","id":"G1lBZXkBQItyEQCQ8DD7e","children":[{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"Prediction pour [0.3 0.2]: classe None\n"},"key":"WAYQYXRkf4"}],"key":"sc36HAfHI7"}],"key":"F8sUVkySd1"},{"type":"block","kind":"notebook-content","children":[{"type":"details","children":[{"type":"summary","children":[{"type":"strong","children":[{"type":"text","value":"Solution","key":"nHplm66mJv"}],"key":"vM5NXPpVXF"},{"type":"text","value":" (cliquez pour afficher)","key":"ykTKjQV2tL"}],"key":"hus1Kc3WpJ"},{"type":"code","lang":"python","meta":null,"value":"def knn_predict(X_train, y_train, x_query, k):\n    # Calculer les distances euclidiennes\n    distances = np.sqrt(np.sum((X_train - x_query)**2, axis=1))\n    \n    # Trouver les indices des k plus proches voisins\n    k_nearest_idx = np.argsort(distances)[:k]\n    \n    # Recuperer les etiquettes des k voisins\n    k_labels = y_train[k_nearest_idx]\n    \n    # Vote majoritaire\n    prediction = 1 if np.sum(k_labels) > k/2 else 0\n    \n    return prediction","key":"ddM124huEk"}],"key":"k3K5LIKkVQ"}],"key":"YfaqVW57oI"},{"type":"block","kind":"notebook-content","children":[{"type":"thematicBreak","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"fl9jQNxOXF"},{"type":"heading","depth":2,"position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"Partie 2: Effet de k","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"djJVbAsQIo"}],"identifier":"partie-2-effet-de-k","label":"Partie 2: Effet de k","html_id":"partie-2-effet-de-k","implicit":true,"key":"Da82POnAwK"},{"type":"paragraph","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"Le parametre ","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"efYDxyv6TF"},{"type":"inlineMath","value":"k","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>k</mi></mrow><annotation encoding=\"application/x-tex\">k</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span></span></span></span>","key":"KsEpHssk30"},{"type":"text","value":" controle la complexite du modele:","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"yKRwWN898A"}],"key":"DcK2bb9Hd5"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":5,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"inlineMath","value":"k=1","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>k</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">k=1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span>","key":"x7PrxNIGAA"}],"key":"wuPRY1GuQy"},{"type":"text","value":": Frontiere tres irreguliere, erreur d’entrainement = 0","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"c82DpysbTb"}],"key":"dgR8PP3BGE"}],"key":"BK1fxmsM5c"},{"type":"listItem","spread":true,"position":{"start":{"line":6,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"Grand ","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"rfawevQHMl"},{"type":"inlineMath","value":"k","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>k</mi></mrow><annotation encoding=\"application/x-tex\">k</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span></span></span></span>","key":"sFR1G2OvnZ"}],"key":"n01daOeDI4"},{"type":"text","value":": Frontiere plus lisse, tend vers la classe majoritaire","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"gHGSl8GX9A"}],"key":"lmXSylwOgu"}],"key":"ZYeSdDkJLC"}],"key":"NNztaqFhCM"},{"type":"paragraph","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"Visualisons la frontiere de decision pour differentes valeurs de ","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"R6U1dE3yCf"},{"type":"inlineMath","value":"k","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>k</mi></mrow><annotation encoding=\"application/x-tex\">k</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span></span></span></span>","key":"ghkP0lpqTG"},{"type":"text","value":".","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"F2B7AFLoBL"}],"key":"XARV6zvvTH"}],"key":"TyDzI4sdQD"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"def knn_predict_batch(X_train, y_train, X_test, k):\n    \"\"\"Predit les classes pour un ensemble de points.\"\"\"\n    predictions = []\n    for x in X_test:\n        distances = np.sqrt(np.sum((X_train - x)**2, axis=1))\n        k_nearest_idx = np.argsort(distances)[:k]\n        k_labels = y_train[k_nearest_idx]\n        predictions.append(1 if np.sum(k_labels) > k/2 else 0)\n    return np.array(predictions)","key":"u4Mr2o6Sbk"},{"type":"outputs","id":"zoj-zwrkHV1Gc-3KOMdfP","children":[],"key":"SVLg7bciNS"}],"key":"Eav9SUdP8T"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Creer une grille pour visualiser la frontiere de decision\nx_min, x_max = X_train[:, 0].min() - 0.5, X_train[:, 0].max() + 0.5\ny_min, y_max = X_train[:, 1].min() - 0.5, X_train[:, 1].max() + 0.5\nxx, yy = np.meshgrid(np.linspace(x_min, x_max, 100),\n                     np.linspace(y_min, y_max, 100))\nX_mesh = np.c_[xx.ravel(), yy.ravel()]\n\n# Visualiser pour differentes valeurs de k\nfig, axes = plt.subplots(1, 3, figsize=(14, 4.5))\nk_values = [1, 5, 15]\ncmap_light = ListedColormap(['#FFAAAA', '#AAAAFF'])\n\nfor ax, k in zip(axes, k_values):\n    Z = knn_predict_batch(X_train, y_train, X_mesh, k)\n    Z = Z.reshape(xx.shape)\n    \n    ax.contourf(xx, yy, Z, alpha=0.4, cmap=cmap_light)\n    ax.scatter(X_train[y_train == 0, 0], X_train[y_train == 0, 1], \n               c='C0', s=40, edgecolors='k', linewidths=0.5)\n    ax.scatter(X_train[y_train == 1, 0], X_train[y_train == 1, 1], \n               c='C1', s=40, edgecolors='k', linewidths=0.5)\n    ax.set_xlim(x_min, x_max)\n    ax.set_ylim(y_min, y_max)\n    ax.set_title(f'$k = {k}$')\n    ax.set_xlabel('$x_1$')\n    ax.set_ylabel('$x_2$')\n\nplt.tight_layout()\nplt.show()","key":"jYzURmr4B1"},{"type":"outputs","id":"AIFo83GUV1igud7uHM9fL","children":[{"type":"output","children":[],"jupyter_data":{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"<Figure size 1400x450 with 3 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"fcb58ce3719b46c173ef85e554a88618","path":"/mlbook/build/fcb58ce3719b46c173ef85e554a88618.png"}}},"key":"q6zUYI47Mb"}],"key":"vir5BPKSlA"}],"key":"tYqReIgkSy"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Question","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Lb2bslzxk6"}],"key":"EsrJanF9iL"},{"type":"text","value":": Que se passe-t-il avec ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"uTP3XY8muS"},{"type":"inlineMath","value":"k=1","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>k</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">k=1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span>","key":"tG45SgXZAw"},{"type":"text","value":"? Et avec ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"vfwwa8zluT"},{"type":"inlineMath","value":"k=N","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>k</mi><mo>=</mo><mi>N</mi></mrow><annotation encoding=\"application/x-tex\">k=N</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span></span></span></span>","key":"QHpTHbLQWU"},{"type":"text","value":" (tous les points)?","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"zZ7p9JV9JJ"}],"key":"V3g0sjt0dA"}],"key":"TsMWWHzclq"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Compromis biais-variance","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"vS1Me4Li6O"}],"identifier":"compromis-biais-variance","label":"Compromis biais-variance","html_id":"compromis-biais-variance","implicit":true,"key":"OpSzic2Bsg"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Tracez l’erreur d’entrainement et de test en fonction de ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"H924hpeGVp"},{"type":"inlineMath","value":"k","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>k</mi></mrow><annotation encoding=\"application/x-tex\">k</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span></span></span></span>","key":"n87Dtus3t5"},{"type":"text","value":".","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"uq10pDtXbU"}],"key":"fagKU1oCHr"}],"key":"qON8qp56t2"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Generer des donnees de test\nnp.random.seed(123)\nX0_test = np.random.randn(50, 2) * 0.6 + np.array([-1, -1])\nX1_test = np.random.randn(50, 2) * 0.6 + np.array([1, 1])\nX_test = np.vstack([X0_test, X1_test])\ny_test = np.array([0] * 50 + [1] * 50)\n\n# Calculer les erreurs pour differents k\nk_values = list(range(1, 30, 2))  # k impair pour eviter les egalites\ntrain_errors = []\ntest_errors = []\n\nfor k in k_values:\n    y_pred_train = knn_predict_batch(X_train, y_train, X_train, k)\n    y_pred_test = knn_predict_batch(X_train, y_train, X_test, k)\n    train_errors.append(np.mean(y_pred_train != y_train))\n    test_errors.append(np.mean(y_pred_test != y_test))\n\n# Tracer\nplt.figure(figsize=(8, 5))\nplt.plot(k_values, train_errors, 'o-', label='Entrainement')\nplt.plot(k_values, test_errors, 's-', label='Test')\nplt.xlabel('$k$ (nombre de voisins)')\nplt.ylabel('Taux d\\'erreur')\nplt.title('Compromis biais-variance')\nplt.legend()\nplt.grid(True, alpha=0.3)\nplt.show()\n\nprint(f\"Meilleur k sur le test: {k_values[np.argmin(test_errors)]}\")","key":"w5pu90Xvu3"},{"type":"outputs","id":"fr75COLb0btocIRwstJBp","children":[{"type":"output","children":[],"jupyter_data":{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"<Figure size 800x500 with 1 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"65caf6bc2a546462faf82eef2dbb334f","path":"/mlbook/build/65caf6bc2a546462faf82eef2dbb334f.png"}}},"key":"c1Nuks00z8"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"Meilleur k sur le test: 21\n"},"key":"ZjwSAz0Do6"}],"key":"YiKOVfZc5w"}],"key":"JOg8deuBgZ"},{"type":"block","kind":"notebook-content","children":[{"type":"thematicBreak","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"AOIdcf1ii4"},{"type":"heading","depth":2,"position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"Partie 3: Fonctions de distance","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"EVfQM0e35R"}],"identifier":"partie-3-fonctions-de-distance","label":"Partie 3: Fonctions de distance","html_id":"partie-3-fonctions-de-distance","implicit":true,"key":"kPdvrE98kL"},{"type":"paragraph","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"L’algorithme k-ppv depend de la fonction de distance utilisee. Les plus communes sont:","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"TOenvug4m7"}],"key":"dBhgSN4Mcb"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":6,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"Distance euclidienne (","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"HrUFA2LqEz"},{"type":"inlineMath","value":"\\ell_2","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi mathvariant=\"normal\">ℓ</mi><mn>2</mn></msub></mrow><annotation encoding=\"application/x-tex\">\\ell_2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8444em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord\">ℓ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"NMIsdcxKR2"},{"type":"text","value":")","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"WBbSgCU7gN"}],"key":"kzuI3G2koW"},{"type":"text","value":": ","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"ZfNojBOZKF"},{"type":"inlineMath","value":"d(\\mathbf{x}, \\mathbf{y}) = \\sqrt{\\sum_j (x_j - y_j)^2}","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>d</mi><mo stretchy=\"false\">(</mo><mi mathvariant=\"bold\">x</mi><mo separator=\"true\">,</mo><mi mathvariant=\"bold\">y</mi><mo stretchy=\"false\">)</mo><mo>=</mo><msqrt><mrow><msub><mo>∑</mo><mi>j</mi></msub><mo stretchy=\"false\">(</mo><msub><mi>x</mi><mi>j</mi></msub><mo>−</mo><msub><mi>y</mi><mi>j</mi></msub><msup><mo stretchy=\"false\">)</mo><mn>2</mn></msup></mrow></msqrt></mrow><annotation encoding=\"application/x-tex\">d(\\mathbf{x}, \\mathbf{y}) = \\sqrt{\\sum_j (x_j - y_j)^2}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">d</span><span class=\"mopen\">(</span><span class=\"mord mathbf\">x</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathbf\" style=\"margin-right:0.01597em;\">y</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.84em;vertical-align:-0.6979em;\"></span><span class=\"mord sqrt\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.1421em;\"><span class=\"svg-align\" style=\"top:-3.8em;\"><span class=\"pstrut\" style=\"height:3.8em;\"></span><span class=\"mord\" style=\"padding-left:1em;\"><span class=\"mop\"><span class=\"mop op-symbol small-op\" style=\"position:relative;top:0em;\">∑</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.162em;\"><span style=\"top:-2.4003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.4358em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span><span class=\"mclose\"><span class=\"mclose\">)</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7401em;\"><span style=\"top:-2.989em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span></span></span><span style=\"top:-3.1021em;\"><span class=\"pstrut\" style=\"height:3.8em;\"></span><span class=\"hide-tail\" style=\"min-width:1.02em;height:1.88em;\"><svg xmlns=\"http://www.w3.org/2000/svg\" width='400em' height='1.88em' viewBox='0 0 400000 1944' preserveAspectRatio='xMinYMin slice'><path d='M983 90\nl0 -0\nc4,-6.7,10,-10,18,-10 H400000v40\nH1013.1s-83.4,268,-264.1,840c-180.7,572,-277,876.3,-289,913c-4.7,4.7,-12.7,7,-24,7\ns-12,0,-12,0c-1.3,-3.3,-3.7,-11.7,-7,-25c-35.3,-125.3,-106.7,-373.3,-214,-744\nc-10,12,-21,25,-33,39s-32,39,-32,39c-6,-5.3,-15,-14,-27,-26s25,-30,25,-30\nc26.7,-32.7,52,-63,76,-91s52,-60,52,-60s208,722,208,722\nc56,-175.3,126.3,-397.3,211,-666c84.7,-268.7,153.8,-488.2,207.5,-658.5\nc53.7,-170.3,84.5,-266.8,92.5,-289.5z\nM1001 80h400000v40h-400000z'/></svg></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6979em;\"><span></span></span></span></span></span></span></span></span>","key":"vUUf786H9X"}],"key":"I1pIz19VlY"}],"key":"hEzjXrUug3"},{"type":"listItem","spread":true,"position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"Distance de Manhattan (","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"Ux4yk2djj2"},{"type":"inlineMath","value":"\\ell_1","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi mathvariant=\"normal\">ℓ</mi><mn>1</mn></msub></mrow><annotation encoding=\"application/x-tex\">\\ell_1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8444em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord\">ℓ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"OxCyPupnK0"},{"type":"text","value":")","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"dXEADQr406"}],"key":"k6F9UVOH4W"},{"type":"text","value":": ","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"kZdfojUSRv"},{"type":"inlineMath","value":"d(\\mathbf{x}, \\mathbf{y}) = \\sum_j |x_j - y_j|","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>d</mi><mo stretchy=\"false\">(</mo><mi mathvariant=\"bold\">x</mi><mo separator=\"true\">,</mo><mi mathvariant=\"bold\">y</mi><mo stretchy=\"false\">)</mo><mo>=</mo><msub><mo>∑</mo><mi>j</mi></msub><mi mathvariant=\"normal\">∣</mi><msub><mi>x</mi><mi>j</mi></msub><mo>−</mo><msub><mi>y</mi><mi>j</mi></msub><mi mathvariant=\"normal\">∣</mi></mrow><annotation encoding=\"application/x-tex\">d(\\mathbf{x}, \\mathbf{y}) = \\sum_j |x_j - y_j|</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">d</span><span class=\"mopen\">(</span><span class=\"mord mathbf\">x</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathbf\" style=\"margin-right:0.01597em;\">y</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.1858em;vertical-align:-0.4358em;\"></span><span class=\"mop\"><span class=\"mop op-symbol small-op\" style=\"position:relative;top:0em;\">∑</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.162em;\"><span style=\"top:-2.4003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.4358em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">∣</span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.0361em;vertical-align:-0.2861em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span><span class=\"mord\">∣</span></span></span></span>","key":"cq5eFS5Ilw"}],"key":"z4XRcxd6r0"}],"key":"mon3hHRl5c"},{"type":"listItem","spread":true,"position":{"start":{"line":8,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"Distance ","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"Zjv3U9rBqG"},{"type":"inlineMath","value":"\\ell_\\infty","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi mathvariant=\"normal\">ℓ</mi><mi mathvariant=\"normal\">∞</mi></msub></mrow><annotation encoding=\"application/x-tex\">\\ell_\\infty</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8444em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord\">ℓ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">∞</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"LQlL3iLw1r"}],"key":"UH04v5GMhT"},{"type":"text","value":": ","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"TibFFa5fGo"},{"type":"inlineMath","value":"d(\\mathbf{x}, \\mathbf{y}) = \\max_j |x_j - y_j|","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>d</mi><mo stretchy=\"false\">(</mo><mi mathvariant=\"bold\">x</mi><mo separator=\"true\">,</mo><mi mathvariant=\"bold\">y</mi><mo stretchy=\"false\">)</mo><mo>=</mo><msub><mrow><mi>max</mi><mo>⁡</mo></mrow><mi>j</mi></msub><mi mathvariant=\"normal\">∣</mi><msub><mi>x</mi><mi>j</mi></msub><mo>−</mo><msub><mi>y</mi><mi>j</mi></msub><mi mathvariant=\"normal\">∣</mi></mrow><annotation encoding=\"application/x-tex\">d(\\mathbf{x}, \\mathbf{y}) = \\max_j |x_j - y_j|</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">d</span><span class=\"mopen\">(</span><span class=\"mord mathbf\">x</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathbf\" style=\"margin-right:0.01597em;\">y</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.0361em;vertical-align:-0.2861em;\"></span><span class=\"mop\"><span class=\"mop\">max</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">∣</span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.0361em;vertical-align:-0.2861em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span><span class=\"mord\">∣</span></span></span></span>","key":"eL6AFhql7M"}],"key":"ZfVgheVONa"}],"key":"CVc2RUZA1N"}],"key":"OvEk8Uix3L"},{"type":"heading","depth":3,"position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"text","value":"Visualiser les boules unite","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"kFTHJZfgF2"}],"identifier":"visualiser-les-boules-unite","label":"Visualiser les boules unite","html_id":"visualiser-les-boules-unite","implicit":true,"key":"B2RhvGJkNL"},{"type":"paragraph","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"text","value":"La forme de la boule unite montre ce que chaque norme considere comme “equidistant”.","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"jK4OkIzugJ"}],"key":"BnjWt1YRDz"}],"key":"liNv0o1gRA"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"fig, axes = plt.subplots(1, 3, figsize=(12, 4))\n\n# Points de reference\np1 = (1, 0)\np2 = (1/np.sqrt(2), 1/np.sqrt(2))  # ~(0.71, 0.71)\n\n# L1 norm (losange)\nax = axes[0]\nt = np.linspace(0, 1, 250)\nx_l1 = np.concatenate([t, 1-t, -t, -1+t])\ny_l1 = np.concatenate([1-t, -t, -1+t, t])\nax.fill(x_l1, y_l1, alpha=0.3, color='C0')\nax.plot(x_l1, y_l1, 'C0-', linewidth=2)\n\nax.scatter([p1[0]], [p1[1]], s=80, c='black', zorder=5)\nax.scatter([p2[0]], [p2[1]], s=80, c='red', zorder=5)\nax.annotate(f'$(1, 0)$\\n$d=1$', p1, textcoords='offset points', \n            xytext=(5, 10), fontsize=9)\nax.annotate(f'$(0.71, 0.71)$\\n$d=1.42$', p2, textcoords='offset points', \n            xytext=(5, 10), fontsize=9, color='red')\n\nax.set_title(r'Norme $\\ell_1$ (Manhattan)')\nax.set_xlim(-1.5, 1.5)\nax.set_ylim(-1.5, 1.5)\nax.set_aspect('equal')\nax.axhline(0, color='gray', linewidth=0.5)\nax.axvline(0, color='gray', linewidth=0.5)\nax.set_xlabel('$x_1$')\nax.set_ylabel('$x_2$')\n\n# L2 norm (cercle)\nax = axes[1]\ntheta = np.linspace(0, 2*np.pi, 1000)\nx_l2 = np.cos(theta)\ny_l2 = np.sin(theta)\nax.fill(x_l2, y_l2, alpha=0.3, color='C1')\nax.plot(x_l2, y_l2, 'C1-', linewidth=2)\n\nax.scatter([p1[0]], [p1[1]], s=80, c='black', zorder=5)\nax.scatter([p2[0]], [p2[1]], s=80, c='black', zorder=5)\nax.annotate(f'$(1, 0)$\\n$d=1$', p1, textcoords='offset points', \n            xytext=(5, 10), fontsize=9)\nax.annotate(f'$(0.71, 0.71)$\\n$d=1$', p2, textcoords='offset points', \n            xytext=(5, 10), fontsize=9)\n\nax.set_title(r'Norme $\\ell_2$ (Euclidienne)')\nax.set_xlim(-1.5, 1.5)\nax.set_ylim(-1.5, 1.5)\nax.set_aspect('equal')\nax.axhline(0, color='gray', linewidth=0.5)\nax.axvline(0, color='gray', linewidth=0.5)\nax.set_xlabel('$x_1$')\nax.set_ylabel('$x_2$')\n\n# L-infinity norm (carre)\nax = axes[2]\nx_linf = np.array([1, 1, -1, -1, 1])\ny_linf = np.array([1, -1, -1, 1, 1])\nax.fill(x_linf, y_linf, alpha=0.3, color='C2')\nax.plot(x_linf, y_linf, 'C2-', linewidth=2)\n\n# Pour L-inf: (1,0), (1,0.5), (1,1) ont tous distance 1\np_inf = [(1, 0), (1, 0.5), (1, 1)]\nfor i, p in enumerate(p_inf):\n    ax.scatter([p[0]], [p[1]], s=80, c='black', zorder=5)\nax.annotate('$(1, 0)$\\n$d=1$', p_inf[0], textcoords='offset points', \n            xytext=(-45, -5), fontsize=9)\nax.annotate('$(1, 0.5)$\\n$d=1$', p_inf[1], textcoords='offset points', \n            xytext=(5, -5), fontsize=9)\nax.annotate('$(1, 1)$\\n$d=1$', p_inf[2], textcoords='offset points', \n            xytext=(5, 5), fontsize=9)\n\nax.set_title(r'Norme $\\ell_\\infty$')\nax.set_xlim(-1.5, 1.5)\nax.set_ylim(-1.5, 1.5)\nax.set_aspect('equal')\nax.axhline(0, color='gray', linewidth=0.5)\nax.axvline(0, color='gray', linewidth=0.5)\nax.set_xlabel('$x_1$')\nax.set_ylabel('$x_2$')\n\nplt.tight_layout()\nplt.show()","key":"ENLZzfWFi0"},{"type":"outputs","id":"0El-An01YQjbSddMAkgQy","children":[{"type":"output","children":[],"jupyter_data":{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"<Figure size 1200x400 with 3 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"32be2d7a1785639c2b15515862368e29","path":"/mlbook/build/32be2d7a1785639c2b15515862368e29.png"}}},"key":"h1tM2Z4K0E"}],"key":"WkzXCVzbA7"}],"key":"kM5GcEvXXI"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Exercice: Calculer les distances","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"EKAF9lT2f5"}],"identifier":"exercice-calculer-les-distances","label":"Exercice: Calculer les distances","html_id":"exercice-calculer-les-distances","implicit":true,"key":"WtDOKj7BN7"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Implementez les trois fonctions de distance.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"QexbSGbVFn"}],"key":"Oc3n2kq7Om"}],"key":"esQpm1gTBa"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"def distance_l1(x, y):\n    \"\"\"Distance de Manhattan.\"\"\"\n    # TODO: Implementer\n    pass\n\ndef distance_l2(x, y):\n    \"\"\"Distance euclidienne.\"\"\"\n    # TODO: Implementer\n    pass\n\ndef distance_linf(x, y):\n    \"\"\"Distance L-infini.\"\"\"\n    # TODO: Implementer\n    pass\n\n# Test avec deux points\nx = np.array([0, 0])\ny = np.array([3, 4])\n\nprint(f\"Points: x = {x}, y = {y}\")\nprint(f\"Distance L1: {distance_l1(x, y)}\")     # Attendu: 7\nprint(f\"Distance L2: {distance_l2(x, y)}\")     # Attendu: 5\nprint(f\"Distance L-inf: {distance_linf(x, y)}\") # Attendu: 4","key":"kpPF7eJHm8"},{"type":"outputs","id":"yq23REKXHaCJutvAEFbfr","children":[{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"Points: x = [0 0], y = [3 4]\nDistance L1: None\nDistance L2: None\nDistance L-inf: None\n"},"key":"p4K0mp1blG"}],"key":"iKMLDxUNey"}],"key":"Y19w8dVjLx"},{"type":"block","kind":"notebook-content","children":[{"type":"details","children":[{"type":"summary","children":[{"type":"strong","children":[{"type":"text","value":"Solution","key":"FTPA2YYlzj"}],"key":"U7nTPmRW5o"},{"type":"text","value":" (cliquez pour afficher)","key":"ygJ9EopCBm"}],"key":"VONDdeyblA"},{"type":"code","lang":"python","meta":null,"value":"def distance_l1(x, y):\n    return np.sum(np.abs(x - y))\n\ndef distance_l2(x, y):\n    return np.sqrt(np.sum((x - y)**2))\n\ndef distance_linf(x, y):\n    return np.max(np.abs(x - y))","key":"qcsK67XNwm"}],"key":"ItSGTdYg1V"}],"key":"SxlSiJF2Rr"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Comment les voisins changent selon la distance","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"HM7CT4EfSv"}],"identifier":"comment-les-voisins-changent-selon-la-distance","label":"Comment les voisins changent selon la distance","html_id":"comment-les-voisins-changent-selon-la-distance","implicit":true,"key":"XcpbOrmR2D"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Visualisons comment le choix de la metrique affecte les voisins selectionnes.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"Owcbdt67yd"}],"key":"syo0mwZuWQ"}],"key":"hGWfW8Dthn"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Implementer les fonctions de distance (solution)\ndef distance_l1(x, y):\n    return np.sum(np.abs(x - y))\n\ndef distance_l2(x, y):\n    return np.sqrt(np.sum((x - y)**2))\n\ndef distance_linf(x, y):\n    return np.max(np.abs(x - y))\n\n# Point requete\nx_q = np.array([0, 0])\nk = 3\n\nfig, axes = plt.subplots(1, 3, figsize=(14, 4.5))\nmetrics = [('$\\\\ell_1$', distance_l1), ('$\\\\ell_2$', distance_l2), ('$\\\\ell_\\infty$', distance_linf)]\n\nfor ax, (name, dist_func) in zip(axes, metrics):\n    # Calculer les distances avec cette metrique\n    distances = np.array([dist_func(x_q, xi) for xi in X_train])\n    k_idx = np.argsort(distances)[:k]\n    \n    ax.scatter(X_train[y_train == 0, 0], X_train[y_train == 0, 1], \n               c='C0', s=50, alpha=0.5)\n    ax.scatter(X_train[y_train == 1, 0], X_train[y_train == 1, 1], \n               c='C1', s=50, alpha=0.5)\n    \n    # Mettre en evidence les k voisins\n    for idx in k_idx:\n        ax.scatter(X_train[idx, 0], X_train[idx, 1], \n                   s=150, facecolors='none', edgecolors='green', linewidths=2)\n    \n    ax.scatter(x_q[0], x_q[1], c='red', s=120, marker='*', zorder=5)\n    ax.set_title(f'Distance {name}')\n    ax.set_xlabel('$x_1$')\n    ax.set_ylabel('$x_2$')\n    ax.set_aspect('equal')\n    ax.grid(True, alpha=0.3)\n\nplt.tight_layout()\nplt.show()","key":"ss27NOhUrx"},{"type":"outputs","id":"GPw7FDo30ZVHysj9N-l5p","children":[{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stderr","text":"<>:16: SyntaxWarning: invalid escape sequence '\\i'\n<>:16: SyntaxWarning: invalid escape sequence '\\i'\n/var/folders/kz/gmggxk812sg1jvysfbnx_y7h0000gq/T/ipykernel_29220/969548489.py:16: SyntaxWarning: invalid escape sequence '\\i'\n  metrics = [('$\\\\ell_1$', distance_l1), ('$\\\\ell_2$', distance_l2), ('$\\\\ell_\\infty$', distance_linf)]\n"},"key":"AOJOCrLFJ6"},{"type":"output","children":[],"jupyter_data":{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"<Figure size 1400x450 with 3 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"b0139bec774c548f8864c05cf61ede28","path":"/mlbook/build/b0139bec774c548f8864c05cf61ede28.png"}}},"key":"Y5uIxyRD46"}],"key":"yzxCMi3NFa"}],"key":"Asjte1dzXW"},{"type":"block","kind":"notebook-content","children":[{"type":"thematicBreak","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"OI4O1ha1wv"},{"type":"heading","depth":2,"position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"Partie 4: Importance de la normalisation","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"YP6dPNsXPo"}],"identifier":"partie-4-importance-de-la-normalisation","label":"Partie 4: Importance de la normalisation","html_id":"partie-4-importance-de-la-normalisation","implicit":true,"key":"PB0NmfUZ7B"},{"type":"paragraph","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"Quand les variables ont des echelles differentes, certaines dominent le calcul de distance.","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"vqZ7vJADc8"}],"key":"IxKo3sQBo8"},{"type":"heading","depth":3,"position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"Exemple: age vs revenu","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"UuYfIfuECZ"}],"identifier":"exemple-age-vs-revenu","label":"Exemple: age vs revenu","html_id":"exemple-age-vs-revenu","implicit":true,"key":"XFsTqUZ18a"}],"key":"MI20V1m6uV"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Donnees: age (20-70) et revenu (20000-200000)\nnp.random.seed(42)\nn = 30\n\n# Generer des donnees realistes\nages = np.random.uniform(25, 65, n)\nrevenus = ages * 2000 + np.random.normal(0, 20000, n) + 30000  # Correlation avec l'age\n\nX_raw = np.column_stack([ages, revenus])\n\n# Etiquettes basees sur une combinaison non-lineaire\ny_raw = ((ages > 45) | (revenus > 100000)).astype(int)\n\nprint(f\"Age: min={ages.min():.1f}, max={ages.max():.1f}\")\nprint(f\"Revenu: min={revenus.min():.0f}, max={revenus.max():.0f}\")","key":"Op6AdaCAsN"},{"type":"outputs","id":"exsKZ1AnqIK10t4miaHff","children":[{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"Age: min=25.8, max=63.8\nRevenu: min=74048, max=163571\n"},"key":"tC3G8VEfdh"}],"key":"MGmXLeisRO"}],"key":"kq28tlrdws"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Calculer les distances avant normalisation\nx1 = np.array([30, 50000])   # Jeune, revenu moyen\nx2 = np.array([35, 51000])   # Similaire en age, revenu proche\nx3 = np.array([31, 150000])  # Age proche, revenu tres different\n\nd_12 = np.sqrt(np.sum((x1 - x2)**2))\nd_13 = np.sqrt(np.sum((x1 - x3)**2))\n\nprint(\"AVANT normalisation:\")\nprint(f\"  Distance x1-x2 (age: +5 ans, revenu: +1000$): {d_12:.1f}\")\nprint(f\"  Distance x1-x3 (age: +1 an, revenu: +100000$): {d_13:.1f}\")\nprint(f\"  Ratio: {d_13/d_12:.1f}x plus loin\")","key":"VTheMdLPxU"},{"type":"outputs","id":"vKsryhUfYwsCGsqWQJYrx","children":[{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"AVANT normalisation:\n  Distance x1-x2 (age: +5 ans, revenu: +1000$): 1000.0\n  Distance x1-x3 (age: +1 an, revenu: +100000$): 100000.0\n  Ratio: 100.0x plus loin\n"},"key":"vwESlPN3xp"}],"key":"Gsi6Z5kcT7"}],"key":"cwFNgg6n6z"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Observation","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"NofCXzNcNc"}],"key":"zYksIAchmZ"},{"type":"text","value":": La difference de revenu domine completement! Une difference de 100000$ est vue comme 100x plus importante qu’une difference de 5 ans.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"OjJU7D9gtL"}],"key":"JDgKYqPeFS"}],"key":"ci3te3uYeq"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Normalisation: centrer et reduire\nmean_age = ages.mean()\nstd_age = ages.std()\nmean_rev = revenus.mean()\nstd_rev = revenus.std()\n\ndef normalize(x):\n    return np.array([(x[0] - mean_age) / std_age, \n                     (x[1] - mean_rev) / std_rev])\n\nx1_norm = normalize(x1)\nx2_norm = normalize(x2)\nx3_norm = normalize(x3)\n\nd_12_norm = np.sqrt(np.sum((x1_norm - x2_norm)**2))\nd_13_norm = np.sqrt(np.sum((x1_norm - x3_norm)**2))\n\nprint(\"APRES normalisation:\")\nprint(f\"  Distance x1-x2: {d_12_norm:.3f}\")\nprint(f\"  Distance x1-x3: {d_13_norm:.3f}\")\nprint(f\"  Ratio: {d_13_norm/d_12_norm:.1f}x plus loin\")","key":"huLtYrJH4G"},{"type":"outputs","id":"Wbxj1gAYJwMz_klxBNd6_","children":[{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"APRES normalisation:\n  Distance x1-x2: 0.453\n  Distance x1-x3: 4.574\n  Ratio: 10.1x plus loin\n"},"key":"PlMyvyqaX2"}],"key":"rynKX1ERoN"}],"key":"C2HTCUAe9w"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Visualiser l'effet de la normalisation\nfig, axes = plt.subplots(1, 2, figsize=(12, 5))\n\n# Avant normalisation\nax = axes[0]\nax.scatter(X_raw[y_raw == 0, 0], X_raw[y_raw == 0, 1], c='C0', s=60, label='Classe 0')\nax.scatter(X_raw[y_raw == 1, 0], X_raw[y_raw == 1, 1], c='C1', s=60, label='Classe 1')\nax.scatter([x1[0]], [x1[1]], c='red', s=150, marker='*', zorder=5, label='Requete')\nax.set_xlabel('Age (annees)')\nax.set_ylabel('Revenu ($)')\nax.set_title('Avant normalisation\\n(le revenu domine)')\nax.legend()\nax.grid(True, alpha=0.3)\n\n# Apres normalisation\nX_norm = np.column_stack([(ages - mean_age) / std_age, \n                          (revenus - mean_rev) / std_rev])\n\nax = axes[1]\nax.scatter(X_norm[y_raw == 0, 0], X_norm[y_raw == 0, 1], c='C0', s=60, label='Classe 0')\nax.scatter(X_norm[y_raw == 1, 0], X_norm[y_raw == 1, 1], c='C1', s=60, label='Classe 1')\nax.scatter([x1_norm[0]], [x1_norm[1]], c='red', s=150, marker='*', zorder=5, label='Requete')\nax.set_xlabel('Age (normalise)')\nax.set_ylabel('Revenu (normalise)')\nax.set_title('Apres normalisation\\n(echelles comparables)')\nax.legend()\nax.set_aspect('equal')\nax.grid(True, alpha=0.3)\n\nplt.tight_layout()\nplt.show()","key":"XFwU8OAZ12"},{"type":"outputs","id":"vYqueF2lZadH0xmReh-7J","children":[{"type":"output","children":[],"jupyter_data":{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"<Figure size 1200x500 with 2 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"db2693c68e19c055477d067fe281680f","path":"/mlbook/build/db2693c68e19c055477d067fe281680f.png"}}},"key":"oJzXS18ITX"}],"key":"Trk6WR7XOL"}],"key":"RmCpJ0Ua5T"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Question","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"hU2iEYnsV7"}],"key":"ZNQGgQ23sr"},{"type":"text","value":": Quelle variable domine le calcul de distance sans normalisation? Pourquoi est-ce problematique pour k-ppv?","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Jpr2jFY8JC"}],"key":"GJ0z2D5GNz"}],"key":"BcUJ2HDujy"},{"type":"block","kind":"notebook-content","children":[{"type":"thematicBreak","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"CxJOhHlmMg"},{"type":"heading","depth":2,"position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"Recapitulatif","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"My5vD9XdVh"}],"identifier":"recapitulatif","label":"Recapitulatif","html_id":"recapitulatif","implicit":true,"key":"aG5xPkmAhn"},{"type":"paragraph","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"Dans ce TP, vous avez appris:","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"ePBmllmGgz"}],"key":"f8Pcs0zYCy"},{"type":"list","ordered":true,"start":1,"spread":false,"position":{"start":{"line":6,"column":1},"end":{"line":16,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":6,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"strong","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"Algorithme k-ppv","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"yNxv8F14SQ"}],"key":"HnZZymWJDO"},{"type":"text","value":": Classifier par vote majoritaire des k voisins les plus proches","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"o87NO4yivo"}],"key":"X82zAS4uvT"}],"key":"eTjBGZL2yV"},{"type":"listItem","spread":true,"position":{"start":{"line":8,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"strong","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"Effet de k","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"Thsmji7fBD"}],"key":"FHgfr4owol"},{"type":"text","value":":","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"X9ybjvNBHK"}],"key":"SIEpj6mWPn"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":9,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Petit k = frontiere irreguliere (haute variance)","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"fEkF9pynmy"}],"key":"UD06yQ5Uvz"}],"key":"px3sX2tPni"},{"type":"listItem","spread":true,"position":{"start":{"line":10,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Grand k = frontiere lisse (haut biais)","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"NVsXsRtKvo"}],"key":"bnfrcBKwm6"}],"key":"euQ9YGlqeg"}],"key":"X8mKgN0WT5"}],"key":"TvSQFJ70aQ"},{"type":"listItem","spread":true,"position":{"start":{"line":12,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"strong","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"text","value":"Fonctions de distance","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"RDMvPQTbWX"}],"key":"xG5gKeFK10"},{"type":"text","value":": ","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"VMKAHFIOss"},{"type":"inlineMath","value":"\\ell_1","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi mathvariant=\"normal\">ℓ</mi><mn>1</mn></msub></mrow><annotation encoding=\"application/x-tex\">\\ell_1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8444em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord\">ℓ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"GZtlOjtdPc"},{"type":"text","value":" (Manhattan), ","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"gu9bUc9moj"},{"type":"inlineMath","value":"\\ell_2","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi mathvariant=\"normal\">ℓ</mi><mn>2</mn></msub></mrow><annotation encoding=\"application/x-tex\">\\ell_2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8444em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord\">ℓ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"XIXpUPbHXD"},{"type":"text","value":" (Euclidienne), ","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"yGD8nasORt"},{"type":"inlineMath","value":"\\ell_\\infty","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi mathvariant=\"normal\">ℓ</mi><mi mathvariant=\"normal\">∞</mi></msub></mrow><annotation encoding=\"application/x-tex\">\\ell_\\infty</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8444em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord\">ℓ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">∞</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"gAD3lm4BfJ"}],"key":"bODjoYunNf"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":13,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":13,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"La forme de la boule unite definit ce qui est “equidistant”","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"K6YgHqSIyt"}],"key":"wZIzwdfYur"}],"key":"bf5v0TUhda"}],"key":"ddUgRtpCZV"}],"key":"IqXtyeKOIO"},{"type":"listItem","spread":true,"position":{"start":{"line":15,"column":1},"end":{"line":16,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"strong","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"text","value":"Normalisation","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"LJmL581jAd"}],"key":"MwuCDjEtfJ"},{"type":"text","value":": Indispensable quand les variables ont des echelles differentes","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"wqmO4pXQio"}],"key":"uXO5p6Ru3d"}],"key":"VJBAkb7zRZ"}],"key":"zyNPZTWDl7"},{"type":"thematicBreak","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"EkMW3AUmcv"},{"type":"paragraph","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"children":[{"type":"strong","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"children":[{"type":"text","value":"Pour aller plus loin","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"ZTxY4C3q81"}],"key":"Nw7xRWnW50"},{"type":"text","value":": ","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"dogwC1ypQH"},{"type":"link","url":"https://pierrelux.github.io/mlbook/drafts/knn","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"children":[{"type":"text","value":"Chapitre complet sur le site du cours","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"qAJIsGhjYO"}],"urlSource":"https://pierrelux.github.io/mlbook/drafts/knn","key":"RyHNKI4oAK"}],"key":"e4MALdChwr"}],"key":"MctEdwN3rP"}],"key":"hOPRBiW30R"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"Le cadre probabiliste","url":"/ch5-probabilistic","group":"Partie I: Fondements"},"next":{"title":"TP1: Le problème d’apprentissage","url":"/tp1-learning-problem","group":"Travaux Pratiques"}}},"domain":"http://localhost:3001"}