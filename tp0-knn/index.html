<!DOCTYPE html><html lang="en" class="" style="scroll-padding:60px"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1"/><title>TP0: Les k plus proches voisins - Fondements de l&#x27;apprentissage machine</title><meta property="og:title" content="TP0: Les k plus proches voisins - Fondements de l&#x27;apprentissage machine"/><meta name="generator" content="mystmd"/><meta name="description" content="Un manuel d&#x27;introduction à l&#x27;apprentissage machine couvrant les méthodes supervisées et non-supervisées, des algorithmes classiques aux réseaux de neurones modernes."/><meta property="og:description" content="Un manuel d&#x27;introduction à l&#x27;apprentissage machine couvrant les méthodes supervisées et non-supervisées, des algorithmes classiques aux réseaux de neurones modernes."/><meta name="keywords" content=""/><meta name="image" content="/mlbook/build/7e2db436150c38a00650f96925aa5581.svg"/><meta property="og:image" content="/mlbook/build/7e2db436150c38a00650f96925aa5581.svg"/><link rel="stylesheet" href="/mlbook/build/_assets/app-AIT5GAEP.css"/><link rel="stylesheet" href="/mlbook/build/_assets/thebe-core-VKVHG5VY.css"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/jupyter-matplotlib@0.11.3/css/mpl_widget.css"/><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.css"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.2/dist/katex.min.css" integrity="sha384-MlJdn/WNKDGXveldHDdyRP1R4CTHr3FeuDNfhsLPYrq2t0UBkUdK2jyTnXPEK1NQ" crossorigin="anonymous"/><link rel="icon" href="/mlbook/favicon.ico"/><link rel="stylesheet" href="/mlbook/myst-theme.css"/><script>
  const savedTheme = localStorage.getItem("myst:theme");
  const theme = window.matchMedia("(prefers-color-scheme: light)").matches ? 'light' : 'dark';
  const classes = document.documentElement.classList;
  const hasAnyTheme = classes.contains('light') || classes.contains('dark');
  if (!hasAnyTheme) classes.add(savedTheme ?? theme);
</script></head><body class="m-0 transition-colors duration-500 bg-white dark:bg-stone-900"><div class="myst-skip-to-article fixed top-1 left-1 h-[0px] w-[0px] focus-within:z-40 focus-within:h-auto focus-within:w-auto bg-white overflow-hidden focus-within:p-2 focus-within:ring-1" aria-label="skip to content options"><a href="#skip-to-frontmatter" class="myst-skip-to-link block px-2 py-1 text-black underline">Skip to article frontmatter</a><a href="#skip-to-article" class="myst-skip-to-link block px-2 py-1 text-black underline">Skip to article content</a></div><dialog id="myst-no-css" style="position:fixed;left:0px;top:0px;width:100vw;height:100vh;font-size:4rem;padding:1rem;color:black;background:white"><strong>Site not loading correctly?</strong><p>This may be due to an incorrect <code>BASE_URL</code> configuration. See<!-- --> <a href="https://mystmd.org/guide/deployment#deploy-base-url">the MyST Documentation</a> <!-- -->for reference.</p><script>
    (() => {
            // Test for has-styling variable set by the MyST stylesheet
            const node = document.currentScript.parentNode;
            const hasCSS = window.getComputedStyle(node).getPropertyValue("--has-styling");
            if (hasCSS === ""){
                    node.showModal();
            }

    })()
</script></dialog><div class="myst-top-nav bg-white/80 backdrop-blur dark:bg-stone-900/80 shadow dark:shadow-stone-700 p-3 md:px-8 sticky w-screen top-0 z-30 h-[60px]"><nav class="myst-top-nav-bar flex items-center justify-between flex-nowrap max-w-[1440px] mx-auto"><div class="flex flex-row xl:min-w-[19.5rem] mr-2 sm:mr-7 justify-start items-center shrink-0"><div class="block xl:hidden"><button class="myst-top-nav-menu-button flex items-center justify-center border-stone-400 text-stone-800 hover:text-stone-900 dark:text-stone-200 hover:dark:text-stone-100 w-10 h-10"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" width="1.5rem" height="1.5rem"><path fill-rule="evenodd" d="M3 6.75A.75.75 0 0 1 3.75 6h16.5a.75.75 0 0 1 0 1.5H3.75A.75.75 0 0 1 3 6.75ZM3 12a.75.75 0 0 1 .75-.75h16.5a.75.75 0 0 1 0 1.5H3.75A.75.75 0 0 1 3 12Zm0 5.25a.75.75 0 0 1 .75-.75h16.5a.75.75 0 0 1 0 1.5H3.75a.75.75 0 0 1-.75-.75Z" clip-rule="evenodd"></path></svg><span class="sr-only">Open Menu</span></button></div><a class="myst-home-link flex items-center ml-3 dark:text-white w-fit md:ml-5 xl:ml-7" href="/mlbook/"><span class="text-md sm:text-xl tracking-tight sm:mr-5">IFT6390</span></a></div><div class="flex items-center flex-grow w-auto"><div class="flex-grow hidden text-md lg:block"></div><div class="flex-grow block"></div><button type="button" aria-haspopup="dialog" aria-expanded="false" aria-controls="radix-:R75cp:" data-state="closed" class="myst-search-bar flex items-center h-10 aspect-square sm:w-64 text-left text-gray-600 border border-gray-300 dark:border-gray-600 rounded-lg bg-gray-50 dark:bg-gray-700 myst-search-bar-disabled hover:ring-blue-500 dark:hover:ring-blue-500 hover:border-blue-500 dark:hover:border-blue-500"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" class="p-2.5 h-10 w-10 aspect-square"><path fill-rule="evenodd" d="M10.5 3.75a6.75 6.75 0 1 0 0 13.5 6.75 6.75 0 0 0 0-13.5ZM2.25 10.5a8.25 8.25 0 1 1 14.59 5.28l4.69 4.69a.75.75 0 1 1-1.06 1.06l-4.69-4.69A8.25 8.25 0 0 1 2.25 10.5Z" clip-rule="evenodd"></path></svg><span class="myst-search-text-placeholder hidden sm:block grow">Search</span><div aria-hidden="true" class="myst-search-shortcut items-center hidden mx-1 font-mono text-sm text-gray-600 sm:flex gap-x-1"><kbd class="px-2 py-1 border border-gray-300 dark:border-gray-600 rounded-md shadow-[0px_2px_0px_0px_rgba(0,0,0,0.08)] dark:shadow-none hide-mac">CTRL</kbd><kbd class="px-2 py-1 border border-gray-300 dark:border-gray-600 rounded-md shadow-[0px_2px_0px_0px_rgba(0,0,0,0.08)] dark:shadow-none show-mac">⌘</kbd><kbd class="px-2 py-1 border border-gray-300 dark:border-gray-600 rounded-md shadow-[0px_2px_0px_0px_rgba(0,0,0,0.08)] dark:shadow-none ">K</kbd><script>
;(() => {
const script = document.currentScript;
const root = script.parentElement;

const isMac = /mac/i.test(
      window.navigator.userAgentData?.platform ?? window.navigator.userAgent,
    );
root.querySelectorAll(".hide-mac").forEach(node => {node.classList.add(isMac ? "hidden" : "block")});
root.querySelectorAll(".show-mac").forEach(node => {node.classList.add(!isMac ? "hidden" : "block")});
})()</script></div></button><button class="myst-theme-button theme rounded-full aspect-square border border-stone-700 dark:border-white hover:bg-neutral-100 border-solid overflow-hidden text-stone-700 dark:text-white hover:text-stone-500 dark:hover:text-neutral-800 w-10 h-10 mx-3" title="Toggle theme between light and dark mode" aria-label="Toggle theme between light and dark mode"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" class="myst-theme-moon-icon h-full w-full p-0.5 hidden dark:block"><path fill-rule="evenodd" d="M9.528 1.718a.75.75 0 0 1 .162.819A8.97 8.97 0 0 0 9 6a9 9 0 0 0 9 9 8.97 8.97 0 0 0 3.463-.69.75.75 0 0 1 .981.98 10.503 10.503 0 0 1-9.694 6.46c-5.799 0-10.5-4.7-10.5-10.5 0-4.368 2.667-8.112 6.46-9.694a.75.75 0 0 1 .818.162Z" clip-rule="evenodd"></path></svg><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" class="myst-theme-sun-icon h-full w-full p-0.5 dark:hidden"><path stroke-linecap="round" stroke-linejoin="round" d="M12 3v2.25m6.364.386-1.591 1.591M21 12h-2.25m-.386 6.364-1.591-1.591M12 18.75V21m-4.773-4.227-1.591 1.591M5.25 12H3m4.227-4.773L5.636 5.636M15.75 12a3.75 3.75 0 1 1-7.5 0 3.75 3.75 0 0 1 7.5 0Z"></path></svg></button><div class="block sm:hidden"><div class="myst-action-menu relative" data-headlessui-state=""><div><button class="myst-action-menu-button flex text-sm bg-transparent rounded-full focus:outline-none" id="headlessui-menu-button-:Rr5cp:" type="button" aria-haspopup="menu" aria-expanded="false" data-headlessui-state=""><span class="sr-only">Open Menu</span><div class="flex items-center text-stone-200 hover:text-white"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" width="2rem" height="2rem" class="p-1"><path fill-rule="evenodd" d="M10.5 6a1.5 1.5 0 1 1 3 0 1.5 1.5 0 0 1-3 0Zm0 6a1.5 1.5 0 1 1 3 0 1.5 1.5 0 0 1-3 0Zm0 6a1.5 1.5 0 1 1 3 0 1.5 1.5 0 0 1-3 0Z" clip-rule="evenodd"></path></svg></div></button></div></div></div><div class="hidden sm:block"><a href="https://github.com/pierrelux/mlbook" target="_blank" rel="noopener noreferrer" class="inline-block px-4 py-2 mx-1 mt-0 leading-none border rounded text-md border-stone-700 dark:border-white text-stone-700 dark:text-white hover:text-stone-500 dark:hover:text-neutral-800 hover:bg-neutral-100">View on GitHub</a></div></div></nav></div><div class="myst-primary-sidebar fixed xl:article-grid grid-gap xl:w-screen xl:pointer-events-none overflow-auto max-xl:min-w-[300px] hidden z-10" style="top:60px"><div class="myst-primary-sidebar-pointer pointer-events-auto xl:col-margin-left flex-col overflow-hidden hidden xl:flex"><div class="myst-primary-sidebar-nav flex-grow py-6 overflow-y-auto primary-scrollbar"><nav aria-label="Navigation" class="myst-primary-sidebar-topnav overflow-y-hidden transition-opacity ml-3 xl:ml-0 mr-3 max-w-[350px] lg:hidden"><div class="w-full px-1 dark:text-white font-medium"></div></nav><div class="my-3 border-b-2 lg:hidden"></div><nav aria-label="Table of Contents" class="myst-primary-sidebar-toc flex-grow overflow-y-hidden transition-opacity ml-3 xl:ml-0 mr-3 max-w-[350px]"><div class="myst-toc w-full px-1 dark:text-white"><a title="Fondements de l&#x27;apprentissage machine" class="block break-words focus:outline outline-blue-200 outline-2 rounded myst-toc-item p-2 my-1 rounded-lg hover:bg-slate-300/30 font-bold" href="/mlbook/">Fondements de l&#x27;apprentissage machine</a><a title="Méthodes non paramétriques" class="block break-words focus:outline outline-blue-200 outline-2 rounded myst-toc-item p-2 my-1 rounded-lg hover:bg-slate-300/30" href="/mlbook/knn">Méthodes non paramétriques</a><a title="Le problème d’apprentissage" class="block break-words focus:outline outline-blue-200 outline-2 rounded myst-toc-item p-2 my-1 rounded-lg hover:bg-slate-300/30" href="/mlbook/learning-problem">Le problème d’apprentissage</a><div data-state="closed" class="w-full"><div class="myst-toc-item flex flex-row w-full gap-2 px-2 my-1 text-left rounded-lg outline-none hover:bg-slate-300/30"><div title="Travaux Pratiques" class="block break-words rounded py-2 grow cursor-pointer">Travaux Pratiques</div><button class="self-center flex-none rounded-md group hover:bg-slate-300/30 focus:outline outline-blue-200 outline-2" aria-label="Open Folder" type="button" aria-controls="radix-:R16psp:" aria-expanded="false" data-state="closed"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" class="transition-transform duration-300 group-data-[state=open]:rotate-90 text-text-slate-700 dark:text-slate-100" height="1.5rem" width="1.5rem"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 0 1 0 1.06l-7.5 7.5a.75.75 0 0 1-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 0 1 1.06-1.06l7.5 7.5Z" clip-rule="evenodd"></path></svg></button></div><div data-state="closed" id="radix-:R16psp:" hidden="" class="pl-3 pr-[2px] collapsible-content"></div></div></div></nav></div><div class="myst-primary-sidebar-footer flex-none py-6 transition-all duration-700 translate-y-6 opacity-0"><a class="myst-made-with-myst flex mx-auto text-gray-700 w-fit hover:text-blue-700 dark:text-gray-200 dark:hover:text-blue-400" href="https://mystmd.org/made-with-myst" target="_blank" rel="noreferrer"><svg style="width:24px;height:24px" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100" stroke="none"><g id="icon"><path fill="currentColor" d="M23.8,54.8v-3.6l4.7-0.8V17.5l-4.7-0.8V13H36l13.4,31.7h0.2l13-31.7h12.6v3.6l-4.7,0.8v32.9l4.7,0.8v3.6h-15
          v-3.6l4.9-0.8V20.8H65L51.4,53.3h-3.8l-14-32.5h-0.1l0.2,17.4v12.1l5,0.8v3.6H23.8z"></path><path fill="#F37726" d="M47,86.9c0-5.9-3.4-8.8-10.1-8.8h-8.4c-5.2,0-9.4-1.3-12.5-3.8c-3.1-2.5-5.4-6.2-6.8-11l4.8-1.6
          c1.8,5.6,6.4,8.6,13.8,8.8h9.2c6.4,0,10.8,2.5,13.1,7.5c2.3-5,6.7-7.5,13.1-7.5h8.4c7.8,0,12.7-2.9,14.6-8.7l4.8,1.6
          c-1.4,4.9-3.6,8.6-6.8,11.1c-3.1,2.5-7.3,3.7-12.4,3.8H63c-6.7,0-10,2.9-10,8.8"></path></g></svg><span class="self-center ml-2 text-sm">Made with MyST</span></a></div></div></div><main class="article-grid grid-gap"><article class="article-grid subgrid-gap col-screen article content"><div class="hidden"></div><div id="skip-to-frontmatter" aria-label="article frontmatter" class="myst-fm-block mb-8 pt-9"><div class="myst-fm-block-header flex items-center mb-5 h-6 text-sm font-light"><div class="flex-grow"></div><div class="myst-fm-block-badges"><a href="https://github.com/pierrelux/mlbook" title="GitHub Repository: pierrelux/mlbook" target="_blank" rel="noopener noreferrer" class="myst-fm-github-link text-inherit hover:text-inherit"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" width="1.25rem" height="1.25rem" class="myst-fm-github-icon inline-block mr-1 opacity-60 hover:opacity-100"><path d="M12 2.5c-5.4 0-9.8 4.4-9.8 9.7 0 4.3 2.8 8 6.7 9.2.5.1.7-.2.7-.5v-1.8c-2.4.5-3.1-.6-3.3-1.1-.1-.3-.6-1.1-1-1.4-.3-.2-.8-.6 0-.6s1.3.7 1.5 1c.9 1.5 2.3 1.1 2.8.8.1-.6.3-1.1.6-1.3-2.2-.2-4.4-1.1-4.4-4.8 0-1.1.4-1.9 1-2.6-.1-.2-.4-1.2.1-2.6 0 0 .8-.3 2.7 1 .8-.2 1.6-.3 2.4-.3.8 0 1.7.1 2.4.3 1.9-1.3 2.7-1 2.7-1 .5 1.3.2 2.3.1 2.6.6.7 1 1.5 1 2.6 0 3.7-2.3 4.6-4.4 4.8.4.3.7.9.7 1.8V21c0 .3.2.6.7.5 3.9-1.3 6.6-4.9 6.6-9.2 0-5.4-4.4-9.8-9.8-9.8z"></path></svg></a></div><a href="https://github.com/pierrelux/mlbook/edit/main/exercises/tp0_knn.ipynb" title="Edit This Page" target="_blank" rel="noopener noreferrer" class="myst-fm-edit-link text-inherit hover:text-inherit"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="1.25rem" height="1.25rem" class="myst-fm-edit-icon inline-block mr-1 opacity-60 hover:opacity-100"><path stroke-linecap="round" stroke-linejoin="round" d="m16.862 4.487 1.687-1.688a1.875 1.875 0 1 1 2.652 2.652L10.582 16.07a4.5 4.5 0 0 1-1.897 1.13L6 18l.8-2.685a4.5 4.5 0 0 1 1.13-1.897l8.932-8.931Zm0 0L19.5 7.125M18 14v4.75A2.25 2.25 0 0 1 15.75 21H5.25A2.25 2.25 0 0 1 3 18.75V8.25A2.25 2.25 0 0 1 5.25 6H10"></path></svg></a><div class="myst-fm-downloads-dropdown relative flex inline-block mx-1 grow-0" data-headlessui-state=""><button class="myst-fm-downloads-button relative ml-2 -mr-1" id="headlessui-menu-button-:Rs8ucp:" type="button" aria-haspopup="menu" aria-expanded="false" data-headlessui-state=""><span class="sr-only">Downloads</span><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="1.25rem" height="1.25rem" class="myst-fm-downloads-icon"><title>Download</title><path stroke-linecap="round" stroke-linejoin="round" d="M3 16.5v2.25A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75V16.5M16.5 12 12 16.5m0 0L7.5 12m4.5 4.5V3"></path></svg></button></div></div><h1 class="myst-fm-block-title mb-0">TP0: Les k plus proches voisins</h1><header class="myst-fm-authors-affiliations mt-4 not-prose"><div class="myst-fm-authors-list"><span class="myst-fm-author font-semibold text-sm myst-fm-author-item inline-block"><button class="myst-fm-author-popover focus:shadow-[0_0_0_2px] focus:shadow-black outline-none hover:underline" aria-label="Author Details" type="button" aria-haspopup="dialog" aria-expanded="false" aria-controls="radix-:R78ucp:" data-state="closed"><span class="myst-fm-author-name">Pierre-Luc Bacon</span></button></span></div></header></div><div class="block my-10 lg:sticky lg:z-10 lg:h-0 lg:pt-0 lg:my-0 lg:ml-10 lg:col-margin-right" style="top:60px"><nav></nav></div><div id="skip-to-article"></div><div id="ssWjkH0ayo" class="myst-jp-nb-block relative group/block"><p><strong>IFT6390 - Fondements de l’apprentissage machine</strong></p><p><a target="_blank" rel="noreferrer" href="https://colab.research.google.com/github/pierrelux/mlbook/blob/main/exercises/tp0_knn.ipynb" class=""><img id="C70hD1GpkI" style="margin-left:auto;margin-right:auto" src="/mlbook/build/7e2db436150c38a00650f96925aa5581.svg" alt="Open In Colab" data-canonical-url="https://colab.research.google.com/assets/colab-badge.svg" class=""/></a></p><p>Ce notebook accompagne le <a target="_blank" rel="noreferrer" href="https://pierrelux.github.io/mlbook/drafts/knn" class="">Chapitre 1: Methodes non parametriques</a>.</p><h2 id="objectifs" class="relative group"><span class="heading-text">Objectifs</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#objectifs" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><p>A la fin de ce TP, vous serez en mesure de:</p><ul><li><p>Comprendre l’algorithme des k plus proches voisins (k-ppv)</p></li><li><p>Observer l’effet du parametre k sur les predictions</p></li><li><p>Comparer differentes fonctions de distance</p></li><li><p>Apprecier l’importance de la normalisation des donnees</p></li></ul><hr class="py-2 my-5 translate-y-2"/></div><div id="Hc0B0UuaMR" class="myst-jp-nb-block relative group/block"><h2 id="partie-0-configuration" class="relative group"><span class="heading-text">Partie 0: Configuration</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#partie-0-configuration" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><p>Executez cette cellule pour importer les bibliotheques necessaires.</p></div><div id="CDalFKh9Gg" class="myst-jp-nb-block relative group/block"><div class="myst-jp-nb-block-spinner flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="myst-jp-nb-block sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute -top-[12px] right-0 flex flex-row rounded bg-white dark:bg-slate-800"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">import numpy as np
import matplotlib.pyplot as plt
from matplotlib.colors import ListedColormap

# Pour de jolis graphiques
plt.rcParams[&#x27;figure.figsize&#x27;] = (8, 5)
plt.rcParams[&#x27;font.size&#x27;] = 12

print(&quot;Configuration terminee!&quot;)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-name="outputs-container" data-mdast-node-id="WCT1RnEABv_RwyrNODRsb" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>Configuration terminee!
</span></code></pre></div></div></div></div><div id="YLjvOcChOJ" class="myst-jp-nb-block relative group/block"><h2 id="partie-1-lalgorithme-k-ppv" class="relative group"><span class="heading-text">Partie 1: L’algorithme k-ppv</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#partie-1-lalgorithme-k-ppv" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><p>L’idee des k plus proches voisins est simple: pour classifier un nouveau point, on regarde les <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span></span> points d’entrainement les plus proches et on prend un vote majoritaire.</p><h3 id="les-donnees" class="relative group"><span class="heading-text">Les donnees</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#les-donnees" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><p>Commencons par generer un jeu de donnees de classification 2D.</p></div><div id="Pt7fo5Pm2C" class="myst-jp-nb-block relative group/block"><div class="myst-jp-nb-block-spinner flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="myst-jp-nb-block sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute -top-[12px] right-0 flex flex-row rounded bg-white dark:bg-slate-800"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># Generation de donnees de classification
np.random.seed(42)
n_per_class = 15

# Classe 0: groupe autour de (-1, -1)
X0 = np.random.randn(n_per_class, 2) * 0.6 + np.array([-1, -1])
# Classe 1: groupe autour de (1, 1)
X1 = np.random.randn(n_per_class, 2) * 0.6 + np.array([1, 1])

X_train = np.vstack([X0, X1])
y_train = np.array([0] * n_per_class + [1] * n_per_class)

print(f&quot;Nombre de points: {len(X_train)}&quot;)
print(f&quot;Classes: {np.unique(y_train)}&quot;)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-name="outputs-container" data-mdast-node-id="mGjdcC1Z2zFGo4fNeQHlo" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>Nombre de points: 30
Classes: [0 1]
</span></code></pre></div></div></div></div><div id="TnUWHHqDkN" class="myst-jp-nb-block relative group/block"><div class="myst-jp-nb-block-spinner flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="myst-jp-nb-block sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute -top-[12px] right-0 flex flex-row rounded bg-white dark:bg-slate-800"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># Visualisation des donnees
plt.figure(figsize=(7, 6))
plt.scatter(X_train[y_train == 0, 0], X_train[y_train == 0, 1], 
           c=&#x27;C0&#x27;, s=60, label=&#x27;Classe 0&#x27;, edgecolors=&#x27;k&#x27;, linewidths=0.5)
plt.scatter(X_train[y_train == 1, 0], X_train[y_train == 1, 1], 
           c=&#x27;C1&#x27;, s=60, label=&#x27;Classe 1&#x27;, edgecolors=&#x27;k&#x27;, linewidths=0.5)
plt.xlabel(&#x27;$x_1$&#x27;)
plt.ylabel(&#x27;$x_2$&#x27;)
plt.legend()
plt.title(&#x27;Donnees d\&#x27;entrainement&#x27;)
plt.axis(&#x27;equal&#x27;)
plt.grid(True, alpha=0.3)
plt.show()</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-name="outputs-container" data-mdast-node-id="ZPB2wZp6hR9BDi1032b7Y" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div data-name="safe-output-image"><img src="/mlbook/build/afb328f42911717142a430799494ceac.png" alt="&lt;Figure size 700x600 with 1 Axes&gt;"/></div></div></div><div id="lEAZ7RJ2q6" class="myst-jp-nb-block relative group/block"><h3 id="visualiser-les-k-voisins" class="relative group"><span class="heading-text">Visualiser les k voisins</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#visualiser-les-k-voisins" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><p>Pour un point requete, identifions ses <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span></span> plus proches voisins.</p></div><div id="Y23WXA6TZ0" class="myst-jp-nb-block relative group/block"><div class="myst-jp-nb-block-spinner flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="myst-jp-nb-block sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute -top-[12px] right-0 flex flex-row rounded bg-white dark:bg-slate-800"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># Point requete
x_query = np.array([0.3, 0.2])
k = 5

# Calcul des distances euclidiennes
distances = np.sqrt(np.sum((X_train - x_query)**2, axis=1))

# Indices des k plus proches
k_nearest_idx = np.argsort(distances)[:k]

print(f&quot;Point requete: {x_query}&quot;)
print(f&quot;\nLes {k} plus proches voisins:&quot;)
for i, idx in enumerate(k_nearest_idx):
    print(f&quot;  Voisin {i+1}: point {idx}, distance = {distances[idx]:.3f}, classe = {y_train[idx]}&quot;)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-name="outputs-container" data-mdast-node-id="vmG0oejsZ-7XUOoDouVTK" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>Point requete: [0.3 0.2]

Les 5 plus proches voisins:
  Voisin 1: point 22, distance = 0.413, classe = 1
  Voisin 2: point 28, distance = 0.645, classe = 1
  Voisin 3: point 16, distance = 0.711, classe = 1
  Voisin 4: point 3, distance = 0.819, classe = 0
  Voisin 5: point 21, distance = 0.884, classe = 1
</span></code></pre></div></div></div></div><div id="GCQwGncNgo" class="myst-jp-nb-block relative group/block"><div class="myst-jp-nb-block-spinner flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="myst-jp-nb-block sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute -top-[12px] right-0 flex flex-row rounded bg-white dark:bg-slate-800"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># Visualisation des k voisins
fig, ax = plt.subplots(figsize=(7, 6))

# Points d&#x27;entrainement
ax.scatter(X_train[y_train == 0, 0], X_train[y_train == 0, 1], 
           c=&#x27;C0&#x27;, s=60, label=&#x27;Classe 0&#x27;, zorder=2)
ax.scatter(X_train[y_train == 1, 0], X_train[y_train == 1, 1], 
           c=&#x27;C1&#x27;, s=60, label=&#x27;Classe 1&#x27;, zorder=2)

# Lignes vers les k voisins et cercles autour
for idx in k_nearest_idx:
    ax.plot([x_query[0], X_train[idx, 0]], [x_query[1], X_train[idx, 1]], 
            &#x27;k--&#x27;, alpha=0.4, linewidth=1, zorder=1)
    ax.scatter(X_train[idx, 0], X_train[idx, 1], 
               s=150, facecolors=&#x27;none&#x27;, edgecolors=&#x27;black&#x27;, linewidths=2, zorder=3)

# Point requete
ax.scatter(x_query[0], x_query[1], c=&#x27;red&#x27;, s=120, marker=&#x27;*&#x27;, 
           label=&#x27;Requete&#x27;, zorder=4)

# Compter les votes
votes = y_train[k_nearest_idx]
n_class0 = np.sum(votes == 0)
n_class1 = np.sum(votes == 1)
prediction = 0 if n_class0 &gt; n_class1 else 1

ax.set_xlabel(&#x27;$x_1$&#x27;)
ax.set_ylabel(&#x27;$x_2$&#x27;)
ax.legend(loc=&#x27;upper left&#x27;)
ax.set_title(f&#x27;$k = {k}$: votes = [{n_class0} classe 0, {n_class1} classe 1] -&gt; prediction: classe {prediction}&#x27;)
ax.set_aspect(&#x27;equal&#x27;)
ax.grid(True, alpha=0.3)
plt.tight_layout()
plt.show()</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-name="outputs-container" data-mdast-node-id="PiE8cRBaQIBsUHWRQZStM" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div data-name="safe-output-image"><img src="/mlbook/build/704f4e8170edbc7022532c9850590032.png" alt="&lt;Figure size 700x600 with 1 Axes&gt;"/></div></div></div><div id="NvCh4xJe1Y" class="myst-jp-nb-block relative group/block"><h3 id="exercice-implementer-le-vote-majoritaire" class="relative group"><span class="heading-text">Exercice: Implementer le vote majoritaire</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#exercice-implementer-le-vote-majoritaire" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><p>Completez la fonction ci-dessous pour compter les votes et predire la classe.</p></div><div id="x8YETZPWvR" class="myst-jp-nb-block relative group/block"><div class="myst-jp-nb-block-spinner flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="myst-jp-nb-block sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute -top-[12px] right-0 flex flex-row rounded bg-white dark:bg-slate-800"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">def knn_predict(X_train, y_train, x_query, k):
    &quot;&quot;&quot;
    Predit la classe d&#x27;un point en utilisant les k plus proches voisins.
    
    Parametres:
        X_train: array (N, d) - points d&#x27;entrainement
        y_train: array (N,) - etiquettes (0 ou 1)
        x_query: array (d,) - point a classifier
        k: int - nombre de voisins
    
    Retourne:
        prediction: int (0 ou 1)
    &quot;&quot;&quot;
    # TODO: Calculer les distances euclidiennes de x_query a tous les points
    distances = None  # A completer
    
    # TODO: Trouver les indices des k plus proches voisins
    k_nearest_idx = None  # A completer
    
    # TODO: Recuperer les etiquettes des k voisins
    k_labels = None  # A completer
    
    # TODO: Vote majoritaire (retourner 0 ou 1)
    prediction = None  # A completer
    
    return prediction

# Test de votre fonction
test_pred = knn_predict(X_train, y_train, x_query, k=5)
print(f&quot;Prediction pour {x_query}: classe {test_pred}&quot;)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-name="outputs-container" data-mdast-node-id="axtk2HRJVLl67aF2YIZo9" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>Prediction pour [0.3 0.2]: classe None
</span></code></pre></div></div></div></div><div id="wPZFy5Zwgt" class="myst-jp-nb-block relative group/block"><details class="myst-dropdown rounded-md my-5 shadow dark:shadow-2xl dark:shadow-neutral-900 overflow-hidden bg-gray-50 dark:bg-stone-800"><summary class="myst-dropdown-header m-0 text-lg font-medium py-1 min-h-[2em] pl-3 cursor-pointer hover:shadow-[inset_0_0_0px_30px_#00000003] dark:hover:shadow-[inset_0_0_0px_30px_#FFFFFF03] bg-gray-100 dark:bg-slate-900"><span class="myst-dropdown-header-title text-neutral-900 dark:text-white"><span class="block float-right text-sm font-thin text-neutral-700 dark:text-neutral-200"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" width="1.5rem" height="1.5rem" class="myst-dropdown-header-icon inline-block pl-2 mr-2 -translate-y-[1px] details-toggle transition-transform"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 0 1 0 1.06l-7.5 7.5a.75.75 0 0 1-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 0 1 1.06-1.06l7.5 7.5Z" clip-rule="evenodd"></path></svg></span><strong>Solution</strong> (cliquez pour afficher)</span></summary><div class="myst-dropdown-body px-4 py-1 details-body"><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 bg-stone-200/10"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">def knn_predict(X_train, y_train, x_query, k):
    # Calculer les distances euclidiennes
    distances = np.sqrt(np.sum((X_train - x_query)**2, axis=1))
    
    # Trouver les indices des k plus proches voisins
    k_nearest_idx = np.argsort(distances)[:k]
    
    # Recuperer les etiquettes des k voisins
    k_labels = y_train[k_nearest_idx]
    
    # Vote majoritaire
    prediction = 1 if np.sum(k_labels) &gt; k/2 else 0
    
    return prediction</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div></div></details></div><div id="jl2IofDx7P" class="myst-jp-nb-block relative group/block"><hr class="py-2 my-5 translate-y-2"/><h2 id="partie-2-effet-de-k" class="relative group"><span class="heading-text">Partie 2: Effet de k</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#partie-2-effet-de-k" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><p>Le parametre <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span></span> controle la complexite du modele:</p><ul><li><p><strong><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">k=1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span></span></strong>: Frontiere tres irreguliere, erreur d’entrainement = 0</p></li><li><p><strong>Grand <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span></span></strong>: Frontiere plus lisse, tend vers la classe majoritaire</p></li></ul><p>Visualisons la frontiere de decision pour differentes valeurs de <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span></span>.</p></div><div id="i9XN0j6xsH" class="myst-jp-nb-block relative group/block"><div class="myst-jp-nb-block-spinner flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="myst-jp-nb-block sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute -top-[12px] right-0 flex flex-row rounded bg-white dark:bg-slate-800"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">def knn_predict_batch(X_train, y_train, X_test, k):
    &quot;&quot;&quot;Predit les classes pour un ensemble de points.&quot;&quot;&quot;
    predictions = []
    for x in X_test:
        distances = np.sqrt(np.sum((X_train - x)**2, axis=1))
        k_nearest_idx = np.argsort(distances)[:k]
        k_labels = y_train[k_nearest_idx]
        predictions.append(1 if np.sum(k_labels) &gt; k/2 else 0)
    return np.array(predictions)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-name="outputs-container" data-mdast-node-id="HILBp_nIUD6y45vXkqg8z" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="PUkUalF3Hu" class="myst-jp-nb-block relative group/block"><div class="myst-jp-nb-block-spinner flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="myst-jp-nb-block sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute -top-[12px] right-0 flex flex-row rounded bg-white dark:bg-slate-800"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># Creer une grille pour visualiser la frontiere de decision
x_min, x_max = X_train[:, 0].min() - 0.5, X_train[:, 0].max() + 0.5
y_min, y_max = X_train[:, 1].min() - 0.5, X_train[:, 1].max() + 0.5
xx, yy = np.meshgrid(np.linspace(x_min, x_max, 100),
                     np.linspace(y_min, y_max, 100))
X_mesh = np.c_[xx.ravel(), yy.ravel()]

# Visualiser pour differentes valeurs de k
fig, axes = plt.subplots(1, 3, figsize=(14, 4.5))
k_values = [1, 5, 15]
cmap_light = ListedColormap([&#x27;#FFAAAA&#x27;, &#x27;#AAAAFF&#x27;])

for ax, k in zip(axes, k_values):
    Z = knn_predict_batch(X_train, y_train, X_mesh, k)
    Z = Z.reshape(xx.shape)
    
    ax.contourf(xx, yy, Z, alpha=0.4, cmap=cmap_light)
    ax.scatter(X_train[y_train == 0, 0], X_train[y_train == 0, 1], 
               c=&#x27;C0&#x27;, s=40, edgecolors=&#x27;k&#x27;, linewidths=0.5)
    ax.scatter(X_train[y_train == 1, 0], X_train[y_train == 1, 1], 
               c=&#x27;C1&#x27;, s=40, edgecolors=&#x27;k&#x27;, linewidths=0.5)
    ax.set_xlim(x_min, x_max)
    ax.set_ylim(y_min, y_max)
    ax.set_title(f&#x27;$k = {k}$&#x27;)
    ax.set_xlabel(&#x27;$x_1$&#x27;)
    ax.set_ylabel(&#x27;$x_2$&#x27;)

plt.tight_layout()
plt.show()</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-name="outputs-container" data-mdast-node-id="7zTc_t0tF7E7wNEk0SsQI" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div data-name="safe-output-image"><img src="/mlbook/build/fcb58ce3719b46c173ef85e554a88618.png" alt="&lt;Figure size 1400x450 with 3 Axes&gt;"/></div></div></div><div id="gcKzl8tFGZ" class="myst-jp-nb-block relative group/block"><p><strong>Question</strong>: Que se passe-t-il avec <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">k=1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span></span>? Et avec <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mo>=</mo><mi>N</mi></mrow><annotation encoding="application/x-tex">k=N</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span></span></span></span></span> (tous les points)?</p></div><div id="vMGPp6OkJt" class="myst-jp-nb-block relative group/block"><h3 id="compromis-biais-variance" class="relative group"><span class="heading-text">Compromis biais-variance</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#compromis-biais-variance" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><p>Tracez l’erreur d’entrainement et de test en fonction de <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span></span>.</p></div><div id="QnYcGM6QLP" class="myst-jp-nb-block relative group/block"><div class="myst-jp-nb-block-spinner flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="myst-jp-nb-block sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute -top-[12px] right-0 flex flex-row rounded bg-white dark:bg-slate-800"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># Generer des donnees de test
np.random.seed(123)
X0_test = np.random.randn(50, 2) * 0.6 + np.array([-1, -1])
X1_test = np.random.randn(50, 2) * 0.6 + np.array([1, 1])
X_test = np.vstack([X0_test, X1_test])
y_test = np.array([0] * 50 + [1] * 50)

# Calculer les erreurs pour differents k
k_values = list(range(1, 30, 2))  # k impair pour eviter les egalites
train_errors = []
test_errors = []

for k in k_values:
    y_pred_train = knn_predict_batch(X_train, y_train, X_train, k)
    y_pred_test = knn_predict_batch(X_train, y_train, X_test, k)
    train_errors.append(np.mean(y_pred_train != y_train))
    test_errors.append(np.mean(y_pred_test != y_test))

# Tracer
plt.figure(figsize=(8, 5))
plt.plot(k_values, train_errors, &#x27;o-&#x27;, label=&#x27;Entrainement&#x27;)
plt.plot(k_values, test_errors, &#x27;s-&#x27;, label=&#x27;Test&#x27;)
plt.xlabel(&#x27;$k$ (nombre de voisins)&#x27;)
plt.ylabel(&#x27;Taux d\&#x27;erreur&#x27;)
plt.title(&#x27;Compromis biais-variance&#x27;)
plt.legend()
plt.grid(True, alpha=0.3)
plt.show()

print(f&quot;Meilleur k sur le test: {k_values[np.argmin(test_errors)]}&quot;)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-name="outputs-container" data-mdast-node-id="OIlo7ZL0i8oaf9TH3l-Hb" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div data-name="safe-output-image"><img src="/mlbook/build/65caf6bc2a546462faf82eef2dbb334f.png" alt="&lt;Figure size 800x500 with 1 Axes&gt;"/></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>Meilleur k sur le test: 21
</span></code></pre></div></div></div></div><div id="P4V5iNBfwe" class="myst-jp-nb-block relative group/block"><hr class="py-2 my-5 translate-y-2"/><h2 id="partie-3-fonctions-de-distance" class="relative group"><span class="heading-text">Partie 3: Fonctions de distance</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#partie-3-fonctions-de-distance" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><p>L’algorithme k-ppv depend de la fonction de distance utilisee. Les plus communes sont:</p><ul><li><p><strong>Distance euclidienne (<span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="normal">ℓ</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">\ell_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord">ℓ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span>)</strong>: <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mo stretchy="false">(</mo><mi mathvariant="bold">x</mi><mo separator="true">,</mo><mi mathvariant="bold">y</mi><mo stretchy="false">)</mo><mo>=</mo><msqrt><mrow><msub><mo>∑</mo><mi>j</mi></msub><mo stretchy="false">(</mo><msub><mi>x</mi><mi>j</mi></msub><mo>−</mo><msub><mi>y</mi><mi>j</mi></msub><msup><mo stretchy="false">)</mo><mn>2</mn></msup></mrow></msqrt></mrow><annotation encoding="application/x-tex">d(\mathbf{x}, \mathbf{y}) = \sqrt{\sum_j (x_j - y_j)^2}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">d</span><span class="mopen">(</span><span class="mord mathbf">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathbf" style="margin-right:0.01597em;">y</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.84em;vertical-align:-0.6979em;"></span><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.1421em;"><span class="svg-align" style="top:-3.8em;"><span class="pstrut" style="height:3.8em;"></span><span class="mord" style="padding-left:1em;"><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:0em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.162em;"><span style="top:-2.4003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4358em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7401em;"><span style="top:-2.989em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span><span style="top:-3.1021em;"><span class="pstrut" style="height:3.8em;"></span><span class="hide-tail" style="min-width:1.02em;height:1.88em;"><svg xmlns="http://www.w3.org/2000/svg" width='400em' height='1.88em' viewBox='0 0 400000 1944' preserveAspectRatio='xMinYMin slice'><path d='M983 90
l0 -0
c4,-6.7,10,-10,18,-10 H400000v40
H1013.1s-83.4,268,-264.1,840c-180.7,572,-277,876.3,-289,913c-4.7,4.7,-12.7,7,-24,7
s-12,0,-12,0c-1.3,-3.3,-3.7,-11.7,-7,-25c-35.3,-125.3,-106.7,-373.3,-214,-744
c-10,12,-21,25,-33,39s-32,39,-32,39c-6,-5.3,-15,-14,-27,-26s25,-30,25,-30
c26.7,-32.7,52,-63,76,-91s52,-60,52,-60s208,722,208,722
c56,-175.3,126.3,-397.3,211,-666c84.7,-268.7,153.8,-488.2,207.5,-658.5
c53.7,-170.3,84.5,-266.8,92.5,-289.5z
M1001 80h400000v40h-400000z'/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.6979em;"><span></span></span></span></span></span></span></span></span></span></p></li><li><p><strong>Distance de Manhattan (<span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="normal">ℓ</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">\ell_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord">ℓ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span>)</strong>: <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mo stretchy="false">(</mo><mi mathvariant="bold">x</mi><mo separator="true">,</mo><mi mathvariant="bold">y</mi><mo stretchy="false">)</mo><mo>=</mo><msub><mo>∑</mo><mi>j</mi></msub><mi mathvariant="normal">∣</mi><msub><mi>x</mi><mi>j</mi></msub><mo>−</mo><msub><mi>y</mi><mi>j</mi></msub><mi mathvariant="normal">∣</mi></mrow><annotation encoding="application/x-tex">d(\mathbf{x}, \mathbf{y}) = \sum_j |x_j - y_j|</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">d</span><span class="mopen">(</span><span class="mord mathbf">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathbf" style="margin-right:0.01597em;">y</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.1858em;vertical-align:-0.4358em;"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:0em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.162em;"><span style="top:-2.4003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4358em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">∣</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.0361em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mord">∣</span></span></span></span></span></p></li><li><p><strong>Distance <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="normal">ℓ</mi><mi mathvariant="normal">∞</mi></msub></mrow><annotation encoding="application/x-tex">\ell_\infty</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord">ℓ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">∞</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span></strong>: <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mo stretchy="false">(</mo><mi mathvariant="bold">x</mi><mo separator="true">,</mo><mi mathvariant="bold">y</mi><mo stretchy="false">)</mo><mo>=</mo><msub><mrow><mi>max</mi><mo>⁡</mo></mrow><mi>j</mi></msub><mi mathvariant="normal">∣</mi><msub><mi>x</mi><mi>j</mi></msub><mo>−</mo><msub><mi>y</mi><mi>j</mi></msub><mi mathvariant="normal">∣</mi></mrow><annotation encoding="application/x-tex">d(\mathbf{x}, \mathbf{y}) = \max_j |x_j - y_j|</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">d</span><span class="mopen">(</span><span class="mord mathbf">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathbf" style="margin-right:0.01597em;">y</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.0361em;vertical-align:-0.2861em;"></span><span class="mop"><span class="mop">max</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">∣</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.0361em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mord">∣</span></span></span></span></span></p></li></ul><h3 id="visualiser-les-boules-unite" class="relative group"><span class="heading-text">Visualiser les boules unite</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#visualiser-les-boules-unite" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><p>La forme de la boule unite montre ce que chaque norme considere comme “equidistant”.</p></div><div id="Mk6nOeeMXt" class="myst-jp-nb-block relative group/block"><div class="myst-jp-nb-block-spinner flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="myst-jp-nb-block sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute -top-[12px] right-0 flex flex-row rounded bg-white dark:bg-slate-800"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">fig, axes = plt.subplots(1, 3, figsize=(12, 4))

# Points de reference
p1 = (1, 0)
p2 = (1/np.sqrt(2), 1/np.sqrt(2))  # ~(0.71, 0.71)

# L1 norm (losange)
ax = axes[0]
t = np.linspace(0, 1, 250)
x_l1 = np.concatenate([t, 1-t, -t, -1+t])
y_l1 = np.concatenate([1-t, -t, -1+t, t])
ax.fill(x_l1, y_l1, alpha=0.3, color=&#x27;C0&#x27;)
ax.plot(x_l1, y_l1, &#x27;C0-&#x27;, linewidth=2)

ax.scatter([p1[0]], [p1[1]], s=80, c=&#x27;black&#x27;, zorder=5)
ax.scatter([p2[0]], [p2[1]], s=80, c=&#x27;red&#x27;, zorder=5)
ax.annotate(f&#x27;$(1, 0)$\n$d=1$&#x27;, p1, textcoords=&#x27;offset points&#x27;, 
            xytext=(5, 10), fontsize=9)
ax.annotate(f&#x27;$(0.71, 0.71)$\n$d=1.42$&#x27;, p2, textcoords=&#x27;offset points&#x27;, 
            xytext=(5, 10), fontsize=9, color=&#x27;red&#x27;)

ax.set_title(r&#x27;Norme $\ell_1$ (Manhattan)&#x27;)
ax.set_xlim(-1.5, 1.5)
ax.set_ylim(-1.5, 1.5)
ax.set_aspect(&#x27;equal&#x27;)
ax.axhline(0, color=&#x27;gray&#x27;, linewidth=0.5)
ax.axvline(0, color=&#x27;gray&#x27;, linewidth=0.5)
ax.set_xlabel(&#x27;$x_1$&#x27;)
ax.set_ylabel(&#x27;$x_2$&#x27;)

# L2 norm (cercle)
ax = axes[1]
theta = np.linspace(0, 2*np.pi, 1000)
x_l2 = np.cos(theta)
y_l2 = np.sin(theta)
ax.fill(x_l2, y_l2, alpha=0.3, color=&#x27;C1&#x27;)
ax.plot(x_l2, y_l2, &#x27;C1-&#x27;, linewidth=2)

ax.scatter([p1[0]], [p1[1]], s=80, c=&#x27;black&#x27;, zorder=5)
ax.scatter([p2[0]], [p2[1]], s=80, c=&#x27;black&#x27;, zorder=5)
ax.annotate(f&#x27;$(1, 0)$\n$d=1$&#x27;, p1, textcoords=&#x27;offset points&#x27;, 
            xytext=(5, 10), fontsize=9)
ax.annotate(f&#x27;$(0.71, 0.71)$\n$d=1$&#x27;, p2, textcoords=&#x27;offset points&#x27;, 
            xytext=(5, 10), fontsize=9)

ax.set_title(r&#x27;Norme $\ell_2$ (Euclidienne)&#x27;)
ax.set_xlim(-1.5, 1.5)
ax.set_ylim(-1.5, 1.5)
ax.set_aspect(&#x27;equal&#x27;)
ax.axhline(0, color=&#x27;gray&#x27;, linewidth=0.5)
ax.axvline(0, color=&#x27;gray&#x27;, linewidth=0.5)
ax.set_xlabel(&#x27;$x_1$&#x27;)
ax.set_ylabel(&#x27;$x_2$&#x27;)

# L-infinity norm (carre)
ax = axes[2]
x_linf = np.array([1, 1, -1, -1, 1])
y_linf = np.array([1, -1, -1, 1, 1])
ax.fill(x_linf, y_linf, alpha=0.3, color=&#x27;C2&#x27;)
ax.plot(x_linf, y_linf, &#x27;C2-&#x27;, linewidth=2)

# Pour L-inf: (1,0), (1,0.5), (1,1) ont tous distance 1
p_inf = [(1, 0), (1, 0.5), (1, 1)]
for i, p in enumerate(p_inf):
    ax.scatter([p[0]], [p[1]], s=80, c=&#x27;black&#x27;, zorder=5)
ax.annotate(&#x27;$(1, 0)$\n$d=1$&#x27;, p_inf[0], textcoords=&#x27;offset points&#x27;, 
            xytext=(-45, -5), fontsize=9)
ax.annotate(&#x27;$(1, 0.5)$\n$d=1$&#x27;, p_inf[1], textcoords=&#x27;offset points&#x27;, 
            xytext=(5, -5), fontsize=9)
ax.annotate(&#x27;$(1, 1)$\n$d=1$&#x27;, p_inf[2], textcoords=&#x27;offset points&#x27;, 
            xytext=(5, 5), fontsize=9)

ax.set_title(r&#x27;Norme $\ell_\infty$&#x27;)
ax.set_xlim(-1.5, 1.5)
ax.set_ylim(-1.5, 1.5)
ax.set_aspect(&#x27;equal&#x27;)
ax.axhline(0, color=&#x27;gray&#x27;, linewidth=0.5)
ax.axvline(0, color=&#x27;gray&#x27;, linewidth=0.5)
ax.set_xlabel(&#x27;$x_1$&#x27;)
ax.set_ylabel(&#x27;$x_2$&#x27;)

plt.tight_layout()
plt.show()</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-name="outputs-container" data-mdast-node-id="CnzpYPK6P_kvZcO-mTktD" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div data-name="safe-output-image"><img src="/mlbook/build/32be2d7a1785639c2b15515862368e29.png" alt="&lt;Figure size 1200x400 with 3 Axes&gt;"/></div></div></div><div id="JxbkKZlgsg" class="myst-jp-nb-block relative group/block"><h3 id="exercice-calculer-les-distances" class="relative group"><span class="heading-text">Exercice: Calculer les distances</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#exercice-calculer-les-distances" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><p>Implementez les trois fonctions de distance.</p></div><div id="VQNGz6JR9n" class="myst-jp-nb-block relative group/block"><div class="myst-jp-nb-block-spinner flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="myst-jp-nb-block sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute -top-[12px] right-0 flex flex-row rounded bg-white dark:bg-slate-800"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">def distance_l1(x, y):
    &quot;&quot;&quot;Distance de Manhattan.&quot;&quot;&quot;
    # TODO: Implementer
    pass

def distance_l2(x, y):
    &quot;&quot;&quot;Distance euclidienne.&quot;&quot;&quot;
    # TODO: Implementer
    pass

def distance_linf(x, y):
    &quot;&quot;&quot;Distance L-infini.&quot;&quot;&quot;
    # TODO: Implementer
    pass

# Test avec deux points
x = np.array([0, 0])
y = np.array([3, 4])

print(f&quot;Points: x = {x}, y = {y}&quot;)
print(f&quot;Distance L1: {distance_l1(x, y)}&quot;)     # Attendu: 7
print(f&quot;Distance L2: {distance_l2(x, y)}&quot;)     # Attendu: 5
print(f&quot;Distance L-inf: {distance_linf(x, y)}&quot;) # Attendu: 4</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-name="outputs-container" data-mdast-node-id="7qTgt1H7NcN_zN0JDF5At" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>Points: x = [0 0], y = [3 4]
Distance L1: None
Distance L2: None
Distance L-inf: None
</span></code></pre></div></div></div></div><div id="SWD0juzv2f" class="myst-jp-nb-block relative group/block"><details class="myst-dropdown rounded-md my-5 shadow dark:shadow-2xl dark:shadow-neutral-900 overflow-hidden bg-gray-50 dark:bg-stone-800"><summary class="myst-dropdown-header m-0 text-lg font-medium py-1 min-h-[2em] pl-3 cursor-pointer hover:shadow-[inset_0_0_0px_30px_#00000003] dark:hover:shadow-[inset_0_0_0px_30px_#FFFFFF03] bg-gray-100 dark:bg-slate-900"><span class="myst-dropdown-header-title text-neutral-900 dark:text-white"><span class="block float-right text-sm font-thin text-neutral-700 dark:text-neutral-200"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" width="1.5rem" height="1.5rem" class="myst-dropdown-header-icon inline-block pl-2 mr-2 -translate-y-[1px] details-toggle transition-transform"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 0 1 0 1.06l-7.5 7.5a.75.75 0 0 1-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 0 1 1.06-1.06l7.5 7.5Z" clip-rule="evenodd"></path></svg></span><strong>Solution</strong> (cliquez pour afficher)</span></summary><div class="myst-dropdown-body px-4 py-1 details-body"><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 bg-stone-200/10"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">def distance_l1(x, y):
    return np.sum(np.abs(x - y))

def distance_l2(x, y):
    return np.sqrt(np.sum((x - y)**2))

def distance_linf(x, y):
    return np.max(np.abs(x - y))</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div></div></details></div><div id="tmLpzjQOmd" class="myst-jp-nb-block relative group/block"><h3 id="comment-les-voisins-changent-selon-la-distance" class="relative group"><span class="heading-text">Comment les voisins changent selon la distance</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#comment-les-voisins-changent-selon-la-distance" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><p>Visualisons comment le choix de la metrique affecte les voisins selectionnes.</p></div><div id="Jzm6KlKhiD" class="myst-jp-nb-block relative group/block"><div class="myst-jp-nb-block-spinner flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="myst-jp-nb-block sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute -top-[12px] right-0 flex flex-row rounded bg-white dark:bg-slate-800"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># Implementer les fonctions de distance (solution)
def distance_l1(x, y):
    return np.sum(np.abs(x - y))

def distance_l2(x, y):
    return np.sqrt(np.sum((x - y)**2))

def distance_linf(x, y):
    return np.max(np.abs(x - y))

# Point requete
x_q = np.array([0, 0])
k = 3

fig, axes = plt.subplots(1, 3, figsize=(14, 4.5))
metrics = [(&#x27;$\\ell_1$&#x27;, distance_l1), (&#x27;$\\ell_2$&#x27;, distance_l2), (&#x27;$\\ell_\infty$&#x27;, distance_linf)]

for ax, (name, dist_func) in zip(axes, metrics):
    # Calculer les distances avec cette metrique
    distances = np.array([dist_func(x_q, xi) for xi in X_train])
    k_idx = np.argsort(distances)[:k]
    
    ax.scatter(X_train[y_train == 0, 0], X_train[y_train == 0, 1], 
               c=&#x27;C0&#x27;, s=50, alpha=0.5)
    ax.scatter(X_train[y_train == 1, 0], X_train[y_train == 1, 1], 
               c=&#x27;C1&#x27;, s=50, alpha=0.5)
    
    # Mettre en evidence les k voisins
    for idx in k_idx:
        ax.scatter(X_train[idx, 0], X_train[idx, 1], 
                   s=150, facecolors=&#x27;none&#x27;, edgecolors=&#x27;green&#x27;, linewidths=2)
    
    ax.scatter(x_q[0], x_q[1], c=&#x27;red&#x27;, s=120, marker=&#x27;*&#x27;, zorder=5)
    ax.set_title(f&#x27;Distance {name}&#x27;)
    ax.set_xlabel(&#x27;$x_1$&#x27;)
    ax.set_ylabel(&#x27;$x_2$&#x27;)
    ax.set_aspect(&#x27;equal&#x27;)
    ax.grid(True, alpha=0.3)

plt.tight_layout()
plt.show()</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-name="outputs-container" data-mdast-node-id="aIzDb0jTDKlwZ34wN43_D" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>&lt;&gt;:16: SyntaxWarning: invalid escape sequence &#x27;\i&#x27;
&lt;&gt;:16: SyntaxWarning: invalid escape sequence &#x27;\i&#x27;
/var/folders/kz/gmggxk812sg1jvysfbnx_y7h0000gq/T/ipykernel_18137/969548489.py:16: SyntaxWarning: invalid escape sequence &#x27;\i&#x27;
  metrics = [(&#x27;$\\ell_1$&#x27;, distance_l1), (&#x27;$\\ell_2$&#x27;, distance_l2), (&#x27;$\\ell_\infty$&#x27;, distance_linf)]
</span></code></pre></div></div><div data-name="safe-output-image"><img src="/mlbook/build/b0139bec774c548f8864c05cf61ede28.png" alt="&lt;Figure size 1400x450 with 3 Axes&gt;"/></div></div></div><div id="J0zQHYp3Uc" class="myst-jp-nb-block relative group/block"><hr class="py-2 my-5 translate-y-2"/><h2 id="partie-4-importance-de-la-normalisation" class="relative group"><span class="heading-text">Partie 4: Importance de la normalisation</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#partie-4-importance-de-la-normalisation" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><p>Quand les variables ont des echelles differentes, certaines dominent le calcul de distance.</p><h3 id="exemple-age-vs-revenu" class="relative group"><span class="heading-text">Exemple: age vs revenu</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#exemple-age-vs-revenu" title="Link to this Section" aria-label="Link to this Section">¶</a></h3></div><div id="OPERjPzQXj" class="myst-jp-nb-block relative group/block"><div class="myst-jp-nb-block-spinner flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="myst-jp-nb-block sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute -top-[12px] right-0 flex flex-row rounded bg-white dark:bg-slate-800"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># Donnees: age (20-70) et revenu (20000-200000)
np.random.seed(42)
n = 30

# Generer des donnees realistes
ages = np.random.uniform(25, 65, n)
revenus = ages * 2000 + np.random.normal(0, 20000, n) + 30000  # Correlation avec l&#x27;age

X_raw = np.column_stack([ages, revenus])

# Etiquettes basees sur une combinaison non-lineaire
y_raw = ((ages &gt; 45) | (revenus &gt; 100000)).astype(int)

print(f&quot;Age: min={ages.min():.1f}, max={ages.max():.1f}&quot;)
print(f&quot;Revenu: min={revenus.min():.0f}, max={revenus.max():.0f}&quot;)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-name="outputs-container" data-mdast-node-id="rDUxtd0qE4YRdYeITqprB" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>Age: min=25.8, max=63.8
Revenu: min=74048, max=163571
</span></code></pre></div></div></div></div><div id="hAsh9QDs0r" class="myst-jp-nb-block relative group/block"><div class="myst-jp-nb-block-spinner flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="myst-jp-nb-block sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute -top-[12px] right-0 flex flex-row rounded bg-white dark:bg-slate-800"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># Calculer les distances avant normalisation
x1 = np.array([30, 50000])   # Jeune, revenu moyen
x2 = np.array([35, 51000])   # Similaire en age, revenu proche
x3 = np.array([31, 150000])  # Age proche, revenu tres different

d_12 = np.sqrt(np.sum((x1 - x2)**2))
d_13 = np.sqrt(np.sum((x1 - x3)**2))

print(&quot;AVANT normalisation:&quot;)
print(f&quot;  Distance x1-x2 (age: +5 ans, revenu: +1000$): {d_12:.1f}&quot;)
print(f&quot;  Distance x1-x3 (age: +1 an, revenu: +100000$): {d_13:.1f}&quot;)
print(f&quot;  Ratio: {d_13/d_12:.1f}x plus loin&quot;)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-name="outputs-container" data-mdast-node-id="kpd99za1dz7_p9t_2yK9O" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>AVANT normalisation:
  Distance x1-x2 (age: +5 ans, revenu: +1000$): 1000.0
  Distance x1-x3 (age: +1 an, revenu: +100000$): 100000.0
  Ratio: 100.0x plus loin
</span></code></pre></div></div></div></div><div id="ngQ7nWM3iU" class="myst-jp-nb-block relative group/block"><p><strong>Observation</strong>: La difference de revenu domine completement! Une difference de 100000$ est vue comme 100x plus importante qu’une difference de 5 ans.</p></div><div id="P15N7tQq3f" class="myst-jp-nb-block relative group/block"><div class="myst-jp-nb-block-spinner flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="myst-jp-nb-block sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute -top-[12px] right-0 flex flex-row rounded bg-white dark:bg-slate-800"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># Normalisation: centrer et reduire
mean_age = ages.mean()
std_age = ages.std()
mean_rev = revenus.mean()
std_rev = revenus.std()

def normalize(x):
    return np.array([(x[0] - mean_age) / std_age, 
                     (x[1] - mean_rev) / std_rev])

x1_norm = normalize(x1)
x2_norm = normalize(x2)
x3_norm = normalize(x3)

d_12_norm = np.sqrt(np.sum((x1_norm - x2_norm)**2))
d_13_norm = np.sqrt(np.sum((x1_norm - x3_norm)**2))

print(&quot;APRES normalisation:&quot;)
print(f&quot;  Distance x1-x2: {d_12_norm:.3f}&quot;)
print(f&quot;  Distance x1-x3: {d_13_norm:.3f}&quot;)
print(f&quot;  Ratio: {d_13_norm/d_12_norm:.1f}x plus loin&quot;)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-name="outputs-container" data-mdast-node-id="TpSAlJBKM97g3Hg_ShIyK" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>APRES normalisation:
  Distance x1-x2: 0.453
  Distance x1-x3: 4.574
  Ratio: 10.1x plus loin
</span></code></pre></div></div></div></div><div id="AoFdu0ClN5" class="myst-jp-nb-block relative group/block"><div class="myst-jp-nb-block-spinner flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="myst-jp-nb-block sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute -top-[12px] right-0 flex flex-row rounded bg-white dark:bg-slate-800"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># Visualiser l&#x27;effet de la normalisation
fig, axes = plt.subplots(1, 2, figsize=(12, 5))

# Avant normalisation
ax = axes[0]
ax.scatter(X_raw[y_raw == 0, 0], X_raw[y_raw == 0, 1], c=&#x27;C0&#x27;, s=60, label=&#x27;Classe 0&#x27;)
ax.scatter(X_raw[y_raw == 1, 0], X_raw[y_raw == 1, 1], c=&#x27;C1&#x27;, s=60, label=&#x27;Classe 1&#x27;)
ax.scatter([x1[0]], [x1[1]], c=&#x27;red&#x27;, s=150, marker=&#x27;*&#x27;, zorder=5, label=&#x27;Requete&#x27;)
ax.set_xlabel(&#x27;Age (annees)&#x27;)
ax.set_ylabel(&#x27;Revenu ($)&#x27;)
ax.set_title(&#x27;Avant normalisation\n(le revenu domine)&#x27;)
ax.legend()
ax.grid(True, alpha=0.3)

# Apres normalisation
X_norm = np.column_stack([(ages - mean_age) / std_age, 
                          (revenus - mean_rev) / std_rev])

ax = axes[1]
ax.scatter(X_norm[y_raw == 0, 0], X_norm[y_raw == 0, 1], c=&#x27;C0&#x27;, s=60, label=&#x27;Classe 0&#x27;)
ax.scatter(X_norm[y_raw == 1, 0], X_norm[y_raw == 1, 1], c=&#x27;C1&#x27;, s=60, label=&#x27;Classe 1&#x27;)
ax.scatter([x1_norm[0]], [x1_norm[1]], c=&#x27;red&#x27;, s=150, marker=&#x27;*&#x27;, zorder=5, label=&#x27;Requete&#x27;)
ax.set_xlabel(&#x27;Age (normalise)&#x27;)
ax.set_ylabel(&#x27;Revenu (normalise)&#x27;)
ax.set_title(&#x27;Apres normalisation\n(echelles comparables)&#x27;)
ax.legend()
ax.set_aspect(&#x27;equal&#x27;)
ax.grid(True, alpha=0.3)

plt.tight_layout()
plt.show()</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-name="outputs-container" data-mdast-node-id="kF6Q-AcwbCKYMhi94JJ3S" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div data-name="safe-output-image"><img src="/mlbook/build/db2693c68e19c055477d067fe281680f.png" alt="&lt;Figure size 1200x500 with 2 Axes&gt;"/></div></div></div><div id="l9bG1LRRus" class="myst-jp-nb-block relative group/block"><p><strong>Question</strong>: Quelle variable domine le calcul de distance sans normalisation? Pourquoi est-ce problematique pour k-ppv?</p></div><div id="LzlZmWHrF4" class="myst-jp-nb-block relative group/block"><hr class="py-2 my-5 translate-y-2"/><h2 id="recapitulatif" class="relative group"><span class="heading-text">Recapitulatif</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#recapitulatif" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><p>Dans ce TP, vous avez appris:</p><ol start="1"><li><p><strong>Algorithme k-ppv</strong>: Classifier par vote majoritaire des k voisins les plus proches</p></li><li><p><strong>Effet de k</strong>:</p><ul><li><p>Petit k = frontiere irreguliere (haute variance)</p></li><li><p>Grand k = frontiere lisse (haut biais)</p></li></ul></li><li><p><strong>Fonctions de distance</strong>: <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="normal">ℓ</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">\ell_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord">ℓ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span> (Manhattan), <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="normal">ℓ</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">\ell_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord">ℓ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span> (Euclidienne), <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="normal">ℓ</mi><mi mathvariant="normal">∞</mi></msub></mrow><annotation encoding="application/x-tex">\ell_\infty</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord">ℓ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">∞</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span></p><ul><li><p>La forme de la boule unite definit ce qui est “equidistant”</p></li></ul></li><li><p><strong>Normalisation</strong>: Indispensable quand les variables ont des echelles differentes</p></li></ol><hr class="py-2 my-5 translate-y-2"/><p><strong>Pour aller plus loin</strong>: <a target="_blank" rel="noreferrer" href="https://pierrelux.github.io/mlbook/drafts/knn" class="">Chapitre complet sur le site du cours</a></p></div><div class="myst-backmatter-parts"></div><div class="myst-footer-links flex pt-10 mb-10 space-x-4"><a class="myst-footer-link flex-1 block p-4 font-normal text-gray-600 no-underline border border-gray-200 rounded shadow-sm group hover:border-blue-600 dark:hover:border-blue-400 hover:text-blue-600 dark:hover:text-blue-400 dark:text-gray-100 dark:border-gray-500 hover:shadow-lg dark:shadow-neutral-700 myst-footer-link-prev" href="/mlbook/learning-problem"><div class="flex h-full align-middle"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="1.5rem" height="1.5rem" class="myst-footer-link-icon self-center transition-transform group-hover:-translate-x-1 shrink-0"><path stroke-linecap="round" stroke-linejoin="round" d="M10.5 19.5 3 12m0 0 7.5-7.5M3 12h18"></path></svg><div class="flex-grow text-right"><div class="myst-footer-link-group text-xs text-gray-500 dark:text-gray-400">Fondements de l&#x27;apprentissage machine</div>Le problème d’apprentissage</div></div></a><a class="myst-footer-link flex-1 block p-4 font-normal text-gray-600 no-underline border border-gray-200 rounded shadow-sm group hover:border-blue-600 dark:hover:border-blue-400 hover:text-blue-600 dark:hover:text-blue-400 dark:text-gray-100 dark:border-gray-500 hover:shadow-lg dark:shadow-neutral-700 myst-footer-link-next" href="/mlbook/tp1-learning-problem"><div class="flex h-full align-middle"><div class="flex-grow"><div class="myst-footer-link-group text-xs text-gray-500 dark:text-gray-400">Travaux Pratiques</div>TP1: Le problème d’apprentissage</div><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="1.5rem" height="1.5rem" class="myst-footer-link-icon self-center transition-transform group-hover:translate-x-1 shrink-0"><path stroke-linecap="round" stroke-linejoin="round" d="M13.5 4.5 21 12m0 0-7.5 7.5M21 12H3"></path></svg></div></a></div></article></main><script>((a,l)=>{if(!window.history.state||!window.history.state.key){let u=Math.random().toString(32).slice(2);window.history.replaceState({key:u},"")}try{let d=JSON.parse(sessionStorage.getItem(a)||"{}")[l||window.history.state.key];typeof d=="number"&&window.scrollTo(0,d)}catch(u){console.error(u),sessionStorage.removeItem(a)}})("positions", null)</script><link rel="modulepreload" href="/mlbook/build/entry.client-PCJPW7TK.js"/><link rel="modulepreload" href="/mlbook/build/_shared/chunk-AQ2CODAG.js"/><link rel="modulepreload" href="/mlbook/build/_shared/chunk-JJXTQVMA.js"/><link rel="modulepreload" href="/mlbook/build/_shared/chunk-OZE3FFNP.js"/><link rel="modulepreload" href="/mlbook/build/_shared/chunk-OYMW4E3D.js"/><link rel="modulepreload" href="/mlbook/build/_shared/chunk-C4DFGG5C.js"/><link rel="modulepreload" href="/mlbook/build/_shared/chunk-J7TUH54J.js"/><link rel="modulepreload" href="/mlbook/build/_shared/chunk-FZ2S7OYD.js"/><link rel="modulepreload" href="/mlbook/build/_shared/chunk-JEM6JXYA.js"/><link rel="modulepreload" href="/mlbook/build/_shared/chunk-34XIY2DH.js"/><link rel="modulepreload" href="/mlbook/build/_shared/chunk-KQM5FBHR.js"/><link rel="modulepreload" href="/mlbook/build/_shared/chunk-OCWQY3HK.js"/><link rel="modulepreload" href="/mlbook/build/_shared/chunk-7HNKBP4B.js"/><link rel="modulepreload" href="/mlbook/build/_shared/chunk-CUKUDK3R.js"/><link rel="modulepreload" href="/mlbook/build/_shared/chunk-3EBOCCHJ.js"/><link rel="modulepreload" href="/mlbook/build/_shared/chunk-O4VQNZ62.js"/><link rel="modulepreload" href="/mlbook/build/_shared/chunk-4OEDG4JQ.js"/><link rel="modulepreload" href="/mlbook/build/_shared/chunk-GUCIBHGO.js"/><link rel="modulepreload" href="/mlbook/build/root-CXYA7X5D.js"/><link rel="modulepreload" href="/mlbook/build/_shared/chunk-DATP5P2X.js"/><link rel="modulepreload" href="/mlbook/build/routes/$-JRBPULBO.js"/><script>window.__remixContext = {"url":"/tp0-knn","state":{"loaderData":{"root":{"config":{"version":3,"myst":"1.7.0","options":{"logo_text":"IFT6390"},"nav":[],"actions":[{"title":"View on GitHub","url":"https://github.com/pierrelux/mlbook","internal":false,"static":false}],"projects":[{"bibliography":["/Users/pierre-luc.bacon/Documents/mlbook/references.bib"],"math":{"\\E":{"macro":"\\mathbb{E}"},"\\Var":{"macro":"\\mathrm{Var}"},"\\Cov":{"macro":"\\mathrm{Cov}"},"\\Prob":{"macro":"\\mathbb{P}"},"\\R":{"macro":"\\mathbb{R}"},"\\N":{"macro":"\\mathbb{N}"},"\\Loss":{"macro":"\\mathcal{L}"},"\\Risk":{"macro":"\\mathcal{R}"},"\\Hypothesis":{"macro":"\\mathcal{H}"},"\\Data":{"macro":"\\mathcal{D}"},"\\indicator":{"macro":"\\mathbb{1}"},"\\defeq":{"macro":"\\triangleq"},"\\mathds":{"macro":"\\mathbb"},"\\hdots":{"macro":"\\cdots"}},"exports":[],"title":"Fondements de l'apprentissage machine","description":"Un manuel d'introduction à l'apprentissage machine couvrant les méthodes supervisées et non-supervisées, des algorithmes classiques aux réseaux de neurones modernes.","authors":[{"nameParsed":{"literal":"Pierre-Luc Bacon","given":"Pierre-Luc","family":"Bacon"},"name":"Pierre-Luc Bacon","id":"contributors-myst-generated-uid-0"}],"github":"https://github.com/pierrelux/mlbook","id":"8a3f2c1d-5e7b-4a9c-b2d8-6f1e3c5a7b9d","toc":[{"file":"drafts/intro.md"},{"file":"drafts/knn.md"},{"file":"learning_problem.md"},{"children":[{"file":"exercises/tp0_knn.ipynb"},{"file":"exercises/tp1_learning_problem.ipynb"}],"title":"Travaux Pratiques"}],"index":"index","pages":[{"slug":"knn","title":"Méthodes non paramétriques","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"learning-problem","title":"Le problème d’apprentissage","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"level":1,"title":"Travaux Pratiques"},{"slug":"tp0-knn","title":"TP0: Les k plus proches voisins","description":"","date":"","thumbnail":"/mlbook/build/7e2db436150c38a00650f96925aa5581.svg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"tp1-learning-problem","title":"TP1: Le problème d’apprentissage","description":"","date":"","thumbnail":"/mlbook/build/7e2db436150c38a00650f96925aa5581.svg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2}]}]},"CONTENT_CDN_PORT":"3101","MODE":"static","BASE_URL":"/mlbook"},"routes/$":{"config":{"version":3,"myst":"1.7.0","options":{"logo_text":"IFT6390"},"nav":[],"actions":[{"title":"View on GitHub","url":"https://github.com/pierrelux/mlbook","internal":false,"static":false}],"projects":[{"bibliography":["/Users/pierre-luc.bacon/Documents/mlbook/references.bib"],"math":{"\\E":{"macro":"\\mathbb{E}"},"\\Var":{"macro":"\\mathrm{Var}"},"\\Cov":{"macro":"\\mathrm{Cov}"},"\\Prob":{"macro":"\\mathbb{P}"},"\\R":{"macro":"\\mathbb{R}"},"\\N":{"macro":"\\mathbb{N}"},"\\Loss":{"macro":"\\mathcal{L}"},"\\Risk":{"macro":"\\mathcal{R}"},"\\Hypothesis":{"macro":"\\mathcal{H}"},"\\Data":{"macro":"\\mathcal{D}"},"\\indicator":{"macro":"\\mathbb{1}"},"\\defeq":{"macro":"\\triangleq"},"\\mathds":{"macro":"\\mathbb"},"\\hdots":{"macro":"\\cdots"}},"exports":[],"title":"Fondements de l'apprentissage machine","description":"Un manuel d'introduction à l'apprentissage machine couvrant les méthodes supervisées et non-supervisées, des algorithmes classiques aux réseaux de neurones modernes.","authors":[{"nameParsed":{"literal":"Pierre-Luc Bacon","given":"Pierre-Luc","family":"Bacon"},"name":"Pierre-Luc Bacon","id":"contributors-myst-generated-uid-0"}],"github":"https://github.com/pierrelux/mlbook","id":"8a3f2c1d-5e7b-4a9c-b2d8-6f1e3c5a7b9d","toc":[{"file":"drafts/intro.md"},{"file":"drafts/knn.md"},{"file":"learning_problem.md"},{"children":[{"file":"exercises/tp0_knn.ipynb"},{"file":"exercises/tp1_learning_problem.ipynb"}],"title":"Travaux Pratiques"}],"index":"index","pages":[{"slug":"knn","title":"Méthodes non paramétriques","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"learning-problem","title":"Le problème d’apprentissage","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"level":1,"title":"Travaux Pratiques"},{"slug":"tp0-knn","title":"TP0: Les k plus proches voisins","description":"","date":"","thumbnail":"/mlbook/build/7e2db436150c38a00650f96925aa5581.svg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"tp1-learning-problem","title":"TP1: Le problème d’apprentissage","description":"","date":"","thumbnail":"/mlbook/build/7e2db436150c38a00650f96925aa5581.svg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2}]}]},"page":{"version":3,"kind":"Notebook","sha256":"66168375435012306b94367ce6b413e7695e848f6c9fba596509db2cc052f74a","slug":"tp0-knn","location":"/exercises/tp0_knn.ipynb","dependencies":[],"frontmatter":{"title":"TP0: Les k plus proches voisins","content_includes_title":false,"kernelspec":{"name":"python3","display_name":"Python 3","language":"python"},"authors":[{"nameParsed":{"literal":"Pierre-Luc Bacon","given":"Pierre-Luc","family":"Bacon"},"name":"Pierre-Luc Bacon","id":"contributors-myst-generated-uid-0"}],"github":"https://github.com/pierrelux/mlbook","math":{"\\E":{"macro":"\\mathbb{E}"},"\\Var":{"macro":"\\mathrm{Var}"},"\\Cov":{"macro":"\\mathrm{Cov}"},"\\Prob":{"macro":"\\mathbb{P}"},"\\R":{"macro":"\\mathbb{R}"},"\\N":{"macro":"\\mathbb{N}"},"\\Loss":{"macro":"\\mathcal{L}"},"\\Risk":{"macro":"\\mathcal{R}"},"\\Hypothesis":{"macro":"\\mathcal{H}"},"\\Data":{"macro":"\\mathcal{D}"},"\\indicator":{"macro":"\\mathbb{1}"},"\\defeq":{"macro":"\\triangleq"},"\\mathds":{"macro":"\\mathbb"},"\\hdots":{"macro":"\\cdots"}},"numbering":{"title":{"offset":1}},"source_url":"https://github.com/pierrelux/mlbook/blob/main/exercises/tp0_knn.ipynb","edit_url":"https://github.com/pierrelux/mlbook/edit/main/exercises/tp0_knn.ipynb","thumbnail":"/mlbook/build/7e2db436150c38a00650f96925aa5581.svg","exports":[{"format":"ipynb","filename":"tp0_knn.ipynb","url":"/mlbook/build/tp0_knn-e6fae0c38060427c3caaf3c9b5bafd1b.ipynb"}]},"widgets":{},"mdast":{"type":"root","children":[{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"strong","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"IFT6390 - Fondements de l’apprentissage machine","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"RD8hIIUq5u"}],"key":"kSfPIvXpvO"}],"key":"MmuJGTznZj"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"link","url":"https://colab.research.google.com/github/pierrelux/mlbook/blob/main/exercises/tp0_knn.ipynb","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"image","url":"/mlbook/build/7e2db436150c38a00650f96925aa5581.svg","alt":"Open In Colab","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"C70hD1GpkI","urlSource":"https://colab.research.google.com/assets/colab-badge.svg"}],"urlSource":"https://colab.research.google.com/github/pierrelux/mlbook/blob/main/exercises/tp0_knn.ipynb","key":"i6Vx46Pgod"}],"key":"jbLURqleT8"},{"type":"paragraph","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"Ce notebook accompagne le ","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"OWUhcD58hk"},{"type":"link","url":"https://pierrelux.github.io/mlbook/drafts/knn","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"Chapitre 1: Methodes non parametriques","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"zlUtuRYFga"}],"urlSource":"https://pierrelux.github.io/mlbook/drafts/knn","key":"QdJcETTw4y"},{"type":"text","value":".","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"sTSDvCJyRN"}],"key":"NqYhG12m4z"},{"type":"heading","depth":2,"position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"Objectifs","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"JHYgojneeg"}],"identifier":"objectifs","label":"Objectifs","html_id":"objectifs","implicit":true,"key":"A20jZOgkUG"},{"type":"paragraph","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"A la fin de ce TP, vous serez en mesure de:","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"OZil7vnuwm"}],"key":"pYxLq46Bj8"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":12,"column":1},"end":{"line":16,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Comprendre l’algorithme des k plus proches voisins (k-ppv)","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"vowU1fQ6en"}],"key":"c59d4ZZGYv"}],"key":"HLltVpXgjW"},{"type":"listItem","spread":true,"position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Observer l’effet du parametre k sur les predictions","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"rkxX1ybfv7"}],"key":"eXTRwBPnec"}],"key":"taGZjTtAiK"},{"type":"listItem","spread":true,"position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Comparer differentes fonctions de distance","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"mNFHhWhVND"}],"key":"EM0neiPtwZ"}],"key":"yLXDDYHSWc"},{"type":"listItem","spread":true,"position":{"start":{"line":15,"column":1},"end":{"line":16,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Apprecier l’importance de la normalisation des donnees","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"wV6i9YcVJ3"}],"key":"bWPmxlNu2w"}],"key":"gLVOmhxct3"}],"key":"hGCB9DeoeA"},{"type":"thematicBreak","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"b3GLk8QI08"}],"key":"ssWjkH0ayo"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Partie 0: Configuration","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Vxys5Wh2Ts"}],"identifier":"partie-0-configuration","label":"Partie 0: Configuration","html_id":"partie-0-configuration","implicit":true,"key":"me3Q3lAPht"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Executez cette cellule pour importer les bibliotheques necessaires.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"bxA6sKqLmM"}],"key":"gIM8pUoHaV"}],"key":"Hc0B0UuaMR"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"import numpy as np\nimport matplotlib.pyplot as plt\nfrom matplotlib.colors import ListedColormap\n\n# Pour de jolis graphiques\nplt.rcParams['figure.figsize'] = (8, 5)\nplt.rcParams['font.size'] = 12\n\nprint(\"Configuration terminee!\")","key":"xCe8lFucrP"},{"type":"outputs","id":"WCT1RnEABv_RwyrNODRsb","children":[{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"Configuration terminee!\n"},"key":"lgUFn4EDPq"}],"key":"nGaMHqp4KE"}],"key":"CDalFKh9Gg"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Partie 1: L’algorithme k-ppv","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"GIs1EyVRIN"}],"identifier":"partie-1-lalgorithme-k-ppv","label":"Partie 1: L’algorithme k-ppv","html_id":"partie-1-lalgorithme-k-ppv","implicit":true,"key":"ZKy50wHkIs"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"L’idee des k plus proches voisins est simple: pour classifier un nouveau point, on regarde les ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"O4JfmcXCA4"},{"type":"inlineMath","value":"k","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmi\u003ek\u003c/mi\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003ek\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.6944em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.03148em;\"\u003ek\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"DJgX7p3cQa"},{"type":"text","value":" points d’entrainement les plus proches et on prend un vote majoritaire.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"wpbLBBUyac"}],"key":"GsBU2XBHGJ"},{"type":"heading","depth":3,"position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Les donnees","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"sUIa5s0sGv"}],"identifier":"les-donnees","label":"Les donnees","html_id":"les-donnees","implicit":true,"key":"GeC0yFhqbC"},{"type":"paragraph","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"Commencons par generer un jeu de donnees de classification 2D.","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"SXlXV1s2II"}],"key":"BYrm54SPUd"}],"key":"YLjvOcChOJ"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Generation de donnees de classification\nnp.random.seed(42)\nn_per_class = 15\n\n# Classe 0: groupe autour de (-1, -1)\nX0 = np.random.randn(n_per_class, 2) * 0.6 + np.array([-1, -1])\n# Classe 1: groupe autour de (1, 1)\nX1 = np.random.randn(n_per_class, 2) * 0.6 + np.array([1, 1])\n\nX_train = np.vstack([X0, X1])\ny_train = np.array([0] * n_per_class + [1] * n_per_class)\n\nprint(f\"Nombre de points: {len(X_train)}\")\nprint(f\"Classes: {np.unique(y_train)}\")","key":"lvfNaOpgyG"},{"type":"outputs","id":"mGjdcC1Z2zFGo4fNeQHlo","children":[{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"Nombre de points: 30\nClasses: [0 1]\n"},"key":"hRcfpUbvnC"}],"key":"K7mFHEUC2I"}],"key":"Pt7fo5Pm2C"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Visualisation des donnees\nplt.figure(figsize=(7, 6))\nplt.scatter(X_train[y_train == 0, 0], X_train[y_train == 0, 1], \n           c='C0', s=60, label='Classe 0', edgecolors='k', linewidths=0.5)\nplt.scatter(X_train[y_train == 1, 0], X_train[y_train == 1, 1], \n           c='C1', s=60, label='Classe 1', edgecolors='k', linewidths=0.5)\nplt.xlabel('$x_1$')\nplt.ylabel('$x_2$')\nplt.legend()\nplt.title('Donnees d\\'entrainement')\nplt.axis('equal')\nplt.grid(True, alpha=0.3)\nplt.show()","key":"Q4F7bI1I7l"},{"type":"outputs","id":"ZPB2wZp6hR9BDi1032b7Y","children":[{"type":"output","children":[],"jupyter_data":{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"\u003cFigure size 700x600 with 1 Axes\u003e","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"afb328f42911717142a430799494ceac","path":"/mlbook/build/afb328f42911717142a430799494ceac.png"}}},"key":"YEohBx1XRo"}],"key":"bYJqMliNWD"}],"key":"TnUWHHqDkN"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Visualiser les k voisins","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Euws3caTy9"}],"identifier":"visualiser-les-k-voisins","label":"Visualiser les k voisins","html_id":"visualiser-les-k-voisins","implicit":true,"key":"HBQ5meGPeu"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Pour un point requete, identifions ses ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"QpKX1tY44t"},{"type":"inlineMath","value":"k","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmi\u003ek\u003c/mi\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003ek\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.6944em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.03148em;\"\u003ek\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"Vlw7kvDvjG"},{"type":"text","value":" plus proches voisins.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"zEIRa7KEVK"}],"key":"PU6KE3uGjR"}],"key":"lEAZ7RJ2q6"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Point requete\nx_query = np.array([0.3, 0.2])\nk = 5\n\n# Calcul des distances euclidiennes\ndistances = np.sqrt(np.sum((X_train - x_query)**2, axis=1))\n\n# Indices des k plus proches\nk_nearest_idx = np.argsort(distances)[:k]\n\nprint(f\"Point requete: {x_query}\")\nprint(f\"\\nLes {k} plus proches voisins:\")\nfor i, idx in enumerate(k_nearest_idx):\n    print(f\"  Voisin {i+1}: point {idx}, distance = {distances[idx]:.3f}, classe = {y_train[idx]}\")","key":"XssAhlRbj1"},{"type":"outputs","id":"vmG0oejsZ-7XUOoDouVTK","children":[{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"Point requete: [0.3 0.2]\n\nLes 5 plus proches voisins:\n  Voisin 1: point 22, distance = 0.413, classe = 1\n  Voisin 2: point 28, distance = 0.645, classe = 1\n  Voisin 3: point 16, distance = 0.711, classe = 1\n  Voisin 4: point 3, distance = 0.819, classe = 0\n  Voisin 5: point 21, distance = 0.884, classe = 1\n"},"key":"vlXTpV2VJ7"}],"key":"OGA1tHWxcI"}],"key":"Y23WXA6TZ0"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Visualisation des k voisins\nfig, ax = plt.subplots(figsize=(7, 6))\n\n# Points d'entrainement\nax.scatter(X_train[y_train == 0, 0], X_train[y_train == 0, 1], \n           c='C0', s=60, label='Classe 0', zorder=2)\nax.scatter(X_train[y_train == 1, 0], X_train[y_train == 1, 1], \n           c='C1', s=60, label='Classe 1', zorder=2)\n\n# Lignes vers les k voisins et cercles autour\nfor idx in k_nearest_idx:\n    ax.plot([x_query[0], X_train[idx, 0]], [x_query[1], X_train[idx, 1]], \n            'k--', alpha=0.4, linewidth=1, zorder=1)\n    ax.scatter(X_train[idx, 0], X_train[idx, 1], \n               s=150, facecolors='none', edgecolors='black', linewidths=2, zorder=3)\n\n# Point requete\nax.scatter(x_query[0], x_query[1], c='red', s=120, marker='*', \n           label='Requete', zorder=4)\n\n# Compter les votes\nvotes = y_train[k_nearest_idx]\nn_class0 = np.sum(votes == 0)\nn_class1 = np.sum(votes == 1)\nprediction = 0 if n_class0 \u003e n_class1 else 1\n\nax.set_xlabel('$x_1$')\nax.set_ylabel('$x_2$')\nax.legend(loc='upper left')\nax.set_title(f'$k = {k}$: votes = [{n_class0} classe 0, {n_class1} classe 1] -\u003e prediction: classe {prediction}')\nax.set_aspect('equal')\nax.grid(True, alpha=0.3)\nplt.tight_layout()\nplt.show()","key":"XGnVlLGapO"},{"type":"outputs","id":"PiE8cRBaQIBsUHWRQZStM","children":[{"type":"output","children":[],"jupyter_data":{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"\u003cFigure size 700x600 with 1 Axes\u003e","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"704f4e8170edbc7022532c9850590032","path":"/mlbook/build/704f4e8170edbc7022532c9850590032.png"}}},"key":"lQ57DmJK7z"}],"key":"SceBdF8diQ"}],"key":"GCQwGncNgo"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Exercice: Implementer le vote majoritaire","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Nwd4hfj0NW"}],"identifier":"exercice-implementer-le-vote-majoritaire","label":"Exercice: Implementer le vote majoritaire","html_id":"exercice-implementer-le-vote-majoritaire","implicit":true,"key":"gDGL9GmCri"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Completez la fonction ci-dessous pour compter les votes et predire la classe.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"BYS3pneVDN"}],"key":"UxW3egVNfP"}],"key":"NvCh4xJe1Y"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"def knn_predict(X_train, y_train, x_query, k):\n    \"\"\"\n    Predit la classe d'un point en utilisant les k plus proches voisins.\n    \n    Parametres:\n        X_train: array (N, d) - points d'entrainement\n        y_train: array (N,) - etiquettes (0 ou 1)\n        x_query: array (d,) - point a classifier\n        k: int - nombre de voisins\n    \n    Retourne:\n        prediction: int (0 ou 1)\n    \"\"\"\n    # TODO: Calculer les distances euclidiennes de x_query a tous les points\n    distances = None  # A completer\n    \n    # TODO: Trouver les indices des k plus proches voisins\n    k_nearest_idx = None  # A completer\n    \n    # TODO: Recuperer les etiquettes des k voisins\n    k_labels = None  # A completer\n    \n    # TODO: Vote majoritaire (retourner 0 ou 1)\n    prediction = None  # A completer\n    \n    return prediction\n\n# Test de votre fonction\ntest_pred = knn_predict(X_train, y_train, x_query, k=5)\nprint(f\"Prediction pour {x_query}: classe {test_pred}\")","key":"spuYQhG78z"},{"type":"outputs","id":"axtk2HRJVLl67aF2YIZo9","children":[{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"Prediction pour [0.3 0.2]: classe None\n"},"key":"haH7LQh3hT"}],"key":"mMwms11kvo"}],"key":"x8YETZPWvR"},{"type":"block","kind":"notebook-content","children":[{"type":"details","children":[{"type":"summary","children":[{"type":"strong","children":[{"type":"text","value":"Solution","key":"BILdOoCCag"}],"key":"JQ0NWvpMIh"},{"type":"text","value":" (cliquez pour afficher)","key":"fXA1gPqWsm"}],"key":"CE1nbbo0Mz"},{"type":"code","lang":"python","meta":null,"value":"def knn_predict(X_train, y_train, x_query, k):\n    # Calculer les distances euclidiennes\n    distances = np.sqrt(np.sum((X_train - x_query)**2, axis=1))\n    \n    # Trouver les indices des k plus proches voisins\n    k_nearest_idx = np.argsort(distances)[:k]\n    \n    # Recuperer les etiquettes des k voisins\n    k_labels = y_train[k_nearest_idx]\n    \n    # Vote majoritaire\n    prediction = 1 if np.sum(k_labels) \u003e k/2 else 0\n    \n    return prediction","key":"wUpJeZk70J"}],"key":"BpbPJzKGmq"}],"key":"wPZFy5Zwgt"},{"type":"block","kind":"notebook-content","children":[{"type":"thematicBreak","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"FePk4NCLKF"},{"type":"heading","depth":2,"position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"Partie 2: Effet de k","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"Q26goBGfCB"}],"identifier":"partie-2-effet-de-k","label":"Partie 2: Effet de k","html_id":"partie-2-effet-de-k","implicit":true,"key":"P47dhxdxf3"},{"type":"paragraph","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"Le parametre ","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"sfye0Svluc"},{"type":"inlineMath","value":"k","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmi\u003ek\u003c/mi\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003ek\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.6944em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.03148em;\"\u003ek\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"oSJgQiJW5H"},{"type":"text","value":" controle la complexite du modele:","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"SNsUhYzpwQ"}],"key":"ZVqkb4lqRj"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":5,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"inlineMath","value":"k=1","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmi\u003ek\u003c/mi\u003e\u003cmo\u003e=\u003c/mo\u003e\u003cmn\u003e1\u003c/mn\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003ek=1\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.6944em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.03148em;\"\u003ek\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003cspan class=\"mrel\"\u003e=\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.6444em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e1\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"WLsSWNHQdc"}],"key":"ZOeAwr5S5p"},{"type":"text","value":": Frontiere tres irreguliere, erreur d’entrainement = 0","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"Q8DkPOxh15"}],"key":"MgXQEBlCjM"}],"key":"hzR8Hhz8aT"},{"type":"listItem","spread":true,"position":{"start":{"line":6,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"Grand ","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"B5QZj8VEda"},{"type":"inlineMath","value":"k","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmi\u003ek\u003c/mi\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003ek\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.6944em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.03148em;\"\u003ek\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"TNDDopiZuR"}],"key":"uVJ36hOC6o"},{"type":"text","value":": Frontiere plus lisse, tend vers la classe majoritaire","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"ERfDXtT3P7"}],"key":"GyX4xgkgtL"}],"key":"NQ0XFw3CpY"}],"key":"PIERd4FwZZ"},{"type":"paragraph","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"Visualisons la frontiere de decision pour differentes valeurs de ","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"Cp5EOEjHX2"},{"type":"inlineMath","value":"k","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmi\u003ek\u003c/mi\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003ek\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.6944em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.03148em;\"\u003ek\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"Fr4tbFtXqQ"},{"type":"text","value":".","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"Jk1AAGYynf"}],"key":"e7FhKIB1Fa"}],"key":"jl2IofDx7P"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"def knn_predict_batch(X_train, y_train, X_test, k):\n    \"\"\"Predit les classes pour un ensemble de points.\"\"\"\n    predictions = []\n    for x in X_test:\n        distances = np.sqrt(np.sum((X_train - x)**2, axis=1))\n        k_nearest_idx = np.argsort(distances)[:k]\n        k_labels = y_train[k_nearest_idx]\n        predictions.append(1 if np.sum(k_labels) \u003e k/2 else 0)\n    return np.array(predictions)","key":"klQRnbj9rn"},{"type":"outputs","id":"HILBp_nIUD6y45vXkqg8z","children":[],"key":"vtDSZDlAC4"}],"key":"i9XN0j6xsH"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Creer une grille pour visualiser la frontiere de decision\nx_min, x_max = X_train[:, 0].min() - 0.5, X_train[:, 0].max() + 0.5\ny_min, y_max = X_train[:, 1].min() - 0.5, X_train[:, 1].max() + 0.5\nxx, yy = np.meshgrid(np.linspace(x_min, x_max, 100),\n                     np.linspace(y_min, y_max, 100))\nX_mesh = np.c_[xx.ravel(), yy.ravel()]\n\n# Visualiser pour differentes valeurs de k\nfig, axes = plt.subplots(1, 3, figsize=(14, 4.5))\nk_values = [1, 5, 15]\ncmap_light = ListedColormap(['#FFAAAA', '#AAAAFF'])\n\nfor ax, k in zip(axes, k_values):\n    Z = knn_predict_batch(X_train, y_train, X_mesh, k)\n    Z = Z.reshape(xx.shape)\n    \n    ax.contourf(xx, yy, Z, alpha=0.4, cmap=cmap_light)\n    ax.scatter(X_train[y_train == 0, 0], X_train[y_train == 0, 1], \n               c='C0', s=40, edgecolors='k', linewidths=0.5)\n    ax.scatter(X_train[y_train == 1, 0], X_train[y_train == 1, 1], \n               c='C1', s=40, edgecolors='k', linewidths=0.5)\n    ax.set_xlim(x_min, x_max)\n    ax.set_ylim(y_min, y_max)\n    ax.set_title(f'$k = {k}$')\n    ax.set_xlabel('$x_1$')\n    ax.set_ylabel('$x_2$')\n\nplt.tight_layout()\nplt.show()","key":"X0XLvQ3p5r"},{"type":"outputs","id":"7zTc_t0tF7E7wNEk0SsQI","children":[{"type":"output","children":[],"jupyter_data":{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"\u003cFigure size 1400x450 with 3 Axes\u003e","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"fcb58ce3719b46c173ef85e554a88618","path":"/mlbook/build/fcb58ce3719b46c173ef85e554a88618.png"}}},"key":"Br7tXCGkiW"}],"key":"hxbEMIr77T"}],"key":"PUkUalF3Hu"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Question","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"kQAvz3CQyB"}],"key":"XFXKHT7rVZ"},{"type":"text","value":": Que se passe-t-il avec ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"YTdJRVUhK3"},{"type":"inlineMath","value":"k=1","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmi\u003ek\u003c/mi\u003e\u003cmo\u003e=\u003c/mo\u003e\u003cmn\u003e1\u003c/mn\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003ek=1\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.6944em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.03148em;\"\u003ek\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003cspan class=\"mrel\"\u003e=\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.6444em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e1\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"Kqbuzj5jF9"},{"type":"text","value":"? Et avec ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"jKwhH8emw0"},{"type":"inlineMath","value":"k=N","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmi\u003ek\u003c/mi\u003e\u003cmo\u003e=\u003c/mo\u003e\u003cmi\u003eN\u003c/mi\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003ek=N\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.6944em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.03148em;\"\u003ek\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003cspan class=\"mrel\"\u003e=\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.6833em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.10903em;\"\u003eN\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"avLHnQSWEb"},{"type":"text","value":" (tous les points)?","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"v0vtQCk3ES"}],"key":"xpyt2Dt1E2"}],"key":"gcKzl8tFGZ"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Compromis biais-variance","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"dQgqm6Xil3"}],"identifier":"compromis-biais-variance","label":"Compromis biais-variance","html_id":"compromis-biais-variance","implicit":true,"key":"k2wVl8Hovw"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Tracez l’erreur d’entrainement et de test en fonction de ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"I94LtL6jxp"},{"type":"inlineMath","value":"k","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmi\u003ek\u003c/mi\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003ek\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.6944em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.03148em;\"\u003ek\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"epq589ZvRz"},{"type":"text","value":".","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"ruAHrZPB1l"}],"key":"yMWKI8euVu"}],"key":"vMGPp6OkJt"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Generer des donnees de test\nnp.random.seed(123)\nX0_test = np.random.randn(50, 2) * 0.6 + np.array([-1, -1])\nX1_test = np.random.randn(50, 2) * 0.6 + np.array([1, 1])\nX_test = np.vstack([X0_test, X1_test])\ny_test = np.array([0] * 50 + [1] * 50)\n\n# Calculer les erreurs pour differents k\nk_values = list(range(1, 30, 2))  # k impair pour eviter les egalites\ntrain_errors = []\ntest_errors = []\n\nfor k in k_values:\n    y_pred_train = knn_predict_batch(X_train, y_train, X_train, k)\n    y_pred_test = knn_predict_batch(X_train, y_train, X_test, k)\n    train_errors.append(np.mean(y_pred_train != y_train))\n    test_errors.append(np.mean(y_pred_test != y_test))\n\n# Tracer\nplt.figure(figsize=(8, 5))\nplt.plot(k_values, train_errors, 'o-', label='Entrainement')\nplt.plot(k_values, test_errors, 's-', label='Test')\nplt.xlabel('$k$ (nombre de voisins)')\nplt.ylabel('Taux d\\'erreur')\nplt.title('Compromis biais-variance')\nplt.legend()\nplt.grid(True, alpha=0.3)\nplt.show()\n\nprint(f\"Meilleur k sur le test: {k_values[np.argmin(test_errors)]}\")","key":"JjuwuKNfTW"},{"type":"outputs","id":"OIlo7ZL0i8oaf9TH3l-Hb","children":[{"type":"output","children":[],"jupyter_data":{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"\u003cFigure size 800x500 with 1 Axes\u003e","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"65caf6bc2a546462faf82eef2dbb334f","path":"/mlbook/build/65caf6bc2a546462faf82eef2dbb334f.png"}}},"key":"uY3tlH8fgg"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"Meilleur k sur le test: 21\n"},"key":"pJRKmCDMNB"}],"key":"Y8uXuy0bqM"}],"key":"QnYcGM6QLP"},{"type":"block","kind":"notebook-content","children":[{"type":"thematicBreak","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"SdtundPusX"},{"type":"heading","depth":2,"position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"Partie 3: Fonctions de distance","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"YkCea7YYCk"}],"identifier":"partie-3-fonctions-de-distance","label":"Partie 3: Fonctions de distance","html_id":"partie-3-fonctions-de-distance","implicit":true,"key":"uo7YtMjvIM"},{"type":"paragraph","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"L’algorithme k-ppv depend de la fonction de distance utilisee. Les plus communes sont:","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"OadfYJXMtC"}],"key":"gJx3hoEWWu"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":6,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"Distance euclidienne (","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"V0E7N4Da60"},{"type":"inlineMath","value":"\\ell_2","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmsub\u003e\u003cmi mathvariant=\"normal\"\u003eℓ\u003c/mi\u003e\u003cmn\u003e2\u003c/mn\u003e\u003c/msub\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003e\\ell_2\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.8444em;vertical-align:-0.15em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord\"\u003eℓ\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.3011em;\"\u003e\u003cspan style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e2\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.15em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"i5fhwXKsRW"},{"type":"text","value":")","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"eIf1c9ZmNW"}],"key":"e2qKVbkSoo"},{"type":"text","value":": ","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"Paj6Vzi8MQ"},{"type":"inlineMath","value":"d(\\mathbf{x}, \\mathbf{y}) = \\sqrt{\\sum_j (x_j - y_j)^2}","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmi\u003ed\u003c/mi\u003e\u003cmo stretchy=\"false\"\u003e(\u003c/mo\u003e\u003cmi mathvariant=\"bold\"\u003ex\u003c/mi\u003e\u003cmo separator=\"true\"\u003e,\u003c/mo\u003e\u003cmi mathvariant=\"bold\"\u003ey\u003c/mi\u003e\u003cmo stretchy=\"false\"\u003e)\u003c/mo\u003e\u003cmo\u003e=\u003c/mo\u003e\u003cmsqrt\u003e\u003cmrow\u003e\u003cmsub\u003e\u003cmo\u003e∑\u003c/mo\u003e\u003cmi\u003ej\u003c/mi\u003e\u003c/msub\u003e\u003cmo stretchy=\"false\"\u003e(\u003c/mo\u003e\u003cmsub\u003e\u003cmi\u003ex\u003c/mi\u003e\u003cmi\u003ej\u003c/mi\u003e\u003c/msub\u003e\u003cmo\u003e−\u003c/mo\u003e\u003cmsub\u003e\u003cmi\u003ey\u003c/mi\u003e\u003cmi\u003ej\u003c/mi\u003e\u003c/msub\u003e\u003cmsup\u003e\u003cmo stretchy=\"false\"\u003e)\u003c/mo\u003e\u003cmn\u003e2\u003c/mn\u003e\u003c/msup\u003e\u003c/mrow\u003e\u003c/msqrt\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003ed(\\mathbf{x}, \\mathbf{y}) = \\sqrt{\\sum_j (x_j - y_j)^2}\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\"\u003ed\u003c/span\u003e\u003cspan class=\"mopen\"\u003e(\u003c/span\u003e\u003cspan class=\"mord mathbf\"\u003ex\u003c/span\u003e\u003cspan class=\"mpunct\"\u003e,\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.1667em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathbf\" style=\"margin-right:0.01597em;\"\u003ey\u003c/span\u003e\u003cspan class=\"mclose\"\u003e)\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003cspan class=\"mrel\"\u003e=\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:1.84em;vertical-align:-0.6979em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord sqrt\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:1.1421em;\"\u003e\u003cspan class=\"svg-align\" style=\"top:-3.8em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3.8em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\" style=\"padding-left:1em;\"\u003e\u003cspan class=\"mop\"\u003e\u003cspan class=\"mop op-symbol small-op\" style=\"position:relative;top:0em;\"\u003e∑\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.162em;\"\u003e\u003cspan style=\"top:-2.4003em;margin-left:0em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\"\u003ej\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.4358em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mopen\"\u003e(\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathnormal\"\u003ex\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.3117em;\"\u003e\u003cspan style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\"\u003ej\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.2861em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2222em;\"\u003e\u003c/span\u003e\u003cspan class=\"mbin\"\u003e−\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2222em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.03588em;\"\u003ey\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.3117em;\"\u003e\u003cspan style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\"\u003ej\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.2861em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mclose\"\u003e\u003cspan class=\"mclose\"\u003e)\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.7401em;\"\u003e\u003cspan style=\"top:-2.989em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e2\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"top:-3.1021em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3.8em;\"\u003e\u003c/span\u003e\u003cspan class=\"hide-tail\" style=\"min-width:1.02em;height:1.88em;\"\u003e\u003csvg xmlns=\"http://www.w3.org/2000/svg\" width='400em' height='1.88em' viewBox='0 0 400000 1944' preserveAspectRatio='xMinYMin slice'\u003e\u003cpath d='M983 90\nl0 -0\nc4,-6.7,10,-10,18,-10 H400000v40\nH1013.1s-83.4,268,-264.1,840c-180.7,572,-277,876.3,-289,913c-4.7,4.7,-12.7,7,-24,7\ns-12,0,-12,0c-1.3,-3.3,-3.7,-11.7,-7,-25c-35.3,-125.3,-106.7,-373.3,-214,-744\nc-10,12,-21,25,-33,39s-32,39,-32,39c-6,-5.3,-15,-14,-27,-26s25,-30,25,-30\nc26.7,-32.7,52,-63,76,-91s52,-60,52,-60s208,722,208,722\nc56,-175.3,126.3,-397.3,211,-666c84.7,-268.7,153.8,-488.2,207.5,-658.5\nc53.7,-170.3,84.5,-266.8,92.5,-289.5z\nM1001 80h400000v40h-400000z'/\u003e\u003c/svg\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.6979em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"Cu2AHRqCpq"}],"key":"Yd6eS1brjS"}],"key":"ET480Jh2c7"},{"type":"listItem","spread":true,"position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"Distance de Manhattan (","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"L5zCGlfGVs"},{"type":"inlineMath","value":"\\ell_1","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmsub\u003e\u003cmi mathvariant=\"normal\"\u003eℓ\u003c/mi\u003e\u003cmn\u003e1\u003c/mn\u003e\u003c/msub\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003e\\ell_1\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.8444em;vertical-align:-0.15em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord\"\u003eℓ\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.3011em;\"\u003e\u003cspan style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e1\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.15em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"sCCUkrVh5S"},{"type":"text","value":")","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"PnfOckFMkD"}],"key":"YpYqKiWubh"},{"type":"text","value":": ","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"rhYps5WcSw"},{"type":"inlineMath","value":"d(\\mathbf{x}, \\mathbf{y}) = \\sum_j |x_j - y_j|","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmi\u003ed\u003c/mi\u003e\u003cmo stretchy=\"false\"\u003e(\u003c/mo\u003e\u003cmi mathvariant=\"bold\"\u003ex\u003c/mi\u003e\u003cmo separator=\"true\"\u003e,\u003c/mo\u003e\u003cmi mathvariant=\"bold\"\u003ey\u003c/mi\u003e\u003cmo stretchy=\"false\"\u003e)\u003c/mo\u003e\u003cmo\u003e=\u003c/mo\u003e\u003cmsub\u003e\u003cmo\u003e∑\u003c/mo\u003e\u003cmi\u003ej\u003c/mi\u003e\u003c/msub\u003e\u003cmi mathvariant=\"normal\"\u003e∣\u003c/mi\u003e\u003cmsub\u003e\u003cmi\u003ex\u003c/mi\u003e\u003cmi\u003ej\u003c/mi\u003e\u003c/msub\u003e\u003cmo\u003e−\u003c/mo\u003e\u003cmsub\u003e\u003cmi\u003ey\u003c/mi\u003e\u003cmi\u003ej\u003c/mi\u003e\u003c/msub\u003e\u003cmi mathvariant=\"normal\"\u003e∣\u003c/mi\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003ed(\\mathbf{x}, \\mathbf{y}) = \\sum_j |x_j - y_j|\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\"\u003ed\u003c/span\u003e\u003cspan class=\"mopen\"\u003e(\u003c/span\u003e\u003cspan class=\"mord mathbf\"\u003ex\u003c/span\u003e\u003cspan class=\"mpunct\"\u003e,\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.1667em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathbf\" style=\"margin-right:0.01597em;\"\u003ey\u003c/span\u003e\u003cspan class=\"mclose\"\u003e)\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003cspan class=\"mrel\"\u003e=\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:1.1858em;vertical-align:-0.4358em;\"\u003e\u003c/span\u003e\u003cspan class=\"mop\"\u003e\u003cspan class=\"mop op-symbol small-op\" style=\"position:relative;top:0em;\"\u003e∑\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.162em;\"\u003e\u003cspan style=\"top:-2.4003em;margin-left:0em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\"\u003ej\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.4358em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.1667em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e∣\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathnormal\"\u003ex\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.3117em;\"\u003e\u003cspan style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\"\u003ej\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.2861em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2222em;\"\u003e\u003c/span\u003e\u003cspan class=\"mbin\"\u003e−\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2222em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:1.0361em;vertical-align:-0.2861em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.03588em;\"\u003ey\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.3117em;\"\u003e\u003cspan style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\"\u003ej\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.2861em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e∣\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"SFYudguk1I"}],"key":"H8IBTfAucJ"}],"key":"mbQWQA6GKn"},{"type":"listItem","spread":true,"position":{"start":{"line":8,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"Distance ","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"bvchXviwz9"},{"type":"inlineMath","value":"\\ell_\\infty","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmsub\u003e\u003cmi mathvariant=\"normal\"\u003eℓ\u003c/mi\u003e\u003cmi mathvariant=\"normal\"\u003e∞\u003c/mi\u003e\u003c/msub\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003e\\ell_\\infty\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.8444em;vertical-align:-0.15em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord\"\u003eℓ\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.1514em;\"\u003e\u003cspan style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e∞\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.15em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"O20GYjNZd1"}],"key":"BCjn5lD8sJ"},{"type":"text","value":": ","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"OAtEVpWT2O"},{"type":"inlineMath","value":"d(\\mathbf{x}, \\mathbf{y}) = \\max_j |x_j - y_j|","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmi\u003ed\u003c/mi\u003e\u003cmo stretchy=\"false\"\u003e(\u003c/mo\u003e\u003cmi mathvariant=\"bold\"\u003ex\u003c/mi\u003e\u003cmo separator=\"true\"\u003e,\u003c/mo\u003e\u003cmi mathvariant=\"bold\"\u003ey\u003c/mi\u003e\u003cmo stretchy=\"false\"\u003e)\u003c/mo\u003e\u003cmo\u003e=\u003c/mo\u003e\u003cmsub\u003e\u003cmrow\u003e\u003cmi\u003emax\u003c/mi\u003e\u003cmo\u003e⁡\u003c/mo\u003e\u003c/mrow\u003e\u003cmi\u003ej\u003c/mi\u003e\u003c/msub\u003e\u003cmi mathvariant=\"normal\"\u003e∣\u003c/mi\u003e\u003cmsub\u003e\u003cmi\u003ex\u003c/mi\u003e\u003cmi\u003ej\u003c/mi\u003e\u003c/msub\u003e\u003cmo\u003e−\u003c/mo\u003e\u003cmsub\u003e\u003cmi\u003ey\u003c/mi\u003e\u003cmi\u003ej\u003c/mi\u003e\u003c/msub\u003e\u003cmi mathvariant=\"normal\"\u003e∣\u003c/mi\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003ed(\\mathbf{x}, \\mathbf{y}) = \\max_j |x_j - y_j|\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\"\u003ed\u003c/span\u003e\u003cspan class=\"mopen\"\u003e(\u003c/span\u003e\u003cspan class=\"mord mathbf\"\u003ex\u003c/span\u003e\u003cspan class=\"mpunct\"\u003e,\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.1667em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathbf\" style=\"margin-right:0.01597em;\"\u003ey\u003c/span\u003e\u003cspan class=\"mclose\"\u003e)\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003cspan class=\"mrel\"\u003e=\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:1.0361em;vertical-align:-0.2861em;\"\u003e\u003c/span\u003e\u003cspan class=\"mop\"\u003e\u003cspan class=\"mop\"\u003emax\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.3117em;\"\u003e\u003cspan style=\"top:-2.55em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\"\u003ej\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.2861em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.1667em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e∣\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathnormal\"\u003ex\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.3117em;\"\u003e\u003cspan style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\"\u003ej\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.2861em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2222em;\"\u003e\u003c/span\u003e\u003cspan class=\"mbin\"\u003e−\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2222em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:1.0361em;vertical-align:-0.2861em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.03588em;\"\u003ey\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.3117em;\"\u003e\u003cspan style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\"\u003ej\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.2861em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e∣\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"ieOS3MGKSQ"}],"key":"QOABprYuAP"}],"key":"kn7pOwXaJ7"}],"key":"anYIeio9Jr"},{"type":"heading","depth":3,"position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"text","value":"Visualiser les boules unite","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"A4P7auHexb"}],"identifier":"visualiser-les-boules-unite","label":"Visualiser les boules unite","html_id":"visualiser-les-boules-unite","implicit":true,"key":"hnjT9OpQ0W"},{"type":"paragraph","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"text","value":"La forme de la boule unite montre ce que chaque norme considere comme “equidistant”.","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"JGttF1ZRy9"}],"key":"MBfLqGYQD1"}],"key":"P4V5iNBfwe"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"fig, axes = plt.subplots(1, 3, figsize=(12, 4))\n\n# Points de reference\np1 = (1, 0)\np2 = (1/np.sqrt(2), 1/np.sqrt(2))  # ~(0.71, 0.71)\n\n# L1 norm (losange)\nax = axes[0]\nt = np.linspace(0, 1, 250)\nx_l1 = np.concatenate([t, 1-t, -t, -1+t])\ny_l1 = np.concatenate([1-t, -t, -1+t, t])\nax.fill(x_l1, y_l1, alpha=0.3, color='C0')\nax.plot(x_l1, y_l1, 'C0-', linewidth=2)\n\nax.scatter([p1[0]], [p1[1]], s=80, c='black', zorder=5)\nax.scatter([p2[0]], [p2[1]], s=80, c='red', zorder=5)\nax.annotate(f'$(1, 0)$\\n$d=1$', p1, textcoords='offset points', \n            xytext=(5, 10), fontsize=9)\nax.annotate(f'$(0.71, 0.71)$\\n$d=1.42$', p2, textcoords='offset points', \n            xytext=(5, 10), fontsize=9, color='red')\n\nax.set_title(r'Norme $\\ell_1$ (Manhattan)')\nax.set_xlim(-1.5, 1.5)\nax.set_ylim(-1.5, 1.5)\nax.set_aspect('equal')\nax.axhline(0, color='gray', linewidth=0.5)\nax.axvline(0, color='gray', linewidth=0.5)\nax.set_xlabel('$x_1$')\nax.set_ylabel('$x_2$')\n\n# L2 norm (cercle)\nax = axes[1]\ntheta = np.linspace(0, 2*np.pi, 1000)\nx_l2 = np.cos(theta)\ny_l2 = np.sin(theta)\nax.fill(x_l2, y_l2, alpha=0.3, color='C1')\nax.plot(x_l2, y_l2, 'C1-', linewidth=2)\n\nax.scatter([p1[0]], [p1[1]], s=80, c='black', zorder=5)\nax.scatter([p2[0]], [p2[1]], s=80, c='black', zorder=5)\nax.annotate(f'$(1, 0)$\\n$d=1$', p1, textcoords='offset points', \n            xytext=(5, 10), fontsize=9)\nax.annotate(f'$(0.71, 0.71)$\\n$d=1$', p2, textcoords='offset points', \n            xytext=(5, 10), fontsize=9)\n\nax.set_title(r'Norme $\\ell_2$ (Euclidienne)')\nax.set_xlim(-1.5, 1.5)\nax.set_ylim(-1.5, 1.5)\nax.set_aspect('equal')\nax.axhline(0, color='gray', linewidth=0.5)\nax.axvline(0, color='gray', linewidth=0.5)\nax.set_xlabel('$x_1$')\nax.set_ylabel('$x_2$')\n\n# L-infinity norm (carre)\nax = axes[2]\nx_linf = np.array([1, 1, -1, -1, 1])\ny_linf = np.array([1, -1, -1, 1, 1])\nax.fill(x_linf, y_linf, alpha=0.3, color='C2')\nax.plot(x_linf, y_linf, 'C2-', linewidth=2)\n\n# Pour L-inf: (1,0), (1,0.5), (1,1) ont tous distance 1\np_inf = [(1, 0), (1, 0.5), (1, 1)]\nfor i, p in enumerate(p_inf):\n    ax.scatter([p[0]], [p[1]], s=80, c='black', zorder=5)\nax.annotate('$(1, 0)$\\n$d=1$', p_inf[0], textcoords='offset points', \n            xytext=(-45, -5), fontsize=9)\nax.annotate('$(1, 0.5)$\\n$d=1$', p_inf[1], textcoords='offset points', \n            xytext=(5, -5), fontsize=9)\nax.annotate('$(1, 1)$\\n$d=1$', p_inf[2], textcoords='offset points', \n            xytext=(5, 5), fontsize=9)\n\nax.set_title(r'Norme $\\ell_\\infty$')\nax.set_xlim(-1.5, 1.5)\nax.set_ylim(-1.5, 1.5)\nax.set_aspect('equal')\nax.axhline(0, color='gray', linewidth=0.5)\nax.axvline(0, color='gray', linewidth=0.5)\nax.set_xlabel('$x_1$')\nax.set_ylabel('$x_2$')\n\nplt.tight_layout()\nplt.show()","key":"LowPBMNuWh"},{"type":"outputs","id":"CnzpYPK6P_kvZcO-mTktD","children":[{"type":"output","children":[],"jupyter_data":{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"\u003cFigure size 1200x400 with 3 Axes\u003e","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"32be2d7a1785639c2b15515862368e29","path":"/mlbook/build/32be2d7a1785639c2b15515862368e29.png"}}},"key":"qzlLMQaJ3k"}],"key":"UhFAeh46eU"}],"key":"Mk6nOeeMXt"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Exercice: Calculer les distances","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"IjQdfe6no5"}],"identifier":"exercice-calculer-les-distances","label":"Exercice: Calculer les distances","html_id":"exercice-calculer-les-distances","implicit":true,"key":"bj0iSy1apm"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Implementez les trois fonctions de distance.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"hylNGY35pg"}],"key":"WR04NPrDAt"}],"key":"JxbkKZlgsg"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"def distance_l1(x, y):\n    \"\"\"Distance de Manhattan.\"\"\"\n    # TODO: Implementer\n    pass\n\ndef distance_l2(x, y):\n    \"\"\"Distance euclidienne.\"\"\"\n    # TODO: Implementer\n    pass\n\ndef distance_linf(x, y):\n    \"\"\"Distance L-infini.\"\"\"\n    # TODO: Implementer\n    pass\n\n# Test avec deux points\nx = np.array([0, 0])\ny = np.array([3, 4])\n\nprint(f\"Points: x = {x}, y = {y}\")\nprint(f\"Distance L1: {distance_l1(x, y)}\")     # Attendu: 7\nprint(f\"Distance L2: {distance_l2(x, y)}\")     # Attendu: 5\nprint(f\"Distance L-inf: {distance_linf(x, y)}\") # Attendu: 4","key":"G5M0FgQrhw"},{"type":"outputs","id":"7qTgt1H7NcN_zN0JDF5At","children":[{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"Points: x = [0 0], y = [3 4]\nDistance L1: None\nDistance L2: None\nDistance L-inf: None\n"},"key":"CyIYkk7gok"}],"key":"DRyBLWgiKA"}],"key":"VQNGz6JR9n"},{"type":"block","kind":"notebook-content","children":[{"type":"details","children":[{"type":"summary","children":[{"type":"strong","children":[{"type":"text","value":"Solution","key":"QpHQxMxB7S"}],"key":"FGZ88LKk1Z"},{"type":"text","value":" (cliquez pour afficher)","key":"G2qgyfZvXt"}],"key":"d1d4VNGTTJ"},{"type":"code","lang":"python","meta":null,"value":"def distance_l1(x, y):\n    return np.sum(np.abs(x - y))\n\ndef distance_l2(x, y):\n    return np.sqrt(np.sum((x - y)**2))\n\ndef distance_linf(x, y):\n    return np.max(np.abs(x - y))","key":"oHpEapqW5O"}],"key":"qtVE62wihg"}],"key":"SWD0juzv2f"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Comment les voisins changent selon la distance","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Jz1Xu4zPcz"}],"identifier":"comment-les-voisins-changent-selon-la-distance","label":"Comment les voisins changent selon la distance","html_id":"comment-les-voisins-changent-selon-la-distance","implicit":true,"key":"UdwwEAPTbR"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Visualisons comment le choix de la metrique affecte les voisins selectionnes.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"bL999cWkiQ"}],"key":"GKDIhI5sFX"}],"key":"tmLpzjQOmd"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Implementer les fonctions de distance (solution)\ndef distance_l1(x, y):\n    return np.sum(np.abs(x - y))\n\ndef distance_l2(x, y):\n    return np.sqrt(np.sum((x - y)**2))\n\ndef distance_linf(x, y):\n    return np.max(np.abs(x - y))\n\n# Point requete\nx_q = np.array([0, 0])\nk = 3\n\nfig, axes = plt.subplots(1, 3, figsize=(14, 4.5))\nmetrics = [('$\\\\ell_1$', distance_l1), ('$\\\\ell_2$', distance_l2), ('$\\\\ell_\\infty$', distance_linf)]\n\nfor ax, (name, dist_func) in zip(axes, metrics):\n    # Calculer les distances avec cette metrique\n    distances = np.array([dist_func(x_q, xi) for xi in X_train])\n    k_idx = np.argsort(distances)[:k]\n    \n    ax.scatter(X_train[y_train == 0, 0], X_train[y_train == 0, 1], \n               c='C0', s=50, alpha=0.5)\n    ax.scatter(X_train[y_train == 1, 0], X_train[y_train == 1, 1], \n               c='C1', s=50, alpha=0.5)\n    \n    # Mettre en evidence les k voisins\n    for idx in k_idx:\n        ax.scatter(X_train[idx, 0], X_train[idx, 1], \n                   s=150, facecolors='none', edgecolors='green', linewidths=2)\n    \n    ax.scatter(x_q[0], x_q[1], c='red', s=120, marker='*', zorder=5)\n    ax.set_title(f'Distance {name}')\n    ax.set_xlabel('$x_1$')\n    ax.set_ylabel('$x_2$')\n    ax.set_aspect('equal')\n    ax.grid(True, alpha=0.3)\n\nplt.tight_layout()\nplt.show()","key":"OsK7YRaGuY"},{"type":"outputs","id":"aIzDb0jTDKlwZ34wN43_D","children":[{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stderr","text":"\u003c\u003e:16: SyntaxWarning: invalid escape sequence '\\i'\n\u003c\u003e:16: SyntaxWarning: invalid escape sequence '\\i'\n/var/folders/kz/gmggxk812sg1jvysfbnx_y7h0000gq/T/ipykernel_18137/969548489.py:16: SyntaxWarning: invalid escape sequence '\\i'\n  metrics = [('$\\\\ell_1$', distance_l1), ('$\\\\ell_2$', distance_l2), ('$\\\\ell_\\infty$', distance_linf)]\n"},"key":"oau0GkXdeN"},{"type":"output","children":[],"jupyter_data":{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"\u003cFigure size 1400x450 with 3 Axes\u003e","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"b0139bec774c548f8864c05cf61ede28","path":"/mlbook/build/b0139bec774c548f8864c05cf61ede28.png"}}},"key":"vCDKoDrkCh"}],"key":"j5laRro3eG"}],"key":"Jzm6KlKhiD"},{"type":"block","kind":"notebook-content","children":[{"type":"thematicBreak","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"l5hp2a7IKQ"},{"type":"heading","depth":2,"position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"Partie 4: Importance de la normalisation","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"XyolEOpmrG"}],"identifier":"partie-4-importance-de-la-normalisation","label":"Partie 4: Importance de la normalisation","html_id":"partie-4-importance-de-la-normalisation","implicit":true,"key":"BS46HRpwPt"},{"type":"paragraph","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"Quand les variables ont des echelles differentes, certaines dominent le calcul de distance.","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"i7rId8Pd7j"}],"key":"rczost9oNL"},{"type":"heading","depth":3,"position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"Exemple: age vs revenu","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"u5ZzDhBbBC"}],"identifier":"exemple-age-vs-revenu","label":"Exemple: age vs revenu","html_id":"exemple-age-vs-revenu","implicit":true,"key":"hZTOJHotv9"}],"key":"J0zQHYp3Uc"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Donnees: age (20-70) et revenu (20000-200000)\nnp.random.seed(42)\nn = 30\n\n# Generer des donnees realistes\nages = np.random.uniform(25, 65, n)\nrevenus = ages * 2000 + np.random.normal(0, 20000, n) + 30000  # Correlation avec l'age\n\nX_raw = np.column_stack([ages, revenus])\n\n# Etiquettes basees sur une combinaison non-lineaire\ny_raw = ((ages \u003e 45) | (revenus \u003e 100000)).astype(int)\n\nprint(f\"Age: min={ages.min():.1f}, max={ages.max():.1f}\")\nprint(f\"Revenu: min={revenus.min():.0f}, max={revenus.max():.0f}\")","key":"pnt9VB6V7T"},{"type":"outputs","id":"rDUxtd0qE4YRdYeITqprB","children":[{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"Age: min=25.8, max=63.8\nRevenu: min=74048, max=163571\n"},"key":"SsZoiEdhmw"}],"key":"OcDeDzUkFn"}],"key":"OPERjPzQXj"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Calculer les distances avant normalisation\nx1 = np.array([30, 50000])   # Jeune, revenu moyen\nx2 = np.array([35, 51000])   # Similaire en age, revenu proche\nx3 = np.array([31, 150000])  # Age proche, revenu tres different\n\nd_12 = np.sqrt(np.sum((x1 - x2)**2))\nd_13 = np.sqrt(np.sum((x1 - x3)**2))\n\nprint(\"AVANT normalisation:\")\nprint(f\"  Distance x1-x2 (age: +5 ans, revenu: +1000$): {d_12:.1f}\")\nprint(f\"  Distance x1-x3 (age: +1 an, revenu: +100000$): {d_13:.1f}\")\nprint(f\"  Ratio: {d_13/d_12:.1f}x plus loin\")","key":"pDm8snPepA"},{"type":"outputs","id":"kpd99za1dz7_p9t_2yK9O","children":[{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"AVANT normalisation:\n  Distance x1-x2 (age: +5 ans, revenu: +1000$): 1000.0\n  Distance x1-x3 (age: +1 an, revenu: +100000$): 100000.0\n  Ratio: 100.0x plus loin\n"},"key":"CE2Vt1rKbe"}],"key":"iYXl7ZYOfw"}],"key":"hAsh9QDs0r"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Observation","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"NgBAoCtd5U"}],"key":"lOutyJZb1k"},{"type":"text","value":": La difference de revenu domine completement! Une difference de 100000$ est vue comme 100x plus importante qu’une difference de 5 ans.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"skIKJHpn1f"}],"key":"Vgnp5Hget7"}],"key":"ngQ7nWM3iU"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Normalisation: centrer et reduire\nmean_age = ages.mean()\nstd_age = ages.std()\nmean_rev = revenus.mean()\nstd_rev = revenus.std()\n\ndef normalize(x):\n    return np.array([(x[0] - mean_age) / std_age, \n                     (x[1] - mean_rev) / std_rev])\n\nx1_norm = normalize(x1)\nx2_norm = normalize(x2)\nx3_norm = normalize(x3)\n\nd_12_norm = np.sqrt(np.sum((x1_norm - x2_norm)**2))\nd_13_norm = np.sqrt(np.sum((x1_norm - x3_norm)**2))\n\nprint(\"APRES normalisation:\")\nprint(f\"  Distance x1-x2: {d_12_norm:.3f}\")\nprint(f\"  Distance x1-x3: {d_13_norm:.3f}\")\nprint(f\"  Ratio: {d_13_norm/d_12_norm:.1f}x plus loin\")","key":"H86uPNAIio"},{"type":"outputs","id":"TpSAlJBKM97g3Hg_ShIyK","children":[{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"APRES normalisation:\n  Distance x1-x2: 0.453\n  Distance x1-x3: 4.574\n  Ratio: 10.1x plus loin\n"},"key":"lF4bRSdApC"}],"key":"Y0O4yGIMdS"}],"key":"P15N7tQq3f"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Visualiser l'effet de la normalisation\nfig, axes = plt.subplots(1, 2, figsize=(12, 5))\n\n# Avant normalisation\nax = axes[0]\nax.scatter(X_raw[y_raw == 0, 0], X_raw[y_raw == 0, 1], c='C0', s=60, label='Classe 0')\nax.scatter(X_raw[y_raw == 1, 0], X_raw[y_raw == 1, 1], c='C1', s=60, label='Classe 1')\nax.scatter([x1[0]], [x1[1]], c='red', s=150, marker='*', zorder=5, label='Requete')\nax.set_xlabel('Age (annees)')\nax.set_ylabel('Revenu ($)')\nax.set_title('Avant normalisation\\n(le revenu domine)')\nax.legend()\nax.grid(True, alpha=0.3)\n\n# Apres normalisation\nX_norm = np.column_stack([(ages - mean_age) / std_age, \n                          (revenus - mean_rev) / std_rev])\n\nax = axes[1]\nax.scatter(X_norm[y_raw == 0, 0], X_norm[y_raw == 0, 1], c='C0', s=60, label='Classe 0')\nax.scatter(X_norm[y_raw == 1, 0], X_norm[y_raw == 1, 1], c='C1', s=60, label='Classe 1')\nax.scatter([x1_norm[0]], [x1_norm[1]], c='red', s=150, marker='*', zorder=5, label='Requete')\nax.set_xlabel('Age (normalise)')\nax.set_ylabel('Revenu (normalise)')\nax.set_title('Apres normalisation\\n(echelles comparables)')\nax.legend()\nax.set_aspect('equal')\nax.grid(True, alpha=0.3)\n\nplt.tight_layout()\nplt.show()","key":"MYUcUoTxZA"},{"type":"outputs","id":"kF6Q-AcwbCKYMhi94JJ3S","children":[{"type":"output","children":[],"jupyter_data":{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"\u003cFigure size 1200x500 with 2 Axes\u003e","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"db2693c68e19c055477d067fe281680f","path":"/mlbook/build/db2693c68e19c055477d067fe281680f.png"}}},"key":"dkAY5LhR91"}],"key":"HIi63wz1nd"}],"key":"AoFdu0ClN5"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Question","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"MLRVRHjIAb"}],"key":"uhVdBOa6v1"},{"type":"text","value":": Quelle variable domine le calcul de distance sans normalisation? Pourquoi est-ce problematique pour k-ppv?","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"vD80GBZEPc"}],"key":"P42z59mmLQ"}],"key":"l9bG1LRRus"},{"type":"block","kind":"notebook-content","children":[{"type":"thematicBreak","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"GHRHduIIek"},{"type":"heading","depth":2,"position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"Recapitulatif","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"q3GN4V4tpB"}],"identifier":"recapitulatif","label":"Recapitulatif","html_id":"recapitulatif","implicit":true,"key":"wYvrIuhU6n"},{"type":"paragraph","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"Dans ce TP, vous avez appris:","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"sXGE5iNzUg"}],"key":"crtR3NmHsy"},{"type":"list","ordered":true,"start":1,"spread":false,"position":{"start":{"line":6,"column":1},"end":{"line":16,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":6,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"strong","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"Algorithme k-ppv","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"GceU7TDTI5"}],"key":"rBvUij685o"},{"type":"text","value":": Classifier par vote majoritaire des k voisins les plus proches","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"iqHLmCOtWl"}],"key":"A52CWYY3Wf"}],"key":"cuWj9Kdtdb"},{"type":"listItem","spread":true,"position":{"start":{"line":8,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"strong","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"Effet de k","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"KtG0S2W1Bp"}],"key":"YOUK2rSaHf"},{"type":"text","value":":","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"sKyPIbb2aW"}],"key":"ufBgynGp0j"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":9,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Petit k = frontiere irreguliere (haute variance)","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"YoNWdR7eql"}],"key":"bSDjqzcamV"}],"key":"FA8L78n7j9"},{"type":"listItem","spread":true,"position":{"start":{"line":10,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Grand k = frontiere lisse (haut biais)","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"wuM1h7ipRz"}],"key":"ReHCislfjn"}],"key":"Ctr6yaCX9t"}],"key":"yw2i7AgyNW"}],"key":"KjtPONlanv"},{"type":"listItem","spread":true,"position":{"start":{"line":12,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"strong","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"text","value":"Fonctions de distance","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"KrfYltGITA"}],"key":"tjp1OOaEnq"},{"type":"text","value":": ","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"H2OT7plWx7"},{"type":"inlineMath","value":"\\ell_1","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmsub\u003e\u003cmi mathvariant=\"normal\"\u003eℓ\u003c/mi\u003e\u003cmn\u003e1\u003c/mn\u003e\u003c/msub\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003e\\ell_1\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.8444em;vertical-align:-0.15em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord\"\u003eℓ\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.3011em;\"\u003e\u003cspan style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e1\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.15em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"ivkGZG6hBl"},{"type":"text","value":" (Manhattan), ","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"pQBT1hEKZ7"},{"type":"inlineMath","value":"\\ell_2","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmsub\u003e\u003cmi mathvariant=\"normal\"\u003eℓ\u003c/mi\u003e\u003cmn\u003e2\u003c/mn\u003e\u003c/msub\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003e\\ell_2\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.8444em;vertical-align:-0.15em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord\"\u003eℓ\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.3011em;\"\u003e\u003cspan style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e2\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.15em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"eeTBK5qrII"},{"type":"text","value":" (Euclidienne), ","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"XUsULWhIyo"},{"type":"inlineMath","value":"\\ell_\\infty","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmsub\u003e\u003cmi mathvariant=\"normal\"\u003eℓ\u003c/mi\u003e\u003cmi mathvariant=\"normal\"\u003e∞\u003c/mi\u003e\u003c/msub\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003e\\ell_\\infty\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.8444em;vertical-align:-0.15em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord\"\u003eℓ\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.1514em;\"\u003e\u003cspan style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e∞\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.15em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"tkM5bQNZT0"}],"key":"h4szUIwey1"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":13,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":13,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"La forme de la boule unite definit ce qui est “equidistant”","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"mckwYiRPn3"}],"key":"FE0ikF2Ztl"}],"key":"TtOria1XcT"}],"key":"s8pktLon2o"}],"key":"uvnUUwsLCt"},{"type":"listItem","spread":true,"position":{"start":{"line":15,"column":1},"end":{"line":16,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"strong","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"text","value":"Normalisation","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"RLPPaqZOKO"}],"key":"fFR1A4zWuH"},{"type":"text","value":": Indispensable quand les variables ont des echelles differentes","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"amCLsfJI2R"}],"key":"DDPi2dUfUG"}],"key":"sGtx8sZfFI"}],"key":"rg88UfKVIk"},{"type":"thematicBreak","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"oRm4nCfvJo"},{"type":"paragraph","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"children":[{"type":"strong","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"children":[{"type":"text","value":"Pour aller plus loin","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"xnM8VfTQOf"}],"key":"kKlNNVB3Eg"},{"type":"text","value":": ","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"lx2phrupuA"},{"type":"link","url":"https://pierrelux.github.io/mlbook/drafts/knn","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"children":[{"type":"text","value":"Chapitre complet sur le site du cours","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"FuSN9NQF1e"}],"urlSource":"https://pierrelux.github.io/mlbook/drafts/knn","key":"m0pZ5jEmUk"}],"key":"ZtqgWOwatK"}],"key":"LzlZmWHrF4"}],"key":"v3dFuT8QAy"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"Le problème d’apprentissage","url":"/learning-problem","group":"Fondements de l'apprentissage machine"},"next":{"title":"TP1: Le problème d’apprentissage","url":"/tp1-learning-problem","group":"Travaux Pratiques"}}},"domain":"http://localhost:3002"},"project":{"bibliography":["/Users/pierre-luc.bacon/Documents/mlbook/references.bib"],"math":{"\\E":{"macro":"\\mathbb{E}"},"\\Var":{"macro":"\\mathrm{Var}"},"\\Cov":{"macro":"\\mathrm{Cov}"},"\\Prob":{"macro":"\\mathbb{P}"},"\\R":{"macro":"\\mathbb{R}"},"\\N":{"macro":"\\mathbb{N}"},"\\Loss":{"macro":"\\mathcal{L}"},"\\Risk":{"macro":"\\mathcal{R}"},"\\Hypothesis":{"macro":"\\mathcal{H}"},"\\Data":{"macro":"\\mathcal{D}"},"\\indicator":{"macro":"\\mathbb{1}"},"\\defeq":{"macro":"\\triangleq"},"\\mathds":{"macro":"\\mathbb"},"\\hdots":{"macro":"\\cdots"}},"exports":[],"title":"Fondements de l'apprentissage machine","description":"Un manuel d'introduction à l'apprentissage machine couvrant les méthodes supervisées et non-supervisées, des algorithmes classiques aux réseaux de neurones modernes.","authors":[{"nameParsed":{"literal":"Pierre-Luc Bacon","given":"Pierre-Luc","family":"Bacon"},"name":"Pierre-Luc Bacon","id":"contributors-myst-generated-uid-0"}],"github":"https://github.com/pierrelux/mlbook","id":"8a3f2c1d-5e7b-4a9c-b2d8-6f1e3c5a7b9d","toc":[{"file":"drafts/intro.md"},{"file":"drafts/knn.md"},{"file":"learning_problem.md"},{"children":[{"file":"exercises/tp0_knn.ipynb"},{"file":"exercises/tp1_learning_problem.ipynb"}],"title":"Travaux Pratiques"}],"index":"index","pages":[{"slug":"knn","title":"Méthodes non paramétriques","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"learning-problem","title":"Le problème d’apprentissage","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"level":1,"title":"Travaux Pratiques"},{"slug":"tp0-knn","title":"TP0: Les k plus proches voisins","description":"","date":"","thumbnail":"/mlbook/build/7e2db436150c38a00650f96925aa5581.svg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"tp1-learning-problem","title":"TP1: Le problème d’apprentissage","description":"","date":"","thumbnail":"/mlbook/build/7e2db436150c38a00650f96925aa5581.svg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2}]}}},"actionData":null,"errors":null},"future":{"unstable_dev":false,"unstable_postcss":false,"unstable_tailwind":false,"v2_errorBoundary":true,"v2_headers":true,"v2_meta":true,"v2_normalizeFormMethod":true,"v2_routeConvention":true}};</script><script type="module" async="">import "/mlbook/build/manifest-86A905A4.js";
import * as route0 from "/mlbook/build/root-CXYA7X5D.js";
import * as route1 from "/mlbook/build/routes/$-JRBPULBO.js";
window.__remixRouteModules = {"root":route0,"routes/$":route1};

import("/mlbook/build/entry.client-PCJPW7TK.js");</script></body></html>