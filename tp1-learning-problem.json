{"version":3,"kind":"Notebook","sha256":"22580043b0348b4b826841df809bf2c11fdc46df70b90301837a0b3b84686b77","slug":"tp1-learning-problem","location":"/exercises/tp1_learning_problem.ipynb","dependencies":[],"frontmatter":{"title":"TP1: Le problème d’apprentissage","content_includes_title":false,"kernelspec":{"name":"python3","display_name":"Python 3","language":"python"},"authors":[{"nameParsed":{"literal":"Pierre-Luc Bacon","given":"Pierre-Luc","family":"Bacon"},"name":"Pierre-Luc Bacon","id":"contributors-myst-generated-uid-0"}],"github":"https://github.com/pierrelux/mlbook","math":{"\\E":{"macro":"\\mathbb{E}"},"\\Var":{"macro":"\\mathrm{Var}"},"\\Cov":{"macro":"\\mathrm{Cov}"},"\\Prob":{"macro":"\\mathbb{P}"},"\\R":{"macro":"\\mathbb{R}"},"\\N":{"macro":"\\mathbb{N}"},"\\Loss":{"macro":"\\mathcal{L}"},"\\Risk":{"macro":"\\mathcal{R}"},"\\Hypothesis":{"macro":"\\mathcal{H}"},"\\Data":{"macro":"\\mathcal{D}"},"\\indicator":{"macro":"\\mathbb{1}"},"\\defeq":{"macro":"\\triangleq"},"\\mathds":{"macro":"\\mathbb"},"\\hdots":{"macro":"\\cdots"}},"numbering":{"title":{"offset":1}},"source_url":"https://github.com/pierrelux/mlbook/blob/main/exercises/tp1_learning_problem.ipynb","edit_url":"https://github.com/pierrelux/mlbook/edit/main/exercises/tp1_learning_problem.ipynb","thumbnail":"/mlbook/build/7e2db436150c38a00650f96925aa5581.svg","exports":[{"format":"ipynb","filename":"tp1_learning_problem.ipynb","url":"/mlbook/build/tp1_learning_problem-d6e1af3ee39b78c892c4cd9275793493.ipynb"}]},"widgets":{},"mdast":{"type":"root","children":[{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"strong","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"IFT6390 - Fondements de l’apprentissage machine","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"mjAEnu6HLI"}],"key":"uz2YwQE0Vs"}],"key":"TZNdDkGDzR"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"link","url":"https://colab.research.google.com/github/pierrelux/mlbook/blob/main/exercises/tp1_learning_problem.ipynb","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"image","url":"/mlbook/build/7e2db436150c38a00650f96925aa5581.svg","alt":"Open In Colab","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"MKPy7wIngl","urlSource":"https://colab.research.google.com/assets/colab-badge.svg"}],"urlSource":"https://colab.research.google.com/github/pierrelux/mlbook/blob/main/exercises/tp1_learning_problem.ipynb","key":"ALB2PDLEMa"}],"key":"WPGIyo4Y0c"},{"type":"paragraph","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"Ce notebook accompagne le ","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"IWWUFjfOxg"},{"type":"link","url":"https://pierrelux.github.io/mlbook/learning-problem","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"Chapitre 2: Le problème d’apprentissage","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"eOflV6op0x"}],"urlSource":"https://pierrelux.github.io/mlbook/learning-problem","key":"l9pEU4hF42"},{"type":"text","value":".","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"wDONTjGeHh"}],"key":"ZqrkgVEQgz"},{"type":"heading","depth":2,"position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"Objectifs","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"yN6arD29ox"}],"identifier":"objectifs","label":"Objectifs","html_id":"objectifs","implicit":true,"key":"qIY1eXvNNf"},{"type":"paragraph","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"À la fin de ce TP, vous serez en mesure de:","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"uuaRCZEW4h"}],"key":"iZ7bvcOGgL"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":12,"column":1},"end":{"line":16,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Calculer l’erreur quadratique moyenne (MSE)","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"Nd3cd11Pnj"}],"key":"re2tAuOOKJ"}],"key":"UwjxJyMt7q"},{"type":"listItem","spread":true,"position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Observer le phénomène de surapprentissage avec des polynômes","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"U2lfzsDSsA"}],"key":"JgVTCcR5uu"}],"key":"P5EPyTO3EU"},{"type":"listItem","spread":true,"position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Comprendre le compromis biais-variance","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"CoLJFT6UWW"}],"key":"PZ3XxBQTRv"}],"key":"GSbOb66h7a"},{"type":"listItem","spread":true,"position":{"start":{"line":15,"column":1},"end":{"line":16,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Implémenter la régularisation Ridge","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"AUBWGyMCBj"}],"key":"QOMY9Dv1Q6"}],"key":"dZAnE2V6W2"}],"key":"AW4YKNilXD"},{"type":"thematicBreak","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"CtMmfRrExN"}],"key":"kZ1p30iclA"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Partie 0: Configuration","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"aahzkabgA5"}],"identifier":"partie-0-configuration","label":"Partie 0: Configuration","html_id":"partie-0-configuration","implicit":true,"key":"OCwcAYw5Y3"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Exécutez cette cellule pour importer les bibliothèques nécessaires.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"AdpmB3Rp69"}],"key":"DrdKuDPA30"}],"key":"QBmJ1NNsVR"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"import numpy as np\nimport matplotlib.pyplot as plt\nimport warnings\nwarnings.filterwarnings('ignore', message='Polyfit may be poorly conditioned')\n\n# Pour de jolis graphiques\nplt.rcParams['figure.figsize'] = (8, 5)\nplt.rcParams['font.size'] = 12\n\nprint(\"Configuration terminee!\")","key":"uyzpWUmw9d"},{"type":"outputs","id":"3kfaGmPrzy9JsNw9Ueha3","children":[{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"Configuration terminee!\n"},"key":"XctnNl9OPT"}],"key":"fMg9hqkQP2"}],"key":"lYXW6DBRWK"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Partie 1: Les données de freinage","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"kIh8gczSV0"}],"identifier":"partie-1-les-donn-es-de-freinage","label":"Partie 1: Les données de freinage","html_id":"partie-1-les-donn-es-de-freinage","implicit":true,"key":"UOw9y7g3cy"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Nous utilisons les données classiques d’Ezekiel (1930): la distance de freinage d’un véhicule en fonction de sa vitesse.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"i0ogrb4J8J"}],"key":"EOrUfyM1iq"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"strong","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Question préliminaire","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"cmVsP8sbyA"}],"key":"WWlYhkg8sQ"},{"type":"text","value":": Quelle relation attendez-vous entre vitesse et distance de freinage? Linéaire? Quadratique? Autre?","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"JsctqAXx7I"}],"key":"d2exoY7wTh"}],"key":"K2wXK0qthx"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Données de freinage (Ezekiel, 1930): vitesse (mph) vs distance d'arrêt (ft)\nspeed = np.array([4, 4, 7, 7, 8, 9, 10, 10, 10, 11, 11, 12, 12, 12, 12, 13, 13, 13, 13, 14,\n                  14, 14, 14, 15, 15, 15, 16, 16, 17, 17, 17, 18, 18, 18, 18, 19, 19, 19,\n                  20, 20, 20, 20, 20, 22, 23, 24, 24, 24, 24, 25], dtype=float)\ndist = np.array([2, 10, 4, 22, 16, 10, 18, 26, 34, 17, 28, 14, 20, 24, 28, 26, 34, 34, 46,\n                 26, 36, 60, 80, 20, 26, 54, 32, 40, 32, 40, 50, 42, 56, 76, 84, 36, 46,\n                 68, 32, 48, 52, 56, 64, 66, 54, 70, 92, 93, 120, 85], dtype=float)\n\nprint(f\"Nombre d'observations: {len(speed)}\")\nprint(f\"Vitesse: min={speed.min():.0f}, max={speed.max():.0f} mph\")\nprint(f\"Distance: min={dist.min():.0f}, max={dist.max():.0f} ft\")","key":"G24vIzWEts"},{"type":"outputs","id":"tWp-bfRlluatlb7P6XweH","children":[{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"Nombre d'observations: 50\nVitesse: min=4, max=25 mph\nDistance: min=2, max=120 ft\n"},"key":"CTc062EmUT"}],"key":"pdLuuVlM0T"}],"key":"ENHQB7Qenf"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Visualisation des données\nplt.figure(figsize=(8, 5))\nplt.scatter(speed, dist, alpha=0.7, s=50)\nplt.xlabel('Vitesse (mph)')\nplt.ylabel('Distance de freinage (ft)')\nplt.title('Données de freinage')\nplt.grid(True, alpha=0.3)\nplt.show()","key":"svvdWA7qrA"},{"type":"outputs","id":"6lURV-r7atoZwPbLBQbT-","children":[{"type":"output","children":[],"jupyter_data":{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"<Figure size 800x500 with 1 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"4b0a027b56e319f0f0001704ff7bf9ed","path":"/mlbook/build/4b0a027b56e319f0f0001704ff7bf9ed.png"}}},"key":"OOAdUeUuHB"}],"key":"uprn65Qnfp"}],"key":"ajzTvegFHL"},{"type":"block","kind":"notebook-content","children":[{"type":"thematicBreak","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"zpmnLkOyLw"},{"type":"heading","depth":2,"position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"Partie 2: Ajuster un polynôme","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"RJVfQ2VNhD"}],"identifier":"partie-2-ajuster-un-polyn-me","label":"Partie 2: Ajuster un polynôme","html_id":"partie-2-ajuster-un-polyn-me","implicit":true,"key":"FRHETlfiPW"},{"type":"paragraph","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"Nous allons ajuster des polynômes de différents degrés aux données.","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"C6eJ2n6Sdt"}],"key":"sFG4f10hY5"},{"type":"heading","depth":3,"position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"2.1 Ajustement simple","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"W3VzFmWaNd"}],"identifier":"id-2-1-ajustement-simple","label":"2.1 Ajustement simple","html_id":"id-2-1-ajustement-simple","implicit":true,"key":"ysjYcDxB48"}],"key":"nIZMZZAAht"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Ajuster un polynôme de degré 2\ndegree = 2\ncoeffs = np.polyfit(speed, dist, degree)\n\nprint(f\"Coefficients du polynôme de degré {degree}:\")\nfor i, c in enumerate(coeffs):\n    print(f\"  coefficient de x^{degree-i}: {c:.4f}\")","key":"Jyxz2gx8UU"},{"type":"outputs","id":"H6aYxLV9Y11if52Kxqg-t","children":[{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"Coefficients du polynôme de degré 2:\n  coefficient de x^2: 0.1000\n  coefficient de x^1: 0.9133\n  coefficient de x^0: 2.4701\n"},"key":"ZAt1lyFzuu"}],"key":"p05YpCDIqs"}],"key":"GlTBZfRaXw"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Visualiser l'ajustement\nplt.figure(figsize=(8, 5))\nplt.scatter(speed, dist, alpha=0.7, s=50, label='Données')\n\n# Grille pour tracer la courbe\nspeed_grid = np.linspace(0, 30, 100)\ndist_pred = np.polyval(coeffs, speed_grid)\nplt.plot(speed_grid, dist_pred, 'r-', linewidth=2, label=f'Polynôme degré {degree}')\n\nplt.xlabel('Vitesse (mph)')\nplt.ylabel('Distance de freinage (ft)')\nplt.legend()\nplt.grid(True, alpha=0.3)\nplt.show()","key":"jJVHPncLV3"},{"type":"outputs","id":"2ROdJTeJ1OKuTb7x1JF2d","children":[{"type":"output","children":[],"jupyter_data":{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"<Figure size 800x500 with 1 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"15d803901f9c4e46843e4bf9ede0e30c","path":"/mlbook/build/15d803901f9c4e46843e4bf9ede0e30c.png"}}},"key":"TiijxgRh7G"}],"key":"QNWZumaKsE"}],"key":"jIvyrDlvy4"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Exercice 1: Calculer l’erreur quadratique moyenne (MSE)","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"OKU767xPwP"}],"identifier":"exercice-1-calculer-lerreur-quadratique-moyenne-mse","label":"Exercice 1: Calculer l’erreur quadratique moyenne (MSE)","html_id":"exercice-1-calculer-lerreur-quadratique-moyenne-mse","implicit":true,"key":"lCjycDaSfD"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"L’erreur quadratique moyenne est définie comme:","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"mQj0Hs9q4d"}],"key":"Xg7g6LD73y"},{"type":"math","value":"\\text{MSE} = \\frac{1}{N} \\sum_{i=1}^{N} (y_i - \\hat{y}_i)^2","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mtext>MSE</mtext><mo>=</mo><mfrac><mn>1</mn><mi>N</mi></mfrac><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></munderover><mo stretchy=\"false\">(</mo><msub><mi>y</mi><mi>i</mi></msub><mo>−</mo><msub><mover accent=\"true\"><mi>y</mi><mo>^</mo></mover><mi>i</mi></msub><msup><mo stretchy=\"false\">)</mo><mn>2</mn></msup></mrow><annotation encoding=\"application/x-tex\">\\text{MSE} = \\frac{1}{N} \\sum_{i=1}^{N} (y_i - \\hat{y}_i)^2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord text\"><span class=\"mord\">MSE</span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:3.106em;vertical-align:-1.2777em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3214em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mop op-limits\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.8283em;\"><span style=\"top:-1.8723em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mrel mtight\">=</span><span class=\"mord mtight\">1</span></span></span></span><span style=\"top:-3.05em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span><span class=\"mop op-symbol large-op\">∑</span></span></span><span style=\"top:-4.3em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.10903em;\">N</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.2777em;\"><span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.1141em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord accent\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6944em;\"><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span></span><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"accent-body\" style=\"left:-0.1944em;\"><span class=\"mord\">^</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1944em;\"><span></span></span></span></span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\"><span class=\"mclose\">)</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8641em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span></span></span></span></span>","enumerator":"1","key":"KRc0LeBTvZ"},{"type":"paragraph","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"strong","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"Complétez la fonction ci-dessous:","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"E2mkL3mSG9"}],"key":"pfVSEWdMlh"}],"key":"e2EyzOCEAV"}],"key":"OftZg0Z6Y8"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"def compute_mse(y_true, y_pred):\n    \"\"\"\n    Calcule l'erreur quadratique moyenne.\n    \n    Args:\n        y_true: valeurs réelles (array)\n        y_pred: prédictions (array)\n    \n    Returns:\n        MSE (float)\n    \"\"\"\n    # ============================================\n    # TODO: Complétez cette fonction\n    # Indice: utilisez np.mean() et l'opérateur **2\n    # ============================================\n    \n    mse = None  # <- Remplacez None par votre code\n    \n    return mse","key":"juw3kPuiDG"},{"type":"outputs","id":"AZ4DmKmY6WYbZXDKDR_C_","children":[],"key":"uG33Nqk2dU"}],"key":"bfNLG61Xwg"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Test de votre fonction\npredictions = np.polyval(coeffs, speed)\nmse = compute_mse(dist, predictions)\n\nif mse is not None:\n    print(f\"MSE pour le polynôme de degré {degree}: {mse:.2f}\")\n    \n    # Vérification\n    expected_mse = np.mean((dist - predictions)**2)\n    if np.isclose(mse, expected_mse):\n        print(\"Correct!\")\n    else:\n        print(f\"Attendu: {expected_mse:.2f}\")\nelse:\n    print(\"La fonction retourne None. Completez le code!\")","key":"zcblNqKNdN"},{"type":"outputs","id":"kSzH03b0FshkTExIXp3-p","children":[{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"La fonction retourne None. Completez le code!\n"},"key":"fF2GZdyXHb"}],"key":"x5PVjvcTgs"}],"key":"imnFbI9ul2"},{"type":"block","kind":"notebook-content","children":[{"type":"details","children":[{"type":"summary","children":[{"type":"text","value":"Cliquez pour voir la solution","key":"NlX1LGKPg2"}],"key":"yON9gT1IuB"},{"type":"code","lang":"python","meta":null,"value":"def compute_mse(y_true, y_pred):\n    mse = np.mean((y_true - y_pred)**2)\n    return mse","key":"NwbvE1Dz66"}],"key":"Qzps4QvNhM"}],"key":"aCKmv26S5S"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Exercice 2: Explorer differents degres","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"jz24hBO6vh"}],"identifier":"exercice-2-explorer-differents-degres","label":"Exercice 2: Explorer differents degres","html_id":"exercice-2-explorer-differents-degres","implicit":true,"key":"dNQL5jt5Za"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"strong","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Modifiez la variable ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"fMQof0rPcB"},{"type":"inlineCode","value":"degree","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"PWNGeTXVvQ"},{"type":"text","value":" ci-dessous et observez:","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"CMnaNuf8v2"}],"key":"Bhp0JtD3ml"}],"key":"pKlHWHZyED"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":4,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Comment change la courbe?","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"MsU5DdlQKQ"}],"key":"wcjl5hgupB"}],"key":"Z5wOWG4LFI"},{"type":"listItem","spread":true,"position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Comment change le MSE?","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"PhvhV2W2zx"}],"key":"jb1uPg8Ite"}],"key":"DspDb4YGBr"}],"key":"pwSqH4uwjA"}],"key":"GhBIvLS3gg"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# ============================================\n# TODO: Essayez différentes valeurs: 1, 2, 5, 10, 15, 20\n# ============================================\ndegree = 2  # <- Modifiez cette valeur!\n\n# Ajustement\ncoeffs = np.polyfit(speed, dist, degree)\npredictions = np.polyval(coeffs, speed)\nmse = np.mean((dist - predictions)**2)\n\n# Visualisation\nplt.figure(figsize=(10, 5))\nplt.scatter(speed, dist, alpha=0.7, s=50, label='Données')\n\nspeed_grid = np.linspace(3, 26, 200)\npred_grid = np.polyval(coeffs, speed_grid)\npred_grid = np.clip(pred_grid, -50, 200)  # Limiter pour la visualisation\n\nplt.plot(speed_grid, pred_grid, 'r-', linewidth=2, label=f'Polynôme degré {degree}')\nplt.xlabel('Vitesse (mph)')\nplt.ylabel('Distance de freinage (ft)')\nplt.title(f'Degré {degree} — MSE = {mse:.1f}')\nplt.legend()\nplt.ylim(-20, 150)\nplt.grid(True, alpha=0.3)\nplt.show()\n\nprint(f\"\\nMSE: {mse:.2f}\")","key":"SKGTTIO13x"},{"type":"outputs","id":"M0nNpZV6ClkqbeCQzyJdS","children":[{"type":"output","children":[],"jupyter_data":{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"<Figure size 1000x500 with 1 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"12bb5590dd57b10fe9e790df698221cf","path":"/mlbook/build/12bb5590dd57b10fe9e790df698221cf.png"}}},"key":"GvZ0f7oO9y"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"\nMSE: 216.49\n"},"key":"wIYAdeVciu"}],"key":"wEzOlQ3zHk"}],"key":"maEL3r2JBO"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Questions de reflexion:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Vts3l6uu51"}],"key":"A0Gd4G6256"}],"key":"SiUI2fgpJU"},{"type":"list","ordered":true,"start":1,"spread":false,"position":{"start":{"line":2,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Quel degré donne le MSE le plus bas?","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"zYHUW2pBqE"}],"key":"RCrz3j2Jd4"}],"key":"OQ4FKOhhz7"},{"type":"listItem","spread":true,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Le polynôme de degré 20 semble-t-il raisonnable pour prédire à de nouvelles vitesses?","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"u5HP4QCA9U"}],"key":"R1xLYQCwl3"}],"key":"Be9jyTDVOr"},{"type":"listItem","spread":true,"position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"C’est quoi le problème avec minimiser uniquement le MSE sur les données d’entraînement?","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"nwyDHqQQGJ"}],"key":"u8WlFX4vVD"}],"key":"nVQl4EVwdh"}],"key":"NJ8X1upHfg"}],"key":"WTqAm0sLoy"},{"type":"block","kind":"notebook-content","children":[{"type":"thematicBreak","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"QqyY1hJO5i"},{"type":"heading","depth":2,"position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"Partie 3: Train/Test Split — Le surapprentissage","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"t4gH6mE5B6"}],"identifier":"partie-3-train-test-split-le-surapprentissage","label":"Partie 3: Train/Test Split — Le surapprentissage","html_id":"partie-3-train-test-split-le-surapprentissage","implicit":true,"key":"IVd8SqYhZK"},{"type":"paragraph","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"Pour détecter le ","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"aic3oQgopm"},{"type":"strong","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"surapprentissage","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"WrtB9sMFjw"}],"key":"qHK4jSuJBg"},{"type":"text","value":", nous séparons les données en:","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"eDsbUoRyDj"}],"key":"G6W92zpc0i"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":5,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Ensemble d’entraînement","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"hAaDyF3GI4"}],"key":"Yy7G3DHHo0"},{"type":"text","value":" (70%): pour ajuster le modèle","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"dorVESy0FA"}],"key":"mHgvhy03oQ"}],"key":"D2qSj2cbHa"},{"type":"listItem","spread":true,"position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"Ensemble de test","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"Cxn1vXUhyD"}],"key":"DJjEcapoFy"},{"type":"text","value":" (30%): pour évaluer la généralisation","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"qF7ztB5kLl"}],"key":"EnmlFaIsjv"}],"key":"Z2CCE7i6D4"}],"key":"X4aOkmuixG"}],"key":"BEloQGyujA"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Séparation train/test\nnp.random.seed(42)  # Pour reproductibilité\nindices = np.random.permutation(len(speed))\nn_train = 35\n\ntrain_idx = indices[:n_train]\ntest_idx = indices[n_train:]\n\nspeed_train, dist_train = speed[train_idx], dist[train_idx]\nspeed_test, dist_test = speed[test_idx], dist[test_idx]\n\nprint(f\"Entraînement: {len(speed_train)} exemples\")\nprint(f\"Test: {len(speed_test)} exemples\")","key":"Ma9gYHLyFg"},{"type":"outputs","id":"Vm0fbsSmT6p27SCnDjDXV","children":[{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"Entraînement: 35 exemples\nTest: 15 exemples\n"},"key":"nFd2W4YBNh"}],"key":"KLoZT8atQc"}],"key":"OFOan4cSIS"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Visualisation de la séparation\nplt.figure(figsize=(8, 5))\nplt.scatter(speed_train, dist_train, alpha=0.7, s=50, label='Entraînement')\nplt.scatter(speed_test, dist_test, alpha=0.7, s=50, marker='s', label='Test')\nplt.xlabel('Vitesse (mph)')\nplt.ylabel('Distance de freinage (ft)')\nplt.legend()\nplt.grid(True, alpha=0.3)\nplt.show()","key":"iaRNK9bXl9"},{"type":"outputs","id":"I_XPS5bLjubX5kF6OyS-3","children":[{"type":"output","children":[],"jupyter_data":{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"<Figure size 800x500 with 1 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"9dfc4022c35909ed2e5c192f673f6a4e","path":"/mlbook/build/9dfc4022c35909ed2e5c192f673f6a4e.png"}}},"key":"F7OjndL2qT"}],"key":"QdY7gtuVRp"}],"key":"n0j0bZehd2"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Exercice 3: Courbe biais-variance","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"hTYTp7BtcY"}],"identifier":"exercice-3-courbe-biais-variance","label":"Exercice 3: Courbe biais-variance","html_id":"exercice-3-courbe-biais-variance","implicit":true,"key":"Un1TGu6suY"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"strong","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Complétez le code pour calculer l’erreur sur train ET test pour chaque degré:","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"nvPp9pgpTI"}],"key":"GubKEIK6eK"}],"key":"uEBj6sAUxO"}],"key":"CcEV9kaykI"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"degrees = range(1, 16)\ntrain_errors = []\ntest_errors = []\n\nfor deg in degrees:\n    # Ajuster sur l'ensemble d'entraînement\n    coeffs = np.polyfit(speed_train, dist_train, deg)\n    \n    # ============================================\n    # TODO: Calculez les prédictions et erreurs\n    # ============================================\n    \n    # Prédictions sur train\n    pred_train = None  # <- Complétez avec np.polyval(...)\n    \n    # Prédictions sur test\n    pred_test = None  # <- Complétez avec np.polyval(...)\n    \n    # MSE sur train\n    mse_train = None  # <- Complétez\n    \n    # MSE sur test\n    mse_test = None  # <- Complétez\n    \n    train_errors.append(mse_train)\n    test_errors.append(mse_test)","key":"FOCt17tRR6"},{"type":"outputs","id":"Fxk3W4_Myoo5PmIcHMmPu","children":[],"key":"IqAjC719FM"}],"key":"eCFJD0Gqtl"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Visualisation (exécutez après avoir complété le code ci-dessus)\nif None not in train_errors and None not in test_errors:\n    plt.figure(figsize=(10, 6))\n    plt.plot(degrees, train_errors, 'o-', linewidth=2, markersize=8, label='Erreur entraînement')\n    plt.plot(degrees, test_errors, 's-', linewidth=2, markersize=8, label='Erreur test')\n    plt.yscale('log')\n    plt.xlabel('Degré du polynôme (complexité)')\n    plt.ylabel('MSE (échelle log)')\n    plt.title('Compromis biais-variance')\n    plt.legend()\n    plt.grid(True, alpha=0.3)\n    plt.xticks(range(1, 16, 2))\n    plt.show()\n    \n    # Trouver le meilleur degré\n    best_deg = degrees[np.argmin(test_errors)]\n    print(f\"\\nMeilleur degre (selon erreur test): {best_deg}\")\n    print(f\"   MSE train: {train_errors[best_deg-1]:.1f}\")\n    print(f\"   MSE test: {test_errors[best_deg-1]:.1f}\")\nelse:\n    print(\"Completez le code de l'exercice 3!\")","key":"J4sUn3r6Vb"},{"type":"outputs","id":"pTh1SVKXus9arcQ2iJH1P","children":[{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"Completez le code de l'exercice 3!\n"},"key":"QwO6YuSDeD"}],"key":"ywcr8KPFvS"}],"key":"Om72oJtVdY"},{"type":"block","kind":"notebook-content","children":[{"type":"details","children":[{"type":"summary","children":[{"type":"text","value":"Cliquez pour voir la solution","key":"XdDdazmfYk"}],"key":"l6suHweUp5"},{"type":"code","lang":"python","meta":null,"value":"# Prédictions sur train\npred_train = np.polyval(coeffs, speed_train)\n\n# Prédictions sur test\npred_test = np.polyval(coeffs, speed_test)\n\n# MSE sur train\nmse_train = np.mean((dist_train - pred_train)**2)\n\n# MSE sur test\nmse_test = np.mean((dist_test - pred_test)**2)","key":"UdBWJJZSnM"}],"key":"OFRBVOT5vO"}],"key":"g2r9IjaSEZ"},{"type":"block","kind":"notebook-content","children":[{"type":"thematicBreak","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"MlCsbVz0kz"},{"type":"heading","depth":2,"position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"Partie 4: Régularisation Ridge","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"SoOUgAWT5y"}],"identifier":"partie-4-r-gularisation-ridge","label":"Partie 4: Régularisation Ridge","html_id":"partie-4-r-gularisation-ridge","implicit":true,"key":"hmiVEhlcjP"},{"type":"paragraph","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"Au lieu de choisir un degré bas, on peut utiliser un polynôme de ","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"UM2t9atV6n"},{"type":"strong","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"haut degré","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"h30t666D2K"}],"key":"ceBZKSiU7o"},{"type":"text","value":" avec ","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"o8QsPBA84L"},{"type":"strong","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"régularisation","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"gkb7KIzvLj"}],"key":"bo3xlcuy30"},{"type":"text","value":".","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"Ye1YGrfqwW"}],"key":"RYc3GhI5qx"},{"type":"paragraph","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"La régularisation Ridge ajoute une pénalité sur les coefficients:","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"C0M4JXELow"}],"key":"TD3ITO9hUo"},{"type":"math","value":"\\hat{\\boldsymbol{\\theta}}_{\\text{Ridge}} = \\arg\\min_{\\boldsymbol{\\theta}} \\left[ \\sum_{i=1}^{N} (y_i - \\boldsymbol{\\theta}^\\top \\mathbf{x}_i)^2 + \\lambda \\|\\boldsymbol{\\theta}\\|^2 \\right]","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><msub><mover accent=\"true\"><mi mathvariant=\"bold-italic\">θ</mi><mo>^</mo></mover><mtext>Ridge</mtext></msub><mo>=</mo><mi>arg</mi><mo>⁡</mo><munder><mrow><mi>min</mi><mo>⁡</mo></mrow><mi mathvariant=\"bold-italic\">θ</mi></munder><mrow><mo fence=\"true\">[</mo><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></munderover><mo stretchy=\"false\">(</mo><msub><mi>y</mi><mi>i</mi></msub><mo>−</mo><msup><mi mathvariant=\"bold-italic\">θ</mi><mi mathvariant=\"normal\">⊤</mi></msup><msub><mi mathvariant=\"bold\">x</mi><mi>i</mi></msub><msup><mo stretchy=\"false\">)</mo><mn>2</mn></msup><mo>+</mo><mi>λ</mi><mi mathvariant=\"normal\">∥</mi><mi mathvariant=\"bold-italic\">θ</mi><msup><mi mathvariant=\"normal\">∥</mi><mn>2</mn></msup><mo fence=\"true\">]</mo></mrow></mrow><annotation encoding=\"application/x-tex\">\\hat{\\boldsymbol{\\theta}}_{\\text{Ridge}} = \\arg\\min_{\\boldsymbol{\\theta}} \\left[ \\sum_{i=1}^{N} (y_i - \\boldsymbol{\\theta}^\\top \\mathbf{x}_i)^2 + \\lambda \\|\\boldsymbol{\\theta}\\|^2 \\right]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.244em;vertical-align:-0.2861em;\"></span><span class=\"mord\"><span class=\"mord accent\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.9579em;\"><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord boldsymbol\" style=\"margin-right:0.03194em;\">θ</span></span></span></span><span style=\"top:-3.2634em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"accent-body\" style=\"left:-0.25em;\"><span class=\"mord\">^</span></span></span></span></span></span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord text mtight\"><span class=\"mord mtight\">Ridge</span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:3.106em;vertical-align:-1.2777em;\"></span><span class=\"mop\">ar<span style=\"margin-right:0.01389em;\">g</span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mop op-limits\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6679em;\"><span style=\"top:-2.3479em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord boldsymbol mtight\" style=\"margin-right:0.03194em;\">θ</span></span></span></span></span></span><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span><span class=\"mop\">min</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7521em;\"><span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"minner\"><span class=\"mopen delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size4\">[</span></span><span class=\"mop op-limits\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.8283em;\"><span style=\"top:-1.8723em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mrel mtight\">=</span><span class=\"mord mtight\">1</span></span></span></span><span style=\"top:-3.05em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span><span class=\"mop op-symbol large-op\">∑</span></span></span><span style=\"top:-4.3em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.10903em;\">N</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.2777em;\"><span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord\"><span class=\"mord boldsymbol\" style=\"margin-right:0.03194em;\">θ</span></span></span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.9334em;\"><span style=\"top:-3.1473em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">⊤</span></span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord mathbf\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\"><span class=\"mclose\">)</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8641em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord mathnormal\">λ</span><span class=\"mord\">∥</span><span class=\"mord\"><span class=\"mord\"><span class=\"mord boldsymbol\" style=\"margin-right:0.03194em;\">θ</span></span></span><span class=\"mord\"><span class=\"mord\">∥</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8641em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mclose delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size4\">]</span></span></span></span></span></span></span>","enumerator":"2","key":"bY3VziQuNl"},{"type":"paragraph","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"text","value":"La solution en forme fermée est:","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"j8DKrl83x8"}],"key":"n2RTZLvTY1"},{"type":"math","value":"\\hat{\\boldsymbol{\\theta}}_{\\text{Ridge}} = (\\mathbf{X}^\\top \\mathbf{X} + \\lambda \\mathbf{I})^{-1} \\mathbf{X}^\\top \\mathbf{y}","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><msub><mover accent=\"true\"><mi mathvariant=\"bold-italic\">θ</mi><mo>^</mo></mover><mtext>Ridge</mtext></msub><mo>=</mo><mo stretchy=\"false\">(</mo><msup><mi mathvariant=\"bold\">X</mi><mi mathvariant=\"normal\">⊤</mi></msup><mi mathvariant=\"bold\">X</mi><mo>+</mo><mi>λ</mi><mi mathvariant=\"bold\">I</mi><msup><mo stretchy=\"false\">)</mo><mrow><mo>−</mo><mn>1</mn></mrow></msup><msup><mi mathvariant=\"bold\">X</mi><mi mathvariant=\"normal\">⊤</mi></msup><mi mathvariant=\"bold\">y</mi></mrow><annotation encoding=\"application/x-tex\">\\hat{\\boldsymbol{\\theta}}_{\\text{Ridge}} = (\\mathbf{X}^\\top \\mathbf{X} + \\lambda \\mathbf{I})^{-1} \\mathbf{X}^\\top \\mathbf{y}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.244em;vertical-align:-0.2861em;\"></span><span class=\"mord\"><span class=\"mord accent\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.9579em;\"><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord boldsymbol\" style=\"margin-right:0.03194em;\">θ</span></span></span></span><span style=\"top:-3.2634em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"accent-body\" style=\"left:-0.25em;\"><span class=\"mord\">^</span></span></span></span></span></span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord text mtight\"><span class=\"mord mtight\">Ridge</span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.1491em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathbf\">X</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8991em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">⊤</span></span></span></span></span></span></span></span><span class=\"mord mathbf\">X</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.1491em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">λ</span><span class=\"mord mathbf\">I</span><span class=\"mclose\"><span class=\"mclose\">)</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8641em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">−</span><span class=\"mord mtight\">1</span></span></span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord mathbf\">X</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8991em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">⊤</span></span></span></span></span></span></span></span><span class=\"mord mathbf\" style=\"margin-right:0.01597em;\">y</span></span></span></span></span>","enumerator":"3","key":"YcmtobT67l"}],"key":"xVeAjjQc0C"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Exercice 4: Implementer Ridge Regression","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"gi6vo2x4mm"}],"identifier":"exercice-4-implementer-ridge-regression","label":"Exercice 4: Implementer Ridge Regression","html_id":"exercice-4-implementer-ridge-regression","implicit":true,"key":"z0delzxQrS"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"strong","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Completez la fonction ci-dessous:","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"CdJSGQcdhJ"}],"key":"mJLwM2Qwvq"}],"key":"CEFk9pLEmS"}],"key":"SDsbiuKbNf"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"def polynomial_features(x, degree):\n    \"\"\"\n    Crée la matrice de caractéristiques polynomiales.\n    \n    Args:\n        x: vecteur d'entrées (n,)\n        degree: degré du polynôme\n    \n    Returns:\n        X: matrice (n, degree+1) avec colonnes [1, x, x², ..., x^degree]\n    \"\"\"\n    n = len(x)\n    X = np.zeros((n, degree + 1))\n    for d in range(degree + 1):\n        X[:, d] = x ** d\n    return X\n\n\ndef ridge_regression(X, y, lambda_reg):\n    \"\"\"\n    Calcule les coefficients Ridge.\n    \n    Args:\n        X: matrice de features (n, d)\n        y: vecteur cible (n,)\n        lambda_reg: coefficient de régularisation\n    \n    Returns:\n        theta: coefficients (d,)\n    \"\"\"\n    # ============================================\n    # TODO: Implémentez la formule Ridge\n    # theta = (X'X + lambda*I)^(-1) X'y\n    # \n    # Indices:\n    # - X.T pour la transposée\n    # - @ pour le produit matriciel\n    # - np.eye(n) pour la matrice identité n×n\n    # - np.linalg.inv() pour l'inverse\n    # ============================================\n    \n    d = X.shape[1]  # nombre de features\n    \n    theta = None  # <- Remplacez par votre code\n    \n    return theta","key":"dHcC5e3a3Z"},{"type":"outputs","id":"hDngyQqjRpEsWbBXXazoY","children":[],"key":"wg6QlGQ7MG"}],"key":"EKfOYWqJf7"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Test de votre implémentation\ndegree = 10\nlambda_reg = 1.0\n\nX_train = polynomial_features(speed_train, degree)\ntheta = ridge_regression(X_train, dist_train, lambda_reg)\n\nif theta is not None:\n    print(f\"Coefficients Ridge (degré={degree}, λ={lambda_reg}):\")\n    print(f\"  Norme des coefficients: {np.linalg.norm(theta):.2f}\")\n    \n    # Prédictions\n    X_test = polynomial_features(speed_test, degree)\n    pred_test = X_test @ theta\n    mse = np.mean((dist_test - pred_test)**2)\n    print(f\"  MSE test: {mse:.1f}\")\n    print(\"\\nImplementation correcte!\")\nelse:\n    print(\"Completez la fonction ridge_regression!\")","key":"dLmsFYe9Rs"},{"type":"outputs","id":"hANwTL0HlzFUNmarfPuX0","children":[{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"Completez la fonction ridge_regression!\n"},"key":"zUzKiUtnc2"}],"key":"h3PXwotHNy"}],"key":"Qp1PnV3nH5"},{"type":"block","kind":"notebook-content","children":[{"type":"details","children":[{"type":"summary","children":[{"type":"text","value":"Cliquez pour voir la solution","key":"xOAhIKMJfR"}],"key":"mq7raVrNEp"},{"type":"code","lang":"python","meta":null,"value":"def ridge_regression(X, y, lambda_reg):\n    d = X.shape[1]\n    I = np.eye(d)\n    theta = np.linalg.inv(X.T @ X + lambda_reg * I) @ X.T @ y\n    return theta","key":"c7OxFZOXie"}],"key":"wky4rKFVDN"}],"key":"k7hWAv6zIy"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Exercice 5: Trouver le meilleur lambda","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"bi8AXPWl9k"}],"identifier":"exercice-5-trouver-le-meilleur-lambda","label":"Exercice 5: Trouver le meilleur lambda","html_id":"exercice-5-trouver-le-meilleur-lambda","implicit":true,"key":"tzvIYKuyPe"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"strong","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Explorez différentes valeurs de λ pour un polynôme de degré 10:","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"XXmfOMsrqk"}],"key":"wlsz3klXir"}],"key":"dcZvDyEcpX"}],"key":"xcMcLkjiFQ"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"degree = 10\nX_train = polynomial_features(speed_train, degree)\nX_test = polynomial_features(speed_test, degree)\n\nlambdas = [0, 0.001, 0.01, 0.1, 1, 10, 100, 1000]\nresults = []\n\nprint(f\"{'λ':>10} | {'MSE Train':>10} | {'MSE Test':>10} | {'||θ||':>10}\")\nprint(\"-\" * 50)\n\nfor lam in lambdas:\n    theta = ridge_regression(X_train, dist_train, lam)\n    if theta is not None:\n        mse_train = np.mean((dist_train - X_train @ theta)**2)\n        mse_test = np.mean((dist_test - X_test @ theta)**2)\n        norm_theta = np.linalg.norm(theta)\n        results.append((lam, mse_train, mse_test, norm_theta))\n        print(f\"{lam:>10.3f} | {mse_train:>10.1f} | {mse_test:>10.1f} | {norm_theta:>10.1f}\")","key":"dfQHwfq92s"},{"type":"outputs","id":"14w9cQ8J-VPh5XaxeYuJs","children":[{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"         λ |  MSE Train |   MSE Test |      ||θ||\n--------------------------------------------------\n"},"key":"hXDjLcJahN"}],"key":"URv0pLnUMd"}],"key":"Wg03XnlQCn"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Visualisation de l'effet de λ\nif len(results) > 0:\n    lambdas_plot = [r[0] for r in results]\n    train_plot = [r[1] for r in results]\n    test_plot = [r[2] for r in results]\n    \n    plt.figure(figsize=(10, 5))\n    plt.semilogx([max(l, 1e-4) for l in lambdas_plot], train_plot, 'o-', label='Train')\n    plt.semilogx([max(l, 1e-4) for l in lambdas_plot], test_plot, 's-', label='Test')\n    plt.xlabel('λ (échelle log)')\n    plt.ylabel('MSE')\n    plt.title(f'Effet de la régularisation Ridge (degré={degree})')\n    plt.legend()\n    plt.grid(True, alpha=0.3)\n    plt.show()","key":"WpiUNavbNF"},{"type":"outputs","id":"w05NV2eMeFh5Zr4IPZjmJ","children":[],"key":"LOVisfAVwJ"}],"key":"DwNHOFNVdW"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Questions:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"IwOuesn5Gr"}],"key":"KbBmpIydRp"}],"key":"FeHyp20Nrc"},{"type":"list","ordered":true,"start":1,"spread":false,"position":{"start":{"line":2,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Quelle valeur de λ minimise l’erreur test?","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"KxcB9ib15K"}],"key":"Sf9OcwkqLJ"}],"key":"ZmO7bOTRBo"},{"type":"listItem","spread":true,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Que se passe-t-il quand λ → 0? Et quand λ → ∞?","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"Vz0djHmwi8"}],"key":"WYl3ZHYvvk"}],"key":"xVWhgIuIWg"},{"type":"listItem","spread":true,"position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Comment la norme des coefficients ||θ|| change avec λ?","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"uV41rzUoHm"}],"key":"Z8RXuMCDN9"}],"key":"r1JYHtLNir"}],"key":"grRMZfHt2o"}],"key":"LcK8qSAlvU"},{"type":"block","kind":"notebook-content","children":[{"type":"thematicBreak","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"BG5GDQDgzS"},{"type":"heading","depth":2,"position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"Partie 5: SVD et la solution MCO","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"uEFtVDB6vn"}],"identifier":"partie-5-svd-et-la-solution-mco","label":"Partie 5: SVD et la solution MCO","html_id":"partie-5-svd-et-la-solution-mco","implicit":true,"key":"FtgZvoQLrp"},{"type":"paragraph","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"La ","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"KRvE20AAO2"},{"type":"strong","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"decomposition en valeurs singulieres","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"HX1cVEDxAS"}],"key":"hNsdjd7msj"},{"type":"text","value":" (SVD) offre une autre facon de comprendre les solutions MCO et Ridge. Cette section explore visuellement pourquoi Ridge fonctionne.","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"G6hp1PPNSE"}],"key":"maQ81J8pF0"},{"type":"heading","depth":3,"position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"Qu’est-ce que la SVD?","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"sfFBv2yIUs"}],"identifier":"quest-ce-que-la-svd","label":"Qu’est-ce que la SVD?","html_id":"quest-ce-que-la-svd","implicit":true,"key":"BGMUVGtHKT"},{"type":"paragraph","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"Toute matrice ","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"jzsDOEWScM"},{"type":"inlineMath","value":"\\mathbf{X}","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">X</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{X}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">X</span></span></span></span>","key":"sIoMTWJMrB"},{"type":"text","value":" peut s’ecrire:","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"yk6s8DF7Fb"}],"key":"kzh9Md0AxK"},{"type":"math","value":"\\mathbf{X} = \\mathbf{U} \\mathbf{D} \\mathbf{V}^\\top","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi mathvariant=\"bold\">X</mi><mo>=</mo><mi mathvariant=\"bold\">U</mi><mi mathvariant=\"bold\">D</mi><msup><mi mathvariant=\"bold\">V</mi><mi mathvariant=\"normal\">⊤</mi></msup></mrow><annotation encoding=\"application/x-tex\">\\mathbf{X} = \\mathbf{U} \\mathbf{D} \\mathbf{V}^\\top</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">X</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8991em;\"></span><span class=\"mord mathbf\">UD</span><span class=\"mord\"><span class=\"mord mathbf\" style=\"margin-right:0.01597em;\">V</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8991em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">⊤</span></span></span></span></span></span></span></span></span></span></span></span>","enumerator":"4","key":"qoS8rYTdV5"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":12,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"paragraph","children":[{"type":"inlineMath","value":"\\mathbf{V}","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">V</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{V}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\" style=\"margin-right:0.01597em;\">V</span></span></span></span>","key":"khDi0PpWYX"},{"type":"text","value":": directions principales dans l’espace des features","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"YKyw91jCt8"}],"key":"zjOZsPOqqX"}],"key":"LdA7vYz5i4"},{"type":"listItem","spread":true,"position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"paragraph","children":[{"type":"inlineMath","value":"\\mathbf{D}","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">D</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{D}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">D</span></span></span></span>","key":"CIf8bn2ge8"},{"type":"text","value":": valeurs singulieres ","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"zycoMI3MhP"},{"type":"inlineMath","value":"d_1 \\geq d_2 \\geq \\cdots \\geq d_p","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>d</mi><mn>1</mn></msub><mo>≥</mo><msub><mi>d</mi><mn>2</mn></msub><mo>≥</mo><mo>⋯</mo><mo>≥</mo><msub><mi>d</mi><mi>p</mi></msub></mrow><annotation encoding=\"application/x-tex\">d_1 \\geq d_2 \\geq \\cdots \\geq d_p</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8444em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">d</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">≥</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8444em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">d</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">≥</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7719em;vertical-align:-0.136em;\"></span><span class=\"minner\">⋯</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">≥</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.9805em;vertical-align:-0.2861em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">d</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">p</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span></span></span></span>","key":"BnubY66HJg"},{"type":"text","value":" (amplitudes)","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"WDS7O8I7N2"}],"key":"aFkYLECXD4"}],"key":"UNNBUbrQDM"},{"type":"listItem","spread":true,"position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"paragraph","children":[{"type":"inlineMath","value":"\\mathbf{U}","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">U</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{U}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">U</span></span></span></span>","key":"HayOfHmDhS"},{"type":"text","value":": directions correspondantes dans l’espace des observations","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"MXdb9Q8pCU"}],"key":"DM6qYDRvWi"}],"key":"wsuEONHjJf"}],"key":"pdauAKR9IX"}],"key":"U6fhmp943s"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Creons des donnees 2D pour visualiser la SVD\nnp.random.seed(123)\nn = 50\n\n# Donnees avec correlation (une direction forte, une faible)\nX_2d = np.random.randn(n, 2)\n# Ajouter de la correlation\nX_2d[:, 1] = 0.9 * X_2d[:, 0] + 0.3 * X_2d[:, 1]\n\n# SVD\nU, s, Vt = np.linalg.svd(X_2d, full_matrices=False)\nV = Vt.T\n\nprint(\"Valeurs singulieres:\")\nprint(f\"  d1 = {s[0]:.2f} (direction forte)\")\nprint(f\"  d2 = {s[1]:.2f} (direction faible)\")\nprint(f\"  Ratio d1/d2 = {s[0]/s[1]:.1f}\")","key":"qYBNnKIxCt"},{"type":"outputs","id":"-nF3pVqj8Gt0GX02peVS4","children":[{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"Valeurs singulieres:\n  d1 = 11.22 (direction forte)\n  d2 = 1.68 (direction faible)\n  Ratio d1/d2 = 6.7\n"},"key":"PrREIHfKlt"}],"key":"zPZZxm2wNA"}],"key":"SmdCNnPWDV"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Visualiser les directions principales\nfig, axes = plt.subplots(1, 2, figsize=(12, 5))\n\n# Gauche: donnees et directions principales\nax = axes[0]\nax.scatter(X_2d[:, 0], X_2d[:, 1], alpha=0.5, s=30)\n\n# Tracer les directions principales (vecteurs propres de X'X)\norigin = np.mean(X_2d, axis=0)\nfor i, (sv, color, label) in enumerate(zip(s, ['C0', 'C1'], ['v1 (forte)', 'v2 (faible)'])):\n    direction = V[:, i] * sv / 5  # Echelle pour visualisation\n    ax.annotate('', xy=origin + direction, xytext=origin,\n                arrowprops=dict(arrowstyle='->', color=color, lw=3))\n    ax.annotate(f'{label}\\nd={sv:.1f}', xy=origin + direction * 1.2, fontsize=10, color=color)\n\nax.set_xlabel('$x_1$')\nax.set_ylabel('$x_2$')\nax.set_title('Donnees et directions principales (SVD)')\nax.set_aspect('equal')\nax.grid(True, alpha=0.3)\n\n# Droite: valeurs singulieres\nax = axes[1]\nax.bar([1, 2], s, color=['C0', 'C1'], alpha=0.7)\nax.set_xticks([1, 2])\nax.set_xticklabels(['$d_1$', '$d_2$'])\nax.set_ylabel('Valeur singuliere')\nax.set_title('Spectre des valeurs singulieres')\nax.grid(True, alpha=0.3, axis='y')\n\nplt.tight_layout()\nplt.show()","key":"VxGgcHOzwq"},{"type":"outputs","id":"5HKGohckMRwXXJQCGqtFt","children":[{"type":"output","children":[],"jupyter_data":{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"<Figure size 1200x500 with 2 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"eb9d801d7ae67f989a0fc2f808c6db1a","path":"/mlbook/build/eb9d801d7ae67f989a0fc2f808c6db1a.png"}}},"key":"Y5CTBKfgms"}],"key":"JCgYDVYrrF"}],"key":"omKgHixCL7"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Facteurs de retrecissement Ridge","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"I5Sj25RMcA"}],"identifier":"facteurs-de-retrecissement-ridge","label":"Facteurs de retrecissement Ridge","html_id":"facteurs-de-retrecissement-ridge","implicit":true,"key":"QkgTaNufu8"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"La solution Ridge s’ecrit:","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"sqMJ5pfwLK"}],"key":"O77YAhy05y"},{"type":"math","value":"\\hat{\\boldsymbol{\\theta}}_{\\text{ridge}} = \\sum_{j=1}^d \\underbrace{\\frac{d_j^2}{d_j^2 + \\lambda}}_{\\text{retrecissement}} \\cdot \\frac{\\mathbf{u}_j^\\top \\mathbf{y}}{d_j} \\cdot \\mathbf{v}_j","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><msub><mover accent=\"true\"><mi mathvariant=\"bold-italic\">θ</mi><mo>^</mo></mover><mtext>ridge</mtext></msub><mo>=</mo><munderover><mo>∑</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mi>d</mi></munderover><munder><munder><mfrac><msubsup><mi>d</mi><mi>j</mi><mn>2</mn></msubsup><mrow><msubsup><mi>d</mi><mi>j</mi><mn>2</mn></msubsup><mo>+</mo><mi>λ</mi></mrow></mfrac><mo stretchy=\"true\">⏟</mo></munder><mtext>retrecissement</mtext></munder><mo>⋅</mo><mfrac><mrow><msubsup><mi mathvariant=\"bold\">u</mi><mi>j</mi><mi mathvariant=\"normal\">⊤</mi></msubsup><mi mathvariant=\"bold\">y</mi></mrow><msub><mi>d</mi><mi>j</mi></msub></mfrac><mo>⋅</mo><msub><mi mathvariant=\"bold\">v</mi><mi>j</mi></msub></mrow><annotation encoding=\"application/x-tex\">\\hat{\\boldsymbol{\\theta}}_{\\text{ridge}} = \\sum_{j=1}^d \\underbrace{\\frac{d_j^2}{d_j^2 + \\lambda}}_{\\text{retrecissement}} \\cdot \\frac{\\mathbf{u}_j^\\top \\mathbf{y}}{d_j} \\cdot \\mathbf{v}_j</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.244em;vertical-align:-0.2861em;\"></span><span class=\"mord\"><span class=\"mord accent\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.9579em;\"><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord boldsymbol\" style=\"margin-right:0.03194em;\">θ</span></span></span></span><span style=\"top:-3.2634em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"accent-body\" style=\"left:-0.25em;\"><span class=\"mord\">^</span></span></span></span></span></span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord text mtight\"><span class=\"mord mtight\">ridge</span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:4.2506em;vertical-align:-2.4145em;\"></span><span class=\"mop op-limits\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.8361em;\"><span style=\"top:-1.8723em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span><span class=\"mrel mtight\">=</span><span class=\"mord mtight\">1</span></span></span></span><span style=\"top:-3.05em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span><span class=\"mop op-symbol large-op\">∑</span></span></span><span style=\"top:-4.3em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">d</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.4138em;\"><span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord munder\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.5989em;\"><span style=\"top:-1.1844em;\"><span class=\"pstrut\" style=\"height:3.5989em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord text mtight\"><span class=\"mord mtight\">retrecissement</span></span></span></span></span><span style=\"top:-3.5989em;\"><span class=\"pstrut\" style=\"height:3.5989em;\"></span><span class=\"mord munder\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.5989em;\"><span class=\"svg-align\" style=\"top:-1.8519em;\"><span class=\"pstrut\" style=\"height:3.5989em;\"></span><span class=\"stretchy\" style=\"height:0.548em;min-width:1.6em;\"><span class=\"brace-left\" style=\"height:0.548em;\"><svg xmlns=\"http://www.w3.org/2000/svg\" width='400em' height='0.548em' viewBox='0 0 400000 548' preserveAspectRatio='xMinYMin slice'><path d='M0 6l6-6h17c12.688 0 19.313.3 20 1 4 4 7.313 8.3 10 13\n 35.313 51.3 80.813 93.8 136.5 127.5 55.688 33.7 117.188 55.8 184.5 66.5.688\n 0 2 .3 4 1 18.688 2.7 76 4.3 172 5h399450v120H429l-6-1c-124.688-8-235-61.7\n-331-161C60.687 138.7 32.312 99.3 7 54L0 41V6z'/></svg></span><span class=\"brace-center\" style=\"height:0.548em;\"><svg xmlns=\"http://www.w3.org/2000/svg\" width='400em' height='0.548em' viewBox='0 0 400000 548' preserveAspectRatio='xMidYMin slice'><path d='M199572 214\nc100.7 8.3 195.3 44 280 108 55.3 42 101.7 93 139 153l9 14c2.7-4 5.7-8.7 9-14\n 53.3-86.7 123.7-153 211-199 66.7-36 137.3-56.3 212-62h199568v120H200432c-178.3\n 11.7-311.7 78.3-403 201-6 8-9.7 12-11 12-.7.7-6.7 1-18 1s-17.3-.3-18-1c-1.3 0\n-5-4-11-12-44.7-59.3-101.3-106.3-170-141s-145.3-54.3-229-60H0V214z'/></svg></span><span class=\"brace-right\" style=\"height:0.548em;\"><svg xmlns=\"http://www.w3.org/2000/svg\" width='400em' height='0.548em' viewBox='0 0 400000 548' preserveAspectRatio='xMaxYMin slice'><path d='M399994 0l6 6v35l-6 11c-56 104-135.3 181.3-238 232-57.3\n 28.7-117 45-179 50H-300V214h399897c43.3-7 81-15 113-26 100.7-33 179.7-91 237\n-174 2.7-5 6-9 10-13 .7-1 7.3-1 20-1h17z'/></svg></span></span></span><span style=\"top:-3.5989em;\"><span class=\"pstrut\" style=\"height:3.5989em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.5989em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\">d</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7959em;\"><span style=\"top:-2.4231em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span><span style=\"top:-3.0448em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.413em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord mathnormal\">λ</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.7848em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\">d</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-2.4413em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3948em;\"><span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.099em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.747em;\"><span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.4145em;\"><span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">⋅</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.606em;vertical-align:-0.9721em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.6339em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\">d</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.7848em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathbf\">u</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8491em;\"><span style=\"top:-2.4413em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">⊤</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3948em;\"><span></span></span></span></span></span></span><span class=\"mord mathbf\" style=\"margin-right:0.01597em;\">y</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.9721em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">⋅</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7305em;vertical-align:-0.2861em;\"></span><span class=\"mord\"><span class=\"mord mathbf\" style=\"margin-right:0.01597em;\">v</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.016em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span></span></span></span></span>","enumerator":"5","key":"rstVgk8au4"},{"type":"paragraph","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"Le facteur ","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"aRWGwKTTnM"},{"type":"inlineMath","value":"\\frac{d_j^2}{d_j^2 + \\lambda}","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mfrac><msubsup><mi>d</mi><mi>j</mi><mn>2</mn></msubsup><mrow><msubsup><mi>d</mi><mi>j</mi><mn>2</mn></msubsup><mo>+</mo><mi>λ</mi></mrow></mfrac></mrow><annotation encoding=\"application/x-tex\">\\frac{d_j^2}{d_j^2 + \\lambda}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.9277em;vertical-align:-0.6964em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.2313em;\"><span style=\"top:-2.6264em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">d</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8051em;\"><span style=\"top:-2.1777em;margin-left:0em;margin-right:0.0714em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span><span style=\"top:-2.8448em;margin-right:0.0714em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.4612em;\"><span></span></span></span></span></span></span><span class=\"mbin mtight\">+</span><span class=\"mord mathnormal mtight\">λ</span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.6074em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">d</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8913em;\"><span style=\"top:-2.214em;margin-left:0em;margin-right:0.0714em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span><span style=\"top:-2.931em;margin-right:0.0714em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.4249em;\"><span></span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6964em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span>","key":"DLCWOIzq8G"},{"type":"text","value":" est toujours < 1, et il est ","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"CgdLmfIYDN"},{"type":"strong","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"plus petit pour les directions faibles","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"ntn44d4W46"}],"key":"pVFyqBMWv3"},{"type":"text","value":" (petit ","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"iABFiVD9Z9"},{"type":"inlineMath","value":"d_j","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>d</mi><mi>j</mi></msub></mrow><annotation encoding=\"application/x-tex\">d_j</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.9805em;vertical-align:-0.2861em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">d</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span></span></span></span>","key":"G8AsCdOOMa"},{"type":"text","value":").","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"mLso1nWcNc"}],"key":"kgzSw96wU8"}],"key":"cATocanZyz"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Visualiser les facteurs de retrecissement\nlambdas = [0.01, 0.1, 1, 10]\nd_values = np.array([s[0], s[1]])  # Nos deux valeurs singulieres\n\nfig, ax = plt.subplots(figsize=(10, 5))\n\nx_pos = np.arange(len(d_values))\nwidth = 0.2\n\nfor i, lam in enumerate(lambdas):\n    shrinkage = d_values**2 / (d_values**2 + lam)\n    bars = ax.bar(x_pos + i * width, shrinkage, width, label=f'$\\\\lambda$ = {lam}', alpha=0.8)\n\nax.set_xticks(x_pos + width * 1.5)\nax.set_xticklabels([f'$d_1$ = {s[0]:.1f}\\n(forte)', f'$d_2$ = {s[1]:.1f}\\n(faible)'])\nax.set_ylabel('Facteur de retrecissement $d_j^2 / (d_j^2 + \\\\lambda)$')\nax.set_title('Ridge retrecit plus les directions faibles')\nax.legend()\nax.set_ylim(0, 1.1)\nax.axhline(1, color='gray', linestyle='--', alpha=0.5, label='MCO (pas de retrecissement)')\nax.grid(True, alpha=0.3, axis='y')\n\nplt.tight_layout()\nplt.show()\n\nprint(\"\\nObservation: La direction faible (d2) est beaucoup plus retrecit que la direction forte (d1).\")\nprint(\"C'est exactement ce qu'on veut: reduire l'incertitude la ou elle est grande.\")","key":"cdYMuszyCb"},{"type":"outputs","id":"jWy3NzzYBKHA-rtWlDfb0","children":[{"type":"output","children":[],"jupyter_data":{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"<Figure size 1000x500 with 1 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"d78535e476c18adfd7d74d290e5ce8ec","path":"/mlbook/build/d78535e476c18adfd7d74d290e5ce8ec.png"}}},"key":"B7F7XWC4Cv"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"\nObservation: La direction faible (d2) est beaucoup plus retrecit que la direction forte (d1).\nC'est exactement ce qu'on veut: reduire l'incertitude la ou elle est grande.\n"},"key":"G2MhA5PN12"}],"key":"rZJgak6575"}],"key":"omHXXWOTG4"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Question","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"YRP7PZAYCB"}],"key":"eE1GUueJKR"},{"type":"text","value":": Pourquoi diviser par une petite valeur singuliere ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"g3FtakEtQb"},{"type":"inlineMath","value":"d_j","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>d</mi><mi>j</mi></msub></mrow><annotation encoding=\"application/x-tex\">d_j</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.9805em;vertical-align:-0.2861em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">d</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span></span></span></span>","key":"sHxv4sEPK7"},{"type":"text","value":" amplifie-t-il le bruit dans MCO?","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"hxUUr2o4yl"}],"key":"NSbHr6bE25"}],"key":"cliqTzet6o"},{"type":"block","kind":"notebook-content","children":[{"type":"thematicBreak","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"fd7qIaQIg2"},{"type":"heading","depth":2,"position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"Partie 6: ERM comme integration de Monte Carlo","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"qbKh48JkQH"}],"identifier":"partie-6-erm-comme-integration-de-monte-carlo","label":"Partie 6: ERM comme integration de Monte Carlo","html_id":"partie-6-erm-comme-integration-de-monte-carlo","implicit":true,"key":"PKYsSyPbJq"},{"type":"paragraph","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"Le ","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"PpBS61f4z5"},{"type":"strong","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"risque","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"ogrEXs6v5s"}],"key":"i849OQIQUS"},{"type":"text","value":" mesure la performance moyenne sur toutes les donnees possibles:","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"QzOyt2Tnfb"}],"key":"smo1tmNMRW"},{"type":"math","value":"\\mathcal{R}(f) = \\mathbb{E}_{(\\mathbf{X},Y) \\sim p}[\\ell(Y, f(\\mathbf{X}))] = \\int \\ell(y, f(\\mathbf{x})) \\, p(\\mathbf{x}, y) \\, d\\mathbf{x} \\, dy","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi mathvariant=\"script\">R</mi><mo stretchy=\"false\">(</mo><mi>f</mi><mo stretchy=\"false\">)</mo><mo>=</mo><msub><mi mathvariant=\"double-struck\">E</mi><mrow><mo stretchy=\"false\">(</mo><mi mathvariant=\"bold\">X</mi><mo separator=\"true\">,</mo><mi>Y</mi><mo stretchy=\"false\">)</mo><mo>∼</mo><mi>p</mi></mrow></msub><mo stretchy=\"false\">[</mo><mi mathvariant=\"normal\">ℓ</mi><mo stretchy=\"false\">(</mo><mi>Y</mi><mo separator=\"true\">,</mo><mi>f</mi><mo stretchy=\"false\">(</mo><mi mathvariant=\"bold\">X</mi><mo stretchy=\"false\">)</mo><mo stretchy=\"false\">)</mo><mo stretchy=\"false\">]</mo><mo>=</mo><mo>∫</mo><mi mathvariant=\"normal\">ℓ</mi><mo stretchy=\"false\">(</mo><mi>y</mi><mo separator=\"true\">,</mo><mi>f</mi><mo stretchy=\"false\">(</mo><mi mathvariant=\"bold\">x</mi><mo stretchy=\"false\">)</mo><mo stretchy=\"false\">)</mo><mtext> </mtext><mi>p</mi><mo stretchy=\"false\">(</mo><mi mathvariant=\"bold\">x</mi><mo separator=\"true\">,</mo><mi>y</mi><mo stretchy=\"false\">)</mo><mtext> </mtext><mi>d</mi><mi mathvariant=\"bold\">x</mi><mtext> </mtext><mi>d</mi><mi>y</mi></mrow><annotation encoding=\"application/x-tex\">\\mathcal{R}(f) = \\mathbb{E}_{(\\mathbf{X},Y) \\sim p}[\\ell(Y, f(\\mathbf{X}))] = \\int \\ell(y, f(\\mathbf{x})) \\, p(\\mathbf{x}, y) \\, d\\mathbf{x} \\, dy</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathcal\">R</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.1052em;vertical-align:-0.3552em;\"></span><span class=\"mord\"><span class=\"mord mathbb\">E</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3448em;\"><span style=\"top:-2.5198em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mopen mtight\">(</span><span class=\"mord mathbf mtight\">X</span><span class=\"mpunct mtight\">,</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.22222em;\">Y</span><span class=\"mclose mtight\">)</span><span class=\"mrel mtight\">∼</span><span class=\"mord mathnormal mtight\">p</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3552em;\"><span></span></span></span></span></span></span><span class=\"mopen\">[</span><span class=\"mord\">ℓ</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.22222em;\">Y</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mopen\">(</span><span class=\"mord mathbf\">X</span><span class=\"mclose\">))]</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.2222em;vertical-align:-0.8622em;\"></span><span class=\"mop op-symbol large-op\" style=\"margin-right:0.44445em;position:relative;top:-0.0011em;\">∫</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">ℓ</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mopen\">(</span><span class=\"mord mathbf\">x</span><span class=\"mclose\">))</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">p</span><span class=\"mopen\">(</span><span class=\"mord mathbf\">x</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">d</span><span class=\"mord mathbf\">x</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">d</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span></span></span></span></span>","enumerator":"6","key":"qYMqOw3HaH"},{"type":"paragraph","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"Probleme: cette integrale est ","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"P7xgRE185j"},{"type":"strong","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"impossible a calculer","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"zIOkhkypJq"}],"key":"eQLLgC3TcZ"},{"type":"text","value":" car:","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"RCwH5kzJw4"}],"key":"CODFdtWbED"},{"type":"list","ordered":true,"start":1,"spread":false,"position":{"start":{"line":9,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"On ne connait pas ","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"q51ec3qlyp"},{"type":"inlineMath","value":"p(\\mathbf{x}, y)","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>p</mi><mo stretchy=\"false\">(</mo><mi mathvariant=\"bold\">x</mi><mo separator=\"true\">,</mo><mi>y</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">p(\\mathbf{x}, y)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">p</span><span class=\"mopen\">(</span><span class=\"mord mathbf\">x</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mclose\">)</span></span></span></span>","key":"pqjRdhznAk"}],"key":"OXPZHpEGKE"}],"key":"jd6BI7IKRl"},{"type":"listItem","spread":true,"position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Meme si on la connaissait, l’integrale en haute dimension est intractable","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"zTwKbf2PD6"}],"key":"fo7dKuMBGX"}],"key":"NIKZ0HfxZQ"}],"key":"IjKiJxCaPS"}],"key":"nMXFk3pTAS"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# La malediction de la dimensionnalite pour l'integration numerique\ndimensions = [1, 2, 3, 5, 10, 20, 50, 100]\npoints_per_dim = 10  # 10 points par dimension pour une grille\n\n# On trace log10 du nombre de points (evite les overflows)\nlog_grid_points = [d for d in dimensions]  # log10(10^d) = d\n\nfig, ax = plt.subplots(figsize=(10, 5))\n\ncolors = plt.cm.Reds(np.linspace(0.3, 0.9, len(dimensions)))\nbars = ax.bar(range(len(dimensions)), log_grid_points, color=colors)\n\nax.set_xticks(range(len(dimensions)))\nax.set_xticklabels([f'd={d}' for d in dimensions])\nax.set_xlabel('Dimension')\nax.set_ylabel('$\\\\log_{10}$(nombre de points)')\nax.set_title('Integration numerique: explosion combinatoire')\n\n# Annotations\nax.axhline(10, color='blue', linestyle='--', alpha=0.7)\nax.text(0.5, 11, '10 milliards ($10^{10}$, limite pratique)', color='blue', fontsize=10)\n\nax.axhline(80, color='red', linestyle='--', alpha=0.7)\nax.text(4, 82, 'Atomes dans l\\'univers (~$10^{80}$)', color='red', fontsize=10)\n\nplt.tight_layout()\nplt.show()\n\nprint(f\"\\nAvec seulement 10 points par dimension:\")\nprint(f\"  d=10: 10^10 = 10 milliards de points\")\nprint(f\"  d=100: 10^100 points (impossible!)\")","key":"aJCnftMtjj"},{"type":"outputs","id":"8sLVRCIQPTcPbPrZXk6Ce","children":[{"type":"output","children":[],"jupyter_data":{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"<Figure size 1000x500 with 1 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"ba639440d3b24e970f4104ed8ce9c5a2","path":"/mlbook/build/ba639440d3b24e970f4104ed8ce9c5a2.png"}}},"key":"r9p3PszLtY"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"\nAvec seulement 10 points par dimension:\n  d=10: 10^10 = 10 milliards de points\n  d=100: 10^100 points (impossible!)\n"},"key":"JFZ6SSM82Z"}],"key":"SEzZyhH29Z"}],"key":"D463tuNzi3"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"La solution: Monte Carlo","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"V1hd9rKprm"}],"identifier":"la-solution-monte-carlo","label":"La solution: Monte Carlo","html_id":"la-solution-monte-carlo","implicit":true,"key":"ovB3NJtgiK"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Le ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"nouj4MTJM6"},{"type":"strong","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"risque empirique","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"EcI5MNFDzB"}],"key":"SbOvxaDgmG"},{"type":"text","value":" est une estimation Monte Carlo du vrai risque:","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"NIWZ8IoPSB"}],"key":"FBHvB1li23"},{"type":"math","value":"\\hat{\\mathcal{R}}(f) = \\frac{1}{N} \\sum_{i=1}^{N} \\ell(y_i, f(\\mathbf{x}_i))","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mover accent=\"true\"><mi mathvariant=\"script\">R</mi><mo>^</mo></mover><mo stretchy=\"false\">(</mo><mi>f</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mfrac><mn>1</mn><mi>N</mi></mfrac><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></munderover><mi mathvariant=\"normal\">ℓ</mi><mo stretchy=\"false\">(</mo><msub><mi>y</mi><mi>i</mi></msub><mo separator=\"true\">,</mo><mi>f</mi><mo stretchy=\"false\">(</mo><msub><mi mathvariant=\"bold\">x</mi><mi>i</mi></msub><mo stretchy=\"false\">)</mo><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">\\hat{\\mathcal{R}}(f) = \\frac{1}{N} \\sum_{i=1}^{N} \\ell(y_i, f(\\mathbf{x}_i))</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.1968em;vertical-align:-0.25em;\"></span><span class=\"mord accent\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.9468em;\"><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord mathcal\">R</span></span><span style=\"top:-3.2523em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"accent-body\" style=\"left:-0.1667em;\"><span class=\"mord\">^</span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:3.106em;vertical-align:-1.2777em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3214em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mop op-limits\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.8283em;\"><span style=\"top:-1.8723em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mrel mtight\">=</span><span class=\"mord mtight\">1</span></span></span></span><span style=\"top:-3.05em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span><span class=\"mop op-symbol large-op\">∑</span></span></span><span style=\"top:-4.3em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.10903em;\">N</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.2777em;\"><span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">ℓ</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathbf\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">))</span></span></span></span></span>","enumerator":"7","key":"Z0uehyMZKV"},{"type":"table","position":{"start":{"line":7,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"tableRow","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"tableCell","header":true,"position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"Methode","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"jIYgxt65RV"}],"key":"dx5jCJ9ZJ6"},{"type":"tableCell","header":true,"position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"Complexite","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"JJTjGcPcOQ"}],"key":"ppwECgPrt0"},{"type":"tableCell","header":true,"position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"Exigence","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"LyxnuXDh9e"}],"key":"myOMeFB6Kg"}],"key":"WuBYy74FVU"},{"type":"tableRow","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"Quadrature","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"y7huiPHmh3"}],"key":"dIiANTvF9a"},{"type":"tableCell","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"inlineMath","value":"O(M^d)","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mo stretchy=\"false\">(</mo><msup><mi>M</mi><mi>d</mi></msup><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">O(M^d)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0991em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">M</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8491em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">d</span></span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span>","key":"wBBshC10Gt"}],"key":"f8wjXZ7hTZ"},{"type":"tableCell","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"Connaitre ","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"tlC2rIuZzl"},{"type":"inlineMath","value":"p(\\mathbf{x},y)","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>p</mi><mo stretchy=\"false\">(</mo><mi mathvariant=\"bold\">x</mi><mo separator=\"true\">,</mo><mi>y</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">p(\\mathbf{x},y)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">p</span><span class=\"mopen\">(</span><span class=\"mord mathbf\">x</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mclose\">)</span></span></span></span>","key":"hu9NhJnO9L"}],"key":"jQFzI3lRDQ"}],"key":"JVlASsffiw"},{"type":"tableRow","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"strong","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"text","value":"Monte Carlo","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"fXDnqqnZSN"}],"key":"gziHZXfVZf"}],"key":"v9yypHupoP"},{"type":"tableCell","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"inlineMath","value":"O(N)","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mo stretchy=\"false\">(</mo><mi>N</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">O(N)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"mclose\">)</span></span></span></span>","key":"PN0GvKY4BJ"}],"key":"YdqA3i1pCR"},{"type":"tableCell","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"text","value":"Avoir des echantillons","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"Oer02X1Nu0"}],"key":"l7qVkznFr9"}],"key":"NaIdFuciFf"}],"key":"pSsQpL4ZMx"},{"type":"paragraph","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"text","value":"La complexite Monte Carlo est ","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"lRhvW9hhXL"},{"type":"strong","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"text","value":"independante de la dimension","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"ldPQ1Wn3T0"}],"key":"PnpjeeMoD2"},{"type":"text","value":"!","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"rb4MmHRAIo"}],"key":"cshpCNttVT"}],"key":"twywCJ6ZsN"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Demonstration: Monte Carlo converge independamment de d\ndef true_integral_1d():\n    \"\"\"Integrale de x^2 sur [0,1] = 1/3\"\"\"\n    return 1/3\n\ndef monte_carlo_estimate(n_samples, dim=1):\n    \"\"\"Estime E[||x||^2/d] pour x uniforme sur [0,1]^d\"\"\"\n    # Pour x uniforme sur [0,1]^d, E[x_i^2] = 1/3 pour chaque composante\n    # Donc E[||x||^2/d] = 1/3\n    samples = np.random.uniform(0, 1, (n_samples, dim))\n    return np.mean(np.sum(samples**2, axis=1) / dim)\n\n# Comparer convergence pour differentes dimensions\nnp.random.seed(42)\nn_values = [10, 50, 100, 500, 1000, 5000]\ndims = [1, 10, 100]\n\nfig, ax = plt.subplots(figsize=(10, 5))\n\ntrue_value = 1/3\n\nfor dim in dims:\n    errors = []\n    for n in n_values:\n        estimates = [monte_carlo_estimate(n, dim) for _ in range(50)]  # 50 repetitions\n        errors.append(np.std(estimates))\n    ax.loglog(n_values, errors, 'o-', label=f'd = {dim}', markersize=8)\n\n# Ligne de reference: 1/sqrt(N)\nn_ref = np.array(n_values)\nax.loglog(n_ref, 0.5 / np.sqrt(n_ref), 'k--', alpha=0.5, label='$1/\\\\sqrt{N}$')\n\nax.set_xlabel('Nombre d\\'echantillons N')\nax.set_ylabel('Ecart-type de l\\'estimation')\nax.set_title('Convergence Monte Carlo: independante de la dimension!')\nax.legend()\nax.grid(True, alpha=0.3)\n\nplt.tight_layout()\nplt.show()\n\nprint(\"\\nObservation: Les trois courbes se superposent!\")\nprint(\"La precision Monte Carlo depend de N, pas de d.\")","key":"MY2iVDqWJn"},{"type":"outputs","id":"Oq_-X71mXjqXLLydk39sC","children":[{"type":"output","children":[],"jupyter_data":{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"<Figure size 1000x500 with 1 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"aac517feb3a47506cd97eb7099f71f7c","path":"/mlbook/build/aac517feb3a47506cd97eb7099f71f7c.png"}}},"key":"wMraRqRQHv"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"\nObservation: Les trois courbes se superposent!\nLa precision Monte Carlo depend de N, pas de d.\n"},"key":"pJnAK5T82d"}],"key":"JRCjwxDKdj"}],"key":"WQYana7kFH"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Question","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"JuIa6Qlig6"}],"key":"GOhKR9F4J1"},{"type":"text","value":": Pourquoi la complexite Monte Carlo est-elle ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"PLoVUFksIj"},{"type":"inlineMath","value":"O(N)","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mo stretchy=\"false\">(</mo><mi>N</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">O(N)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"mclose\">)</span></span></span></span>","key":"GeslrvKqra"},{"type":"text","value":" independamment de la dimension ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"vFBoL7lecg"},{"type":"inlineMath","value":"d","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>d</mi></mrow><annotation encoding=\"application/x-tex\">d</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\">d</span></span></span></span>","key":"PEcCR4RcJq"},{"type":"text","value":"?","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"eSwiOv0jGd"}],"key":"NQPKJhuSde"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"strong","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Reponse a reflechir","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"sH8XdMhdqd"}],"key":"S9hSRa3RHb"},{"type":"text","value":": Parce que chaque echantillon ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"eVLcsG7FKK"},{"type":"inlineMath","value":"(\\mathbf{x}_i, y_i)","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">(</mo><msub><mi mathvariant=\"bold\">x</mi><mi>i</mi></msub><mo separator=\"true\">,</mo><msub><mi>y</mi><mi>i</mi></msub><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">(\\mathbf{x}_i, y_i)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathbf\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span>","key":"Ml9Mc0Je6w"},{"type":"text","value":" contribue une evaluation de la perte, peu importe la dimension de ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"x9HTBxsiir"},{"type":"inlineMath","value":"\\mathbf{x}_i","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi mathvariant=\"bold\">x</mi><mi>i</mi></msub></mrow><annotation encoding=\"application/x-tex\">\\mathbf{x}_i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5944em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"HU4yUH412D"},{"type":"text","value":". On ne discretise pas l’espace; on utilise les echantillons tels quels.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"TKyQQYvoX4"}],"key":"bGyp8cCANA"}],"key":"yLIFekzh12"},{"type":"block","kind":"notebook-content","children":[{"type":"thematicBreak","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"uFua4RW7Eg"},{"type":"heading","depth":2,"position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"Recapitulatif","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"EJ4UpFXrMG"}],"identifier":"recapitulatif","label":"Recapitulatif","html_id":"recapitulatif","implicit":true,"key":"eCF7Jn6Wtd"},{"type":"paragraph","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"Dans ce TP, vous avez appris:","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"W7iv7hxULp"}],"key":"VPVWiuCsg3"},{"type":"list","ordered":true,"start":1,"spread":false,"position":{"start":{"line":6,"column":1},"end":{"line":22,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":6,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"strong","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"MSE","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"WF6eDYjw9p"}],"key":"jPbmtNxRQZ"},{"type":"text","value":": L’erreur quadratique moyenne mesure la qualite des predictions","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"BeCBrsQMC1"}],"key":"OPugnfZ75z"}],"key":"AI2WNjNNrY"},{"type":"listItem","spread":true,"position":{"start":{"line":8,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"strong","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"Surapprentissage","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"w8bXrmeMrK"}],"key":"Z6Kl886oef"},{"type":"text","value":": Un modele trop complexe memorise le bruit","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"yPBgV4bVfP"}],"key":"jq6COj7wxp"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":9,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":9,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Erreur train diminue mais erreur test augmente","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"t29N9YawAL"}],"key":"sfGMEAojdg"}],"key":"gW5jhaND3O"}],"key":"OoUBpK6BDD"}],"key":"QxnKzj7l2X"},{"type":"listItem","spread":true,"position":{"start":{"line":11,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"strong","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"Compromis biais-variance","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"pkmhqrA89y"}],"key":"ER6zYW5juq"},{"type":"text","value":":","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"RRlwEyrS1I"}],"key":"XJinagTZwF"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":12,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Modele simple = biais eleve (sous-apprentissage)","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"AqOAB8qiCW"}],"key":"aBbq39fHD8"}],"key":"P3WGqKWRP5"},{"type":"listItem","spread":true,"position":{"start":{"line":13,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Modele complexe = variance elevee (surapprentissage)","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"Sie06DiShI"}],"key":"Mv0gikltYO"}],"key":"gAugjtMj69"}],"key":"VUVlBMgN76"}],"key":"uJVUdP6bMK"},{"type":"listItem","spread":true,"position":{"start":{"line":15,"column":1},"end":{"line":18,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"strong","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"text","value":"Regularisation Ridge","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"g0dfQLhjxf"}],"key":"q3buNrZmtp"},{"type":"text","value":": Penalise les grands coefficients","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"q05QR4FGZ4"}],"key":"n2DN5zvZmD"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":16,"column":1},"end":{"line":18,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Permet d’utiliser des modeles complexes sans surapprentissage","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"F8VXwVOpPv"}],"key":"hpqWW3ul0T"}],"key":"WSersIu1oE"},{"type":"listItem","spread":true,"position":{"start":{"line":17,"column":1},"end":{"line":18,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Lambda controle la force de la regularisation","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"bAvJsGRtcj"}],"key":"Ax1jfwvWNa"}],"key":"rbbP2ImFOX"}],"key":"NxzRGjCNQo"}],"key":"svpNsNY10I"},{"type":"listItem","spread":true,"position":{"start":{"line":19,"column":1},"end":{"line":20,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"children":[{"type":"strong","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"children":[{"type":"text","value":"SVD et Ridge","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"NWkvNa2kJ8"}],"key":"VDT50H5vmL"},{"type":"text","value":": Ridge retrecit plus les directions faibles (petites valeurs singulieres)","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"ZiXDCZUkrO"}],"key":"cRhU8ISvj4"}],"key":"r3zayuaraO"},{"type":"listItem","spread":true,"position":{"start":{"line":21,"column":1},"end":{"line":22,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"children":[{"type":"strong","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"children":[{"type":"text","value":"ERM = Monte Carlo","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"key":"do7zqKhIRw"}],"key":"kD9gSGrSmM"},{"type":"text","value":": Le risque empirique est une estimation Monte Carlo du vrai risque, avec complexite independante de la dimension","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"key":"pAdGywZdup"}],"key":"Phr1HhaeVX"}],"key":"DpmrGLZLUB"}],"key":"DffoDNf5gX"},{"type":"thematicBreak","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"key":"Pw6J13FJWf"},{"type":"paragraph","position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"children":[{"type":"strong","position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"children":[{"type":"text","value":"Pour aller plus loin","position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"key":"FaovsO3ioF"}],"key":"EQWNqYYvWK"},{"type":"text","value":": ","position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"key":"gj3kMIsbV0"},{"type":"link","url":"https://pierrelux.github.io/mlbook/learning-problem","position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"children":[{"type":"text","value":"Chapitre complet sur le site du cours","position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"key":"JJETneN7HV"}],"urlSource":"https://pierrelux.github.io/mlbook/learning-problem","key":"qqygUxQY47"}],"key":"qzx9I2zAC7"}],"key":"faFga8slSq"}],"key":"RrLm9FjYCY"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"TP0: Les k plus proches voisins","url":"/tp0-knn","group":"Travaux Pratiques"}}},"domain":"http://localhost:3002"}