{"version":3,"kind":"Notebook","sha256":"22580043b0348b4b826841df809bf2c11fdc46df70b90301837a0b3b84686b77","slug":"tp1-learning-problem","location":"/exercises/tp1_learning_problem.ipynb","dependencies":[],"frontmatter":{"title":"TP1: Le problème d’apprentissage","content_includes_title":false,"kernelspec":{"name":"python3","display_name":"Python 3","language":"python"},"authors":[{"nameParsed":{"literal":"Pierre-Luc Bacon","given":"Pierre-Luc","family":"Bacon"},"name":"Pierre-Luc Bacon","id":"contributors-myst-generated-uid-0"}],"github":"https://github.com/pierrelux/mlbook","math":{"\\E":{"macro":"\\mathbb{E}"},"\\Var":{"macro":"\\mathrm{Var}"},"\\Cov":{"macro":"\\mathrm{Cov}"},"\\Prob":{"macro":"\\mathbb{P}"},"\\R":{"macro":"\\mathbb{R}"},"\\N":{"macro":"\\mathbb{N}"},"\\Loss":{"macro":"\\mathcal{L}"},"\\Risk":{"macro":"\\mathcal{R}"},"\\Hypothesis":{"macro":"\\mathcal{H}"},"\\Data":{"macro":"\\mathcal{D}"},"\\indicator":{"macro":"\\mathbb{1}"},"\\defeq":{"macro":"\\triangleq"},"\\mathds":{"macro":"\\mathbb"},"\\hdots":{"macro":"\\cdots"}},"numbering":{"title":{"offset":1}},"source_url":"https://github.com/pierrelux/mlbook/blob/main/exercises/tp1_learning_problem.ipynb","edit_url":"https://github.com/pierrelux/mlbook/edit/main/exercises/tp1_learning_problem.ipynb","thumbnail":"/mlbook/build/7e2db436150c38a00650f96925aa5581.svg","exports":[{"format":"ipynb","filename":"tp1_learning_problem.ipynb","url":"/mlbook/build/tp1_learning_problem-d6e1af3ee39b78c892c4cd9275793493.ipynb"}]},"widgets":{},"mdast":{"type":"root","children":[{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"strong","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"IFT6390 - Fondements de l’apprentissage machine","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"a6yJbFAUpK"}],"key":"rN3Iwta5ng"}],"key":"Hmpj7E8nU7"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"link","url":"https://colab.research.google.com/github/pierrelux/mlbook/blob/main/exercises/tp1_learning_problem.ipynb","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"image","url":"/mlbook/build/7e2db436150c38a00650f96925aa5581.svg","alt":"Open In Colab","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"wTh82AYB9k","urlSource":"https://colab.research.google.com/assets/colab-badge.svg"}],"urlSource":"https://colab.research.google.com/github/pierrelux/mlbook/blob/main/exercises/tp1_learning_problem.ipynb","key":"fxKW98MIHa"}],"key":"Dq8nVHKYu2"},{"type":"paragraph","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"Ce notebook accompagne le ","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"mM8DXZfdfR"},{"type":"link","url":"https://pierrelux.github.io/mlbook/learning-problem","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"Chapitre 2: Le problème d’apprentissage","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"Dqns32tyxz"}],"urlSource":"https://pierrelux.github.io/mlbook/learning-problem","key":"U3ZIJuwhW8"},{"type":"text","value":".","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"DLlRLsfUP4"}],"key":"D7ofJ1oMJn"},{"type":"heading","depth":2,"position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"Objectifs","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"qVhekjRi0q"}],"identifier":"objectifs","label":"Objectifs","html_id":"objectifs","implicit":true,"key":"VRXhEULuOR"},{"type":"paragraph","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"À la fin de ce TP, vous serez en mesure de:","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"ZjneNZkm8r"}],"key":"NUgakiQ0qq"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":12,"column":1},"end":{"line":16,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Calculer l’erreur quadratique moyenne (MSE)","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"NztU9bxnSt"}],"key":"nKsopfq1Lt"}],"key":"fad0ZIe9Iz"},{"type":"listItem","spread":true,"position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Observer le phénomène de surapprentissage avec des polynômes","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"zndbJWw4Nq"}],"key":"mN9yhoBsri"}],"key":"MxgvxwcAx3"},{"type":"listItem","spread":true,"position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Comprendre le compromis biais-variance","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"jEbKm3X6XV"}],"key":"QcvU9u0P8b"}],"key":"V4ogwfUVj0"},{"type":"listItem","spread":true,"position":{"start":{"line":15,"column":1},"end":{"line":16,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Implémenter la régularisation Ridge","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"sfcxAvkCXL"}],"key":"E3gaYdhck2"}],"key":"EYOkMvxHLJ"}],"key":"BRxGtp63TF"},{"type":"thematicBreak","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"ZrTpX5BSEV"}],"key":"hNJfGp6cY7"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Partie 0: Configuration","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"aM6cTF7wO8"}],"identifier":"partie-0-configuration","label":"Partie 0: Configuration","html_id":"partie-0-configuration","implicit":true,"key":"g6dnBoClEF"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Exécutez cette cellule pour importer les bibliothèques nécessaires.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"aVHwUllvQD"}],"key":"PWJmdvK6E2"}],"key":"GUsc2RIjwL"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"import numpy as np\nimport matplotlib.pyplot as plt\nimport warnings\nwarnings.filterwarnings('ignore', message='Polyfit may be poorly conditioned')\n\n# Pour de jolis graphiques\nplt.rcParams['figure.figsize'] = (8, 5)\nplt.rcParams['font.size'] = 12\n\nprint(\"Configuration terminee!\")","key":"wrsV1rj1kw"},{"type":"outputs","id":"23Nim3EN3MczW4WjYYbEh","children":[{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"Configuration terminee!\n"},"key":"U5bdct98xO"}],"key":"QCg6xedoZJ"}],"key":"mCvL22DC1L"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Partie 1: Les données de freinage","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"PTWC2YQdMO"}],"identifier":"partie-1-les-donn-es-de-freinage","label":"Partie 1: Les données de freinage","html_id":"partie-1-les-donn-es-de-freinage","implicit":true,"key":"plhy04njKH"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Nous utilisons les données classiques d’Ezekiel (1930): la distance de freinage d’un véhicule en fonction de sa vitesse.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"SxSOTizTl1"}],"key":"hS6CMT4jW3"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"strong","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Question préliminaire","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"ZQzdZCyZUb"}],"key":"NIU7y0aqCk"},{"type":"text","value":": Quelle relation attendez-vous entre vitesse et distance de freinage? Linéaire? Quadratique? Autre?","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"gAODH7xIGL"}],"key":"XFuQ3fq11P"}],"key":"pb1hALrrd8"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Données de freinage (Ezekiel, 1930): vitesse (mph) vs distance d'arrêt (ft)\nspeed = np.array([4, 4, 7, 7, 8, 9, 10, 10, 10, 11, 11, 12, 12, 12, 12, 13, 13, 13, 13, 14,\n                  14, 14, 14, 15, 15, 15, 16, 16, 17, 17, 17, 18, 18, 18, 18, 19, 19, 19,\n                  20, 20, 20, 20, 20, 22, 23, 24, 24, 24, 24, 25], dtype=float)\ndist = np.array([2, 10, 4, 22, 16, 10, 18, 26, 34, 17, 28, 14, 20, 24, 28, 26, 34, 34, 46,\n                 26, 36, 60, 80, 20, 26, 54, 32, 40, 32, 40, 50, 42, 56, 76, 84, 36, 46,\n                 68, 32, 48, 52, 56, 64, 66, 54, 70, 92, 93, 120, 85], dtype=float)\n\nprint(f\"Nombre d'observations: {len(speed)}\")\nprint(f\"Vitesse: min={speed.min():.0f}, max={speed.max():.0f} mph\")\nprint(f\"Distance: min={dist.min():.0f}, max={dist.max():.0f} ft\")","key":"zlxmdPQQ8e"},{"type":"outputs","id":"M_XCs0a2AJRnCQ9W04dYT","children":[{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"Nombre d'observations: 50\nVitesse: min=4, max=25 mph\nDistance: min=2, max=120 ft\n"},"key":"piQBio89Mi"}],"key":"Dr42juDpKl"}],"key":"I9Mqkbbuf1"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Visualisation des données\nplt.figure(figsize=(8, 5))\nplt.scatter(speed, dist, alpha=0.7, s=50)\nplt.xlabel('Vitesse (mph)')\nplt.ylabel('Distance de freinage (ft)')\nplt.title('Données de freinage')\nplt.grid(True, alpha=0.3)\nplt.show()","key":"ZKKvLZJQgC"},{"type":"outputs","id":"R-x0WLh4IbkXKAvl6UF0R","children":[{"type":"output","children":[],"jupyter_data":{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"<Figure size 800x500 with 1 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"4b0a027b56e319f0f0001704ff7bf9ed","path":"/mlbook/build/4b0a027b56e319f0f0001704ff7bf9ed.png"}}},"key":"nE6KEwnRkl"}],"key":"PlQvJ6KHTe"}],"key":"O01hTPSULH"},{"type":"block","kind":"notebook-content","children":[{"type":"thematicBreak","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"QkvVNtPgYE"},{"type":"heading","depth":2,"position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"Partie 2: Ajuster un polynôme","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"duOV2vyG59"}],"identifier":"partie-2-ajuster-un-polyn-me","label":"Partie 2: Ajuster un polynôme","html_id":"partie-2-ajuster-un-polyn-me","implicit":true,"key":"csQmPYzZXk"},{"type":"paragraph","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"Nous allons ajuster des polynômes de différents degrés aux données.","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"FtlmcECZEB"}],"key":"VU3Mwn4dlL"},{"type":"heading","depth":3,"position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"2.1 Ajustement simple","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"FvzF8RRI7c"}],"identifier":"id-2-1-ajustement-simple","label":"2.1 Ajustement simple","html_id":"id-2-1-ajustement-simple","implicit":true,"key":"WT8rjdIGJc"}],"key":"ZmlGmEr6zd"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Ajuster un polynôme de degré 2\ndegree = 2\ncoeffs = np.polyfit(speed, dist, degree)\n\nprint(f\"Coefficients du polynôme de degré {degree}:\")\nfor i, c in enumerate(coeffs):\n    print(f\"  coefficient de x^{degree-i}: {c:.4f}\")","key":"Zbjrwh3kEp"},{"type":"outputs","id":"dai6pID2sAmC-D4izLIKc","children":[{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"Coefficients du polynôme de degré 2:\n  coefficient de x^2: 0.1000\n  coefficient de x^1: 0.9133\n  coefficient de x^0: 2.4701\n"},"key":"XN3dRH7sAi"}],"key":"zCqvejgpBZ"}],"key":"cl85WjNhgS"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Visualiser l'ajustement\nplt.figure(figsize=(8, 5))\nplt.scatter(speed, dist, alpha=0.7, s=50, label='Données')\n\n# Grille pour tracer la courbe\nspeed_grid = np.linspace(0, 30, 100)\ndist_pred = np.polyval(coeffs, speed_grid)\nplt.plot(speed_grid, dist_pred, 'r-', linewidth=2, label=f'Polynôme degré {degree}')\n\nplt.xlabel('Vitesse (mph)')\nplt.ylabel('Distance de freinage (ft)')\nplt.legend()\nplt.grid(True, alpha=0.3)\nplt.show()","key":"VL4iCqMEmh"},{"type":"outputs","id":"Sv1dw9ICJhdLvdh37HDU1","children":[{"type":"output","children":[],"jupyter_data":{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"<Figure size 800x500 with 1 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"15d803901f9c4e46843e4bf9ede0e30c","path":"/mlbook/build/15d803901f9c4e46843e4bf9ede0e30c.png"}}},"key":"vMqiEGbONX"}],"key":"EOS8r8dP95"}],"key":"WHAMr4r3dV"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Exercice 1: Calculer l’erreur quadratique moyenne (MSE)","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"t1bUId9pn8"}],"identifier":"exercice-1-calculer-lerreur-quadratique-moyenne-mse","label":"Exercice 1: Calculer l’erreur quadratique moyenne (MSE)","html_id":"exercice-1-calculer-lerreur-quadratique-moyenne-mse","implicit":true,"key":"jdSddIMJJL"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"L’erreur quadratique moyenne est définie comme:","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"auTkPdkeM2"}],"key":"NWglJUS851"},{"type":"math","value":"\\text{MSE} = \\frac{1}{N} \\sum_{i=1}^{N} (y_i - \\hat{y}_i)^2","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mtext>MSE</mtext><mo>=</mo><mfrac><mn>1</mn><mi>N</mi></mfrac><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></munderover><mo stretchy=\"false\">(</mo><msub><mi>y</mi><mi>i</mi></msub><mo>−</mo><msub><mover accent=\"true\"><mi>y</mi><mo>^</mo></mover><mi>i</mi></msub><msup><mo stretchy=\"false\">)</mo><mn>2</mn></msup></mrow><annotation encoding=\"application/x-tex\">\\text{MSE} = \\frac{1}{N} \\sum_{i=1}^{N} (y_i - \\hat{y}_i)^2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord text\"><span class=\"mord\">MSE</span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:3.106em;vertical-align:-1.2777em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3214em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mop op-limits\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.8283em;\"><span style=\"top:-1.8723em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mrel mtight\">=</span><span class=\"mord mtight\">1</span></span></span></span><span style=\"top:-3.05em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span><span class=\"mop op-symbol large-op\">∑</span></span></span><span style=\"top:-4.3em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.10903em;\">N</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.2777em;\"><span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.1141em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord accent\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6944em;\"><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span></span><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"accent-body\" style=\"left:-0.1944em;\"><span class=\"mord\">^</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1944em;\"><span></span></span></span></span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\"><span class=\"mclose\">)</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8641em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span></span></span></span></span>","enumerator":"1","key":"TUHIBFnrdR"},{"type":"paragraph","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"strong","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"Complétez la fonction ci-dessous:","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"Yz5M8W4Cds"}],"key":"CAHgwD6CRP"}],"key":"YUCVzIun0Z"}],"key":"xTfRbaDKls"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"def compute_mse(y_true, y_pred):\n    \"\"\"\n    Calcule l'erreur quadratique moyenne.\n    \n    Args:\n        y_true: valeurs réelles (array)\n        y_pred: prédictions (array)\n    \n    Returns:\n        MSE (float)\n    \"\"\"\n    # ============================================\n    # TODO: Complétez cette fonction\n    # Indice: utilisez np.mean() et l'opérateur **2\n    # ============================================\n    \n    mse = None  # <- Remplacez None par votre code\n    \n    return mse","key":"TbbUMWLApr"},{"type":"outputs","id":"PuHHtpQkAumNxsaGLDyzR","children":[],"key":"MLlfD1g8aL"}],"key":"pwS5JlPSf4"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Test de votre fonction\npredictions = np.polyval(coeffs, speed)\nmse = compute_mse(dist, predictions)\n\nif mse is not None:\n    print(f\"MSE pour le polynôme de degré {degree}: {mse:.2f}\")\n    \n    # Vérification\n    expected_mse = np.mean((dist - predictions)**2)\n    if np.isclose(mse, expected_mse):\n        print(\"Correct!\")\n    else:\n        print(f\"Attendu: {expected_mse:.2f}\")\nelse:\n    print(\"La fonction retourne None. Completez le code!\")","key":"isub3zH73W"},{"type":"outputs","id":"dT02L2jsxTXL4nWMqStwe","children":[{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"La fonction retourne None. Completez le code!\n"},"key":"MaigJXoGR4"}],"key":"FdUoEsBkUk"}],"key":"h1iu1nKNPr"},{"type":"block","kind":"notebook-content","children":[{"type":"details","children":[{"type":"summary","children":[{"type":"text","value":"Cliquez pour voir la solution","key":"nYVtzDqtn8"}],"key":"KqouH7tFrk"},{"type":"code","lang":"python","meta":null,"value":"def compute_mse(y_true, y_pred):\n    mse = np.mean((y_true - y_pred)**2)\n    return mse","key":"J3UIkGuiE9"}],"key":"dV61FfgMAt"}],"key":"cxYsmBKZoH"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Exercice 2: Explorer differents degres","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"BqXGCPUclb"}],"identifier":"exercice-2-explorer-differents-degres","label":"Exercice 2: Explorer differents degres","html_id":"exercice-2-explorer-differents-degres","implicit":true,"key":"K9PqKSkuJM"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"strong","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Modifiez la variable ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"LoJj0WHWiJ"},{"type":"inlineCode","value":"degree","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"kZnSsqLMgk"},{"type":"text","value":" ci-dessous et observez:","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"kfQF3Ozs13"}],"key":"BOIAb3yQgw"}],"key":"ZuNO1B04pt"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":4,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Comment change la courbe?","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"HjhJ0Hp60Z"}],"key":"BmwSzvBIWg"}],"key":"fC5e8nzKB7"},{"type":"listItem","spread":true,"position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Comment change le MSE?","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"ANC3chRJAy"}],"key":"HgtP67fIZu"}],"key":"VehldIZYrZ"}],"key":"voUbHfOILF"}],"key":"XRjRzkSebc"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# ============================================\n# TODO: Essayez différentes valeurs: 1, 2, 5, 10, 15, 20\n# ============================================\ndegree = 2  # <- Modifiez cette valeur!\n\n# Ajustement\ncoeffs = np.polyfit(speed, dist, degree)\npredictions = np.polyval(coeffs, speed)\nmse = np.mean((dist - predictions)**2)\n\n# Visualisation\nplt.figure(figsize=(10, 5))\nplt.scatter(speed, dist, alpha=0.7, s=50, label='Données')\n\nspeed_grid = np.linspace(3, 26, 200)\npred_grid = np.polyval(coeffs, speed_grid)\npred_grid = np.clip(pred_grid, -50, 200)  # Limiter pour la visualisation\n\nplt.plot(speed_grid, pred_grid, 'r-', linewidth=2, label=f'Polynôme degré {degree}')\nplt.xlabel('Vitesse (mph)')\nplt.ylabel('Distance de freinage (ft)')\nplt.title(f'Degré {degree} — MSE = {mse:.1f}')\nplt.legend()\nplt.ylim(-20, 150)\nplt.grid(True, alpha=0.3)\nplt.show()\n\nprint(f\"\\nMSE: {mse:.2f}\")","key":"ZVot22rz7p"},{"type":"outputs","id":"fhq7Rb1Nqc5ii9MCHYCXa","children":[{"type":"output","children":[],"jupyter_data":{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"<Figure size 1000x500 with 1 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"12bb5590dd57b10fe9e790df698221cf","path":"/mlbook/build/12bb5590dd57b10fe9e790df698221cf.png"}}},"key":"eScLZqZFep"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"\nMSE: 216.49\n"},"key":"o36OHpIYmk"}],"key":"d3Lsah8YmO"}],"key":"mdINvZp4Ai"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Questions de reflexion:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"SWAaj3e1G2"}],"key":"qBsR2hMKg6"}],"key":"f0TyMcBCxf"},{"type":"list","ordered":true,"start":1,"spread":false,"position":{"start":{"line":2,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Quel degré donne le MSE le plus bas?","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"lIuQO0wHpI"}],"key":"AotgTsHYhK"}],"key":"VfCS9lftfU"},{"type":"listItem","spread":true,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Le polynôme de degré 20 semble-t-il raisonnable pour prédire à de nouvelles vitesses?","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"T5CuPltrSG"}],"key":"z0YkEgr5n6"}],"key":"TUbod2yZe0"},{"type":"listItem","spread":true,"position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"C’est quoi le problème avec minimiser uniquement le MSE sur les données d’entraînement?","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"xLhzX7Qdz3"}],"key":"I0zcJFGE4w"}],"key":"e8rVsZU9iN"}],"key":"yEN8lb3R6U"}],"key":"qhj8sV4BzN"},{"type":"block","kind":"notebook-content","children":[{"type":"thematicBreak","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"UuWnezTYsK"},{"type":"heading","depth":2,"position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"Partie 3: Train/Test Split — Le surapprentissage","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"B6YSIWus9N"}],"identifier":"partie-3-train-test-split-le-surapprentissage","label":"Partie 3: Train/Test Split — Le surapprentissage","html_id":"partie-3-train-test-split-le-surapprentissage","implicit":true,"key":"ixA61dia2o"},{"type":"paragraph","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"Pour détecter le ","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"KxEL6q9R2V"},{"type":"strong","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"surapprentissage","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"g0eVFyT5r4"}],"key":"rt6Mks5pp4"},{"type":"text","value":", nous séparons les données en:","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"zVnOZMCzyn"}],"key":"XT9nOJs6gL"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":5,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Ensemble d’entraînement","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"Rl7lwbXpAD"}],"key":"hv4esYTHz6"},{"type":"text","value":" (70%): pour ajuster le modèle","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"H9TuJW0KhM"}],"key":"azZ2chqmri"}],"key":"pt2WlYZUR4"},{"type":"listItem","spread":true,"position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"Ensemble de test","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"whDeNCHQSJ"}],"key":"oSSRmhMig5"},{"type":"text","value":" (30%): pour évaluer la généralisation","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"k1SWGlXNO2"}],"key":"wMWUcyCQP4"}],"key":"zS71ygSVMt"}],"key":"mCfWO6JgEf"}],"key":"wPLaqWkuaQ"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Séparation train/test\nnp.random.seed(42)  # Pour reproductibilité\nindices = np.random.permutation(len(speed))\nn_train = 35\n\ntrain_idx = indices[:n_train]\ntest_idx = indices[n_train:]\n\nspeed_train, dist_train = speed[train_idx], dist[train_idx]\nspeed_test, dist_test = speed[test_idx], dist[test_idx]\n\nprint(f\"Entraînement: {len(speed_train)} exemples\")\nprint(f\"Test: {len(speed_test)} exemples\")","key":"SGBPSFUTH8"},{"type":"outputs","id":"tOLkxVJ5pWkTGGakRpk9T","children":[{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"Entraînement: 35 exemples\nTest: 15 exemples\n"},"key":"o64UMlHUKI"}],"key":"RA0CzwLu8f"}],"key":"xZN0eEFgvW"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Visualisation de la séparation\nplt.figure(figsize=(8, 5))\nplt.scatter(speed_train, dist_train, alpha=0.7, s=50, label='Entraînement')\nplt.scatter(speed_test, dist_test, alpha=0.7, s=50, marker='s', label='Test')\nplt.xlabel('Vitesse (mph)')\nplt.ylabel('Distance de freinage (ft)')\nplt.legend()\nplt.grid(True, alpha=0.3)\nplt.show()","key":"SXGwTGFAFA"},{"type":"outputs","id":"uLO-hxEW0VQbceaarQ_Ni","children":[{"type":"output","children":[],"jupyter_data":{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"<Figure size 800x500 with 1 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"9dfc4022c35909ed2e5c192f673f6a4e","path":"/mlbook/build/9dfc4022c35909ed2e5c192f673f6a4e.png"}}},"key":"ifUgyHAHAe"}],"key":"bMmG7KMbVd"}],"key":"xCbGn79akF"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Exercice 3: Courbe biais-variance","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"GeQvwxfsIR"}],"identifier":"exercice-3-courbe-biais-variance","label":"Exercice 3: Courbe biais-variance","html_id":"exercice-3-courbe-biais-variance","implicit":true,"key":"poXxY98ifm"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"strong","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Complétez le code pour calculer l’erreur sur train ET test pour chaque degré:","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"xbFdOze0hs"}],"key":"DJRPBgunfH"}],"key":"Db8FzalYT6"}],"key":"whrRy0h8uI"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"degrees = range(1, 16)\ntrain_errors = []\ntest_errors = []\n\nfor deg in degrees:\n    # Ajuster sur l'ensemble d'entraînement\n    coeffs = np.polyfit(speed_train, dist_train, deg)\n    \n    # ============================================\n    # TODO: Calculez les prédictions et erreurs\n    # ============================================\n    \n    # Prédictions sur train\n    pred_train = None  # <- Complétez avec np.polyval(...)\n    \n    # Prédictions sur test\n    pred_test = None  # <- Complétez avec np.polyval(...)\n    \n    # MSE sur train\n    mse_train = None  # <- Complétez\n    \n    # MSE sur test\n    mse_test = None  # <- Complétez\n    \n    train_errors.append(mse_train)\n    test_errors.append(mse_test)","key":"X7ZDLqsSn2"},{"type":"outputs","id":"JktXhdc0_A0CCh0k4cpUu","children":[],"key":"pqaXTJ2sIV"}],"key":"s5i0OXUOLz"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Visualisation (exécutez après avoir complété le code ci-dessus)\nif None not in train_errors and None not in test_errors:\n    plt.figure(figsize=(10, 6))\n    plt.plot(degrees, train_errors, 'o-', linewidth=2, markersize=8, label='Erreur entraînement')\n    plt.plot(degrees, test_errors, 's-', linewidth=2, markersize=8, label='Erreur test')\n    plt.yscale('log')\n    plt.xlabel('Degré du polynôme (complexité)')\n    plt.ylabel('MSE (échelle log)')\n    plt.title('Compromis biais-variance')\n    plt.legend()\n    plt.grid(True, alpha=0.3)\n    plt.xticks(range(1, 16, 2))\n    plt.show()\n    \n    # Trouver le meilleur degré\n    best_deg = degrees[np.argmin(test_errors)]\n    print(f\"\\nMeilleur degre (selon erreur test): {best_deg}\")\n    print(f\"   MSE train: {train_errors[best_deg-1]:.1f}\")\n    print(f\"   MSE test: {test_errors[best_deg-1]:.1f}\")\nelse:\n    print(\"Completez le code de l'exercice 3!\")","key":"SSsDpzzKd5"},{"type":"outputs","id":"l225lcjFCP9_7m8bS1hcz","children":[{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"Completez le code de l'exercice 3!\n"},"key":"lEXgSKIsjc"}],"key":"P8HAPzFP1V"}],"key":"gow4kN5RrK"},{"type":"block","kind":"notebook-content","children":[{"type":"details","children":[{"type":"summary","children":[{"type":"text","value":"Cliquez pour voir la solution","key":"tgIEvbZwFq"}],"key":"VVFpJ87tZe"},{"type":"code","lang":"python","meta":null,"value":"# Prédictions sur train\npred_train = np.polyval(coeffs, speed_train)\n\n# Prédictions sur test\npred_test = np.polyval(coeffs, speed_test)\n\n# MSE sur train\nmse_train = np.mean((dist_train - pred_train)**2)\n\n# MSE sur test\nmse_test = np.mean((dist_test - pred_test)**2)","key":"hzmCOGbSlJ"}],"key":"kfL7jc8Bjb"}],"key":"VVH9GZS9dr"},{"type":"block","kind":"notebook-content","children":[{"type":"thematicBreak","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"I1Xd8SDbVr"},{"type":"heading","depth":2,"position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"Partie 4: Régularisation Ridge","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"AVV29m2w4J"}],"identifier":"partie-4-r-gularisation-ridge","label":"Partie 4: Régularisation Ridge","html_id":"partie-4-r-gularisation-ridge","implicit":true,"key":"EcrRhTyJcc"},{"type":"paragraph","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"Au lieu de choisir un degré bas, on peut utiliser un polynôme de ","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"x2D6bZgvje"},{"type":"strong","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"haut degré","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"Oejb16er6I"}],"key":"A3G3vlyagF"},{"type":"text","value":" avec ","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"v066baueyV"},{"type":"strong","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"régularisation","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"Q0YPj19SXu"}],"key":"F5bhrLskO0"},{"type":"text","value":".","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"BkTyY2fIAI"}],"key":"cB1Rcxsb1j"},{"type":"paragraph","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"La régularisation Ridge ajoute une pénalité sur les coefficients:","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"vM8QeZp6m7"}],"key":"AAuoMZMame"},{"type":"math","value":"\\hat{\\boldsymbol{\\theta}}_{\\text{Ridge}} = \\arg\\min_{\\boldsymbol{\\theta}} \\left[ \\sum_{i=1}^{N} (y_i - \\boldsymbol{\\theta}^\\top \\mathbf{x}_i)^2 + \\lambda \\|\\boldsymbol{\\theta}\\|^2 \\right]","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><msub><mover accent=\"true\"><mi mathvariant=\"bold-italic\">θ</mi><mo>^</mo></mover><mtext>Ridge</mtext></msub><mo>=</mo><mi>arg</mi><mo>⁡</mo><munder><mrow><mi>min</mi><mo>⁡</mo></mrow><mi mathvariant=\"bold-italic\">θ</mi></munder><mrow><mo fence=\"true\">[</mo><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></munderover><mo stretchy=\"false\">(</mo><msub><mi>y</mi><mi>i</mi></msub><mo>−</mo><msup><mi mathvariant=\"bold-italic\">θ</mi><mi mathvariant=\"normal\">⊤</mi></msup><msub><mi mathvariant=\"bold\">x</mi><mi>i</mi></msub><msup><mo stretchy=\"false\">)</mo><mn>2</mn></msup><mo>+</mo><mi>λ</mi><mi mathvariant=\"normal\">∥</mi><mi mathvariant=\"bold-italic\">θ</mi><msup><mi mathvariant=\"normal\">∥</mi><mn>2</mn></msup><mo fence=\"true\">]</mo></mrow></mrow><annotation encoding=\"application/x-tex\">\\hat{\\boldsymbol{\\theta}}_{\\text{Ridge}} = \\arg\\min_{\\boldsymbol{\\theta}} \\left[ \\sum_{i=1}^{N} (y_i - \\boldsymbol{\\theta}^\\top \\mathbf{x}_i)^2 + \\lambda \\|\\boldsymbol{\\theta}\\|^2 \\right]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.244em;vertical-align:-0.2861em;\"></span><span class=\"mord\"><span class=\"mord accent\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.9579em;\"><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord boldsymbol\" style=\"margin-right:0.03194em;\">θ</span></span></span></span><span style=\"top:-3.2634em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"accent-body\" style=\"left:-0.25em;\"><span class=\"mord\">^</span></span></span></span></span></span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord text mtight\"><span class=\"mord mtight\">Ridge</span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:3.106em;vertical-align:-1.2777em;\"></span><span class=\"mop\">ar<span style=\"margin-right:0.01389em;\">g</span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mop op-limits\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6679em;\"><span style=\"top:-2.3479em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord boldsymbol mtight\" style=\"margin-right:0.03194em;\">θ</span></span></span></span></span></span><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span><span class=\"mop\">min</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7521em;\"><span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"minner\"><span class=\"mopen delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size4\">[</span></span><span class=\"mop op-limits\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.8283em;\"><span style=\"top:-1.8723em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mrel mtight\">=</span><span class=\"mord mtight\">1</span></span></span></span><span style=\"top:-3.05em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span><span class=\"mop op-symbol large-op\">∑</span></span></span><span style=\"top:-4.3em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.10903em;\">N</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.2777em;\"><span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord\"><span class=\"mord boldsymbol\" style=\"margin-right:0.03194em;\">θ</span></span></span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.9334em;\"><span style=\"top:-3.1473em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">⊤</span></span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord mathbf\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\"><span class=\"mclose\">)</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8641em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord mathnormal\">λ</span><span class=\"mord\">∥</span><span class=\"mord\"><span class=\"mord\"><span class=\"mord boldsymbol\" style=\"margin-right:0.03194em;\">θ</span></span></span><span class=\"mord\"><span class=\"mord\">∥</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8641em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mclose delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size4\">]</span></span></span></span></span></span></span>","enumerator":"2","key":"wYpVNIOmEK"},{"type":"paragraph","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"text","value":"La solution en forme fermée est:","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"pLPmIOIpSD"}],"key":"G7LBi7y95Z"},{"type":"math","value":"\\hat{\\boldsymbol{\\theta}}_{\\text{Ridge}} = (\\mathbf{X}^\\top \\mathbf{X} + \\lambda \\mathbf{I})^{-1} \\mathbf{X}^\\top \\mathbf{y}","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><msub><mover accent=\"true\"><mi mathvariant=\"bold-italic\">θ</mi><mo>^</mo></mover><mtext>Ridge</mtext></msub><mo>=</mo><mo stretchy=\"false\">(</mo><msup><mi mathvariant=\"bold\">X</mi><mi mathvariant=\"normal\">⊤</mi></msup><mi mathvariant=\"bold\">X</mi><mo>+</mo><mi>λ</mi><mi mathvariant=\"bold\">I</mi><msup><mo stretchy=\"false\">)</mo><mrow><mo>−</mo><mn>1</mn></mrow></msup><msup><mi mathvariant=\"bold\">X</mi><mi mathvariant=\"normal\">⊤</mi></msup><mi mathvariant=\"bold\">y</mi></mrow><annotation encoding=\"application/x-tex\">\\hat{\\boldsymbol{\\theta}}_{\\text{Ridge}} = (\\mathbf{X}^\\top \\mathbf{X} + \\lambda \\mathbf{I})^{-1} \\mathbf{X}^\\top \\mathbf{y}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.244em;vertical-align:-0.2861em;\"></span><span class=\"mord\"><span class=\"mord accent\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.9579em;\"><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord boldsymbol\" style=\"margin-right:0.03194em;\">θ</span></span></span></span><span style=\"top:-3.2634em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"accent-body\" style=\"left:-0.25em;\"><span class=\"mord\">^</span></span></span></span></span></span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord text mtight\"><span class=\"mord mtight\">Ridge</span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.1491em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathbf\">X</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8991em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">⊤</span></span></span></span></span></span></span></span><span class=\"mord mathbf\">X</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.1491em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">λ</span><span class=\"mord mathbf\">I</span><span class=\"mclose\"><span class=\"mclose\">)</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8641em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">−</span><span class=\"mord mtight\">1</span></span></span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord mathbf\">X</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8991em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">⊤</span></span></span></span></span></span></span></span><span class=\"mord mathbf\" style=\"margin-right:0.01597em;\">y</span></span></span></span></span>","enumerator":"3","key":"FLdt4Diuld"}],"key":"AntRwQl8X5"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Exercice 4: Implementer Ridge Regression","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"f0CaZKTHpA"}],"identifier":"exercice-4-implementer-ridge-regression","label":"Exercice 4: Implementer Ridge Regression","html_id":"exercice-4-implementer-ridge-regression","implicit":true,"key":"YFkdYyBpHh"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"strong","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Completez la fonction ci-dessous:","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"gYGHxJ3f5X"}],"key":"SHv4XZ4pEk"}],"key":"shMRgi0vRX"}],"key":"jquA5Bk1UI"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"def polynomial_features(x, degree):\n    \"\"\"\n    Crée la matrice de caractéristiques polynomiales.\n    \n    Args:\n        x: vecteur d'entrées (n,)\n        degree: degré du polynôme\n    \n    Returns:\n        X: matrice (n, degree+1) avec colonnes [1, x, x², ..., x^degree]\n    \"\"\"\n    n = len(x)\n    X = np.zeros((n, degree + 1))\n    for d in range(degree + 1):\n        X[:, d] = x ** d\n    return X\n\n\ndef ridge_regression(X, y, lambda_reg):\n    \"\"\"\n    Calcule les coefficients Ridge.\n    \n    Args:\n        X: matrice de features (n, d)\n        y: vecteur cible (n,)\n        lambda_reg: coefficient de régularisation\n    \n    Returns:\n        theta: coefficients (d,)\n    \"\"\"\n    # ============================================\n    # TODO: Implémentez la formule Ridge\n    # theta = (X'X + lambda*I)^(-1) X'y\n    # \n    # Indices:\n    # - X.T pour la transposée\n    # - @ pour le produit matriciel\n    # - np.eye(n) pour la matrice identité n×n\n    # - np.linalg.inv() pour l'inverse\n    # ============================================\n    \n    d = X.shape[1]  # nombre de features\n    \n    theta = None  # <- Remplacez par votre code\n    \n    return theta","key":"yd8ndfN22r"},{"type":"outputs","id":"JieTwYwZLm7V2_AFHZcDz","children":[],"key":"XeRdqWZfLz"}],"key":"csA27OdpB8"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Test de votre implémentation\ndegree = 10\nlambda_reg = 1.0\n\nX_train = polynomial_features(speed_train, degree)\ntheta = ridge_regression(X_train, dist_train, lambda_reg)\n\nif theta is not None:\n    print(f\"Coefficients Ridge (degré={degree}, λ={lambda_reg}):\")\n    print(f\"  Norme des coefficients: {np.linalg.norm(theta):.2f}\")\n    \n    # Prédictions\n    X_test = polynomial_features(speed_test, degree)\n    pred_test = X_test @ theta\n    mse = np.mean((dist_test - pred_test)**2)\n    print(f\"  MSE test: {mse:.1f}\")\n    print(\"\\nImplementation correcte!\")\nelse:\n    print(\"Completez la fonction ridge_regression!\")","key":"vXdNCspwXl"},{"type":"outputs","id":"YqXn-uyEAq9XqdkNV5uWo","children":[{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"Completez la fonction ridge_regression!\n"},"key":"QR1fQIhrBQ"}],"key":"QRyyOz8ho0"}],"key":"PEKASVnxo3"},{"type":"block","kind":"notebook-content","children":[{"type":"details","children":[{"type":"summary","children":[{"type":"text","value":"Cliquez pour voir la solution","key":"IWMDHfaIMK"}],"key":"xS3h1KCP1z"},{"type":"code","lang":"python","meta":null,"value":"def ridge_regression(X, y, lambda_reg):\n    d = X.shape[1]\n    I = np.eye(d)\n    theta = np.linalg.inv(X.T @ X + lambda_reg * I) @ X.T @ y\n    return theta","key":"mVATdNkMnx"}],"key":"tQluvOYzJ1"}],"key":"Kz0s9AyIsI"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Exercice 5: Trouver le meilleur lambda","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"bNMLjpNTSC"}],"identifier":"exercice-5-trouver-le-meilleur-lambda","label":"Exercice 5: Trouver le meilleur lambda","html_id":"exercice-5-trouver-le-meilleur-lambda","implicit":true,"key":"RWHUCZmQeF"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"strong","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Explorez différentes valeurs de λ pour un polynôme de degré 10:","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"gmo0og0aV6"}],"key":"cAy7NIBqwe"}],"key":"zc2ywRJ05P"}],"key":"N7N2iwLRor"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"degree = 10\nX_train = polynomial_features(speed_train, degree)\nX_test = polynomial_features(speed_test, degree)\n\nlambdas = [0, 0.001, 0.01, 0.1, 1, 10, 100, 1000]\nresults = []\n\nprint(f\"{'λ':>10} | {'MSE Train':>10} | {'MSE Test':>10} | {'||θ||':>10}\")\nprint(\"-\" * 50)\n\nfor lam in lambdas:\n    theta = ridge_regression(X_train, dist_train, lam)\n    if theta is not None:\n        mse_train = np.mean((dist_train - X_train @ theta)**2)\n        mse_test = np.mean((dist_test - X_test @ theta)**2)\n        norm_theta = np.linalg.norm(theta)\n        results.append((lam, mse_train, mse_test, norm_theta))\n        print(f\"{lam:>10.3f} | {mse_train:>10.1f} | {mse_test:>10.1f} | {norm_theta:>10.1f}\")","key":"EJ0B2Z6RPo"},{"type":"outputs","id":"cmfvWp98LOozATCdxNb2Z","children":[{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"         λ |  MSE Train |   MSE Test |      ||θ||\n--------------------------------------------------\n"},"key":"DUOivnpk53"}],"key":"QXCbv8h3Cq"}],"key":"D7NX55yzmz"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Visualisation de l'effet de λ\nif len(results) > 0:\n    lambdas_plot = [r[0] for r in results]\n    train_plot = [r[1] for r in results]\n    test_plot = [r[2] for r in results]\n    \n    plt.figure(figsize=(10, 5))\n    plt.semilogx([max(l, 1e-4) for l in lambdas_plot], train_plot, 'o-', label='Train')\n    plt.semilogx([max(l, 1e-4) for l in lambdas_plot], test_plot, 's-', label='Test')\n    plt.xlabel('λ (échelle log)')\n    plt.ylabel('MSE')\n    plt.title(f'Effet de la régularisation Ridge (degré={degree})')\n    plt.legend()\n    plt.grid(True, alpha=0.3)\n    plt.show()","key":"ooLPOBALn0"},{"type":"outputs","id":"6fNzjdR5O9wM9XquGvu-s","children":[],"key":"MRuapvsma0"}],"key":"cBSzU3k9SI"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Questions:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"qJuW18RmJd"}],"key":"BnNFLgnKCO"}],"key":"R6IgjLJ9pu"},{"type":"list","ordered":true,"start":1,"spread":false,"position":{"start":{"line":2,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Quelle valeur de λ minimise l’erreur test?","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"P8ZP1By37W"}],"key":"MKYvlW7qs8"}],"key":"eLh2oW5FsW"},{"type":"listItem","spread":true,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Que se passe-t-il quand λ → 0? Et quand λ → ∞?","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"ZR7P1qlXJx"}],"key":"UjgV4CUyli"}],"key":"Jo9vXvUny8"},{"type":"listItem","spread":true,"position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Comment la norme des coefficients ||θ|| change avec λ?","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"sW0pTVmsFc"}],"key":"UIiKavgKXn"}],"key":"hmFUQVQHEj"}],"key":"OGfszmb7RP"}],"key":"wtV1G8pBkR"},{"type":"block","kind":"notebook-content","children":[{"type":"thematicBreak","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"i2THJgCzW0"},{"type":"heading","depth":2,"position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"Partie 5: SVD et la solution MCO","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"cNFzunR656"}],"identifier":"partie-5-svd-et-la-solution-mco","label":"Partie 5: SVD et la solution MCO","html_id":"partie-5-svd-et-la-solution-mco","implicit":true,"key":"P8AmwyyWd6"},{"type":"paragraph","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"La ","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"OAGxWXNvNp"},{"type":"strong","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"decomposition en valeurs singulieres","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"zjLzthVL2Y"}],"key":"PUCWrG6GZc"},{"type":"text","value":" (SVD) offre une autre facon de comprendre les solutions MCO et Ridge. Cette section explore visuellement pourquoi Ridge fonctionne.","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"XuS5VNTfoX"}],"key":"Lgp4mRJpsS"},{"type":"heading","depth":3,"position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"Qu’est-ce que la SVD?","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"uI5S0fSpBe"}],"identifier":"quest-ce-que-la-svd","label":"Qu’est-ce que la SVD?","html_id":"quest-ce-que-la-svd","implicit":true,"key":"P08TjBHpqW"},{"type":"paragraph","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"Toute matrice ","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"szBbC6NYlC"},{"type":"inlineMath","value":"\\mathbf{X}","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">X</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{X}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">X</span></span></span></span>","key":"r8kybqXC9S"},{"type":"text","value":" peut s’ecrire:","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"vFOPRQOSuZ"}],"key":"Vc4SanUQuO"},{"type":"math","value":"\\mathbf{X} = \\mathbf{U} \\mathbf{D} \\mathbf{V}^\\top","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi mathvariant=\"bold\">X</mi><mo>=</mo><mi mathvariant=\"bold\">U</mi><mi mathvariant=\"bold\">D</mi><msup><mi mathvariant=\"bold\">V</mi><mi mathvariant=\"normal\">⊤</mi></msup></mrow><annotation encoding=\"application/x-tex\">\\mathbf{X} = \\mathbf{U} \\mathbf{D} \\mathbf{V}^\\top</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">X</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8991em;\"></span><span class=\"mord mathbf\">UD</span><span class=\"mord\"><span class=\"mord mathbf\" style=\"margin-right:0.01597em;\">V</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8991em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">⊤</span></span></span></span></span></span></span></span></span></span></span></span>","enumerator":"4","key":"jreVgSx5xK"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":12,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"paragraph","children":[{"type":"inlineMath","value":"\\mathbf{V}","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">V</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{V}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\" style=\"margin-right:0.01597em;\">V</span></span></span></span>","key":"KpPRLQr0uI"},{"type":"text","value":": directions principales dans l’espace des features","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"qZkDbtx516"}],"key":"kRnFMWNFEV"}],"key":"ceAbwzzchM"},{"type":"listItem","spread":true,"position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"paragraph","children":[{"type":"inlineMath","value":"\\mathbf{D}","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">D</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{D}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">D</span></span></span></span>","key":"cUXrBSJWf9"},{"type":"text","value":": valeurs singulieres ","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"wTlgnOUtT3"},{"type":"inlineMath","value":"d_1 \\geq d_2 \\geq \\cdots \\geq d_p","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>d</mi><mn>1</mn></msub><mo>≥</mo><msub><mi>d</mi><mn>2</mn></msub><mo>≥</mo><mo>⋯</mo><mo>≥</mo><msub><mi>d</mi><mi>p</mi></msub></mrow><annotation encoding=\"application/x-tex\">d_1 \\geq d_2 \\geq \\cdots \\geq d_p</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8444em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">d</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">≥</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8444em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">d</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">≥</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7719em;vertical-align:-0.136em;\"></span><span class=\"minner\">⋯</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">≥</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.9805em;vertical-align:-0.2861em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">d</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">p</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span></span></span></span>","key":"Ou0DH04oar"},{"type":"text","value":" (amplitudes)","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"UTkkMXD5hL"}],"key":"RFmZqCKQFY"}],"key":"jzN6dVSLFs"},{"type":"listItem","spread":true,"position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"paragraph","children":[{"type":"inlineMath","value":"\\mathbf{U}","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">U</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{U}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">U</span></span></span></span>","key":"rlnP4Ais7f"},{"type":"text","value":": directions correspondantes dans l’espace des observations","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"t96zZSnjQk"}],"key":"pAptJmYFVH"}],"key":"hVgeHa9aNd"}],"key":"SQaE8y3vRk"}],"key":"Xf8gtPA21w"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Creons des donnees 2D pour visualiser la SVD\nnp.random.seed(123)\nn = 50\n\n# Donnees avec correlation (une direction forte, une faible)\nX_2d = np.random.randn(n, 2)\n# Ajouter de la correlation\nX_2d[:, 1] = 0.9 * X_2d[:, 0] + 0.3 * X_2d[:, 1]\n\n# SVD\nU, s, Vt = np.linalg.svd(X_2d, full_matrices=False)\nV = Vt.T\n\nprint(\"Valeurs singulieres:\")\nprint(f\"  d1 = {s[0]:.2f} (direction forte)\")\nprint(f\"  d2 = {s[1]:.2f} (direction faible)\")\nprint(f\"  Ratio d1/d2 = {s[0]/s[1]:.1f}\")","key":"XLmwfueq0n"},{"type":"outputs","id":"16aEWv3R1sKe6FKFdYiXc","children":[{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"Valeurs singulieres:\n  d1 = 11.22 (direction forte)\n  d2 = 1.68 (direction faible)\n  Ratio d1/d2 = 6.7\n"},"key":"Dwm4S0GKEm"}],"key":"wo3GSoYYso"}],"key":"gWhWfvDB0W"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Visualiser les directions principales\nfig, axes = plt.subplots(1, 2, figsize=(12, 5))\n\n# Gauche: donnees et directions principales\nax = axes[0]\nax.scatter(X_2d[:, 0], X_2d[:, 1], alpha=0.5, s=30)\n\n# Tracer les directions principales (vecteurs propres de X'X)\norigin = np.mean(X_2d, axis=0)\nfor i, (sv, color, label) in enumerate(zip(s, ['C0', 'C1'], ['v1 (forte)', 'v2 (faible)'])):\n    direction = V[:, i] * sv / 5  # Echelle pour visualisation\n    ax.annotate('', xy=origin + direction, xytext=origin,\n                arrowprops=dict(arrowstyle='->', color=color, lw=3))\n    ax.annotate(f'{label}\\nd={sv:.1f}', xy=origin + direction * 1.2, fontsize=10, color=color)\n\nax.set_xlabel('$x_1$')\nax.set_ylabel('$x_2$')\nax.set_title('Donnees et directions principales (SVD)')\nax.set_aspect('equal')\nax.grid(True, alpha=0.3)\n\n# Droite: valeurs singulieres\nax = axes[1]\nax.bar([1, 2], s, color=['C0', 'C1'], alpha=0.7)\nax.set_xticks([1, 2])\nax.set_xticklabels(['$d_1$', '$d_2$'])\nax.set_ylabel('Valeur singuliere')\nax.set_title('Spectre des valeurs singulieres')\nax.grid(True, alpha=0.3, axis='y')\n\nplt.tight_layout()\nplt.show()","key":"zAycrCZdt6"},{"type":"outputs","id":"ZzQEbKzIdPgzq_vLPF2zU","children":[{"type":"output","children":[],"jupyter_data":{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"<Figure size 1200x500 with 2 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"eb9d801d7ae67f989a0fc2f808c6db1a","path":"/mlbook/build/eb9d801d7ae67f989a0fc2f808c6db1a.png"}}},"key":"s4pHAZw1cr"}],"key":"aim4KHyuh3"}],"key":"gx69TGGN6J"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Facteurs de retrecissement Ridge","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"lLReC43rTc"}],"identifier":"facteurs-de-retrecissement-ridge","label":"Facteurs de retrecissement Ridge","html_id":"facteurs-de-retrecissement-ridge","implicit":true,"key":"rIElhuLnZ6"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"La solution Ridge s’ecrit:","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"OtFL9FySWB"}],"key":"RfIRHBHGYN"},{"type":"math","value":"\\hat{\\boldsymbol{\\theta}}_{\\text{ridge}} = \\sum_{j=1}^d \\underbrace{\\frac{d_j^2}{d_j^2 + \\lambda}}_{\\text{retrecissement}} \\cdot \\frac{\\mathbf{u}_j^\\top \\mathbf{y}}{d_j} \\cdot \\mathbf{v}_j","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><msub><mover accent=\"true\"><mi mathvariant=\"bold-italic\">θ</mi><mo>^</mo></mover><mtext>ridge</mtext></msub><mo>=</mo><munderover><mo>∑</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mi>d</mi></munderover><munder><munder><mfrac><msubsup><mi>d</mi><mi>j</mi><mn>2</mn></msubsup><mrow><msubsup><mi>d</mi><mi>j</mi><mn>2</mn></msubsup><mo>+</mo><mi>λ</mi></mrow></mfrac><mo stretchy=\"true\">⏟</mo></munder><mtext>retrecissement</mtext></munder><mo>⋅</mo><mfrac><mrow><msubsup><mi mathvariant=\"bold\">u</mi><mi>j</mi><mi mathvariant=\"normal\">⊤</mi></msubsup><mi mathvariant=\"bold\">y</mi></mrow><msub><mi>d</mi><mi>j</mi></msub></mfrac><mo>⋅</mo><msub><mi mathvariant=\"bold\">v</mi><mi>j</mi></msub></mrow><annotation encoding=\"application/x-tex\">\\hat{\\boldsymbol{\\theta}}_{\\text{ridge}} = \\sum_{j=1}^d \\underbrace{\\frac{d_j^2}{d_j^2 + \\lambda}}_{\\text{retrecissement}} \\cdot \\frac{\\mathbf{u}_j^\\top \\mathbf{y}}{d_j} \\cdot \\mathbf{v}_j</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.244em;vertical-align:-0.2861em;\"></span><span class=\"mord\"><span class=\"mord accent\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.9579em;\"><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord boldsymbol\" style=\"margin-right:0.03194em;\">θ</span></span></span></span><span style=\"top:-3.2634em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"accent-body\" style=\"left:-0.25em;\"><span class=\"mord\">^</span></span></span></span></span></span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord text mtight\"><span class=\"mord mtight\">ridge</span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:4.2506em;vertical-align:-2.4145em;\"></span><span class=\"mop op-limits\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.8361em;\"><span style=\"top:-1.8723em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span><span class=\"mrel mtight\">=</span><span class=\"mord mtight\">1</span></span></span></span><span style=\"top:-3.05em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span><span class=\"mop op-symbol large-op\">∑</span></span></span><span style=\"top:-4.3em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">d</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.4138em;\"><span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord munder\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.5989em;\"><span style=\"top:-1.1844em;\"><span class=\"pstrut\" style=\"height:3.5989em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord text mtight\"><span class=\"mord mtight\">retrecissement</span></span></span></span></span><span style=\"top:-3.5989em;\"><span class=\"pstrut\" style=\"height:3.5989em;\"></span><span class=\"mord munder\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.5989em;\"><span class=\"svg-align\" style=\"top:-1.8519em;\"><span class=\"pstrut\" style=\"height:3.5989em;\"></span><span class=\"stretchy\" style=\"height:0.548em;min-width:1.6em;\"><span class=\"brace-left\" style=\"height:0.548em;\"><svg xmlns=\"http://www.w3.org/2000/svg\" width='400em' height='0.548em' viewBox='0 0 400000 548' preserveAspectRatio='xMinYMin slice'><path d='M0 6l6-6h17c12.688 0 19.313.3 20 1 4 4 7.313 8.3 10 13\n 35.313 51.3 80.813 93.8 136.5 127.5 55.688 33.7 117.188 55.8 184.5 66.5.688\n 0 2 .3 4 1 18.688 2.7 76 4.3 172 5h399450v120H429l-6-1c-124.688-8-235-61.7\n-331-161C60.687 138.7 32.312 99.3 7 54L0 41V6z'/></svg></span><span class=\"brace-center\" style=\"height:0.548em;\"><svg xmlns=\"http://www.w3.org/2000/svg\" width='400em' height='0.548em' viewBox='0 0 400000 548' preserveAspectRatio='xMidYMin slice'><path d='M199572 214\nc100.7 8.3 195.3 44 280 108 55.3 42 101.7 93 139 153l9 14c2.7-4 5.7-8.7 9-14\n 53.3-86.7 123.7-153 211-199 66.7-36 137.3-56.3 212-62h199568v120H200432c-178.3\n 11.7-311.7 78.3-403 201-6 8-9.7 12-11 12-.7.7-6.7 1-18 1s-17.3-.3-18-1c-1.3 0\n-5-4-11-12-44.7-59.3-101.3-106.3-170-141s-145.3-54.3-229-60H0V214z'/></svg></span><span class=\"brace-right\" style=\"height:0.548em;\"><svg xmlns=\"http://www.w3.org/2000/svg\" width='400em' height='0.548em' viewBox='0 0 400000 548' preserveAspectRatio='xMaxYMin slice'><path d='M399994 0l6 6v35l-6 11c-56 104-135.3 181.3-238 232-57.3\n 28.7-117 45-179 50H-300V214h399897c43.3-7 81-15 113-26 100.7-33 179.7-91 237\n-174 2.7-5 6-9 10-13 .7-1 7.3-1 20-1h17z'/></svg></span></span></span><span style=\"top:-3.5989em;\"><span class=\"pstrut\" style=\"height:3.5989em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.5989em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\">d</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7959em;\"><span style=\"top:-2.4231em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span><span style=\"top:-3.0448em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.413em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord mathnormal\">λ</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.7848em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\">d</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-2.4413em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3948em;\"><span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.099em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.747em;\"><span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.4145em;\"><span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">⋅</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.606em;vertical-align:-0.9721em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.6339em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\">d</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.7848em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathbf\">u</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8491em;\"><span style=\"top:-2.4413em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">⊤</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3948em;\"><span></span></span></span></span></span></span><span class=\"mord mathbf\" style=\"margin-right:0.01597em;\">y</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.9721em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">⋅</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7305em;vertical-align:-0.2861em;\"></span><span class=\"mord\"><span class=\"mord mathbf\" style=\"margin-right:0.01597em;\">v</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.016em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span></span></span></span></span>","enumerator":"5","key":"s9XM4hRGVk"},{"type":"paragraph","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"Le facteur ","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"HJQJ3DP1K3"},{"type":"inlineMath","value":"\\frac{d_j^2}{d_j^2 + \\lambda}","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mfrac><msubsup><mi>d</mi><mi>j</mi><mn>2</mn></msubsup><mrow><msubsup><mi>d</mi><mi>j</mi><mn>2</mn></msubsup><mo>+</mo><mi>λ</mi></mrow></mfrac></mrow><annotation encoding=\"application/x-tex\">\\frac{d_j^2}{d_j^2 + \\lambda}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.9277em;vertical-align:-0.6964em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.2313em;\"><span style=\"top:-2.6264em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">d</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8051em;\"><span style=\"top:-2.1777em;margin-left:0em;margin-right:0.0714em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span><span style=\"top:-2.8448em;margin-right:0.0714em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.4612em;\"><span></span></span></span></span></span></span><span class=\"mbin mtight\">+</span><span class=\"mord mathnormal mtight\">λ</span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.6074em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">d</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8913em;\"><span style=\"top:-2.214em;margin-left:0em;margin-right:0.0714em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span><span style=\"top:-2.931em;margin-right:0.0714em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.4249em;\"><span></span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6964em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span>","key":"npQg1ErHlK"},{"type":"text","value":" est toujours < 1, et il est ","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"rMMGgbD5Re"},{"type":"strong","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"plus petit pour les directions faibles","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"VfW7Znx4wH"}],"key":"aQHdO27xks"},{"type":"text","value":" (petit ","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"SrRtvX5vRe"},{"type":"inlineMath","value":"d_j","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>d</mi><mi>j</mi></msub></mrow><annotation encoding=\"application/x-tex\">d_j</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.9805em;vertical-align:-0.2861em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">d</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span></span></span></span>","key":"VMgeGLyI71"},{"type":"text","value":").","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"nHkB9sm7Iq"}],"key":"YkTPfBcj9l"}],"key":"xa5kFiVVkD"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Visualiser les facteurs de retrecissement\nlambdas = [0.01, 0.1, 1, 10]\nd_values = np.array([s[0], s[1]])  # Nos deux valeurs singulieres\n\nfig, ax = plt.subplots(figsize=(10, 5))\n\nx_pos = np.arange(len(d_values))\nwidth = 0.2\n\nfor i, lam in enumerate(lambdas):\n    shrinkage = d_values**2 / (d_values**2 + lam)\n    bars = ax.bar(x_pos + i * width, shrinkage, width, label=f'$\\\\lambda$ = {lam}', alpha=0.8)\n\nax.set_xticks(x_pos + width * 1.5)\nax.set_xticklabels([f'$d_1$ = {s[0]:.1f}\\n(forte)', f'$d_2$ = {s[1]:.1f}\\n(faible)'])\nax.set_ylabel('Facteur de retrecissement $d_j^2 / (d_j^2 + \\\\lambda)$')\nax.set_title('Ridge retrecit plus les directions faibles')\nax.legend()\nax.set_ylim(0, 1.1)\nax.axhline(1, color='gray', linestyle='--', alpha=0.5, label='MCO (pas de retrecissement)')\nax.grid(True, alpha=0.3, axis='y')\n\nplt.tight_layout()\nplt.show()\n\nprint(\"\\nObservation: La direction faible (d2) est beaucoup plus retrecit que la direction forte (d1).\")\nprint(\"C'est exactement ce qu'on veut: reduire l'incertitude la ou elle est grande.\")","key":"WQ936ugSye"},{"type":"outputs","id":"TyNtpogMo4fUdqRRhnP5I","children":[{"type":"output","children":[],"jupyter_data":{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"<Figure size 1000x500 with 1 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"d78535e476c18adfd7d74d290e5ce8ec","path":"/mlbook/build/d78535e476c18adfd7d74d290e5ce8ec.png"}}},"key":"Nv7w55igRU"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"\nObservation: La direction faible (d2) est beaucoup plus retrecit que la direction forte (d1).\nC'est exactement ce qu'on veut: reduire l'incertitude la ou elle est grande.\n"},"key":"wVwSCyhuwl"}],"key":"pdTwHHcNRQ"}],"key":"MA5PG4jGj0"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Question","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ZIlrazK9OW"}],"key":"i4vnrBljGT"},{"type":"text","value":": Pourquoi diviser par une petite valeur singuliere ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"DK5EBY7yhz"},{"type":"inlineMath","value":"d_j","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>d</mi><mi>j</mi></msub></mrow><annotation encoding=\"application/x-tex\">d_j</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.9805em;vertical-align:-0.2861em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">d</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span></span></span></span>","key":"WSBjOHqpOd"},{"type":"text","value":" amplifie-t-il le bruit dans MCO?","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"PIe1iTOBnb"}],"key":"Nusr4Yx8Nv"}],"key":"Fh1kdmai9b"},{"type":"block","kind":"notebook-content","children":[{"type":"thematicBreak","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Zhcr4UardB"},{"type":"heading","depth":2,"position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"Partie 6: ERM comme integration de Monte Carlo","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"bDI8MK45Bz"}],"identifier":"partie-6-erm-comme-integration-de-monte-carlo","label":"Partie 6: ERM comme integration de Monte Carlo","html_id":"partie-6-erm-comme-integration-de-monte-carlo","implicit":true,"key":"gqfjKOeg5e"},{"type":"paragraph","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"Le ","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"Ls0yHu7zaI"},{"type":"strong","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"risque","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"Q52I9Zze3g"}],"key":"jqXmKsI0Rh"},{"type":"text","value":" mesure la performance moyenne sur toutes les donnees possibles:","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"ORZHX2cnB6"}],"key":"CQ6Q4fdtos"},{"type":"math","value":"\\mathcal{R}(f) = \\mathbb{E}_{(\\mathbf{X},Y) \\sim p}[\\ell(Y, f(\\mathbf{X}))] = \\int \\ell(y, f(\\mathbf{x})) \\, p(\\mathbf{x}, y) \\, d\\mathbf{x} \\, dy","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi mathvariant=\"script\">R</mi><mo stretchy=\"false\">(</mo><mi>f</mi><mo stretchy=\"false\">)</mo><mo>=</mo><msub><mi mathvariant=\"double-struck\">E</mi><mrow><mo stretchy=\"false\">(</mo><mi mathvariant=\"bold\">X</mi><mo separator=\"true\">,</mo><mi>Y</mi><mo stretchy=\"false\">)</mo><mo>∼</mo><mi>p</mi></mrow></msub><mo stretchy=\"false\">[</mo><mi mathvariant=\"normal\">ℓ</mi><mo stretchy=\"false\">(</mo><mi>Y</mi><mo separator=\"true\">,</mo><mi>f</mi><mo stretchy=\"false\">(</mo><mi mathvariant=\"bold\">X</mi><mo stretchy=\"false\">)</mo><mo stretchy=\"false\">)</mo><mo stretchy=\"false\">]</mo><mo>=</mo><mo>∫</mo><mi mathvariant=\"normal\">ℓ</mi><mo stretchy=\"false\">(</mo><mi>y</mi><mo separator=\"true\">,</mo><mi>f</mi><mo stretchy=\"false\">(</mo><mi mathvariant=\"bold\">x</mi><mo stretchy=\"false\">)</mo><mo stretchy=\"false\">)</mo><mtext> </mtext><mi>p</mi><mo stretchy=\"false\">(</mo><mi mathvariant=\"bold\">x</mi><mo separator=\"true\">,</mo><mi>y</mi><mo stretchy=\"false\">)</mo><mtext> </mtext><mi>d</mi><mi mathvariant=\"bold\">x</mi><mtext> </mtext><mi>d</mi><mi>y</mi></mrow><annotation encoding=\"application/x-tex\">\\mathcal{R}(f) = \\mathbb{E}_{(\\mathbf{X},Y) \\sim p}[\\ell(Y, f(\\mathbf{X}))] = \\int \\ell(y, f(\\mathbf{x})) \\, p(\\mathbf{x}, y) \\, d\\mathbf{x} \\, dy</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathcal\">R</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.1052em;vertical-align:-0.3552em;\"></span><span class=\"mord\"><span class=\"mord mathbb\">E</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3448em;\"><span style=\"top:-2.5198em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mopen mtight\">(</span><span class=\"mord mathbf mtight\">X</span><span class=\"mpunct mtight\">,</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.22222em;\">Y</span><span class=\"mclose mtight\">)</span><span class=\"mrel mtight\">∼</span><span class=\"mord mathnormal mtight\">p</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3552em;\"><span></span></span></span></span></span></span><span class=\"mopen\">[</span><span class=\"mord\">ℓ</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.22222em;\">Y</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mopen\">(</span><span class=\"mord mathbf\">X</span><span class=\"mclose\">))]</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.2222em;vertical-align:-0.8622em;\"></span><span class=\"mop op-symbol large-op\" style=\"margin-right:0.44445em;position:relative;top:-0.0011em;\">∫</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">ℓ</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mopen\">(</span><span class=\"mord mathbf\">x</span><span class=\"mclose\">))</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">p</span><span class=\"mopen\">(</span><span class=\"mord mathbf\">x</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">d</span><span class=\"mord mathbf\">x</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">d</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span></span></span></span></span>","enumerator":"6","key":"u12iG2fNSN"},{"type":"paragraph","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"Probleme: cette integrale est ","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"kyBJG4vFps"},{"type":"strong","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"impossible a calculer","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"LILtjhpQbg"}],"key":"JMZmZ98GgL"},{"type":"text","value":" car:","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"z3cW5ygATw"}],"key":"vwg3hYx0TX"},{"type":"list","ordered":true,"start":1,"spread":false,"position":{"start":{"line":9,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"On ne connait pas ","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"jlF5DFisd0"},{"type":"inlineMath","value":"p(\\mathbf{x}, y)","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>p</mi><mo stretchy=\"false\">(</mo><mi mathvariant=\"bold\">x</mi><mo separator=\"true\">,</mo><mi>y</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">p(\\mathbf{x}, y)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">p</span><span class=\"mopen\">(</span><span class=\"mord mathbf\">x</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mclose\">)</span></span></span></span>","key":"MpmkP24mkA"}],"key":"je6wfREF0T"}],"key":"wTfS8B81iX"},{"type":"listItem","spread":true,"position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Meme si on la connaissait, l’integrale en haute dimension est intractable","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"LVbZZp4LTc"}],"key":"fo7YMdWtH1"}],"key":"CVLY8ZC2f8"}],"key":"astiQSaWcU"}],"key":"U9xkkWy4s2"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# La malediction de la dimensionnalite pour l'integration numerique\ndimensions = [1, 2, 3, 5, 10, 20, 50, 100]\npoints_per_dim = 10  # 10 points par dimension pour une grille\n\n# On trace log10 du nombre de points (evite les overflows)\nlog_grid_points = [d for d in dimensions]  # log10(10^d) = d\n\nfig, ax = plt.subplots(figsize=(10, 5))\n\ncolors = plt.cm.Reds(np.linspace(0.3, 0.9, len(dimensions)))\nbars = ax.bar(range(len(dimensions)), log_grid_points, color=colors)\n\nax.set_xticks(range(len(dimensions)))\nax.set_xticklabels([f'd={d}' for d in dimensions])\nax.set_xlabel('Dimension')\nax.set_ylabel('$\\\\log_{10}$(nombre de points)')\nax.set_title('Integration numerique: explosion combinatoire')\n\n# Annotations\nax.axhline(10, color='blue', linestyle='--', alpha=0.7)\nax.text(0.5, 11, '10 milliards ($10^{10}$, limite pratique)', color='blue', fontsize=10)\n\nax.axhline(80, color='red', linestyle='--', alpha=0.7)\nax.text(4, 82, 'Atomes dans l\\'univers (~$10^{80}$)', color='red', fontsize=10)\n\nplt.tight_layout()\nplt.show()\n\nprint(f\"\\nAvec seulement 10 points par dimension:\")\nprint(f\"  d=10: 10^10 = 10 milliards de points\")\nprint(f\"  d=100: 10^100 points (impossible!)\")","key":"oLeglrNOQU"},{"type":"outputs","id":"AqtKW76JjOkyOqnNi19mU","children":[{"type":"output","children":[],"jupyter_data":{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"<Figure size 1000x500 with 1 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"ba639440d3b24e970f4104ed8ce9c5a2","path":"/mlbook/build/ba639440d3b24e970f4104ed8ce9c5a2.png"}}},"key":"aIwdZYrqhe"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"\nAvec seulement 10 points par dimension:\n  d=10: 10^10 = 10 milliards de points\n  d=100: 10^100 points (impossible!)\n"},"key":"LABwM30EfR"}],"key":"YduSlocspW"}],"key":"KyvehhdBjY"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"La solution: Monte Carlo","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ddwU1msatd"}],"identifier":"la-solution-monte-carlo","label":"La solution: Monte Carlo","html_id":"la-solution-monte-carlo","implicit":true,"key":"QBD5F6k8ef"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Le ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"xG0TpzhyBn"},{"type":"strong","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"risque empirique","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"hG0qevocjf"}],"key":"STC46vr89K"},{"type":"text","value":" est une estimation Monte Carlo du vrai risque:","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"gpeenzVju4"}],"key":"uGSrWU1fI4"},{"type":"math","value":"\\hat{\\mathcal{R}}(f) = \\frac{1}{N} \\sum_{i=1}^{N} \\ell(y_i, f(\\mathbf{x}_i))","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mover accent=\"true\"><mi mathvariant=\"script\">R</mi><mo>^</mo></mover><mo stretchy=\"false\">(</mo><mi>f</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mfrac><mn>1</mn><mi>N</mi></mfrac><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></munderover><mi mathvariant=\"normal\">ℓ</mi><mo stretchy=\"false\">(</mo><msub><mi>y</mi><mi>i</mi></msub><mo separator=\"true\">,</mo><mi>f</mi><mo stretchy=\"false\">(</mo><msub><mi mathvariant=\"bold\">x</mi><mi>i</mi></msub><mo stretchy=\"false\">)</mo><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">\\hat{\\mathcal{R}}(f) = \\frac{1}{N} \\sum_{i=1}^{N} \\ell(y_i, f(\\mathbf{x}_i))</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.1968em;vertical-align:-0.25em;\"></span><span class=\"mord accent\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.9468em;\"><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord mathcal\">R</span></span><span style=\"top:-3.2523em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"accent-body\" style=\"left:-0.1667em;\"><span class=\"mord\">^</span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:3.106em;vertical-align:-1.2777em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3214em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mop op-limits\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.8283em;\"><span style=\"top:-1.8723em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mrel mtight\">=</span><span class=\"mord mtight\">1</span></span></span></span><span style=\"top:-3.05em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span><span class=\"mop op-symbol large-op\">∑</span></span></span><span style=\"top:-4.3em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.10903em;\">N</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.2777em;\"><span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">ℓ</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathbf\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">))</span></span></span></span></span>","enumerator":"7","key":"xokg1S6SYU"},{"type":"table","position":{"start":{"line":7,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"tableRow","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"tableCell","header":true,"position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"Methode","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"h8fIBJtwoZ"}],"key":"JxKgOu7kxJ"},{"type":"tableCell","header":true,"position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"Complexite","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"Ee96PM3kUW"}],"key":"gRfoorJf60"},{"type":"tableCell","header":true,"position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"Exigence","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"VFuNhf2DV6"}],"key":"FMVx2379hF"}],"key":"g0bSaeSA3b"},{"type":"tableRow","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"Quadrature","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"tOMQBkVsBV"}],"key":"cwWhF8dqkC"},{"type":"tableCell","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"inlineMath","value":"O(M^d)","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mo stretchy=\"false\">(</mo><msup><mi>M</mi><mi>d</mi></msup><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">O(M^d)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0991em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">M</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8491em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">d</span></span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span>","key":"aLiGtdg9B1"}],"key":"vLRqp5HmuJ"},{"type":"tableCell","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"Connaitre ","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"OKVE6zswlx"},{"type":"inlineMath","value":"p(\\mathbf{x},y)","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>p</mi><mo stretchy=\"false\">(</mo><mi mathvariant=\"bold\">x</mi><mo separator=\"true\">,</mo><mi>y</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">p(\\mathbf{x},y)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">p</span><span class=\"mopen\">(</span><span class=\"mord mathbf\">x</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mclose\">)</span></span></span></span>","key":"sOTkzCd2vY"}],"key":"cuLQMDQTDD"}],"key":"AJNnr4AAWM"},{"type":"tableRow","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"strong","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"text","value":"Monte Carlo","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"BGEAF5WIB6"}],"key":"mIDJ62URFr"}],"key":"qhhMy5hZVe"},{"type":"tableCell","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"inlineMath","value":"O(N)","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mo stretchy=\"false\">(</mo><mi>N</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">O(N)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"mclose\">)</span></span></span></span>","key":"O9Z5fRJZ3w"}],"key":"R81YBU1u5u"},{"type":"tableCell","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"text","value":"Avoir des echantillons","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"qe60f1Cz1u"}],"key":"kisaAFS1c9"}],"key":"HbuIHNfxqY"}],"key":"ciWG02PUZP"},{"type":"paragraph","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"text","value":"La complexite Monte Carlo est ","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"PuT3RitnfE"},{"type":"strong","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"text","value":"independante de la dimension","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"gDYd2IBvhU"}],"key":"KrxOK6HOqU"},{"type":"text","value":"!","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"rbQFkYgTaa"}],"key":"H9dQStLebU"}],"key":"C1vTPwNVuM"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Demonstration: Monte Carlo converge independamment de d\ndef true_integral_1d():\n    \"\"\"Integrale de x^2 sur [0,1] = 1/3\"\"\"\n    return 1/3\n\ndef monte_carlo_estimate(n_samples, dim=1):\n    \"\"\"Estime E[||x||^2/d] pour x uniforme sur [0,1]^d\"\"\"\n    # Pour x uniforme sur [0,1]^d, E[x_i^2] = 1/3 pour chaque composante\n    # Donc E[||x||^2/d] = 1/3\n    samples = np.random.uniform(0, 1, (n_samples, dim))\n    return np.mean(np.sum(samples**2, axis=1) / dim)\n\n# Comparer convergence pour differentes dimensions\nnp.random.seed(42)\nn_values = [10, 50, 100, 500, 1000, 5000]\ndims = [1, 10, 100]\n\nfig, ax = plt.subplots(figsize=(10, 5))\n\ntrue_value = 1/3\n\nfor dim in dims:\n    errors = []\n    for n in n_values:\n        estimates = [monte_carlo_estimate(n, dim) for _ in range(50)]  # 50 repetitions\n        errors.append(np.std(estimates))\n    ax.loglog(n_values, errors, 'o-', label=f'd = {dim}', markersize=8)\n\n# Ligne de reference: 1/sqrt(N)\nn_ref = np.array(n_values)\nax.loglog(n_ref, 0.5 / np.sqrt(n_ref), 'k--', alpha=0.5, label='$1/\\\\sqrt{N}$')\n\nax.set_xlabel('Nombre d\\'echantillons N')\nax.set_ylabel('Ecart-type de l\\'estimation')\nax.set_title('Convergence Monte Carlo: independante de la dimension!')\nax.legend()\nax.grid(True, alpha=0.3)\n\nplt.tight_layout()\nplt.show()\n\nprint(\"\\nObservation: Les trois courbes se superposent!\")\nprint(\"La precision Monte Carlo depend de N, pas de d.\")","key":"NMSKIZlTG2"},{"type":"outputs","id":"wZowDkIuzO62I9c3qrm42","children":[{"type":"output","children":[],"jupyter_data":{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"<Figure size 1000x500 with 1 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"aac517feb3a47506cd97eb7099f71f7c","path":"/mlbook/build/aac517feb3a47506cd97eb7099f71f7c.png"}}},"key":"q00yNDm4eO"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"\nObservation: Les trois courbes se superposent!\nLa precision Monte Carlo depend de N, pas de d.\n"},"key":"JhVqMdKqtn"}],"key":"F7e9qJ3zUz"}],"key":"cPjbawYUrw"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Question","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Ib5Empmqz9"}],"key":"MRrHJtUJB9"},{"type":"text","value":": Pourquoi la complexite Monte Carlo est-elle ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"XxWrGNHbMR"},{"type":"inlineMath","value":"O(N)","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mo stretchy=\"false\">(</mo><mi>N</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">O(N)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"mclose\">)</span></span></span></span>","key":"UWhSmyNQHI"},{"type":"text","value":" independamment de la dimension ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"pPkJvvofd5"},{"type":"inlineMath","value":"d","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>d</mi></mrow><annotation encoding=\"application/x-tex\">d</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\">d</span></span></span></span>","key":"FJuqcGrT57"},{"type":"text","value":"?","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"dy7uhbhqOL"}],"key":"G61OOozcXE"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"strong","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Reponse a reflechir","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"yJsw5bnZ06"}],"key":"jR2TyWeylX"},{"type":"text","value":": Parce que chaque echantillon ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"NMC2qOh58C"},{"type":"inlineMath","value":"(\\mathbf{x}_i, y_i)","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">(</mo><msub><mi mathvariant=\"bold\">x</mi><mi>i</mi></msub><mo separator=\"true\">,</mo><msub><mi>y</mi><mi>i</mi></msub><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">(\\mathbf{x}_i, y_i)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathbf\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span>","key":"xSucRbGsMG"},{"type":"text","value":" contribue une evaluation de la perte, peu importe la dimension de ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"ylXHP5DQgk"},{"type":"inlineMath","value":"\\mathbf{x}_i","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi mathvariant=\"bold\">x</mi><mi>i</mi></msub></mrow><annotation encoding=\"application/x-tex\">\\mathbf{x}_i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5944em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"nlLJNHW55q"},{"type":"text","value":". On ne discretise pas l’espace; on utilise les echantillons tels quels.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"XVEqTolFRG"}],"key":"XbcM755fyZ"}],"key":"kJGDh7RICo"},{"type":"block","kind":"notebook-content","children":[{"type":"thematicBreak","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"wlPUlBE2l6"},{"type":"heading","depth":2,"position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"Recapitulatif","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"CNggB4STtw"}],"identifier":"recapitulatif","label":"Recapitulatif","html_id":"recapitulatif","implicit":true,"key":"JO0oHIe15y"},{"type":"paragraph","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"Dans ce TP, vous avez appris:","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"AlrnzxzGC7"}],"key":"exVFpG2WSv"},{"type":"list","ordered":true,"start":1,"spread":false,"position":{"start":{"line":6,"column":1},"end":{"line":22,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":6,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"strong","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"MSE","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"OjMjaZyHkd"}],"key":"ZKuwqdAAqW"},{"type":"text","value":": L’erreur quadratique moyenne mesure la qualite des predictions","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"D83qDAax7v"}],"key":"q8xRBBcQgM"}],"key":"xMl6QGAezF"},{"type":"listItem","spread":true,"position":{"start":{"line":8,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"strong","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"Surapprentissage","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"X8WkOEZsPj"}],"key":"JwCgkCDWdJ"},{"type":"text","value":": Un modele trop complexe memorise le bruit","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"ymf6KRXmry"}],"key":"xo7WmuYQZw"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":9,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":9,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Erreur train diminue mais erreur test augmente","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"MiDX1hqMb2"}],"key":"aECQ35ETuB"}],"key":"ND1fjmBvyZ"}],"key":"ZZ4HihZWRG"}],"key":"aBNZfjwQNi"},{"type":"listItem","spread":true,"position":{"start":{"line":11,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"strong","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"Compromis biais-variance","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"NFqPQjgqZd"}],"key":"B8NFcytewA"},{"type":"text","value":":","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"BuXTmTk24B"}],"key":"iACwPoOY2W"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":12,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Modele simple = biais eleve (sous-apprentissage)","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"gRxHwbQ4Sf"}],"key":"arXIkgTNng"}],"key":"XU0EjB5ZUU"},{"type":"listItem","spread":true,"position":{"start":{"line":13,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Modele complexe = variance elevee (surapprentissage)","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"taBIByiltq"}],"key":"CZfTeC32nK"}],"key":"eYER1Randg"}],"key":"af0tRJDBRH"}],"key":"ORGrtf7lAP"},{"type":"listItem","spread":true,"position":{"start":{"line":15,"column":1},"end":{"line":18,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"strong","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"text","value":"Regularisation Ridge","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"KVUBZ0VMdT"}],"key":"pTrHfjsBej"},{"type":"text","value":": Penalise les grands coefficients","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"e3fOik36Ti"}],"key":"TylqgM37QI"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":16,"column":1},"end":{"line":18,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Permet d’utiliser des modeles complexes sans surapprentissage","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"h9bjEMLLFt"}],"key":"rxV96S7BIG"}],"key":"Rd1m4niPzN"},{"type":"listItem","spread":true,"position":{"start":{"line":17,"column":1},"end":{"line":18,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Lambda controle la force de la regularisation","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"Dg18Nv8gM9"}],"key":"GTDr92JTqi"}],"key":"RfQX5G6qbf"}],"key":"Mzbp2f0h0y"}],"key":"fsdUiBBgqf"},{"type":"listItem","spread":true,"position":{"start":{"line":19,"column":1},"end":{"line":20,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"children":[{"type":"strong","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"children":[{"type":"text","value":"SVD et Ridge","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"slPY7Msmq9"}],"key":"UJYfRkfjkz"},{"type":"text","value":": Ridge retrecit plus les directions faibles (petites valeurs singulieres)","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"YnNXSGJX3R"}],"key":"T7yuDQfRPu"}],"key":"C5wDozFoZB"},{"type":"listItem","spread":true,"position":{"start":{"line":21,"column":1},"end":{"line":22,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"children":[{"type":"strong","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"children":[{"type":"text","value":"ERM = Monte Carlo","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"key":"QNARBLEPjE"}],"key":"ZO0myySfES"},{"type":"text","value":": Le risque empirique est une estimation Monte Carlo du vrai risque, avec complexite independante de la dimension","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"key":"S9bK2UjDg4"}],"key":"AOQqpuISD3"}],"key":"xyudYV3Vkl"}],"key":"ydkddNjGhq"},{"type":"thematicBreak","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"key":"VHTRwlVCvN"},{"type":"paragraph","position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"children":[{"type":"strong","position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"children":[{"type":"text","value":"Pour aller plus loin","position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"key":"pXPc7Y1wkb"}],"key":"TwiZgBinkG"},{"type":"text","value":": ","position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"key":"U7UNKrxuIf"},{"type":"link","url":"https://pierrelux.github.io/mlbook/learning-problem","position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"children":[{"type":"text","value":"Chapitre complet sur le site du cours","position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"key":"LkKfLb9S2d"}],"urlSource":"https://pierrelux.github.io/mlbook/learning-problem","key":"lWbRngfU69"}],"key":"IYjQ01X90F"}],"key":"Ne9FOiPXev"}],"key":"sjNfG6NfWs"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"TP0: Les k plus proches voisins","url":"/tp0-knn","group":"Travaux Pratiques"}}},"domain":"http://localhost:3001"}