{"version":3,"kind":"Notebook","sha256":"22580043b0348b4b826841df809bf2c11fdc46df70b90301837a0b3b84686b77","slug":"tp1-learning-problem","location":"/exercises/tp1_learning_problem.ipynb","dependencies":[],"frontmatter":{"title":"TP1: Le problème d’apprentissage","content_includes_title":false,"kernelspec":{"name":"python3","display_name":"Python 3","language":"python"},"authors":[{"nameParsed":{"literal":"Pierre-Luc Bacon","given":"Pierre-Luc","family":"Bacon"},"name":"Pierre-Luc Bacon","id":"contributors-myst-generated-uid-0"}],"github":"https://github.com/pierrelux/mlbook","math":{"\\E":{"macro":"\\mathbb{E}"},"\\Var":{"macro":"\\mathrm{Var}"},"\\Cov":{"macro":"\\mathrm{Cov}"},"\\Prob":{"macro":"\\mathbb{P}"},"\\R":{"macro":"\\mathbb{R}"},"\\N":{"macro":"\\mathbb{N}"},"\\Loss":{"macro":"\\mathcal{L}"},"\\Risk":{"macro":"\\mathcal{R}"},"\\Hypothesis":{"macro":"\\mathcal{H}"},"\\Data":{"macro":"\\mathcal{D}"},"\\indicator":{"macro":"\\mathbb{1}"},"\\defeq":{"macro":"\\triangleq"},"\\mathds":{"macro":"\\mathbb"},"\\hdots":{"macro":"\\cdots"}},"numbering":{"title":{"offset":1}},"source_url":"https://github.com/pierrelux/mlbook/blob/main/exercises/tp1_learning_problem.ipynb","edit_url":"https://github.com/pierrelux/mlbook/edit/main/exercises/tp1_learning_problem.ipynb","thumbnail":"/mlbook/build/7e2db436150c38a00650f96925aa5581.svg","exports":[{"format":"ipynb","filename":"tp1_learning_problem.ipynb","url":"/mlbook/build/tp1_learning_problem-d6e1af3ee39b78c892c4cd9275793493.ipynb"}]},"widgets":{},"mdast":{"type":"root","children":[{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"strong","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"IFT6390 - Fondements de l’apprentissage machine","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"ubPoTrpJw6"}],"key":"h2Wjoc6klP"}],"key":"E3494VNkwt"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"link","url":"https://colab.research.google.com/github/pierrelux/mlbook/blob/main/exercises/tp1_learning_problem.ipynb","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"image","url":"/mlbook/build/7e2db436150c38a00650f96925aa5581.svg","alt":"Open In Colab","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"oLYRUY1zX6","urlSource":"https://colab.research.google.com/assets/colab-badge.svg"}],"urlSource":"https://colab.research.google.com/github/pierrelux/mlbook/blob/main/exercises/tp1_learning_problem.ipynb","key":"kmmSSYtQpW"}],"key":"AFnrOojNuW"},{"type":"paragraph","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"Ce notebook accompagne le ","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"D0a2NF5Ybn"},{"type":"link","url":"https://pierrelux.github.io/mlbook/learning-problem","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"Chapitre 2: Le problème d’apprentissage","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"yrGFXePfhK"}],"urlSource":"https://pierrelux.github.io/mlbook/learning-problem","key":"kAT2a902IQ"},{"type":"text","value":".","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"CVBI3q99qG"}],"key":"c8mC89ypUO"},{"type":"heading","depth":2,"position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"Objectifs","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"ZL9bQOvZYm"}],"identifier":"objectifs","label":"Objectifs","html_id":"objectifs","implicit":true,"key":"ZUmuNqA9MF"},{"type":"paragraph","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"À la fin de ce TP, vous serez en mesure de:","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"gXs7n7BEEz"}],"key":"jdjgfYZCdm"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":12,"column":1},"end":{"line":16,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Calculer l’erreur quadratique moyenne (MSE)","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"PgzNXpJxeh"}],"key":"POGaCdtiWd"}],"key":"opJpibbAix"},{"type":"listItem","spread":true,"position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Observer le phénomène de surapprentissage avec des polynômes","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"xvC9BmO1yA"}],"key":"azRf7XRiQy"}],"key":"aZqVZK5ARR"},{"type":"listItem","spread":true,"position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Comprendre le compromis biais-variance","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"Y9tzSmigXk"}],"key":"Xu0JRHmDvh"}],"key":"rGoUbJPxdg"},{"type":"listItem","spread":true,"position":{"start":{"line":15,"column":1},"end":{"line":16,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Implémenter la régularisation Ridge","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"lKXWr7ptix"}],"key":"AH8Q21Woqx"}],"key":"tLemQ02a4n"}],"key":"OW4Wh31Bk8"},{"type":"thematicBreak","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"ZLEIYJ0WAg"}],"key":"wrC8g7irDz"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Partie 0: Configuration","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"XSvKslIBVv"}],"identifier":"partie-0-configuration","label":"Partie 0: Configuration","html_id":"partie-0-configuration","implicit":true,"key":"wwZ7IZN63c"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Exécutez cette cellule pour importer les bibliothèques nécessaires.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"ryAgeoKRci"}],"key":"TyokDx6IJm"}],"key":"jN1MgajjV9"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"import numpy as np\nimport matplotlib.pyplot as plt\nimport warnings\nwarnings.filterwarnings('ignore', message='Polyfit may be poorly conditioned')\n\n# Pour de jolis graphiques\nplt.rcParams['figure.figsize'] = (8, 5)\nplt.rcParams['font.size'] = 12\n\nprint(\"Configuration terminee!\")","key":"SyrxDbdI3D"},{"type":"outputs","id":"Kh9D5-uagry8110DRr9Et","children":[{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"Configuration terminee!\n"},"key":"B26KgjhleC"}],"key":"LleRtx1agi"}],"key":"nXrs9AFEMh"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Partie 1: Les données de freinage","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"z2YegCrbcn"}],"identifier":"partie-1-les-donn-es-de-freinage","label":"Partie 1: Les données de freinage","html_id":"partie-1-les-donn-es-de-freinage","implicit":true,"key":"ILp8z3h6gy"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Nous utilisons les données classiques d’Ezekiel (1930): la distance de freinage d’un véhicule en fonction de sa vitesse.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"aGvwDs9390"}],"key":"LXGHq7qd6d"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"strong","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Question préliminaire","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"lYI7Pe6zYU"}],"key":"JKcAo6VWsd"},{"type":"text","value":": Quelle relation attendez-vous entre vitesse et distance de freinage? Linéaire? Quadratique? Autre?","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"QXlfCRaf9q"}],"key":"QoVDLsHzKn"}],"key":"LBT1V5NMML"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Données de freinage (Ezekiel, 1930): vitesse (mph) vs distance d'arrêt (ft)\nspeed = np.array([4, 4, 7, 7, 8, 9, 10, 10, 10, 11, 11, 12, 12, 12, 12, 13, 13, 13, 13, 14,\n                  14, 14, 14, 15, 15, 15, 16, 16, 17, 17, 17, 18, 18, 18, 18, 19, 19, 19,\n                  20, 20, 20, 20, 20, 22, 23, 24, 24, 24, 24, 25], dtype=float)\ndist = np.array([2, 10, 4, 22, 16, 10, 18, 26, 34, 17, 28, 14, 20, 24, 28, 26, 34, 34, 46,\n                 26, 36, 60, 80, 20, 26, 54, 32, 40, 32, 40, 50, 42, 56, 76, 84, 36, 46,\n                 68, 32, 48, 52, 56, 64, 66, 54, 70, 92, 93, 120, 85], dtype=float)\n\nprint(f\"Nombre d'observations: {len(speed)}\")\nprint(f\"Vitesse: min={speed.min():.0f}, max={speed.max():.0f} mph\")\nprint(f\"Distance: min={dist.min():.0f}, max={dist.max():.0f} ft\")","key":"IJWJ5bZ2Lu"},{"type":"outputs","id":"uxzO50RtFBMncuxWX10a0","children":[{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"Nombre d'observations: 50\nVitesse: min=4, max=25 mph\nDistance: min=2, max=120 ft\n"},"key":"Fx6wiqx2My"}],"key":"pirxg7F61n"}],"key":"dWWSL6Gbkx"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Visualisation des données\nplt.figure(figsize=(8, 5))\nplt.scatter(speed, dist, alpha=0.7, s=50)\nplt.xlabel('Vitesse (mph)')\nplt.ylabel('Distance de freinage (ft)')\nplt.title('Données de freinage')\nplt.grid(True, alpha=0.3)\nplt.show()","key":"QXiNre8ve6"},{"type":"outputs","id":"dQmSZzWrVpQ5TaehxDOo4","children":[{"type":"output","children":[],"jupyter_data":{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"<Figure size 800x500 with 1 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"4b0a027b56e319f0f0001704ff7bf9ed","path":"/mlbook/build/4b0a027b56e319f0f0001704ff7bf9ed.png"}}},"key":"xOMm9c2rCM"}],"key":"hGXpyUAxrB"}],"key":"q7hw7NUGS8"},{"type":"block","kind":"notebook-content","children":[{"type":"thematicBreak","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"zCcxhFb7iK"},{"type":"heading","depth":2,"position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"Partie 2: Ajuster un polynôme","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"L8SFipswl5"}],"identifier":"partie-2-ajuster-un-polyn-me","label":"Partie 2: Ajuster un polynôme","html_id":"partie-2-ajuster-un-polyn-me","implicit":true,"key":"cCnhvcgRuN"},{"type":"paragraph","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"Nous allons ajuster des polynômes de différents degrés aux données.","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"y5vYp0zIkB"}],"key":"pSpEUcsrXV"},{"type":"heading","depth":3,"position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"2.1 Ajustement simple","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"LxT0M025Ja"}],"identifier":"id-2-1-ajustement-simple","label":"2.1 Ajustement simple","html_id":"id-2-1-ajustement-simple","implicit":true,"key":"r4j38fzY2s"}],"key":"Rz8urBe80d"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Ajuster un polynôme de degré 2\ndegree = 2\ncoeffs = np.polyfit(speed, dist, degree)\n\nprint(f\"Coefficients du polynôme de degré {degree}:\")\nfor i, c in enumerate(coeffs):\n    print(f\"  coefficient de x^{degree-i}: {c:.4f}\")","key":"JAagKlrbEk"},{"type":"outputs","id":"GWig6Wf9eSAOHdvU_GilK","children":[{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"Coefficients du polynôme de degré 2:\n  coefficient de x^2: 0.1000\n  coefficient de x^1: 0.9133\n  coefficient de x^0: 2.4701\n"},"key":"JRRlUHCukE"}],"key":"PJxvSmUTBb"}],"key":"DTTq5HFsOQ"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Visualiser l'ajustement\nplt.figure(figsize=(8, 5))\nplt.scatter(speed, dist, alpha=0.7, s=50, label='Données')\n\n# Grille pour tracer la courbe\nspeed_grid = np.linspace(0, 30, 100)\ndist_pred = np.polyval(coeffs, speed_grid)\nplt.plot(speed_grid, dist_pred, 'r-', linewidth=2, label=f'Polynôme degré {degree}')\n\nplt.xlabel('Vitesse (mph)')\nplt.ylabel('Distance de freinage (ft)')\nplt.legend()\nplt.grid(True, alpha=0.3)\nplt.show()","key":"bfgWRC3l9F"},{"type":"outputs","id":"Z3lY7QAXKKkOSWTxlcUO-","children":[{"type":"output","children":[],"jupyter_data":{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"<Figure size 800x500 with 1 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"15d803901f9c4e46843e4bf9ede0e30c","path":"/mlbook/build/15d803901f9c4e46843e4bf9ede0e30c.png"}}},"key":"yzgozIcQR6"}],"key":"qIZntQJrTk"}],"key":"PnmnNoApcH"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Exercice 1: Calculer l’erreur quadratique moyenne (MSE)","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"WYpfPnAVel"}],"identifier":"exercice-1-calculer-lerreur-quadratique-moyenne-mse","label":"Exercice 1: Calculer l’erreur quadratique moyenne (MSE)","html_id":"exercice-1-calculer-lerreur-quadratique-moyenne-mse","implicit":true,"key":"cjj6NjFeMO"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"L’erreur quadratique moyenne est définie comme:","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"CBLGKf4VVL"}],"key":"ZH9HfrbdLk"},{"type":"math","value":"\\text{MSE} = \\frac{1}{N} \\sum_{i=1}^{N} (y_i - \\hat{y}_i)^2","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mtext>MSE</mtext><mo>=</mo><mfrac><mn>1</mn><mi>N</mi></mfrac><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></munderover><mo stretchy=\"false\">(</mo><msub><mi>y</mi><mi>i</mi></msub><mo>−</mo><msub><mover accent=\"true\"><mi>y</mi><mo>^</mo></mover><mi>i</mi></msub><msup><mo stretchy=\"false\">)</mo><mn>2</mn></msup></mrow><annotation encoding=\"application/x-tex\">\\text{MSE} = \\frac{1}{N} \\sum_{i=1}^{N} (y_i - \\hat{y}_i)^2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord text\"><span class=\"mord\">MSE</span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:3.106em;vertical-align:-1.2777em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3214em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mop op-limits\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.8283em;\"><span style=\"top:-1.8723em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mrel mtight\">=</span><span class=\"mord mtight\">1</span></span></span></span><span style=\"top:-3.05em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span><span class=\"mop op-symbol large-op\">∑</span></span></span><span style=\"top:-4.3em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.10903em;\">N</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.2777em;\"><span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.1141em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord accent\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6944em;\"><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span></span><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"accent-body\" style=\"left:-0.1944em;\"><span class=\"mord\">^</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1944em;\"><span></span></span></span></span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\"><span class=\"mclose\">)</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8641em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span></span></span></span></span>","enumerator":"1","key":"TD0kCzbYCk"},{"type":"paragraph","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"strong","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"Complétez la fonction ci-dessous:","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"LK3hBwuuJP"}],"key":"yAL9vRIAZk"}],"key":"Vu4aTt4PEL"}],"key":"EUFVOzpdGa"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"def compute_mse(y_true, y_pred):\n    \"\"\"\n    Calcule l'erreur quadratique moyenne.\n    \n    Args:\n        y_true: valeurs réelles (array)\n        y_pred: prédictions (array)\n    \n    Returns:\n        MSE (float)\n    \"\"\"\n    # ============================================\n    # TODO: Complétez cette fonction\n    # Indice: utilisez np.mean() et l'opérateur **2\n    # ============================================\n    \n    mse = None  # <- Remplacez None par votre code\n    \n    return mse","key":"D5A7HrU967"},{"type":"outputs","id":"yay_oiCDQJsamZfj6Z4G5","children":[],"key":"MZA1YxskRb"}],"key":"kKA7lyIpis"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Test de votre fonction\npredictions = np.polyval(coeffs, speed)\nmse = compute_mse(dist, predictions)\n\nif mse is not None:\n    print(f\"MSE pour le polynôme de degré {degree}: {mse:.2f}\")\n    \n    # Vérification\n    expected_mse = np.mean((dist - predictions)**2)\n    if np.isclose(mse, expected_mse):\n        print(\"Correct!\")\n    else:\n        print(f\"Attendu: {expected_mse:.2f}\")\nelse:\n    print(\"La fonction retourne None. Completez le code!\")","key":"MmVGJz0Hd4"},{"type":"outputs","id":"BN_XQQxQzORAD1S-ioRcg","children":[{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"La fonction retourne None. Completez le code!\n"},"key":"nJm0kkFt5T"}],"key":"pl19hSzJeV"}],"key":"kVTmsmg8Ay"},{"type":"block","kind":"notebook-content","children":[{"type":"details","children":[{"type":"summary","children":[{"type":"text","value":"Cliquez pour voir la solution","key":"l2FssPLcqi"}],"key":"va1vA4dDle"},{"type":"code","lang":"python","meta":null,"value":"def compute_mse(y_true, y_pred):\n    mse = np.mean((y_true - y_pred)**2)\n    return mse","key":"PC2yjpAnqw"}],"key":"YF57cES5Wm"}],"key":"VYxTkb7lZR"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Exercice 2: Explorer differents degres","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"u7vGp794Rj"}],"identifier":"exercice-2-explorer-differents-degres","label":"Exercice 2: Explorer differents degres","html_id":"exercice-2-explorer-differents-degres","implicit":true,"key":"g99hheVY5f"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"strong","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Modifiez la variable ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"dhzkIVHXvX"},{"type":"inlineCode","value":"degree","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"ajSFdpnknV"},{"type":"text","value":" ci-dessous et observez:","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"NYgyUyNcZ0"}],"key":"tvy0N3sn6y"}],"key":"pK12qoqYHq"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":4,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Comment change la courbe?","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"MfGmqVri1u"}],"key":"MDYOkJeMGk"}],"key":"z3QYYUYGlg"},{"type":"listItem","spread":true,"position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Comment change le MSE?","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"eNSmwKbeYp"}],"key":"CmlNEEp6Ck"}],"key":"PDRK8ALhGG"}],"key":"Ry1yioQICd"}],"key":"o8jghlQTsZ"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# ============================================\n# TODO: Essayez différentes valeurs: 1, 2, 5, 10, 15, 20\n# ============================================\ndegree = 2  # <- Modifiez cette valeur!\n\n# Ajustement\ncoeffs = np.polyfit(speed, dist, degree)\npredictions = np.polyval(coeffs, speed)\nmse = np.mean((dist - predictions)**2)\n\n# Visualisation\nplt.figure(figsize=(10, 5))\nplt.scatter(speed, dist, alpha=0.7, s=50, label='Données')\n\nspeed_grid = np.linspace(3, 26, 200)\npred_grid = np.polyval(coeffs, speed_grid)\npred_grid = np.clip(pred_grid, -50, 200)  # Limiter pour la visualisation\n\nplt.plot(speed_grid, pred_grid, 'r-', linewidth=2, label=f'Polynôme degré {degree}')\nplt.xlabel('Vitesse (mph)')\nplt.ylabel('Distance de freinage (ft)')\nplt.title(f'Degré {degree} — MSE = {mse:.1f}')\nplt.legend()\nplt.ylim(-20, 150)\nplt.grid(True, alpha=0.3)\nplt.show()\n\nprint(f\"\\nMSE: {mse:.2f}\")","key":"q3ENZkTTPo"},{"type":"outputs","id":"o6m170MnqpgjIr4E_cXtY","children":[{"type":"output","children":[],"jupyter_data":{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"<Figure size 1000x500 with 1 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"12bb5590dd57b10fe9e790df698221cf","path":"/mlbook/build/12bb5590dd57b10fe9e790df698221cf.png"}}},"key":"QvL8VVi92b"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"\nMSE: 216.49\n"},"key":"O76rQHCPmr"}],"key":"lIQNui16p2"}],"key":"FWH1UlTuyG"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Questions de reflexion:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Z2P9Eq4CWc"}],"key":"yViNj8aGkJ"}],"key":"w0L3BcH613"},{"type":"list","ordered":true,"start":1,"spread":false,"position":{"start":{"line":2,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Quel degré donne le MSE le plus bas?","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"osIxXZUS0s"}],"key":"hLNnbuwiKq"}],"key":"fRl1opw9dz"},{"type":"listItem","spread":true,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Le polynôme de degré 20 semble-t-il raisonnable pour prédire à de nouvelles vitesses?","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"pMECMADpPg"}],"key":"gvxGGS4w0P"}],"key":"rxtuaPsc6U"},{"type":"listItem","spread":true,"position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"C’est quoi le problème avec minimiser uniquement le MSE sur les données d’entraînement?","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"IIs74dTYHn"}],"key":"iyIk2HQcNe"}],"key":"LfmTnH6ORS"}],"key":"kkCuJwxSv3"}],"key":"f3Y8I1QCzp"},{"type":"block","kind":"notebook-content","children":[{"type":"thematicBreak","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"zaQZ8yCX7T"},{"type":"heading","depth":2,"position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"Partie 3: Train/Test Split — Le surapprentissage","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"ShylwMBRvS"}],"identifier":"partie-3-train-test-split-le-surapprentissage","label":"Partie 3: Train/Test Split — Le surapprentissage","html_id":"partie-3-train-test-split-le-surapprentissage","implicit":true,"key":"J8X4s6lLwB"},{"type":"paragraph","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"Pour détecter le ","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"yLsOAPCT76"},{"type":"strong","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"surapprentissage","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"gE4rItbATw"}],"key":"OMOWo1BJwW"},{"type":"text","value":", nous séparons les données en:","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"pju9jtIFDZ"}],"key":"iNpimvm344"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":5,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Ensemble d’entraînement","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"p0OGHQrMiV"}],"key":"b4p9x9wfpz"},{"type":"text","value":" (70%): pour ajuster le modèle","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"mIhwx9Mrbl"}],"key":"TostvewAsr"}],"key":"BR5DGo0miW"},{"type":"listItem","spread":true,"position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"Ensemble de test","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"TvXjdDfEFn"}],"key":"P6nMcyR8V1"},{"type":"text","value":" (30%): pour évaluer la généralisation","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"YXmJwBrZYd"}],"key":"QszYWc1miP"}],"key":"fOy0Oq6CwD"}],"key":"h8DmK7LQOo"}],"key":"U2v6tN2Bhd"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Séparation train/test\nnp.random.seed(42)  # Pour reproductibilité\nindices = np.random.permutation(len(speed))\nn_train = 35\n\ntrain_idx = indices[:n_train]\ntest_idx = indices[n_train:]\n\nspeed_train, dist_train = speed[train_idx], dist[train_idx]\nspeed_test, dist_test = speed[test_idx], dist[test_idx]\n\nprint(f\"Entraînement: {len(speed_train)} exemples\")\nprint(f\"Test: {len(speed_test)} exemples\")","key":"DKXcE30Wz9"},{"type":"outputs","id":"oj0NGQ8Y-M62Sm-90UodF","children":[{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"Entraînement: 35 exemples\nTest: 15 exemples\n"},"key":"YDLVdbAg6i"}],"key":"l3E6UCdM3S"}],"key":"AAjyMuuT76"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Visualisation de la séparation\nplt.figure(figsize=(8, 5))\nplt.scatter(speed_train, dist_train, alpha=0.7, s=50, label='Entraînement')\nplt.scatter(speed_test, dist_test, alpha=0.7, s=50, marker='s', label='Test')\nplt.xlabel('Vitesse (mph)')\nplt.ylabel('Distance de freinage (ft)')\nplt.legend()\nplt.grid(True, alpha=0.3)\nplt.show()","key":"MtGdA8hzU9"},{"type":"outputs","id":"UqEFOvu8OS2VPMz8QqURn","children":[{"type":"output","children":[],"jupyter_data":{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"<Figure size 800x500 with 1 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"9dfc4022c35909ed2e5c192f673f6a4e","path":"/mlbook/build/9dfc4022c35909ed2e5c192f673f6a4e.png"}}},"key":"dqekOQ9GVo"}],"key":"XMytnggNuh"}],"key":"IUFoborJDG"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Exercice 3: Courbe biais-variance","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"zGNbXA6V4o"}],"identifier":"exercice-3-courbe-biais-variance","label":"Exercice 3: Courbe biais-variance","html_id":"exercice-3-courbe-biais-variance","implicit":true,"key":"QOypChmLOJ"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"strong","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Complétez le code pour calculer l’erreur sur train ET test pour chaque degré:","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"D11ULbjqnS"}],"key":"CxY9XeCcN2"}],"key":"ocWtuSveKr"}],"key":"zM15rjlCyx"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"degrees = range(1, 16)\ntrain_errors = []\ntest_errors = []\n\nfor deg in degrees:\n    # Ajuster sur l'ensemble d'entraînement\n    coeffs = np.polyfit(speed_train, dist_train, deg)\n    \n    # ============================================\n    # TODO: Calculez les prédictions et erreurs\n    # ============================================\n    \n    # Prédictions sur train\n    pred_train = None  # <- Complétez avec np.polyval(...)\n    \n    # Prédictions sur test\n    pred_test = None  # <- Complétez avec np.polyval(...)\n    \n    # MSE sur train\n    mse_train = None  # <- Complétez\n    \n    # MSE sur test\n    mse_test = None  # <- Complétez\n    \n    train_errors.append(mse_train)\n    test_errors.append(mse_test)","key":"ttYLIE1SPU"},{"type":"outputs","id":"nGtO21nF1EGR4_uTPW87H","children":[],"key":"LWszLQwz5o"}],"key":"wgBEDJchQI"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Visualisation (exécutez après avoir complété le code ci-dessus)\nif None not in train_errors and None not in test_errors:\n    plt.figure(figsize=(10, 6))\n    plt.plot(degrees, train_errors, 'o-', linewidth=2, markersize=8, label='Erreur entraînement')\n    plt.plot(degrees, test_errors, 's-', linewidth=2, markersize=8, label='Erreur test')\n    plt.yscale('log')\n    plt.xlabel('Degré du polynôme (complexité)')\n    plt.ylabel('MSE (échelle log)')\n    plt.title('Compromis biais-variance')\n    plt.legend()\n    plt.grid(True, alpha=0.3)\n    plt.xticks(range(1, 16, 2))\n    plt.show()\n    \n    # Trouver le meilleur degré\n    best_deg = degrees[np.argmin(test_errors)]\n    print(f\"\\nMeilleur degre (selon erreur test): {best_deg}\")\n    print(f\"   MSE train: {train_errors[best_deg-1]:.1f}\")\n    print(f\"   MSE test: {test_errors[best_deg-1]:.1f}\")\nelse:\n    print(\"Completez le code de l'exercice 3!\")","key":"SYURaDBKOU"},{"type":"outputs","id":"ZH51_-LOh8DUQIKCRRT7S","children":[{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"Completez le code de l'exercice 3!\n"},"key":"Jx9uTWuh78"}],"key":"K8w6Hrq0AF"}],"key":"cL4WLNFIYM"},{"type":"block","kind":"notebook-content","children":[{"type":"details","children":[{"type":"summary","children":[{"type":"text","value":"Cliquez pour voir la solution","key":"EHeZPVYTxN"}],"key":"gwwbdTlf4H"},{"type":"code","lang":"python","meta":null,"value":"# Prédictions sur train\npred_train = np.polyval(coeffs, speed_train)\n\n# Prédictions sur test\npred_test = np.polyval(coeffs, speed_test)\n\n# MSE sur train\nmse_train = np.mean((dist_train - pred_train)**2)\n\n# MSE sur test\nmse_test = np.mean((dist_test - pred_test)**2)","key":"ESONZb9fGm"}],"key":"reRNUIdU8v"}],"key":"plGOESDEge"},{"type":"block","kind":"notebook-content","children":[{"type":"thematicBreak","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"LA6B6SQ3DS"},{"type":"heading","depth":2,"position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"Partie 4: Régularisation Ridge","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"vTFcWxvOIR"}],"identifier":"partie-4-r-gularisation-ridge","label":"Partie 4: Régularisation Ridge","html_id":"partie-4-r-gularisation-ridge","implicit":true,"key":"Fo6ok74u3a"},{"type":"paragraph","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"Au lieu de choisir un degré bas, on peut utiliser un polynôme de ","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"yF9wAtfqhL"},{"type":"strong","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"haut degré","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"bmKd9Y6EHa"}],"key":"isIlv86QFd"},{"type":"text","value":" avec ","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"n7hAF3Dv7z"},{"type":"strong","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"régularisation","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"WNoJllCgoC"}],"key":"r9IUqwJq7D"},{"type":"text","value":".","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"yZbQVMNGMA"}],"key":"zI1FmdXFqv"},{"type":"paragraph","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"La régularisation Ridge ajoute une pénalité sur les coefficients:","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"GUb8sOjxzt"}],"key":"NrH5q92mXg"},{"type":"math","value":"\\hat{\\boldsymbol{\\theta}}_{\\text{Ridge}} = \\arg\\min_{\\boldsymbol{\\theta}} \\left[ \\sum_{i=1}^{N} (y_i - \\boldsymbol{\\theta}^\\top \\mathbf{x}_i)^2 + \\lambda \\|\\boldsymbol{\\theta}\\|^2 \\right]","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><msub><mover accent=\"true\"><mi mathvariant=\"bold-italic\">θ</mi><mo>^</mo></mover><mtext>Ridge</mtext></msub><mo>=</mo><mi>arg</mi><mo>⁡</mo><munder><mrow><mi>min</mi><mo>⁡</mo></mrow><mi mathvariant=\"bold-italic\">θ</mi></munder><mrow><mo fence=\"true\">[</mo><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></munderover><mo stretchy=\"false\">(</mo><msub><mi>y</mi><mi>i</mi></msub><mo>−</mo><msup><mi mathvariant=\"bold-italic\">θ</mi><mi mathvariant=\"normal\">⊤</mi></msup><msub><mi mathvariant=\"bold\">x</mi><mi>i</mi></msub><msup><mo stretchy=\"false\">)</mo><mn>2</mn></msup><mo>+</mo><mi>λ</mi><mi mathvariant=\"normal\">∥</mi><mi mathvariant=\"bold-italic\">θ</mi><msup><mi mathvariant=\"normal\">∥</mi><mn>2</mn></msup><mo fence=\"true\">]</mo></mrow></mrow><annotation encoding=\"application/x-tex\">\\hat{\\boldsymbol{\\theta}}_{\\text{Ridge}} = \\arg\\min_{\\boldsymbol{\\theta}} \\left[ \\sum_{i=1}^{N} (y_i - \\boldsymbol{\\theta}^\\top \\mathbf{x}_i)^2 + \\lambda \\|\\boldsymbol{\\theta}\\|^2 \\right]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.244em;vertical-align:-0.2861em;\"></span><span class=\"mord\"><span class=\"mord accent\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.9579em;\"><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord boldsymbol\" style=\"margin-right:0.03194em;\">θ</span></span></span></span><span style=\"top:-3.2634em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"accent-body\" style=\"left:-0.25em;\"><span class=\"mord\">^</span></span></span></span></span></span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord text mtight\"><span class=\"mord mtight\">Ridge</span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:3.106em;vertical-align:-1.2777em;\"></span><span class=\"mop\">ar<span style=\"margin-right:0.01389em;\">g</span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mop op-limits\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6679em;\"><span style=\"top:-2.3479em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord boldsymbol mtight\" style=\"margin-right:0.03194em;\">θ</span></span></span></span></span></span><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span><span class=\"mop\">min</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7521em;\"><span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"minner\"><span class=\"mopen delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size4\">[</span></span><span class=\"mop op-limits\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.8283em;\"><span style=\"top:-1.8723em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mrel mtight\">=</span><span class=\"mord mtight\">1</span></span></span></span><span style=\"top:-3.05em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span><span class=\"mop op-symbol large-op\">∑</span></span></span><span style=\"top:-4.3em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.10903em;\">N</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.2777em;\"><span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord\"><span class=\"mord boldsymbol\" style=\"margin-right:0.03194em;\">θ</span></span></span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.9334em;\"><span style=\"top:-3.1473em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">⊤</span></span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord mathbf\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\"><span class=\"mclose\">)</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8641em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord mathnormal\">λ</span><span class=\"mord\">∥</span><span class=\"mord\"><span class=\"mord\"><span class=\"mord boldsymbol\" style=\"margin-right:0.03194em;\">θ</span></span></span><span class=\"mord\"><span class=\"mord\">∥</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8641em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mclose delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size4\">]</span></span></span></span></span></span></span>","enumerator":"2","key":"NXHAtk5mzV"},{"type":"paragraph","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"text","value":"La solution en forme fermée est:","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"K4jY1WmOf3"}],"key":"eWvEhutYWO"},{"type":"math","value":"\\hat{\\boldsymbol{\\theta}}_{\\text{Ridge}} = (\\mathbf{X}^\\top \\mathbf{X} + \\lambda \\mathbf{I})^{-1} \\mathbf{X}^\\top \\mathbf{y}","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><msub><mover accent=\"true\"><mi mathvariant=\"bold-italic\">θ</mi><mo>^</mo></mover><mtext>Ridge</mtext></msub><mo>=</mo><mo stretchy=\"false\">(</mo><msup><mi mathvariant=\"bold\">X</mi><mi mathvariant=\"normal\">⊤</mi></msup><mi mathvariant=\"bold\">X</mi><mo>+</mo><mi>λ</mi><mi mathvariant=\"bold\">I</mi><msup><mo stretchy=\"false\">)</mo><mrow><mo>−</mo><mn>1</mn></mrow></msup><msup><mi mathvariant=\"bold\">X</mi><mi mathvariant=\"normal\">⊤</mi></msup><mi mathvariant=\"bold\">y</mi></mrow><annotation encoding=\"application/x-tex\">\\hat{\\boldsymbol{\\theta}}_{\\text{Ridge}} = (\\mathbf{X}^\\top \\mathbf{X} + \\lambda \\mathbf{I})^{-1} \\mathbf{X}^\\top \\mathbf{y}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.244em;vertical-align:-0.2861em;\"></span><span class=\"mord\"><span class=\"mord accent\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.9579em;\"><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord boldsymbol\" style=\"margin-right:0.03194em;\">θ</span></span></span></span><span style=\"top:-3.2634em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"accent-body\" style=\"left:-0.25em;\"><span class=\"mord\">^</span></span></span></span></span></span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord text mtight\"><span class=\"mord mtight\">Ridge</span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.1491em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathbf\">X</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8991em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">⊤</span></span></span></span></span></span></span></span><span class=\"mord mathbf\">X</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.1491em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">λ</span><span class=\"mord mathbf\">I</span><span class=\"mclose\"><span class=\"mclose\">)</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8641em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">−</span><span class=\"mord mtight\">1</span></span></span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord mathbf\">X</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8991em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">⊤</span></span></span></span></span></span></span></span><span class=\"mord mathbf\" style=\"margin-right:0.01597em;\">y</span></span></span></span></span>","enumerator":"3","key":"j6PGZCT4rd"}],"key":"Azv3Ss7Xew"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Exercice 4: Implementer Ridge Regression","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"bbHHKQ1uzH"}],"identifier":"exercice-4-implementer-ridge-regression","label":"Exercice 4: Implementer Ridge Regression","html_id":"exercice-4-implementer-ridge-regression","implicit":true,"key":"ilpwRWwGoM"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"strong","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Completez la fonction ci-dessous:","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"Lletc7GjZD"}],"key":"shQV5LB6Jv"}],"key":"Csfk44tq37"}],"key":"mChJeK4ZFM"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"def polynomial_features(x, degree):\n    \"\"\"\n    Crée la matrice de caractéristiques polynomiales.\n    \n    Args:\n        x: vecteur d'entrées (n,)\n        degree: degré du polynôme\n    \n    Returns:\n        X: matrice (n, degree+1) avec colonnes [1, x, x², ..., x^degree]\n    \"\"\"\n    n = len(x)\n    X = np.zeros((n, degree + 1))\n    for d in range(degree + 1):\n        X[:, d] = x ** d\n    return X\n\n\ndef ridge_regression(X, y, lambda_reg):\n    \"\"\"\n    Calcule les coefficients Ridge.\n    \n    Args:\n        X: matrice de features (n, d)\n        y: vecteur cible (n,)\n        lambda_reg: coefficient de régularisation\n    \n    Returns:\n        theta: coefficients (d,)\n    \"\"\"\n    # ============================================\n    # TODO: Implémentez la formule Ridge\n    # theta = (X'X + lambda*I)^(-1) X'y\n    # \n    # Indices:\n    # - X.T pour la transposée\n    # - @ pour le produit matriciel\n    # - np.eye(n) pour la matrice identité n×n\n    # - np.linalg.inv() pour l'inverse\n    # ============================================\n    \n    d = X.shape[1]  # nombre de features\n    \n    theta = None  # <- Remplacez par votre code\n    \n    return theta","key":"r54vCkAkpn"},{"type":"outputs","id":"ZrlByQRHfHLMMjv151_0w","children":[],"key":"fJeefuQ6Vi"}],"key":"hpIQOilXFD"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Test de votre implémentation\ndegree = 10\nlambda_reg = 1.0\n\nX_train = polynomial_features(speed_train, degree)\ntheta = ridge_regression(X_train, dist_train, lambda_reg)\n\nif theta is not None:\n    print(f\"Coefficients Ridge (degré={degree}, λ={lambda_reg}):\")\n    print(f\"  Norme des coefficients: {np.linalg.norm(theta):.2f}\")\n    \n    # Prédictions\n    X_test = polynomial_features(speed_test, degree)\n    pred_test = X_test @ theta\n    mse = np.mean((dist_test - pred_test)**2)\n    print(f\"  MSE test: {mse:.1f}\")\n    print(\"\\nImplementation correcte!\")\nelse:\n    print(\"Completez la fonction ridge_regression!\")","key":"ReEFLnMnic"},{"type":"outputs","id":"7EieupD-i4VC8zrD9q1g_","children":[{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"Completez la fonction ridge_regression!\n"},"key":"cIIeUd3gYi"}],"key":"m5sAhsRznM"}],"key":"AIimd7aJlT"},{"type":"block","kind":"notebook-content","children":[{"type":"details","children":[{"type":"summary","children":[{"type":"text","value":"Cliquez pour voir la solution","key":"zYYDEFGPz5"}],"key":"v851wAesoY"},{"type":"code","lang":"python","meta":null,"value":"def ridge_regression(X, y, lambda_reg):\n    d = X.shape[1]\n    I = np.eye(d)\n    theta = np.linalg.inv(X.T @ X + lambda_reg * I) @ X.T @ y\n    return theta","key":"JxvVRiU8m3"}],"key":"Dar4HjrSjt"}],"key":"r6E2my6HkN"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Exercice 5: Trouver le meilleur lambda","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"CtWyAClnff"}],"identifier":"exercice-5-trouver-le-meilleur-lambda","label":"Exercice 5: Trouver le meilleur lambda","html_id":"exercice-5-trouver-le-meilleur-lambda","implicit":true,"key":"mCSoQHqLdW"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"strong","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Explorez différentes valeurs de λ pour un polynôme de degré 10:","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"wRCmMt0Vh2"}],"key":"vdXIN832gf"}],"key":"d7C23lyVPY"}],"key":"y8FJpWYZaj"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"degree = 10\nX_train = polynomial_features(speed_train, degree)\nX_test = polynomial_features(speed_test, degree)\n\nlambdas = [0, 0.001, 0.01, 0.1, 1, 10, 100, 1000]\nresults = []\n\nprint(f\"{'λ':>10} | {'MSE Train':>10} | {'MSE Test':>10} | {'||θ||':>10}\")\nprint(\"-\" * 50)\n\nfor lam in lambdas:\n    theta = ridge_regression(X_train, dist_train, lam)\n    if theta is not None:\n        mse_train = np.mean((dist_train - X_train @ theta)**2)\n        mse_test = np.mean((dist_test - X_test @ theta)**2)\n        norm_theta = np.linalg.norm(theta)\n        results.append((lam, mse_train, mse_test, norm_theta))\n        print(f\"{lam:>10.3f} | {mse_train:>10.1f} | {mse_test:>10.1f} | {norm_theta:>10.1f}\")","key":"LoZzW2Bipk"},{"type":"outputs","id":"RA_Emb1HahBg4DAv3f_Rh","children":[{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"         λ |  MSE Train |   MSE Test |      ||θ||\n--------------------------------------------------\n"},"key":"RqvwYAywop"}],"key":"IEjLCnjHYS"}],"key":"xW6Bt3W9o2"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Visualisation de l'effet de λ\nif len(results) > 0:\n    lambdas_plot = [r[0] for r in results]\n    train_plot = [r[1] for r in results]\n    test_plot = [r[2] for r in results]\n    \n    plt.figure(figsize=(10, 5))\n    plt.semilogx([max(l, 1e-4) for l in lambdas_plot], train_plot, 'o-', label='Train')\n    plt.semilogx([max(l, 1e-4) for l in lambdas_plot], test_plot, 's-', label='Test')\n    plt.xlabel('λ (échelle log)')\n    plt.ylabel('MSE')\n    plt.title(f'Effet de la régularisation Ridge (degré={degree})')\n    plt.legend()\n    plt.grid(True, alpha=0.3)\n    plt.show()","key":"FTxjju93MN"},{"type":"outputs","id":"hbJfw3r-0EBSLoS6Z_yNx","children":[],"key":"zf5zlYcR6H"}],"key":"qmYYYtF6SY"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Questions:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"nv91L46bFc"}],"key":"hcjinuTq4u"}],"key":"MUFjGudovF"},{"type":"list","ordered":true,"start":1,"spread":false,"position":{"start":{"line":2,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Quelle valeur de λ minimise l’erreur test?","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"zd7iigWu2K"}],"key":"CC488gTRMu"}],"key":"jbAfx3gOPh"},{"type":"listItem","spread":true,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Que se passe-t-il quand λ → 0? Et quand λ → ∞?","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"woFr2NVixO"}],"key":"zI0QIGlr7W"}],"key":"yppTDAphTG"},{"type":"listItem","spread":true,"position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Comment la norme des coefficients ||θ|| change avec λ?","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"ure9iXgwjm"}],"key":"FcrxhJoUjU"}],"key":"Pq690qfhZH"}],"key":"oe88HsC5r6"}],"key":"b6WKZxE5AR"},{"type":"block","kind":"notebook-content","children":[{"type":"thematicBreak","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"q55gPvAz7N"},{"type":"heading","depth":2,"position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"Partie 5: SVD et la solution MCO","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"fYcP4kKn2M"}],"identifier":"partie-5-svd-et-la-solution-mco","label":"Partie 5: SVD et la solution MCO","html_id":"partie-5-svd-et-la-solution-mco","implicit":true,"key":"YlnKqqLT4P"},{"type":"paragraph","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"La ","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"zhMdS0j6Mh"},{"type":"strong","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"decomposition en valeurs singulieres","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"kxBY9ml8e2"}],"key":"sELcPcaczv"},{"type":"text","value":" (SVD) offre une autre facon de comprendre les solutions MCO et Ridge. Cette section explore visuellement pourquoi Ridge fonctionne.","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"POtewA0RCx"}],"key":"aitCIE4K0X"},{"type":"heading","depth":3,"position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"Qu’est-ce que la SVD?","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"DYPi2jPOxv"}],"identifier":"quest-ce-que-la-svd","label":"Qu’est-ce que la SVD?","html_id":"quest-ce-que-la-svd","implicit":true,"key":"cbnSB6pVN6"},{"type":"paragraph","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"Toute matrice ","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"dTfiUE2Tsh"},{"type":"inlineMath","value":"\\mathbf{X}","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">X</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{X}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">X</span></span></span></span>","key":"kZEm4JcKkV"},{"type":"text","value":" peut s’ecrire:","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"ntg6VfWRWU"}],"key":"eu46pW8zEv"},{"type":"math","value":"\\mathbf{X} = \\mathbf{U} \\mathbf{D} \\mathbf{V}^\\top","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi mathvariant=\"bold\">X</mi><mo>=</mo><mi mathvariant=\"bold\">U</mi><mi mathvariant=\"bold\">D</mi><msup><mi mathvariant=\"bold\">V</mi><mi mathvariant=\"normal\">⊤</mi></msup></mrow><annotation encoding=\"application/x-tex\">\\mathbf{X} = \\mathbf{U} \\mathbf{D} \\mathbf{V}^\\top</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">X</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8991em;\"></span><span class=\"mord mathbf\">UD</span><span class=\"mord\"><span class=\"mord mathbf\" style=\"margin-right:0.01597em;\">V</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8991em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">⊤</span></span></span></span></span></span></span></span></span></span></span></span>","enumerator":"4","key":"K6Xk6nyMLy"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":12,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"paragraph","children":[{"type":"inlineMath","value":"\\mathbf{V}","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">V</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{V}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\" style=\"margin-right:0.01597em;\">V</span></span></span></span>","key":"JxBlcxgAqY"},{"type":"text","value":": directions principales dans l’espace des features","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"quFOfIPaO9"}],"key":"tCF3uncvQE"}],"key":"xViGTxBRAy"},{"type":"listItem","spread":true,"position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"paragraph","children":[{"type":"inlineMath","value":"\\mathbf{D}","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">D</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{D}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">D</span></span></span></span>","key":"rC7md2MaP3"},{"type":"text","value":": valeurs singulieres ","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"OExj4Tc8w5"},{"type":"inlineMath","value":"d_1 \\geq d_2 \\geq \\cdots \\geq d_p","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>d</mi><mn>1</mn></msub><mo>≥</mo><msub><mi>d</mi><mn>2</mn></msub><mo>≥</mo><mo>⋯</mo><mo>≥</mo><msub><mi>d</mi><mi>p</mi></msub></mrow><annotation encoding=\"application/x-tex\">d_1 \\geq d_2 \\geq \\cdots \\geq d_p</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8444em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">d</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">≥</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8444em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">d</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">≥</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7719em;vertical-align:-0.136em;\"></span><span class=\"minner\">⋯</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">≥</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.9805em;vertical-align:-0.2861em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">d</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">p</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span></span></span></span>","key":"aZaNu7TkOr"},{"type":"text","value":" (amplitudes)","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"Q5go1lEsYN"}],"key":"YQIn74jn8Y"}],"key":"zFv1RnNEBW"},{"type":"listItem","spread":true,"position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"paragraph","children":[{"type":"inlineMath","value":"\\mathbf{U}","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">U</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{U}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">U</span></span></span></span>","key":"kIrXUlWTjT"},{"type":"text","value":": directions correspondantes dans l’espace des observations","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"qmVg56U4xn"}],"key":"HY2xbS6iu1"}],"key":"Fy9DiJyqu3"}],"key":"jfKVsLlFeP"}],"key":"cJ0UISGEfh"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Creons des donnees 2D pour visualiser la SVD\nnp.random.seed(123)\nn = 50\n\n# Donnees avec correlation (une direction forte, une faible)\nX_2d = np.random.randn(n, 2)\n# Ajouter de la correlation\nX_2d[:, 1] = 0.9 * X_2d[:, 0] + 0.3 * X_2d[:, 1]\n\n# SVD\nU, s, Vt = np.linalg.svd(X_2d, full_matrices=False)\nV = Vt.T\n\nprint(\"Valeurs singulieres:\")\nprint(f\"  d1 = {s[0]:.2f} (direction forte)\")\nprint(f\"  d2 = {s[1]:.2f} (direction faible)\")\nprint(f\"  Ratio d1/d2 = {s[0]/s[1]:.1f}\")","key":"SIJrYrzNCd"},{"type":"outputs","id":"6EKcbDdWX5l0qY62iLu6z","children":[{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"Valeurs singulieres:\n  d1 = 11.22 (direction forte)\n  d2 = 1.68 (direction faible)\n  Ratio d1/d2 = 6.7\n"},"key":"glUxAVxc63"}],"key":"mt9KnTR1lD"}],"key":"N5ek5tOfb3"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Visualiser les directions principales\nfig, axes = plt.subplots(1, 2, figsize=(12, 5))\n\n# Gauche: donnees et directions principales\nax = axes[0]\nax.scatter(X_2d[:, 0], X_2d[:, 1], alpha=0.5, s=30)\n\n# Tracer les directions principales (vecteurs propres de X'X)\norigin = np.mean(X_2d, axis=0)\nfor i, (sv, color, label) in enumerate(zip(s, ['C0', 'C1'], ['v1 (forte)', 'v2 (faible)'])):\n    direction = V[:, i] * sv / 5  # Echelle pour visualisation\n    ax.annotate('', xy=origin + direction, xytext=origin,\n                arrowprops=dict(arrowstyle='->', color=color, lw=3))\n    ax.annotate(f'{label}\\nd={sv:.1f}', xy=origin + direction * 1.2, fontsize=10, color=color)\n\nax.set_xlabel('$x_1$')\nax.set_ylabel('$x_2$')\nax.set_title('Donnees et directions principales (SVD)')\nax.set_aspect('equal')\nax.grid(True, alpha=0.3)\n\n# Droite: valeurs singulieres\nax = axes[1]\nax.bar([1, 2], s, color=['C0', 'C1'], alpha=0.7)\nax.set_xticks([1, 2])\nax.set_xticklabels(['$d_1$', '$d_2$'])\nax.set_ylabel('Valeur singuliere')\nax.set_title('Spectre des valeurs singulieres')\nax.grid(True, alpha=0.3, axis='y')\n\nplt.tight_layout()\nplt.show()","key":"WBs8mA9YdV"},{"type":"outputs","id":"enSVcrDoMdvgwDjlEYUCU","children":[{"type":"output","children":[],"jupyter_data":{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"<Figure size 1200x500 with 2 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"eb9d801d7ae67f989a0fc2f808c6db1a","path":"/mlbook/build/eb9d801d7ae67f989a0fc2f808c6db1a.png"}}},"key":"UxPLbwqXCK"}],"key":"np1yfydfKu"}],"key":"kwaU0APMb7"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Facteurs de retrecissement Ridge","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"KwyG93FLbk"}],"identifier":"facteurs-de-retrecissement-ridge","label":"Facteurs de retrecissement Ridge","html_id":"facteurs-de-retrecissement-ridge","implicit":true,"key":"jF74OyxvMP"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"La solution Ridge s’ecrit:","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"yiEdGnmEOJ"}],"key":"Q7zzf0z75D"},{"type":"math","value":"\\hat{\\boldsymbol{\\theta}}_{\\text{ridge}} = \\sum_{j=1}^d \\underbrace{\\frac{d_j^2}{d_j^2 + \\lambda}}_{\\text{retrecissement}} \\cdot \\frac{\\mathbf{u}_j^\\top \\mathbf{y}}{d_j} \\cdot \\mathbf{v}_j","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><msub><mover accent=\"true\"><mi mathvariant=\"bold-italic\">θ</mi><mo>^</mo></mover><mtext>ridge</mtext></msub><mo>=</mo><munderover><mo>∑</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mi>d</mi></munderover><munder><munder><mfrac><msubsup><mi>d</mi><mi>j</mi><mn>2</mn></msubsup><mrow><msubsup><mi>d</mi><mi>j</mi><mn>2</mn></msubsup><mo>+</mo><mi>λ</mi></mrow></mfrac><mo stretchy=\"true\">⏟</mo></munder><mtext>retrecissement</mtext></munder><mo>⋅</mo><mfrac><mrow><msubsup><mi mathvariant=\"bold\">u</mi><mi>j</mi><mi mathvariant=\"normal\">⊤</mi></msubsup><mi mathvariant=\"bold\">y</mi></mrow><msub><mi>d</mi><mi>j</mi></msub></mfrac><mo>⋅</mo><msub><mi mathvariant=\"bold\">v</mi><mi>j</mi></msub></mrow><annotation encoding=\"application/x-tex\">\\hat{\\boldsymbol{\\theta}}_{\\text{ridge}} = \\sum_{j=1}^d \\underbrace{\\frac{d_j^2}{d_j^2 + \\lambda}}_{\\text{retrecissement}} \\cdot \\frac{\\mathbf{u}_j^\\top \\mathbf{y}}{d_j} \\cdot \\mathbf{v}_j</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.244em;vertical-align:-0.2861em;\"></span><span class=\"mord\"><span class=\"mord accent\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.9579em;\"><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord boldsymbol\" style=\"margin-right:0.03194em;\">θ</span></span></span></span><span style=\"top:-3.2634em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"accent-body\" style=\"left:-0.25em;\"><span class=\"mord\">^</span></span></span></span></span></span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord text mtight\"><span class=\"mord mtight\">ridge</span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:4.2506em;vertical-align:-2.4145em;\"></span><span class=\"mop op-limits\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.8361em;\"><span style=\"top:-1.8723em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span><span class=\"mrel mtight\">=</span><span class=\"mord mtight\">1</span></span></span></span><span style=\"top:-3.05em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span><span class=\"mop op-symbol large-op\">∑</span></span></span><span style=\"top:-4.3em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">d</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.4138em;\"><span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord munder\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.5989em;\"><span style=\"top:-1.1844em;\"><span class=\"pstrut\" style=\"height:3.5989em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord text mtight\"><span class=\"mord mtight\">retrecissement</span></span></span></span></span><span style=\"top:-3.5989em;\"><span class=\"pstrut\" style=\"height:3.5989em;\"></span><span class=\"mord munder\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.5989em;\"><span class=\"svg-align\" style=\"top:-1.8519em;\"><span class=\"pstrut\" style=\"height:3.5989em;\"></span><span class=\"stretchy\" style=\"height:0.548em;min-width:1.6em;\"><span class=\"brace-left\" style=\"height:0.548em;\"><svg xmlns=\"http://www.w3.org/2000/svg\" width='400em' height='0.548em' viewBox='0 0 400000 548' preserveAspectRatio='xMinYMin slice'><path d='M0 6l6-6h17c12.688 0 19.313.3 20 1 4 4 7.313 8.3 10 13\n 35.313 51.3 80.813 93.8 136.5 127.5 55.688 33.7 117.188 55.8 184.5 66.5.688\n 0 2 .3 4 1 18.688 2.7 76 4.3 172 5h399450v120H429l-6-1c-124.688-8-235-61.7\n-331-161C60.687 138.7 32.312 99.3 7 54L0 41V6z'/></svg></span><span class=\"brace-center\" style=\"height:0.548em;\"><svg xmlns=\"http://www.w3.org/2000/svg\" width='400em' height='0.548em' viewBox='0 0 400000 548' preserveAspectRatio='xMidYMin slice'><path d='M199572 214\nc100.7 8.3 195.3 44 280 108 55.3 42 101.7 93 139 153l9 14c2.7-4 5.7-8.7 9-14\n 53.3-86.7 123.7-153 211-199 66.7-36 137.3-56.3 212-62h199568v120H200432c-178.3\n 11.7-311.7 78.3-403 201-6 8-9.7 12-11 12-.7.7-6.7 1-18 1s-17.3-.3-18-1c-1.3 0\n-5-4-11-12-44.7-59.3-101.3-106.3-170-141s-145.3-54.3-229-60H0V214z'/></svg></span><span class=\"brace-right\" style=\"height:0.548em;\"><svg xmlns=\"http://www.w3.org/2000/svg\" width='400em' height='0.548em' viewBox='0 0 400000 548' preserveAspectRatio='xMaxYMin slice'><path d='M399994 0l6 6v35l-6 11c-56 104-135.3 181.3-238 232-57.3\n 28.7-117 45-179 50H-300V214h399897c43.3-7 81-15 113-26 100.7-33 179.7-91 237\n-174 2.7-5 6-9 10-13 .7-1 7.3-1 20-1h17z'/></svg></span></span></span><span style=\"top:-3.5989em;\"><span class=\"pstrut\" style=\"height:3.5989em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.5989em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\">d</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7959em;\"><span style=\"top:-2.4231em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span><span style=\"top:-3.0448em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.413em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord mathnormal\">λ</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.7848em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\">d</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-2.4413em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3948em;\"><span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.099em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.747em;\"><span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.4145em;\"><span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">⋅</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.606em;vertical-align:-0.9721em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.6339em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\">d</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.7848em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathbf\">u</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8491em;\"><span style=\"top:-2.4413em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">⊤</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3948em;\"><span></span></span></span></span></span></span><span class=\"mord mathbf\" style=\"margin-right:0.01597em;\">y</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.9721em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">⋅</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7305em;vertical-align:-0.2861em;\"></span><span class=\"mord\"><span class=\"mord mathbf\" style=\"margin-right:0.01597em;\">v</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.016em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span></span></span></span></span>","enumerator":"5","key":"mi572OXfpw"},{"type":"paragraph","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"Le facteur ","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"XyKGqIzluD"},{"type":"inlineMath","value":"\\frac{d_j^2}{d_j^2 + \\lambda}","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mfrac><msubsup><mi>d</mi><mi>j</mi><mn>2</mn></msubsup><mrow><msubsup><mi>d</mi><mi>j</mi><mn>2</mn></msubsup><mo>+</mo><mi>λ</mi></mrow></mfrac></mrow><annotation encoding=\"application/x-tex\">\\frac{d_j^2}{d_j^2 + \\lambda}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.9277em;vertical-align:-0.6964em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.2313em;\"><span style=\"top:-2.6264em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">d</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8051em;\"><span style=\"top:-2.1777em;margin-left:0em;margin-right:0.0714em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span><span style=\"top:-2.8448em;margin-right:0.0714em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.4612em;\"><span></span></span></span></span></span></span><span class=\"mbin mtight\">+</span><span class=\"mord mathnormal mtight\">λ</span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.6074em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">d</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8913em;\"><span style=\"top:-2.214em;margin-left:0em;margin-right:0.0714em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span><span style=\"top:-2.931em;margin-right:0.0714em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.4249em;\"><span></span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6964em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span>","key":"LZmJI2RsdG"},{"type":"text","value":" est toujours < 1, et il est ","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"eZK4whOBXq"},{"type":"strong","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"plus petit pour les directions faibles","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"wHYRfH7W7J"}],"key":"VjP4drng6e"},{"type":"text","value":" (petit ","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"a8tjXcShpE"},{"type":"inlineMath","value":"d_j","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>d</mi><mi>j</mi></msub></mrow><annotation encoding=\"application/x-tex\">d_j</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.9805em;vertical-align:-0.2861em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">d</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span></span></span></span>","key":"qvuyHbB9Py"},{"type":"text","value":").","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"kMeeSzvN1X"}],"key":"gX6ODkoRw6"}],"key":"Dq4WK8VXJX"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Visualiser les facteurs de retrecissement\nlambdas = [0.01, 0.1, 1, 10]\nd_values = np.array([s[0], s[1]])  # Nos deux valeurs singulieres\n\nfig, ax = plt.subplots(figsize=(10, 5))\n\nx_pos = np.arange(len(d_values))\nwidth = 0.2\n\nfor i, lam in enumerate(lambdas):\n    shrinkage = d_values**2 / (d_values**2 + lam)\n    bars = ax.bar(x_pos + i * width, shrinkage, width, label=f'$\\\\lambda$ = {lam}', alpha=0.8)\n\nax.set_xticks(x_pos + width * 1.5)\nax.set_xticklabels([f'$d_1$ = {s[0]:.1f}\\n(forte)', f'$d_2$ = {s[1]:.1f}\\n(faible)'])\nax.set_ylabel('Facteur de retrecissement $d_j^2 / (d_j^2 + \\\\lambda)$')\nax.set_title('Ridge retrecit plus les directions faibles')\nax.legend()\nax.set_ylim(0, 1.1)\nax.axhline(1, color='gray', linestyle='--', alpha=0.5, label='MCO (pas de retrecissement)')\nax.grid(True, alpha=0.3, axis='y')\n\nplt.tight_layout()\nplt.show()\n\nprint(\"\\nObservation: La direction faible (d2) est beaucoup plus retrecit que la direction forte (d1).\")\nprint(\"C'est exactement ce qu'on veut: reduire l'incertitude la ou elle est grande.\")","key":"gKKuEOhnGH"},{"type":"outputs","id":"Kp8UtO41puOMtdePoTXrI","children":[{"type":"output","children":[],"jupyter_data":{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"<Figure size 1000x500 with 1 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"d78535e476c18adfd7d74d290e5ce8ec","path":"/mlbook/build/d78535e476c18adfd7d74d290e5ce8ec.png"}}},"key":"uquHMMpbNS"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"\nObservation: La direction faible (d2) est beaucoup plus retrecit que la direction forte (d1).\nC'est exactement ce qu'on veut: reduire l'incertitude la ou elle est grande.\n"},"key":"SVFi0KadxC"}],"key":"fKqhqLuQM0"}],"key":"NKQTJ5dGtR"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Question","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"YXxEVraCPh"}],"key":"J6okwmm7IG"},{"type":"text","value":": Pourquoi diviser par une petite valeur singuliere ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"v4EjTB2Lzd"},{"type":"inlineMath","value":"d_j","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>d</mi><mi>j</mi></msub></mrow><annotation encoding=\"application/x-tex\">d_j</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.9805em;vertical-align:-0.2861em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">d</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span></span></span></span>","key":"tfNyFDZ0lf"},{"type":"text","value":" amplifie-t-il le bruit dans MCO?","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ZGbN9paNAt"}],"key":"FHJpb7zpYa"}],"key":"TeXGp4FKbI"},{"type":"block","kind":"notebook-content","children":[{"type":"thematicBreak","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"gQ87OonHsC"},{"type":"heading","depth":2,"position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"Partie 6: ERM comme integration de Monte Carlo","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"bqIrcxkaFR"}],"identifier":"partie-6-erm-comme-integration-de-monte-carlo","label":"Partie 6: ERM comme integration de Monte Carlo","html_id":"partie-6-erm-comme-integration-de-monte-carlo","implicit":true,"key":"x7P6cKNOPp"},{"type":"paragraph","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"Le ","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"BS8huVM0bq"},{"type":"strong","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"risque","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"WIf8Nm8wvl"}],"key":"su7lHrDBAs"},{"type":"text","value":" mesure la performance moyenne sur toutes les donnees possibles:","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"MafXVqOTW8"}],"key":"ZqbpJiHvb2"},{"type":"math","value":"\\mathcal{R}(f) = \\mathbb{E}_{(\\mathbf{X},Y) \\sim p}[\\ell(Y, f(\\mathbf{X}))] = \\int \\ell(y, f(\\mathbf{x})) \\, p(\\mathbf{x}, y) \\, d\\mathbf{x} \\, dy","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi mathvariant=\"script\">R</mi><mo stretchy=\"false\">(</mo><mi>f</mi><mo stretchy=\"false\">)</mo><mo>=</mo><msub><mi mathvariant=\"double-struck\">E</mi><mrow><mo stretchy=\"false\">(</mo><mi mathvariant=\"bold\">X</mi><mo separator=\"true\">,</mo><mi>Y</mi><mo stretchy=\"false\">)</mo><mo>∼</mo><mi>p</mi></mrow></msub><mo stretchy=\"false\">[</mo><mi mathvariant=\"normal\">ℓ</mi><mo stretchy=\"false\">(</mo><mi>Y</mi><mo separator=\"true\">,</mo><mi>f</mi><mo stretchy=\"false\">(</mo><mi mathvariant=\"bold\">X</mi><mo stretchy=\"false\">)</mo><mo stretchy=\"false\">)</mo><mo stretchy=\"false\">]</mo><mo>=</mo><mo>∫</mo><mi mathvariant=\"normal\">ℓ</mi><mo stretchy=\"false\">(</mo><mi>y</mi><mo separator=\"true\">,</mo><mi>f</mi><mo stretchy=\"false\">(</mo><mi mathvariant=\"bold\">x</mi><mo stretchy=\"false\">)</mo><mo stretchy=\"false\">)</mo><mtext> </mtext><mi>p</mi><mo stretchy=\"false\">(</mo><mi mathvariant=\"bold\">x</mi><mo separator=\"true\">,</mo><mi>y</mi><mo stretchy=\"false\">)</mo><mtext> </mtext><mi>d</mi><mi mathvariant=\"bold\">x</mi><mtext> </mtext><mi>d</mi><mi>y</mi></mrow><annotation encoding=\"application/x-tex\">\\mathcal{R}(f) = \\mathbb{E}_{(\\mathbf{X},Y) \\sim p}[\\ell(Y, f(\\mathbf{X}))] = \\int \\ell(y, f(\\mathbf{x})) \\, p(\\mathbf{x}, y) \\, d\\mathbf{x} \\, dy</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathcal\">R</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.1052em;vertical-align:-0.3552em;\"></span><span class=\"mord\"><span class=\"mord mathbb\">E</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3448em;\"><span style=\"top:-2.5198em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mopen mtight\">(</span><span class=\"mord mathbf mtight\">X</span><span class=\"mpunct mtight\">,</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.22222em;\">Y</span><span class=\"mclose mtight\">)</span><span class=\"mrel mtight\">∼</span><span class=\"mord mathnormal mtight\">p</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3552em;\"><span></span></span></span></span></span></span><span class=\"mopen\">[</span><span class=\"mord\">ℓ</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.22222em;\">Y</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mopen\">(</span><span class=\"mord mathbf\">X</span><span class=\"mclose\">))]</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.2222em;vertical-align:-0.8622em;\"></span><span class=\"mop op-symbol large-op\" style=\"margin-right:0.44445em;position:relative;top:-0.0011em;\">∫</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">ℓ</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mopen\">(</span><span class=\"mord mathbf\">x</span><span class=\"mclose\">))</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">p</span><span class=\"mopen\">(</span><span class=\"mord mathbf\">x</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">d</span><span class=\"mord mathbf\">x</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">d</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span></span></span></span></span>","enumerator":"6","key":"aCasdw8ZDK"},{"type":"paragraph","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"Probleme: cette integrale est ","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"oaeoBakZgK"},{"type":"strong","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"impossible a calculer","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"tCZch62XT5"}],"key":"cSBIZFq3Yy"},{"type":"text","value":" car:","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"VuE7psopmj"}],"key":"QbiSJ0J0ZB"},{"type":"list","ordered":true,"start":1,"spread":false,"position":{"start":{"line":9,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"On ne connait pas ","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"eHwVQ223ox"},{"type":"inlineMath","value":"p(\\mathbf{x}, y)","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>p</mi><mo stretchy=\"false\">(</mo><mi mathvariant=\"bold\">x</mi><mo separator=\"true\">,</mo><mi>y</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">p(\\mathbf{x}, y)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">p</span><span class=\"mopen\">(</span><span class=\"mord mathbf\">x</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mclose\">)</span></span></span></span>","key":"ziqkiLGDz1"}],"key":"XyjRYz33Zo"}],"key":"hH64ke7mdn"},{"type":"listItem","spread":true,"position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Meme si on la connaissait, l’integrale en haute dimension est intractable","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"TZqqvSuzYO"}],"key":"NfTqBgM832"}],"key":"IBI5DBIYKg"}],"key":"z7xeDk2dDr"}],"key":"xDnzxy8dUw"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# La malediction de la dimensionnalite pour l'integration numerique\ndimensions = [1, 2, 3, 5, 10, 20, 50, 100]\npoints_per_dim = 10  # 10 points par dimension pour une grille\n\n# On trace log10 du nombre de points (evite les overflows)\nlog_grid_points = [d for d in dimensions]  # log10(10^d) = d\n\nfig, ax = plt.subplots(figsize=(10, 5))\n\ncolors = plt.cm.Reds(np.linspace(0.3, 0.9, len(dimensions)))\nbars = ax.bar(range(len(dimensions)), log_grid_points, color=colors)\n\nax.set_xticks(range(len(dimensions)))\nax.set_xticklabels([f'd={d}' for d in dimensions])\nax.set_xlabel('Dimension')\nax.set_ylabel('$\\\\log_{10}$(nombre de points)')\nax.set_title('Integration numerique: explosion combinatoire')\n\n# Annotations\nax.axhline(10, color='blue', linestyle='--', alpha=0.7)\nax.text(0.5, 11, '10 milliards ($10^{10}$, limite pratique)', color='blue', fontsize=10)\n\nax.axhline(80, color='red', linestyle='--', alpha=0.7)\nax.text(4, 82, 'Atomes dans l\\'univers (~$10^{80}$)', color='red', fontsize=10)\n\nplt.tight_layout()\nplt.show()\n\nprint(f\"\\nAvec seulement 10 points par dimension:\")\nprint(f\"  d=10: 10^10 = 10 milliards de points\")\nprint(f\"  d=100: 10^100 points (impossible!)\")","key":"gbcqgJTadY"},{"type":"outputs","id":"bMJ4A0qxr8nDIa1qkX4ve","children":[{"type":"output","children":[],"jupyter_data":{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"<Figure size 1000x500 with 1 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"ba639440d3b24e970f4104ed8ce9c5a2","path":"/mlbook/build/ba639440d3b24e970f4104ed8ce9c5a2.png"}}},"key":"kxXmPr3yPE"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"\nAvec seulement 10 points par dimension:\n  d=10: 10^10 = 10 milliards de points\n  d=100: 10^100 points (impossible!)\n"},"key":"iYl8blMhNq"}],"key":"gQsbpWEbES"}],"key":"ZFdEDcisvN"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"La solution: Monte Carlo","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"gMBbb51ugw"}],"identifier":"la-solution-monte-carlo","label":"La solution: Monte Carlo","html_id":"la-solution-monte-carlo","implicit":true,"key":"KP6lE0UQ3M"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Le ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"onae0f6t1l"},{"type":"strong","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"risque empirique","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"ojl0zTRl0d"}],"key":"DwRxEBKbbR"},{"type":"text","value":" est une estimation Monte Carlo du vrai risque:","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"dFsozTQ9SD"}],"key":"mmPZW0LXc3"},{"type":"math","value":"\\hat{\\mathcal{R}}(f) = \\frac{1}{N} \\sum_{i=1}^{N} \\ell(y_i, f(\\mathbf{x}_i))","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mover accent=\"true\"><mi mathvariant=\"script\">R</mi><mo>^</mo></mover><mo stretchy=\"false\">(</mo><mi>f</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mfrac><mn>1</mn><mi>N</mi></mfrac><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></munderover><mi mathvariant=\"normal\">ℓ</mi><mo stretchy=\"false\">(</mo><msub><mi>y</mi><mi>i</mi></msub><mo separator=\"true\">,</mo><mi>f</mi><mo stretchy=\"false\">(</mo><msub><mi mathvariant=\"bold\">x</mi><mi>i</mi></msub><mo stretchy=\"false\">)</mo><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">\\hat{\\mathcal{R}}(f) = \\frac{1}{N} \\sum_{i=1}^{N} \\ell(y_i, f(\\mathbf{x}_i))</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.1968em;vertical-align:-0.25em;\"></span><span class=\"mord accent\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.9468em;\"><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord mathcal\">R</span></span><span style=\"top:-3.2523em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"accent-body\" style=\"left:-0.1667em;\"><span class=\"mord\">^</span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:3.106em;vertical-align:-1.2777em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3214em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mop op-limits\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.8283em;\"><span style=\"top:-1.8723em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mrel mtight\">=</span><span class=\"mord mtight\">1</span></span></span></span><span style=\"top:-3.05em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span><span class=\"mop op-symbol large-op\">∑</span></span></span><span style=\"top:-4.3em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.10903em;\">N</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.2777em;\"><span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">ℓ</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathbf\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">))</span></span></span></span></span>","enumerator":"7","key":"FNDEouTIQY"},{"type":"table","position":{"start":{"line":7,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"tableRow","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"tableCell","header":true,"position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"Methode","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"Y79L1K11BC"}],"key":"poeO727zYW"},{"type":"tableCell","header":true,"position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"Complexite","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"dPCkqcy2pe"}],"key":"lmETgOu0rW"},{"type":"tableCell","header":true,"position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"Exigence","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"yquRH1xaDZ"}],"key":"F9THK25u0G"}],"key":"xgIKbg02Xu"},{"type":"tableRow","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"Quadrature","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"iVWtLL9IPN"}],"key":"CsMg3v36lS"},{"type":"tableCell","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"inlineMath","value":"O(M^d)","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mo stretchy=\"false\">(</mo><msup><mi>M</mi><mi>d</mi></msup><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">O(M^d)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0991em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">M</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8491em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">d</span></span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span>","key":"lra89wIcKj"}],"key":"oWVmFAcXwC"},{"type":"tableCell","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"Connaitre ","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"pK5TyxuvoG"},{"type":"inlineMath","value":"p(\\mathbf{x},y)","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>p</mi><mo stretchy=\"false\">(</mo><mi mathvariant=\"bold\">x</mi><mo separator=\"true\">,</mo><mi>y</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">p(\\mathbf{x},y)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">p</span><span class=\"mopen\">(</span><span class=\"mord mathbf\">x</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mclose\">)</span></span></span></span>","key":"X6sb4KHPgr"}],"key":"lToVVVGGhp"}],"key":"gHPVqgHYZw"},{"type":"tableRow","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"strong","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"text","value":"Monte Carlo","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"LB2IyHXnAZ"}],"key":"ywp9I0Lgo2"}],"key":"PO9pLFuJT6"},{"type":"tableCell","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"inlineMath","value":"O(N)","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mo stretchy=\"false\">(</mo><mi>N</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">O(N)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"mclose\">)</span></span></span></span>","key":"hmAzqXWTTd"}],"key":"KOW2kCJDbh"},{"type":"tableCell","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"text","value":"Avoir des echantillons","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"sC1CesyyUE"}],"key":"Xho9EDUJIX"}],"key":"jtMhmod4cv"}],"key":"q7kdYXGHeg"},{"type":"paragraph","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"text","value":"La complexite Monte Carlo est ","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"S0Q7G4zqBD"},{"type":"strong","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"text","value":"independante de la dimension","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"X8S9OvRMhx"}],"key":"M0xr4t73QS"},{"type":"text","value":"!","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"RBWdNFBeyd"}],"key":"RF5bNwLid7"}],"key":"kHNeLok7nq"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Demonstration: Monte Carlo converge independamment de d\ndef true_integral_1d():\n    \"\"\"Integrale de x^2 sur [0,1] = 1/3\"\"\"\n    return 1/3\n\ndef monte_carlo_estimate(n_samples, dim=1):\n    \"\"\"Estime E[||x||^2/d] pour x uniforme sur [0,1]^d\"\"\"\n    # Pour x uniforme sur [0,1]^d, E[x_i^2] = 1/3 pour chaque composante\n    # Donc E[||x||^2/d] = 1/3\n    samples = np.random.uniform(0, 1, (n_samples, dim))\n    return np.mean(np.sum(samples**2, axis=1) / dim)\n\n# Comparer convergence pour differentes dimensions\nnp.random.seed(42)\nn_values = [10, 50, 100, 500, 1000, 5000]\ndims = [1, 10, 100]\n\nfig, ax = plt.subplots(figsize=(10, 5))\n\ntrue_value = 1/3\n\nfor dim in dims:\n    errors = []\n    for n in n_values:\n        estimates = [monte_carlo_estimate(n, dim) for _ in range(50)]  # 50 repetitions\n        errors.append(np.std(estimates))\n    ax.loglog(n_values, errors, 'o-', label=f'd = {dim}', markersize=8)\n\n# Ligne de reference: 1/sqrt(N)\nn_ref = np.array(n_values)\nax.loglog(n_ref, 0.5 / np.sqrt(n_ref), 'k--', alpha=0.5, label='$1/\\\\sqrt{N}$')\n\nax.set_xlabel('Nombre d\\'echantillons N')\nax.set_ylabel('Ecart-type de l\\'estimation')\nax.set_title('Convergence Monte Carlo: independante de la dimension!')\nax.legend()\nax.grid(True, alpha=0.3)\n\nplt.tight_layout()\nplt.show()\n\nprint(\"\\nObservation: Les trois courbes se superposent!\")\nprint(\"La precision Monte Carlo depend de N, pas de d.\")","key":"iEMwc7OLuE"},{"type":"outputs","id":"w1vAHv_rRTKmoF8IBpPPG","children":[{"type":"output","children":[],"jupyter_data":{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"<Figure size 1000x500 with 1 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"aac517feb3a47506cd97eb7099f71f7c","path":"/mlbook/build/aac517feb3a47506cd97eb7099f71f7c.png"}}},"key":"B02OysNdis"},{"type":"output","children":[],"jupyter_data":{"output_type":"stream","name":"stdout","text":"\nObservation: Les trois courbes se superposent!\nLa precision Monte Carlo depend de N, pas de d.\n"},"key":"pGWW3rIbrN"}],"key":"xkuZt4RCrn"}],"key":"KbxHFWv6qY"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Question","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"CjkswtmHAS"}],"key":"z7codihZzE"},{"type":"text","value":": Pourquoi la complexite Monte Carlo est-elle ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"mFoDCZIyr6"},{"type":"inlineMath","value":"O(N)","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mo stretchy=\"false\">(</mo><mi>N</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">O(N)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"mclose\">)</span></span></span></span>","key":"LjYnqz7lZG"},{"type":"text","value":" independamment de la dimension ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"sjgi527DGh"},{"type":"inlineMath","value":"d","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>d</mi></mrow><annotation encoding=\"application/x-tex\">d</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\">d</span></span></span></span>","key":"MsWqfVRq26"},{"type":"text","value":"?","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"oRk7op5ovA"}],"key":"EUDbyTz8QD"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"strong","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Reponse a reflechir","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"asdkmeqok8"}],"key":"ysCFr3Ol1q"},{"type":"text","value":": Parce que chaque echantillon ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"XkWtrMEsx2"},{"type":"inlineMath","value":"(\\mathbf{x}_i, y_i)","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">(</mo><msub><mi mathvariant=\"bold\">x</mi><mi>i</mi></msub><mo separator=\"true\">,</mo><msub><mi>y</mi><mi>i</mi></msub><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">(\\mathbf{x}_i, y_i)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathbf\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span>","key":"ft1Jsc7hlS"},{"type":"text","value":" contribue une evaluation de la perte, peu importe la dimension de ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"csvloo1OnB"},{"type":"inlineMath","value":"\\mathbf{x}_i","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi mathvariant=\"bold\">x</mi><mi>i</mi></msub></mrow><annotation encoding=\"application/x-tex\">\\mathbf{x}_i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5944em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"JXw4Yvooyw"},{"type":"text","value":". On ne discretise pas l’espace; on utilise les echantillons tels quels.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"RwCM4CNe6Q"}],"key":"Emo3NHdXox"}],"key":"WJYzibpvkF"},{"type":"block","kind":"notebook-content","children":[{"type":"thematicBreak","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ZcCzTC2mXJ"},{"type":"heading","depth":2,"position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"Recapitulatif","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"o2DK2qS2vM"}],"identifier":"recapitulatif","label":"Recapitulatif","html_id":"recapitulatif","implicit":true,"key":"muuQTw8iZ3"},{"type":"paragraph","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"Dans ce TP, vous avez appris:","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"AV7sezcVsn"}],"key":"iybrNuEDg6"},{"type":"list","ordered":true,"start":1,"spread":false,"position":{"start":{"line":6,"column":1},"end":{"line":22,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":6,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"strong","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"MSE","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"xS5HEtAd0B"}],"key":"aF6XxyCy53"},{"type":"text","value":": L’erreur quadratique moyenne mesure la qualite des predictions","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"CBGQ7j3FaA"}],"key":"OXuKtm2sLi"}],"key":"hesxqGgwSw"},{"type":"listItem","spread":true,"position":{"start":{"line":8,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"strong","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"Surapprentissage","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"JZibbZtFMD"}],"key":"JvcxShda5Y"},{"type":"text","value":": Un modele trop complexe memorise le bruit","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"brutHsVo4d"}],"key":"l0Hw2Kxakq"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":9,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":9,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Erreur train diminue mais erreur test augmente","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"RdCmco4PEh"}],"key":"INmcKdPP8z"}],"key":"r5Fkd9CB2S"}],"key":"PYLcNEG5u6"}],"key":"b6R6ooPOpy"},{"type":"listItem","spread":true,"position":{"start":{"line":11,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"strong","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"Compromis biais-variance","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"VLJddfidEv"}],"key":"mkSKZqWBoX"},{"type":"text","value":":","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"NsiLHHTngR"}],"key":"fBUPVCedk1"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":12,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Modele simple = biais eleve (sous-apprentissage)","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"kmyj6VHD5q"}],"key":"l40RF0fdwE"}],"key":"qB3nfu03Vm"},{"type":"listItem","spread":true,"position":{"start":{"line":13,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Modele complexe = variance elevee (surapprentissage)","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"lrs0sJtI67"}],"key":"wgG0lwxaHT"}],"key":"Im9T3wZrH4"}],"key":"YIkSidWra1"}],"key":"RNnajC25jF"},{"type":"listItem","spread":true,"position":{"start":{"line":15,"column":1},"end":{"line":18,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"strong","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"text","value":"Regularisation Ridge","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"MvCuf249RI"}],"key":"NZm7S0kSNz"},{"type":"text","value":": Penalise les grands coefficients","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"kXkE0geV7r"}],"key":"fnH8EyguJZ"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":16,"column":1},"end":{"line":18,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Permet d’utiliser des modeles complexes sans surapprentissage","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"GXmHZKBUgM"}],"key":"WztY9XYyM7"}],"key":"WuAwFDUlvy"},{"type":"listItem","spread":true,"position":{"start":{"line":17,"column":1},"end":{"line":18,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Lambda controle la force de la regularisation","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"kOKtzTyRa9"}],"key":"afMIrdbD4e"}],"key":"KPie8M5JGd"}],"key":"yqVGabPYyn"}],"key":"KbnmsoD1HI"},{"type":"listItem","spread":true,"position":{"start":{"line":19,"column":1},"end":{"line":20,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"children":[{"type":"strong","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"children":[{"type":"text","value":"SVD et Ridge","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"ZYfyYxCKZv"}],"key":"OTQneNTzey"},{"type":"text","value":": Ridge retrecit plus les directions faibles (petites valeurs singulieres)","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"kKnd66QrOl"}],"key":"THiodUyJ9b"}],"key":"QOJqw6yp6Y"},{"type":"listItem","spread":true,"position":{"start":{"line":21,"column":1},"end":{"line":22,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"children":[{"type":"strong","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"children":[{"type":"text","value":"ERM = Monte Carlo","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"key":"WpdkeDnVaX"}],"key":"MHgoFao76G"},{"type":"text","value":": Le risque empirique est une estimation Monte Carlo du vrai risque, avec complexite independante de la dimension","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"key":"nVkeFPJKqE"}],"key":"oaiZgzoxRh"}],"key":"DMy4ionDFU"}],"key":"fv4kxveMuz"},{"type":"thematicBreak","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"key":"rpI5C6hlgm"},{"type":"paragraph","position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"children":[{"type":"strong","position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"children":[{"type":"text","value":"Pour aller plus loin","position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"key":"t2LWe0S9Aw"}],"key":"gtIeTvS7hX"},{"type":"text","value":": ","position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"key":"rviuSuTgoh"},{"type":"link","url":"https://pierrelux.github.io/mlbook/learning-problem","position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"children":[{"type":"text","value":"Chapitre complet sur le site du cours","position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"key":"w6AbcTvG3O"}],"urlSource":"https://pierrelux.github.io/mlbook/learning-problem","key":"ER1q0Gdbg3"}],"key":"s2ZAaB13Dt"}],"key":"ymBzhIK2GO"}],"key":"Pct1Fw4mUk"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"TP0: Les k plus proches voisins","url":"/tp0-knn","group":"Travaux Pratiques"}}},"domain":"http://localhost:3001"}