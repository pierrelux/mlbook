{"version":3,"kind":"Notebook","sha256":"b72bff2999dfadcc9bf34f13408e7fb2aa5d78033704d40804f4b76c0417cff8","slug":"knn","location":"/drafts/knn.md","dependencies":[],"frontmatter":{"title":"K plus proches voisins","kernelspec":{"name":"python3","display_name":"Python 3"},"content_includes_title":false,"authors":[{"nameParsed":{"literal":"Pierre-Luc Bacon","given":"Pierre-Luc","family":"Bacon"},"name":"Pierre-Luc Bacon","id":"contributors-myst-generated-uid-0"}],"github":"https://github.com/pierrelux/mlbook","math":{"\\E":{"macro":"\\mathbb{E}"},"\\Var":{"macro":"\\mathrm{Var}"},"\\Cov":{"macro":"\\mathrm{Cov}"},"\\Prob":{"macro":"\\mathbb{P}"},"\\R":{"macro":"\\mathbb{R}"},"\\N":{"macro":"\\mathbb{N}"},"\\Loss":{"macro":"\\mathcal{L}"},"\\Risk":{"macro":"\\mathcal{R}"},"\\Hypothesis":{"macro":"\\mathcal{H}"},"\\Data":{"macro":"\\mathcal{D}"},"\\indicator":{"macro":"\\mathbb{1}"},"\\defeq":{"macro":"\\triangleq"},"\\mathds":{"macro":"\\mathbb"},"\\hdots":{"macro":"\\cdots"}},"source_url":"https://github.com/pierrelux/mlbook/blob/main/drafts/knn.md","edit_url":"https://github.com/pierrelux/mlbook/edit/main/drafts/knn.md","exports":[{"format":"md","filename":"knn.md","url":"/mlbook/build/knn-fcc2ecdbc0889593edf55b716df7f0f1.md"}]},"mdast":{"type":"root","children":[{"type":"block","children":[{"type":"admonition","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Objectifs d’apprentissage","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"ubJDDRgvqh"}],"key":"CTyU5L7PCo"},{"type":"paragraph","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"text","value":"À la fin de ce chapitre, vous serez en mesure de:","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"kShIJ7lCag"}],"key":"nlAF6ZRpbL"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":13,"column":1},"end":{"line":17,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Expliquer le fonctionnement de l’algorithme des k plus proches voisins","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"yz7rOWtDNV"}],"key":"l4MzJBy8nZ"}],"key":"ggZuhppiCH"},{"type":"listItem","spread":true,"position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Définir et appliquer différentes fonctions de distance","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"tb0kwsvfMN"}],"key":"PslKoFuepR"}],"key":"KIIrizWkjF"},{"type":"listItem","spread":true,"position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Analyser l’effet du paramètre k sur le compromis biais-variance","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"mw5Xp8t3K0"}],"key":"ZtOPHxWNRf"}],"key":"tmXvzVgSgA"},{"type":"listItem","spread":true,"position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Expliquer le fléau de la dimensionnalité et ses conséquences","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"ds8CERsHCw"}],"key":"RSNm1p0DOv"}],"key":"neZRmZM9Ny"},{"type":"listItem","spread":true,"position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Implémenter l’algorithme k-ppv pour la classification et la régression","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"NRhMOb8ypB"}],"key":"Pzz0B4zxz2"}],"key":"SuhhHzTnry"}],"key":"X30bZ7jaAc"}],"class":"note","key":"iuIfzRtyqh"},{"type":"heading","depth":2,"position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"children":[{"type":"text","value":"L’idée de base","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"key":"g9kP9og8TX"}],"identifier":"lid-e-de-base","label":"L’idée de base","html_id":"lid-e-de-base","implicit":true,"key":"dN2lM5EDMf"},{"type":"paragraph","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"children":[{"type":"text","value":"Soit ","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"key":"lKDubgFs3l"},{"type":"inlineMath","value":"\\mathcal{D} = \\{(x_i, y_i)\\}_{i=1}^N","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"script\">D</mi><mo>=</mo><mo stretchy=\"false\">{</mo><mo stretchy=\"false\">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo separator=\"true\">,</mo><msub><mi>y</mi><mi>i</mi></msub><mo stretchy=\"false\">)</mo><msubsup><mo stretchy=\"false\">}</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></msubsup></mrow><annotation encoding=\"application/x-tex\">\\mathcal{D} = \\{(x_i, y_i)\\}_{i=1}^N</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathcal\" style=\"margin-right:0.02778em;\">D</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.1em;vertical-align:-0.2587em;\"></span><span class=\"mopen\">{(</span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span><span class=\"mclose\"><span class=\"mclose\">}</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8413em;\"><span style=\"top:-2.4413em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mrel mtight\">=</span><span class=\"mord mtight\">1</span></span></span></span><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.10903em;\">N</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2587em;\"><span></span></span></span></span></span></span></span></span></span>","key":"ZEZoe7v7nG"},{"type":"text","value":" un ensemble d’entraînement avec ","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"key":"z7QDvm0VHq"},{"type":"inlineMath","value":"x_i \\in \\mathbb{R}^d","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>x</mi><mi>i</mi></msub><mo>∈</mo><msup><mi mathvariant=\"double-struck\">R</mi><mi>d</mi></msup></mrow><annotation encoding=\"application/x-tex\">x_i \\in \\mathbb{R}^d</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6891em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">∈</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8491em;\"></span><span class=\"mord\"><span class=\"mord mathbb\">R</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8491em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">d</span></span></span></span></span></span></span></span></span></span></span>","key":"X6wacyEO1W"},{"type":"text","value":" et ","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"key":"xj4TxGjBoV"},{"type":"inlineMath","value":"y_i \\in \\{1, \\ldots, C\\}","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>y</mi><mi>i</mi></msub><mo>∈</mo><mo stretchy=\"false\">{</mo><mn>1</mn><mo separator=\"true\">,</mo><mo>…</mo><mo separator=\"true\">,</mo><mi>C</mi><mo stretchy=\"false\">}</mo></mrow><annotation encoding=\"application/x-tex\">y_i \\in \\{1, \\ldots, C\\}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7335em;vertical-align:-0.1944em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">∈</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">{</span><span class=\"mord\">1</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"minner\">…</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">C</span><span class=\"mclose\">}</span></span></span></span>","key":"sYbzJkyK3O"},{"type":"text","value":". Nous voulons prédire l’étiquette d’un nouveau point ","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"key":"qtk6wIqiBJ"},{"type":"inlineMath","value":"x","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi></mrow><annotation encoding=\"application/x-tex\">x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span></span></span></span>","key":"VDlLuF3raw"},{"type":"text","value":". L’approche la plus simple consiste à regarder les exemples connus qui ressemblent à ","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"key":"BmPk05msEs"},{"type":"inlineMath","value":"x","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi></mrow><annotation encoding=\"application/x-tex\">x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span></span></span></span>","key":"CSWTc0fiN5"},{"type":"text","value":" et à prédire la même chose.","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"key":"CIhwZupsGs"}],"key":"XUHpOBgj2G"},{"type":"paragraph","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"children":[{"type":"text","value":"Les k plus proches voisins (k-ppv) formalisent cette intuition. Pour classifier ","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"key":"GPT9jS7u5R"},{"type":"inlineMath","value":"x","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi></mrow><annotation encoding=\"application/x-tex\">x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span></span></span></span>","key":"oHQkd6kFuS"},{"type":"text","value":", nous identifions les ","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"key":"ByHOgr5DUx"},{"type":"inlineMath","value":"k","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>k</mi></mrow><annotation encoding=\"application/x-tex\">k</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span></span></span></span>","key":"FCQfT2Dxs6"},{"type":"text","value":" points de ","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"key":"MdP4dZ1wrG"},{"type":"inlineMath","value":"\\mathcal{D}","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"script\">D</mi></mrow><annotation encoding=\"application/x-tex\">\\mathcal{D}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathcal\" style=\"margin-right:0.02778em;\">D</span></span></span></span>","key":"PnL7pmZaWL"},{"type":"text","value":" les plus proches de ","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"key":"s0tNpYqW2Y"},{"type":"inlineMath","value":"x","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi></mrow><annotation encoding=\"application/x-tex\">x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span></span></span></span>","key":"mSryHHuI9n"},{"type":"text","value":" et prenons un vote majoritaire sur leurs étiquettes. La méthode ne fait aucune hypothèse sur la forme de la relation entre ","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"key":"lySu7tOmKP"},{"type":"inlineMath","value":"x","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi></mrow><annotation encoding=\"application/x-tex\">x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span></span></span></span>","key":"abXVjtNzYs"},{"type":"text","value":" et ","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"key":"dISl0zUkwh"},{"type":"inlineMath","value":"y","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>y</mi></mrow><annotation encoding=\"application/x-tex\">y</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span></span></span></span>","key":"rUjK6RYeTA"},{"type":"text","value":". Elle se contente de consulter les données au moment de la prédiction.","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"key":"onDBjjm12g"}],"key":"aPbrXdfaHV"}],"key":"TbBLM2mMgY"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"import numpy as np\nimport matplotlib.pyplot as plt\n\n# Generate simple 2D data\nnp.random.seed(42)\nn_per_class = 15\n\n# Class 0: cluster around (-1, -1)\nX0 = np.random.randn(n_per_class, 2) * 0.6 + np.array([-1, -1])\n# Class 1: cluster around (1, 1)\nX1 = np.random.randn(n_per_class, 2) * 0.6 + np.array([1, 1])\n\nX_train = np.vstack([X0, X1])\ny_train = np.array([0] * n_per_class + [1] * n_per_class)\n\n# Query point\nx_query = np.array([0.3, 0.2])\nk = 5\n\n# Compute distances and find k nearest\ndistances = np.sqrt(np.sum((X_train - x_query)**2, axis=1))\nk_nearest_idx = np.argsort(distances)[:k]\n\nfig, ax = plt.subplots(figsize=(6, 5))\n\n# Plot training points\nax.scatter(X_train[y_train == 0, 0], X_train[y_train == 0, 1], \n           c='C0', s=60, label='Classe 0', zorder=2)\nax.scatter(X_train[y_train == 1, 0], X_train[y_train == 1, 1], \n           c='C1', s=60, label='Classe 1', zorder=2)\n\n# Highlight k nearest neighbors\nfor idx in k_nearest_idx:\n    ax.plot([x_query[0], X_train[idx, 0]], [x_query[1], X_train[idx, 1]], \n            'k--', alpha=0.4, linewidth=1, zorder=1)\n    ax.scatter(X_train[idx, 0], X_train[idx, 1], \n               s=150, facecolors='none', edgecolors='black', linewidths=2, zorder=3)\n\n# Plot query point\nax.scatter(x_query[0], x_query[1], c='red', s=120, marker='*', \n           label='Point requête', zorder=4)\n\n# Count votes\nvotes = y_train[k_nearest_idx]\nn_class0 = np.sum(votes == 0)\nn_class1 = np.sum(votes == 1)\nprediction = 0 if n_class0 > n_class1 else 1\n\nax.set_xlabel('$x_1$')\nax.set_ylabel('$x_2$')\nax.legend(loc='upper left')\nax.set_title(f'$k = {k}$: votes = [{n_class0} classe 0, {n_class1} classe 1] → prédiction: classe {prediction}')\nax.set_aspect('equal')\nplt.tight_layout()","visibility":"hide","key":"kyRbNrNE8R"},{"type":"outputs","id":"DHjUd76Zg7vQ2oGoJ4mMp","children":[{"type":"output","children":[],"jupyter_data":{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"<Figure size 600x500 with 1 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"694162a8e720de9ef64bd0b9e6d6af6e","path":"/mlbook/build/694162a8e720de9ef64bd0b9e6d6af6e.png"}}},"key":"iMhH5oUcZ3"}],"visibility":"show","key":"K4ArKh51zN"}],"data":{"tags":[]},"visibility":"show","key":"zcoLTSzTtT"},{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":85,"column":1},"end":{"line":85,"column":1}},"children":[{"type":"text","value":"Soit ","position":{"start":{"line":85,"column":1},"end":{"line":85,"column":1}},"key":"bNjWmekmzm"},{"type":"inlineMath","value":"\\mathcal{N}_k(x)","position":{"start":{"line":85,"column":1},"end":{"line":85,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi mathvariant=\"script\">N</mi><mi>k</mi></msub><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">\\mathcal{N}_k(x)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathcal\" style=\"margin-right:0.14736em;\">N</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:-0.1474em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span></span></span></span>","key":"OlnzP3dP3y"},{"type":"text","value":" l’ensemble des indices des ","position":{"start":{"line":85,"column":1},"end":{"line":85,"column":1}},"key":"avCZCJ6585"},{"type":"inlineMath","value":"k","position":{"start":{"line":85,"column":1},"end":{"line":85,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>k</mi></mrow><annotation encoding=\"application/x-tex\">k</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span></span></span></span>","key":"ueMaiqF2R2"},{"type":"text","value":" plus proches voisins de ","position":{"start":{"line":85,"column":1},"end":{"line":85,"column":1}},"key":"kpVADJQoxw"},{"type":"inlineMath","value":"x","position":{"start":{"line":85,"column":1},"end":{"line":85,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi></mrow><annotation encoding=\"application/x-tex\">x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span></span></span></span>","key":"pUaDedsg5N"},{"type":"text","value":". La prédiction est:","position":{"start":{"line":85,"column":1},"end":{"line":85,"column":1}},"key":"dolbTcfqTs"}],"key":"ipn89o2k5i"},{"type":"math","value":"\\hat{y} = \\arg\\max_{c} \\sum_{i \\in \\mathcal{N}_k(x)} \\mathbb{1}_{y_i = c}","position":{"start":{"line":87,"column":1},"end":{"line":89,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mover accent=\"true\"><mi>y</mi><mo>^</mo></mover><mo>=</mo><mi>arg</mi><mo>⁡</mo><munder><mrow><mi>max</mi><mo>⁡</mo></mrow><mi>c</mi></munder><munder><mo>∑</mo><mrow><mi>i</mi><mo>∈</mo><msub><mi mathvariant=\"script\">N</mi><mi>k</mi></msub><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow></munder><msub><mn mathvariant=\"double-struck\">1</mn><mrow><msub><mi>y</mi><mi>i</mi></msub><mo>=</mo><mi>c</mi></mrow></msub></mrow><annotation encoding=\"application/x-tex\">\\hat{y} = \\arg\\max_{c} \\sum_{i \\in \\mathcal{N}_k(x)} \\mathbb{1}_{y_i = c}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord accent\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6944em;\"><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span></span><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"accent-body\" style=\"left:-0.1944em;\"><span class=\"mord\">^</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1944em;\"><span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.566em;vertical-align:-1.516em;\"></span><span class=\"mop\">ar<span style=\"margin-right:0.01389em;\">g</span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mop op-limits\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.4306em;\"><span style=\"top:-2.4em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">c</span></span></span></span><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span><span class=\"mop\">max</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7em;\"><span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mop op-limits\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.05em;\"><span style=\"top:-1.809em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mrel mtight\">∈</span><span class=\"mord mtight\"><span class=\"mord mathcal mtight\" style=\"margin-right:0.14736em;\">N</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3448em;\"><span style=\"top:-2.3488em;margin-left:-0.1474em;margin-right:0.0714em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1512em;\"><span></span></span></span></span></span></span><span class=\"mopen mtight\">(</span><span class=\"mord mathnormal mtight\">x</span><span class=\"mclose mtight\">)</span></span></span></span><span style=\"top:-3.05em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span><span class=\"mop op-symbol large-op\">∑</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.516em;\"><span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord\">1</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3281em;\"><span style=\"top:-2.357em;margin-left:-0.0359em;margin-right:0.0714em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.143em;\"><span></span></span></span></span></span></span><span class=\"mrel mtight\">=</span><span class=\"mord mathnormal mtight\">c</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span></span></span></span></span>","enumerator":"1","key":"H1s5hw0LMc"},{"type":"paragraph","position":{"start":{"line":91,"column":1},"end":{"line":91,"column":1}},"children":[{"type":"text","value":"La somme compte combien de voisins appartiennent à chaque classe ","position":{"start":{"line":91,"column":1},"end":{"line":91,"column":1}},"key":"imtCnrPiyE"},{"type":"inlineMath","value":"c","position":{"start":{"line":91,"column":1},"end":{"line":91,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>c</mi></mrow><annotation encoding=\"application/x-tex\">c</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">c</span></span></span></span>","key":"j71S4kDDhR"},{"type":"text","value":", et nous retenons la classe la plus fréquente.","position":{"start":{"line":91,"column":1},"end":{"line":91,"column":1}},"key":"CpE3JJOack"}],"key":"zOBh2AbGNK"},{"type":"paragraph","position":{"start":{"line":93,"column":1},"end":{"line":93,"column":1}},"children":[{"type":"text","value":"Cette formulation admet une interprétation probabiliste. La proportion de voisins appartenant à la classe ","position":{"start":{"line":93,"column":1},"end":{"line":93,"column":1}},"key":"ibW2Dsc7Z6"},{"type":"inlineMath","value":"c","position":{"start":{"line":93,"column":1},"end":{"line":93,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>c</mi></mrow><annotation encoding=\"application/x-tex\">c</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">c</span></span></span></span>","key":"ZMnzLyqYI2"},{"type":"text","value":" estime la probabilité conditionnelle:","position":{"start":{"line":93,"column":1},"end":{"line":93,"column":1}},"key":"LipKBG0p16"}],"key":"w0GmRvfdTW"},{"type":"math","value":"p(y = c \\mid x, \\mathcal{D}) = \\frac{1}{k} \\sum_{i \\in \\mathcal{N}_k(x)} \\mathbb{1}_{y_i = c}","position":{"start":{"line":95,"column":1},"end":{"line":97,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi>p</mi><mo stretchy=\"false\">(</mo><mi>y</mi><mo>=</mo><mi>c</mi><mo>∣</mo><mi>x</mi><mo separator=\"true\">,</mo><mi mathvariant=\"script\">D</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mfrac><mn>1</mn><mi>k</mi></mfrac><munder><mo>∑</mo><mrow><mi>i</mi><mo>∈</mo><msub><mi mathvariant=\"script\">N</mi><mi>k</mi></msub><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow></munder><msub><mn mathvariant=\"double-struck\">1</mn><mrow><msub><mi>y</mi><mi>i</mi></msub><mo>=</mo><mi>c</mi></mrow></msub></mrow><annotation encoding=\"application/x-tex\">p(y = c \\mid x, \\mathcal{D}) = \\frac{1}{k} \\sum_{i \\in \\mathcal{N}_k(x)} \\mathbb{1}_{y_i = c}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">p</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">c</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">∣</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">x</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathcal\" style=\"margin-right:0.02778em;\">D</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.8374em;vertical-align:-1.516em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3214em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mop op-limits\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.05em;\"><span style=\"top:-1.809em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mrel mtight\">∈</span><span class=\"mord mtight\"><span class=\"mord mathcal mtight\" style=\"margin-right:0.14736em;\">N</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3448em;\"><span style=\"top:-2.3488em;margin-left:-0.1474em;margin-right:0.0714em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1512em;\"><span></span></span></span></span></span></span><span class=\"mopen mtight\">(</span><span class=\"mord mathnormal mtight\">x</span><span class=\"mclose mtight\">)</span></span></span></span><span style=\"top:-3.05em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span><span class=\"mop op-symbol large-op\">∑</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.516em;\"><span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord\">1</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3281em;\"><span style=\"top:-2.357em;margin-left:-0.0359em;margin-right:0.0714em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.143em;\"><span></span></span></span></span></span></span><span class=\"mrel mtight\">=</span><span class=\"mord mathnormal mtight\">c</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span></span></span></span></span>","enumerator":"2","key":"OMc33jLfUe"},{"type":"paragraph","position":{"start":{"line":99,"column":1},"end":{"line":99,"column":1}},"children":[{"type":"text","value":"La prédiction déterministe correspond au mode de cette distribution empirique.","position":{"start":{"line":99,"column":1},"end":{"line":99,"column":1}},"key":"EDoi4PxYEB"}],"key":"WgHyPYfj2w"},{"type":"heading","depth":2,"position":{"start":{"line":101,"column":1},"end":{"line":101,"column":1}},"children":[{"type":"text","value":"Fonctions de distance","position":{"start":{"line":101,"column":1},"end":{"line":101,"column":1}},"key":"twDBguQnIw"}],"identifier":"fonctions-de-distance","label":"Fonctions de distance","html_id":"fonctions-de-distance","implicit":true,"key":"Gw3cVH5CFw"},{"type":"paragraph","position":{"start":{"line":103,"column":1},"end":{"line":103,"column":1}},"children":[{"type":"text","value":"L’algorithme repose sur la capacité à mesurer la proximité entre points. Une ","position":{"start":{"line":103,"column":1},"end":{"line":103,"column":1}},"key":"Fhb9IZ5enS"},{"type":"strong","position":{"start":{"line":103,"column":1},"end":{"line":103,"column":1}},"children":[{"type":"text","value":"fonction de distance","position":{"start":{"line":103,"column":1},"end":{"line":103,"column":1}},"key":"yiUcUIJGwc"}],"key":"J2NckZbiZE"},{"type":"text","value":" ","position":{"start":{"line":103,"column":1},"end":{"line":103,"column":1}},"key":"gJDl6cVwFS"},{"type":"inlineMath","value":"d: \\mathcal{X} \\times \\mathcal{X} \\to [0, \\infty)","position":{"start":{"line":103,"column":1},"end":{"line":103,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>d</mi><mo>:</mo><mi mathvariant=\"script\">X</mi><mo>×</mo><mi mathvariant=\"script\">X</mi><mo>→</mo><mo stretchy=\"false\">[</mo><mn>0</mn><mo separator=\"true\">,</mo><mi mathvariant=\"normal\">∞</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">d: \\mathcal{X} \\times \\mathcal{X} \\to [0, \\infty)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\">d</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">:</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7667em;vertical-align:-0.0833em;\"></span><span class=\"mord mathcal\" style=\"margin-right:0.14643em;\">X</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">×</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathcal\" style=\"margin-right:0.14643em;\">X</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">→</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">[</span><span class=\"mord\">0</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">∞</span><span class=\"mclose\">)</span></span></span></span>","key":"txaH13smBl"},{"type":"text","value":" doit satisfaire trois axiomes: ","position":{"start":{"line":103,"column":1},"end":{"line":103,"column":1}},"key":"uQXB4lWQBX"},{"type":"inlineMath","value":"d(x, y) = 0","position":{"start":{"line":103,"column":1},"end":{"line":103,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>d</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo separator=\"true\">,</mo><mi>y</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">d(x, y) = 0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">d</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0</span></span></span></span>","key":"WEKdZEEVSW"},{"type":"text","value":" si et seulement si ","position":{"start":{"line":103,"column":1},"end":{"line":103,"column":1}},"key":"wjtVvmu0I8"},{"type":"inlineMath","value":"x = y","position":{"start":{"line":103,"column":1},"end":{"line":103,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi><mo>=</mo><mi>y</mi></mrow><annotation encoding=\"application/x-tex\">x = y</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span></span></span></span>","key":"DrVjOVunU3"},{"type":"text","value":" (identité), ","position":{"start":{"line":103,"column":1},"end":{"line":103,"column":1}},"key":"DQCDTA4hc3"},{"type":"inlineMath","value":"d(x, y) = d(y, x)","position":{"start":{"line":103,"column":1},"end":{"line":103,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>d</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo separator=\"true\">,</mo><mi>y</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mi>d</mi><mo stretchy=\"false\">(</mo><mi>y</mi><mo separator=\"true\">,</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">d(x, y) = d(y, x)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">d</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">d</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span></span></span></span>","key":"LtoAIPMv1a"},{"type":"text","value":" (symétrie), et ","position":{"start":{"line":103,"column":1},"end":{"line":103,"column":1}},"key":"PjDHylmCo4"},{"type":"inlineMath","value":"d(x, z) \\leq d(x, y) + d(y, z)","position":{"start":{"line":103,"column":1},"end":{"line":103,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>d</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo separator=\"true\">,</mo><mi>z</mi><mo stretchy=\"false\">)</mo><mo>≤</mo><mi>d</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo separator=\"true\">,</mo><mi>y</mi><mo stretchy=\"false\">)</mo><mo>+</mo><mi>d</mi><mo stretchy=\"false\">(</mo><mi>y</mi><mo separator=\"true\">,</mo><mi>z</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">d(x, z) \\leq d(x, y) + d(y, z)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">d</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.04398em;\">z</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">≤</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">d</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">d</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.04398em;\">z</span><span class=\"mclose\">)</span></span></span></span>","key":"zN9xlWSfCh"},{"type":"text","value":" (inégalité triangulaire).","position":{"start":{"line":103,"column":1},"end":{"line":103,"column":1}},"key":"HHlvAHLAmf"}],"key":"R1TYtfpW4g"},{"type":"paragraph","position":{"start":{"line":105,"column":1},"end":{"line":105,"column":1}},"children":[{"type":"text","value":"La ","position":{"start":{"line":105,"column":1},"end":{"line":105,"column":1}},"key":"hNN3gbap9v"},{"type":"strong","position":{"start":{"line":105,"column":1},"end":{"line":105,"column":1}},"children":[{"type":"text","value":"distance euclidienne","position":{"start":{"line":105,"column":1},"end":{"line":105,"column":1}},"key":"E9MKdcYnYf"}],"key":"pJzZU7YVDL"},{"type":"text","value":" est le choix le plus courant:","position":{"start":{"line":105,"column":1},"end":{"line":105,"column":1}},"key":"v9CoLPC92I"}],"key":"JO9rOwwnKW"},{"type":"math","value":"d_2(x, y) = \\sqrt{\\sum_{j=1}^{d} (x_j - y_j)^2} = \\|x - y\\|_2","position":{"start":{"line":107,"column":1},"end":{"line":109,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><msub><mi>d</mi><mn>2</mn></msub><mo stretchy=\"false\">(</mo><mi>x</mi><mo separator=\"true\">,</mo><mi>y</mi><mo stretchy=\"false\">)</mo><mo>=</mo><msqrt><mrow><munderover><mo>∑</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mi>d</mi></munderover><mo stretchy=\"false\">(</mo><msub><mi>x</mi><mi>j</mi></msub><mo>−</mo><msub><mi>y</mi><mi>j</mi></msub><msup><mo stretchy=\"false\">)</mo><mn>2</mn></msup></mrow></msqrt><mo>=</mo><mi mathvariant=\"normal\">∥</mi><mi>x</mi><mo>−</mo><mi>y</mi><msub><mi mathvariant=\"normal\">∥</mi><mn>2</mn></msub></mrow><annotation encoding=\"application/x-tex\">d_2(x, y) = \\sqrt{\\sum_{j=1}^{d} (x_j - y_j)^2} = \\|x - y\\|_2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">d</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:3.4776em;vertical-align:-1.4138em;\"></span><span class=\"mord sqrt\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.0639em;\"><span class=\"svg-align\" style=\"top:-5.4376em;\"><span class=\"pstrut\" style=\"height:5.4376em;\"></span><span class=\"mord\" style=\"padding-left:1.056em;\"><span class=\"mop op-limits\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.8361em;\"><span style=\"top:-1.8723em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span><span class=\"mrel mtight\">=</span><span class=\"mord mtight\">1</span></span></span></span><span style=\"top:-3.05em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span><span class=\"mop op-symbol large-op\">∑</span></span></span><span style=\"top:-4.3em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">d</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.4138em;\"><span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span><span class=\"mclose\"><span class=\"mclose\">)</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7401em;\"><span style=\"top:-2.989em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span></span></span><span style=\"top:-4.0239em;\"><span class=\"pstrut\" style=\"height:5.4376em;\"></span><span class=\"hide-tail\" style=\"min-width:0.742em;height:3.5176em;\"><svg xmlns=\"http://www.w3.org/2000/svg\" width='400em' height='3.5176em' viewBox='0 0 400000 3517' preserveAspectRatio='xMinYMin slice'><path d='M702 80H40000040\nH742v3383l-4 4-4 4c-.667.7 -2 1.5-4 2.5s-4.167 1.833-6.5 2.5-5.5 1-9.5 1\nh-12l-28-84c-16.667-52-96.667 -294.333-240-727l-212 -643 -85 170\nc-4-3.333-8.333-7.667-13 -13l-13-13l77-155 77-156c66 199.333 139 419.667\n219 661 l218 661zM702 80H400000v40H742z'/></svg></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.4138em;\"><span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">∥</span><span class=\"mord mathnormal\">x</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mord\"><span class=\"mord\">∥</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span></span>","enumerator":"3","key":"x30EuXRMmr"},{"type":"paragraph","position":{"start":{"line":111,"column":1},"end":{"line":111,"column":1}},"children":[{"type":"text","value":"La ","position":{"start":{"line":111,"column":1},"end":{"line":111,"column":1}},"key":"x9eTuxjVao"},{"type":"strong","position":{"start":{"line":111,"column":1},"end":{"line":111,"column":1}},"children":[{"type":"text","value":"distance de Manhattan","position":{"start":{"line":111,"column":1},"end":{"line":111,"column":1}},"key":"NRbdY4z1PA"}],"key":"KmtRk3Xilc"},{"type":"text","value":" suit les axes plutôt que la ligne droite:","position":{"start":{"line":111,"column":1},"end":{"line":111,"column":1}},"key":"YglXvwC6QY"}],"key":"JeB1sQAQXy"},{"type":"math","value":"d_1(x, y) = \\sum_{j=1}^{d} |x_j - y_j| = \\|x - y\\|_1","position":{"start":{"line":113,"column":1},"end":{"line":115,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><msub><mi>d</mi><mn>1</mn></msub><mo stretchy=\"false\">(</mo><mi>x</mi><mo separator=\"true\">,</mo><mi>y</mi><mo stretchy=\"false\">)</mo><mo>=</mo><munderover><mo>∑</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mi>d</mi></munderover><mi mathvariant=\"normal\">∣</mi><msub><mi>x</mi><mi>j</mi></msub><mo>−</mo><msub><mi>y</mi><mi>j</mi></msub><mi mathvariant=\"normal\">∣</mi><mo>=</mo><mi mathvariant=\"normal\">∥</mi><mi>x</mi><mo>−</mo><mi>y</mi><msub><mi mathvariant=\"normal\">∥</mi><mn>1</mn></msub></mrow><annotation encoding=\"application/x-tex\">d_1(x, y) = \\sum_{j=1}^{d} |x_j - y_j| = \\|x - y\\|_1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">d</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:3.2499em;vertical-align:-1.4138em;\"></span><span class=\"mop op-limits\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.8361em;\"><span style=\"top:-1.8723em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span><span class=\"mrel mtight\">=</span><span class=\"mord mtight\">1</span></span></span></span><span style=\"top:-3.05em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span><span class=\"mop op-symbol large-op\">∑</span></span></span><span style=\"top:-4.3em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">d</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.4138em;\"><span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">∣</span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.0361em;vertical-align:-0.2861em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span><span class=\"mord\">∣</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">∥</span><span class=\"mord mathnormal\">x</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mord\"><span class=\"mord\">∥</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span></span>","enumerator":"4","key":"DV0peVJF14"},{"type":"paragraph","position":{"start":{"line":117,"column":1},"end":{"line":117,"column":1}},"children":[{"type":"text","value":"Ces deux distances appartiennent à la famille des normes ","position":{"start":{"line":117,"column":1},"end":{"line":117,"column":1}},"key":"vqgY03ISHE"},{"type":"inlineMath","value":"\\ell_p","position":{"start":{"line":117,"column":1},"end":{"line":117,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi mathvariant=\"normal\">ℓ</mi><mi>p</mi></msub></mrow><annotation encoding=\"application/x-tex\">\\ell_p</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.9805em;vertical-align:-0.2861em;\"></span><span class=\"mord\"><span class=\"mord\">ℓ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">p</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span></span></span></span>","key":"YicpJgsjZc"},{"type":"text","value":", définies par ","position":{"start":{"line":117,"column":1},"end":{"line":117,"column":1}},"key":"DYOrKcAqyk"},{"type":"inlineMath","value":"\\|x\\|_p = \\left(\\sum_j |x_j|^p\\right)^{1/p}","position":{"start":{"line":117,"column":1},"end":{"line":117,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"normal\">∥</mi><mi>x</mi><msub><mi mathvariant=\"normal\">∥</mi><mi>p</mi></msub><mo>=</mo><msup><mrow><mo fence=\"true\">(</mo><msub><mo>∑</mo><mi>j</mi></msub><mi mathvariant=\"normal\">∣</mi><msub><mi>x</mi><mi>j</mi></msub><msup><mi mathvariant=\"normal\">∣</mi><mi>p</mi></msup><mo fence=\"true\">)</mo></mrow><mrow><mn>1</mn><mi mathvariant=\"normal\">/</mi><mi>p</mi></mrow></msup></mrow><annotation encoding=\"application/x-tex\">\\|x\\|_p = \\left(\\sum_j |x_j|^p\\right)^{1/p}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0361em;vertical-align:-0.2861em;\"></span><span class=\"mord\">∥</span><span class=\"mord mathnormal\">x</span><span class=\"mord\"><span class=\"mord\">∥</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">p</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.0779em;vertical-align:-0.65em;\"></span><span class=\"minner\"><span class=\"minner\"><span class=\"mopen delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size2\">(</span></span><span class=\"mop\"><span class=\"mop op-symbol small-op\" style=\"position:relative;top:0em;\">∑</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.162em;\"><span style=\"top:-2.4003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.4358em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">∣</span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord\">∣</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6644em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">p</span></span></span></span></span></span></span></span><span class=\"mclose delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size2\">)</span></span></span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.4279em;\"><span style=\"top:-3.6029em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">1/</span><span class=\"mord mathnormal mtight\">p</span></span></span></span></span></span></span></span></span></span></span></span>","key":"Q2AgCG5yPx"},{"type":"text","value":". Le cas limite ","position":{"start":{"line":117,"column":1},"end":{"line":117,"column":1}},"key":"TtSnAAtN1n"},{"type":"inlineMath","value":"p \\to \\infty","position":{"start":{"line":117,"column":1},"end":{"line":117,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>p</mi><mo>→</mo><mi mathvariant=\"normal\">∞</mi></mrow><annotation encoding=\"application/x-tex\">p \\to \\infty</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\">p</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">→</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord\">∞</span></span></span></span>","key":"fmsnvoBFZ8"},{"type":"text","value":" donne la norme ","position":{"start":{"line":117,"column":1},"end":{"line":117,"column":1}},"key":"NdLJg22SIh"},{"type":"inlineMath","value":"\\ell_\\infty","position":{"start":{"line":117,"column":1},"end":{"line":117,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi mathvariant=\"normal\">ℓ</mi><mi mathvariant=\"normal\">∞</mi></msub></mrow><annotation encoding=\"application/x-tex\">\\ell_\\infty</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8444em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord\">ℓ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">∞</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"vjeuhfEY32"},{"type":"text","value":":","position":{"start":{"line":117,"column":1},"end":{"line":117,"column":1}},"key":"aW1b68CBUX"}],"key":"jcMvWZA4K9"},{"type":"math","value":"\\|x\\|_\\infty = \\max_j |x_j|","position":{"start":{"line":119,"column":1},"end":{"line":121,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi mathvariant=\"normal\">∥</mi><mi>x</mi><msub><mi mathvariant=\"normal\">∥</mi><mi mathvariant=\"normal\">∞</mi></msub><mo>=</mo><munder><mrow><mi>max</mi><mo>⁡</mo></mrow><mi>j</mi></munder><mi mathvariant=\"normal\">∣</mi><msub><mi>x</mi><mi>j</mi></msub><mi mathvariant=\"normal\">∣</mi></mrow><annotation encoding=\"application/x-tex\">\\|x\\|_\\infty = \\max_j |x_j|</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">∥</span><span class=\"mord mathnormal\">x</span><span class=\"mord\"><span class=\"mord\">∥</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">∞</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.6138em;vertical-align:-0.8638em;\"></span><span class=\"mop op-limits\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.4306em;\"><span style=\"top:-2.3723em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span><span class=\"mop\">max</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8638em;\"><span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">∣</span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span><span class=\"mord\">∣</span></span></span></span></span>","enumerator":"5","key":"fCtokh27LG"},{"type":"heading","depth":3,"position":{"start":{"line":123,"column":1},"end":{"line":123,"column":1}},"children":[{"type":"text","value":"Boules unité: visualiser ce que “équidistant” signifie","position":{"start":{"line":123,"column":1},"end":{"line":123,"column":1}},"key":"lLz3618Dsn"}],"identifier":"boules-unit-visualiser-ce-que-quidistant-signifie","label":"Boules unité: visualiser ce que “équidistant” signifie","html_id":"boules-unit-visualiser-ce-que-quidistant-signifie","implicit":true,"key":"PD9iOxq0TC"},{"type":"paragraph","position":{"start":{"line":125,"column":1},"end":{"line":125,"column":1}},"children":[{"type":"text","value":"Pour comprendre comment une norme mesure les distances, on trace sa ","position":{"start":{"line":125,"column":1},"end":{"line":125,"column":1}},"key":"T8ja7dr8LP"},{"type":"strong","position":{"start":{"line":125,"column":1},"end":{"line":125,"column":1}},"children":[{"type":"text","value":"boule unité","position":{"start":{"line":125,"column":1},"end":{"line":125,"column":1}},"key":"B6LxFzLPSl"}],"key":"Cw8CkxHNM0"},{"type":"text","value":". Formellement, la boule unité d’une norme ","position":{"start":{"line":125,"column":1},"end":{"line":125,"column":1}},"key":"FtlV7u91Ho"},{"type":"inlineMath","value":"\\|\\cdot\\|","position":{"start":{"line":125,"column":1},"end":{"line":125,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"normal\">∥</mi><mo>⋅</mo><mi mathvariant=\"normal\">∥</mi></mrow><annotation encoding=\"application/x-tex\">\\|\\cdot\\|</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">∥</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">⋅</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">∥</span></span></span></span>","key":"ze7LojPq4I"},{"type":"text","value":" est l’ensemble:","position":{"start":{"line":125,"column":1},"end":{"line":125,"column":1}},"key":"bSxOMlAKvD"}],"key":"A0bIotACCM"},{"type":"math","value":"B = \\{x \\in \\mathbb{R}^d : \\|x\\| \\leq 1\\}","position":{"start":{"line":127,"column":1},"end":{"line":129,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi>B</mi><mo>=</mo><mo stretchy=\"false\">{</mo><mi>x</mi><mo>∈</mo><msup><mi mathvariant=\"double-struck\">R</mi><mi>d</mi></msup><mo>:</mo><mi mathvariant=\"normal\">∥</mi><mi>x</mi><mi mathvariant=\"normal\">∥</mi><mo>≤</mo><mn>1</mn><mo stretchy=\"false\">}</mo></mrow><annotation encoding=\"application/x-tex\">B = \\{x \\in \\mathbb{R}^d : \\|x\\| \\leq 1\\}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05017em;\">B</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">{</span><span class=\"mord mathnormal\">x</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">∈</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8991em;\"></span><span class=\"mord\"><span class=\"mord mathbb\">R</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8991em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">d</span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">:</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">∥</span><span class=\"mord mathnormal\">x</span><span class=\"mord\">∥</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">≤</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">1</span><span class=\"mclose\">}</span></span></span></span></span>","enumerator":"6","key":"Rg8i5fX53w"},{"type":"paragraph","position":{"start":{"line":131,"column":1},"end":{"line":131,"column":1}},"children":[{"type":"text","value":"et sa frontière, la ","position":{"start":{"line":131,"column":1},"end":{"line":131,"column":1}},"key":"uzNv0vIGSO"},{"type":"strong","position":{"start":{"line":131,"column":1},"end":{"line":131,"column":1}},"children":[{"type":"text","value":"sphère unité","position":{"start":{"line":131,"column":1},"end":{"line":131,"column":1}},"key":"XRVcLWyJ8H"}],"key":"DRH8T2iM6R"},{"type":"text","value":", est ","position":{"start":{"line":131,"column":1},"end":{"line":131,"column":1}},"key":"mLND9TjiQp"},{"type":"inlineMath","value":"S = \\{x : \\|x\\| = 1\\}","position":{"start":{"line":131,"column":1},"end":{"line":131,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>S</mi><mo>=</mo><mo stretchy=\"false\">{</mo><mi>x</mi><mo>:</mo><mi mathvariant=\"normal\">∥</mi><mi>x</mi><mi mathvariant=\"normal\">∥</mi><mo>=</mo><mn>1</mn><mo stretchy=\"false\">}</mo></mrow><annotation encoding=\"application/x-tex\">S = \\{x : \\|x\\| = 1\\}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">S</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">{</span><span class=\"mord mathnormal\">x</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">:</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">∥</span><span class=\"mord mathnormal\">x</span><span class=\"mord\">∥</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">1</span><span class=\"mclose\">}</span></span></span></span>","key":"Ok4zk6wuNc"},{"type":"text","value":". Tous les points sur cette sphère sont à distance exactement 1 de l’origine. La forme de la boule révèle ce que la norme considère comme “équidistant”.","position":{"start":{"line":131,"column":1},"end":{"line":131,"column":1}},"key":"vFDnp2Nz4u"}],"key":"Tc093cVAgb"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":133,"column":1},"end":{"line":138,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":133,"column":1},"end":{"line":134,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":133,"column":1},"end":{"line":133,"column":1}},"children":[{"type":"strong","position":{"start":{"line":133,"column":1},"end":{"line":133,"column":1}},"children":[{"type":"text","value":"Norme ","position":{"start":{"line":133,"column":1},"end":{"line":133,"column":1}},"key":"Nlna0UjRge"},{"type":"inlineMath","value":"\\ell_2","position":{"start":{"line":133,"column":1},"end":{"line":133,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi mathvariant=\"normal\">ℓ</mi><mn>2</mn></msub></mrow><annotation encoding=\"application/x-tex\">\\ell_2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8444em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord\">ℓ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"UGLQeoXh3n"},{"type":"text","value":" (cercle)","position":{"start":{"line":133,"column":1},"end":{"line":133,"column":1}},"key":"etQ4wUcCS3"}],"key":"N2am719LVf"},{"type":"text","value":": Le point ","position":{"start":{"line":133,"column":1},"end":{"line":133,"column":1}},"key":"p6nBPBJI6N"},{"type":"inlineMath","value":"(1, 0)","position":{"start":{"line":133,"column":1},"end":{"line":133,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">(</mo><mn>1</mn><mo separator=\"true\">,</mo><mn>0</mn><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">(1, 0)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord\">1</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">0</span><span class=\"mclose\">)</span></span></span></span>","key":"FyWu0J3Rky"},{"type":"text","value":" et le point ","position":{"start":{"line":133,"column":1},"end":{"line":133,"column":1}},"key":"uaAdboSeqs"},{"type":"inlineMath","value":"(0.71, 0.71)","position":{"start":{"line":133,"column":1},"end":{"line":133,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">(</mo><mn>0.71</mn><mo separator=\"true\">,</mo><mn>0.71</mn><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">(0.71, 0.71)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord\">0.71</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">0.71</span><span class=\"mclose\">)</span></span></span></span>","key":"SVq2pYw6t8"},{"type":"text","value":" sont à la même distance de l’origine. Se déplacer en diagonale coûte autant que suivre un axe. C’est notre intuition géométrique habituelle.","position":{"start":{"line":133,"column":1},"end":{"line":133,"column":1}},"key":"tDAO1J9YJp"}],"key":"irRUNRG9vX"}],"key":"kmse3w0UDv"},{"type":"listItem","spread":true,"position":{"start":{"line":135,"column":1},"end":{"line":136,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":135,"column":1},"end":{"line":135,"column":1}},"children":[{"type":"strong","position":{"start":{"line":135,"column":1},"end":{"line":135,"column":1}},"children":[{"type":"text","value":"Norme ","position":{"start":{"line":135,"column":1},"end":{"line":135,"column":1}},"key":"T5ptdyMeXf"},{"type":"inlineMath","value":"\\ell_1","position":{"start":{"line":135,"column":1},"end":{"line":135,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi mathvariant=\"normal\">ℓ</mi><mn>1</mn></msub></mrow><annotation encoding=\"application/x-tex\">\\ell_1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8444em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord\">ℓ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"FmjQkfi2WK"},{"type":"text","value":" (losange)","position":{"start":{"line":135,"column":1},"end":{"line":135,"column":1}},"key":"RzVkdWP2ZL"}],"key":"beUnqiZ0FW"},{"type":"text","value":": Le point ","position":{"start":{"line":135,"column":1},"end":{"line":135,"column":1}},"key":"BT5huQk651"},{"type":"inlineMath","value":"(1, 0)","position":{"start":{"line":135,"column":1},"end":{"line":135,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">(</mo><mn>1</mn><mo separator=\"true\">,</mo><mn>0</mn><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">(1, 0)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord\">1</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">0</span><span class=\"mclose\">)</span></span></span></span>","key":"k1Vd8UnoYA"},{"type":"text","value":" est à distance 1, mais ","position":{"start":{"line":135,"column":1},"end":{"line":135,"column":1}},"key":"VFqxobx1NL"},{"type":"inlineMath","value":"(0.71, 0.71)","position":{"start":{"line":135,"column":1},"end":{"line":135,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">(</mo><mn>0.71</mn><mo separator=\"true\">,</mo><mn>0.71</mn><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">(0.71, 0.71)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord\">0.71</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">0.71</span><span class=\"mclose\">)</span></span></span></span>","key":"RF1JWVrL7g"},{"type":"text","value":" est à distance ","position":{"start":{"line":135,"column":1},"end":{"line":135,"column":1}},"key":"Wzd44QK9Bh"},{"type":"inlineMath","value":"0.71 + 0.71 = 1.42","position":{"start":{"line":135,"column":1},"end":{"line":135,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>0.71</mn><mo>+</mo><mn>0.71</mn><mo>=</mo><mn>1.42</mn></mrow><annotation encoding=\"application/x-tex\">0.71 + 0.71 = 1.42</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7278em;vertical-align:-0.0833em;\"></span><span class=\"mord\">0.71</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0.71</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1.42</span></span></span></span>","key":"YtIWbALgyR"},{"type":"text","value":". Se déplacer en diagonale coûte plus cher, comme un taxi qui ne peut tourner qu’aux intersections.","position":{"start":{"line":135,"column":1},"end":{"line":135,"column":1}},"key":"sGNQCXO4Ju"}],"key":"dgJqzK4NtS"}],"key":"xKx6py5Mj9"},{"type":"listItem","spread":true,"position":{"start":{"line":137,"column":1},"end":{"line":138,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":137,"column":1},"end":{"line":137,"column":1}},"children":[{"type":"strong","position":{"start":{"line":137,"column":1},"end":{"line":137,"column":1}},"children":[{"type":"text","value":"Norme ","position":{"start":{"line":137,"column":1},"end":{"line":137,"column":1}},"key":"uWDItJlqyb"},{"type":"inlineMath","value":"\\ell_\\infty","position":{"start":{"line":137,"column":1},"end":{"line":137,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi mathvariant=\"normal\">ℓ</mi><mi mathvariant=\"normal\">∞</mi></msub></mrow><annotation encoding=\"application/x-tex\">\\ell_\\infty</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8444em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord\">ℓ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">∞</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"j1z5QmrtDq"},{"type":"text","value":" (carré)","position":{"start":{"line":137,"column":1},"end":{"line":137,"column":1}},"key":"uz2wPJkYnY"}],"key":"P1uSTpxtMR"},{"type":"text","value":": Seule la plus grande coordonnée compte. Les points ","position":{"start":{"line":137,"column":1},"end":{"line":137,"column":1}},"key":"M992RiQ6oR"},{"type":"inlineMath","value":"(1, 0)","position":{"start":{"line":137,"column":1},"end":{"line":137,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">(</mo><mn>1</mn><mo separator=\"true\">,</mo><mn>0</mn><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">(1, 0)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord\">1</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">0</span><span class=\"mclose\">)</span></span></span></span>","key":"FIj4FMZPo1"},{"type":"text","value":", ","position":{"start":{"line":137,"column":1},"end":{"line":137,"column":1}},"key":"SQawEFQgDT"},{"type":"inlineMath","value":"(1, 0.5)","position":{"start":{"line":137,"column":1},"end":{"line":137,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">(</mo><mn>1</mn><mo separator=\"true\">,</mo><mn>0.5</mn><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">(1, 0.5)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord\">1</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">0.5</span><span class=\"mclose\">)</span></span></span></span>","key":"BzxTlwszhw"},{"type":"text","value":" et ","position":{"start":{"line":137,"column":1},"end":{"line":137,"column":1}},"key":"aXlPxA1D8k"},{"type":"inlineMath","value":"(1, 1)","position":{"start":{"line":137,"column":1},"end":{"line":137,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">(</mo><mn>1</mn><mo separator=\"true\">,</mo><mn>1</mn><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">(1, 1)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord\">1</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">1</span><span class=\"mclose\">)</span></span></span></span>","key":"mpGGjLubPu"},{"type":"text","value":" sont tous à distance 1. C’est la distance du joueur d’échecs (le roi peut se déplacer d’une case dans n’importe quelle direction).","position":{"start":{"line":137,"column":1},"end":{"line":137,"column":1}},"key":"bS78ucwjAQ"}],"key":"tacfiQpISF"}],"key":"NnAPvR3L4U"}],"key":"cunfK4K7yV"},{"type":"paragraph","position":{"start":{"line":139,"column":1},"end":{"line":139,"column":1}},"children":[{"type":"text","value":"Pour les k-ppv, la forme de la boule détermine quels points sont considérés voisins. Avec ","position":{"start":{"line":139,"column":1},"end":{"line":139,"column":1}},"key":"AfcKbpGShn"},{"type":"inlineMath","value":"\\ell_1","position":{"start":{"line":139,"column":1},"end":{"line":139,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi mathvariant=\"normal\">ℓ</mi><mn>1</mn></msub></mrow><annotation encoding=\"application/x-tex\">\\ell_1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8444em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord\">ℓ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"um4k1dmnCA"},{"type":"text","value":", les voisins forment un losange autour de la requête; avec ","position":{"start":{"line":139,"column":1},"end":{"line":139,"column":1}},"key":"BcXfgshVNg"},{"type":"inlineMath","value":"\\ell_\\infty","position":{"start":{"line":139,"column":1},"end":{"line":139,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi mathvariant=\"normal\">ℓ</mi><mi mathvariant=\"normal\">∞</mi></msub></mrow><annotation encoding=\"application/x-tex\">\\ell_\\infty</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8444em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord\">ℓ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">∞</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"Awpglzl0d9"},{"type":"text","value":", un carré.","position":{"start":{"line":139,"column":1},"end":{"line":139,"column":1}},"key":"hJtrEW9qA3"}],"key":"bLgq3LSyNi"}],"key":"k7k4Bi93yy"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"import numpy as np\nimport matplotlib.pyplot as plt\n\nfig, axes = plt.subplots(1, 3, figsize=(11, 4))\n\n# Unit balls for different norms\ntheta = np.linspace(0, 2*np.pi, 1000)\n\n# Key points to highlight\np1 = (1, 0)\np2 = (1/np.sqrt(2), 1/np.sqrt(2))  # ≈ (0.71, 0.71)\n\n# L1 norm (diamond)\nax = axes[0]\nt = np.linspace(0, 1, 250)\nx_l1 = np.concatenate([t, 1-t, -t, -1+t])\ny_l1 = np.concatenate([1-t, -t, -1+t, t])\nax.fill(x_l1, y_l1, alpha=0.3, color='C0')\nax.plot(x_l1, y_l1, 'C0-', linewidth=2)\n\n# Show points - (1,0) is on boundary, (0.71, 0.71) is OUTSIDE\nax.scatter([p1[0]], [p1[1]], s=80, c='black', zorder=5)\nax.scatter([p2[0]], [p2[1]], s=80, c='red', zorder=5)\nax.annotate(f'$(1, 0)$\\n$d=1$', p1, textcoords='offset points', \n            xytext=(5, 10), fontsize=9)\nax.annotate(f'$(0.71, 0.71)$\\n$d=1.42$', p2, textcoords='offset points', \n            xytext=(5, 10), fontsize=9, color='red')\n\nax.set_title(r'Norme $\\ell_1$ (Manhattan)')\nax.set_xlim(-1.5, 1.5)\nax.set_ylim(-1.5, 1.5)\nax.set_aspect('equal')\nax.axhline(0, color='gray', linewidth=0.5)\nax.axvline(0, color='gray', linewidth=0.5)\nax.set_xlabel('$x_1$')\nax.set_ylabel('$x_2$')\n\n# L2 norm (circle)\nax = axes[1]\nx_l2 = np.cos(theta)\ny_l2 = np.sin(theta)\nax.fill(x_l2, y_l2, alpha=0.3, color='C1')\nax.plot(x_l2, y_l2, 'C1-', linewidth=2)\n\n# Both points are on the boundary for L2\nax.scatter([p1[0]], [p1[1]], s=80, c='black', zorder=5)\nax.scatter([p2[0]], [p2[1]], s=80, c='black', zorder=5)\nax.annotate(f'$(1, 0)$\\n$d=1$', p1, textcoords='offset points', \n            xytext=(5, 10), fontsize=9)\nax.annotate(f'$(0.71, 0.71)$\\n$d=1$', p2, textcoords='offset points', \n            xytext=(5, 10), fontsize=9)\n\nax.set_title(r'Norme $\\ell_2$ (Euclidienne)')\nax.set_xlim(-1.5, 1.5)\nax.set_ylim(-1.5, 1.5)\nax.set_aspect('equal')\nax.axhline(0, color='gray', linewidth=0.5)\nax.axvline(0, color='gray', linewidth=0.5)\nax.set_xlabel('$x_1$')\nax.set_ylabel('$x_2$')\n\n# L-infinity norm (square)\nax = axes[2]\nx_linf = np.array([1, 1, -1, -1, 1])\ny_linf = np.array([1, -1, -1, 1, 1])\nax.fill(x_linf, y_linf, alpha=0.3, color='C2')\nax.plot(x_linf, y_linf, 'C2-', linewidth=2)\n\n# For L-inf: (1,0), (1,0.5), (1,1) all have distance 1\np_inf = [(1, 0), (1, 0.5), (1, 1)]\nfor i, p in enumerate(p_inf):\n    ax.scatter([p[0]], [p[1]], s=80, c='black', zorder=5)\nax.annotate('$(1, 0)$\\n$d=1$', p_inf[0], textcoords='offset points', \n            xytext=(-45, -5), fontsize=9)\nax.annotate('$(1, 0.5)$\\n$d=1$', p_inf[1], textcoords='offset points', \n            xytext=(5, -5), fontsize=9)\nax.annotate('$(1, 1)$\\n$d=1$', p_inf[2], textcoords='offset points', \n            xytext=(5, 5), fontsize=9)\n\nax.set_title(r'Norme $\\ell_\\infty$')\nax.set_xlim(-1.5, 1.5)\nax.set_ylim(-1.5, 1.5)\nax.set_aspect('equal')\nax.axhline(0, color='gray', linewidth=0.5)\nax.axvline(0, color='gray', linewidth=0.5)\nax.set_xlabel('$x_1$')\nax.set_ylabel('$x_2$')\n\nplt.tight_layout()","visibility":"hide","key":"Nfwhtwvb0s"},{"type":"outputs","id":"g_yKFofLFldJ56EIKbLO2","children":[{"type":"output","children":[],"jupyter_data":{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"<Figure size 1100x400 with 3 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"80825433bf9e3cd3957ae711559478d0","path":"/mlbook/build/80825433bf9e3cd3957ae711559478d0.png"}}},"key":"OxjNzV0C24"}],"visibility":"show","key":"mSlplDj4yJ"}],"data":{"tags":[]},"visibility":"show","key":"w0eOVchDHT"},{"type":"block","children":[{"type":"heading","depth":3,"position":{"start":{"line":235,"column":1},"end":{"line":235,"column":1}},"children":[{"type":"text","value":"Données numériques: normalisation et corrélation","position":{"start":{"line":235,"column":1},"end":{"line":235,"column":1}},"key":"bZ1h4d5Zr0"}],"identifier":"donn-es-num-riques-normalisation-et-corr-lation","label":"Données numériques: normalisation et corrélation","html_id":"donn-es-num-riques-normalisation-et-corr-lation","implicit":true,"key":"lVP80f2U6V"},{"type":"paragraph","position":{"start":{"line":237,"column":1},"end":{"line":237,"column":1}},"children":[{"type":"text","value":"La distance euclidienne traite toutes les dimensions de manière égale. Si les variables ont des échelles différentes, certaines domineront le calcul. Imaginons un problème où ","position":{"start":{"line":237,"column":1},"end":{"line":237,"column":1}},"key":"O12BE5hpPv"},{"type":"inlineMath","value":"x_1","position":{"start":{"line":237,"column":1},"end":{"line":237,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>x</mi><mn>1</mn></msub></mrow><annotation encoding=\"application/x-tex\">x_1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"cg3RabyYnD"},{"type":"text","value":" est l’âge (0-100) et ","position":{"start":{"line":237,"column":1},"end":{"line":237,"column":1}},"key":"jzoxueVk0k"},{"type":"inlineMath","value":"x_2","position":{"start":{"line":237,"column":1},"end":{"line":237,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>x</mi><mn>2</mn></msub></mrow><annotation encoding=\"application/x-tex\">x_2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"RrSZm2rjNj"},{"type":"text","value":" est le revenu annuel (0-500000). Sans normalisation, la différence de revenu écrasera la différence d’âge.","position":{"start":{"line":237,"column":1},"end":{"line":237,"column":1}},"key":"Sj4bwcII34"}],"key":"ri3B7rNJpl"},{"type":"paragraph","position":{"start":{"line":239,"column":1},"end":{"line":239,"column":1}},"children":[{"type":"strong","position":{"start":{"line":239,"column":1},"end":{"line":239,"column":1}},"children":[{"type":"text","value":"Solution pratique","position":{"start":{"line":239,"column":1},"end":{"line":239,"column":1}},"key":"evY4EMlsJi"}],"key":"jkLOOOF4TS"},{"type":"text","value":": normaliser les variables (soustraire la moyenne, diviser par l’écart-type) avant d’appliquer les k-ppv. C’est presque toujours nécessaire pour des données tabulaires.","position":{"start":{"line":239,"column":1},"end":{"line":239,"column":1}},"key":"fNi9RQfRdn"}],"key":"dspWQWOLZ7"},{"type":"paragraph","position":{"start":{"line":241,"column":1},"end":{"line":241,"column":1}},"children":[{"type":"text","value":"La ","position":{"start":{"line":241,"column":1},"end":{"line":241,"column":1}},"key":"DLPyHDn8rl"},{"type":"strong","position":{"start":{"line":241,"column":1},"end":{"line":241,"column":1}},"children":[{"type":"text","value":"distance de Mahalanobis","position":{"start":{"line":241,"column":1},"end":{"line":241,"column":1}},"key":"KHlCXg7dNM"}],"key":"VFL1R2dhLJ"},{"type":"text","value":" va plus loin en tenant compte des corrélations:","position":{"start":{"line":241,"column":1},"end":{"line":241,"column":1}},"key":"e8N6n8odgU"}],"key":"fFpfvkaGrD"},{"type":"math","value":"d_M(x, y) = \\sqrt{(x - y)^\\top \\Sigma^{-1} (x - y)}","position":{"start":{"line":243,"column":1},"end":{"line":245,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><msub><mi>d</mi><mi>M</mi></msub><mo stretchy=\"false\">(</mo><mi>x</mi><mo separator=\"true\">,</mo><mi>y</mi><mo stretchy=\"false\">)</mo><mo>=</mo><msqrt><mrow><mo stretchy=\"false\">(</mo><mi>x</mi><mo>−</mo><mi>y</mi><msup><mo stretchy=\"false\">)</mo><mi mathvariant=\"normal\">⊤</mi></msup><msup><mi mathvariant=\"normal\">Σ</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><mo stretchy=\"false\">(</mo><mi>x</mi><mo>−</mo><mi>y</mi><mo stretchy=\"false\">)</mo></mrow></msqrt></mrow><annotation encoding=\"application/x-tex\">d_M(x, y) = \\sqrt{(x - y)^\\top \\Sigma^{-1} (x - y)}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">d</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3283em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.10903em;\">M</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.84em;vertical-align:-0.5436em;\"></span><span class=\"mord sqrt\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.2964em;\"><span class=\"svg-align\" style=\"top:-3.8em;\"><span class=\"pstrut\" style=\"height:3.8em;\"></span><span class=\"mord\" style=\"padding-left:1em;\"><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mclose\"><span class=\"mclose\">)</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7751em;\"><span style=\"top:-2.989em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">⊤</span></span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord\">Σ</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7401em;\"><span style=\"top:-2.989em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">−</span><span class=\"mord mtight\">1</span></span></span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mclose\">)</span></span></span><span style=\"top:-3.2564em;\"><span class=\"pstrut\" style=\"height:3.8em;\"></span><span class=\"hide-tail\" style=\"min-width:1.02em;height:1.88em;\"><svg xmlns=\"http://www.w3.org/2000/svg\" width='400em' height='1.88em' viewBox='0 0 400000 1944' preserveAspectRatio='xMinYMin slice'><path d='M983 90\nl0 -0\nc4,-6.7,10,-10,18,-10 H400000v40\nH1013.1s-83.4,268,-264.1,840c-180.7,572,-277,876.3,-289,913c-4.7,4.7,-12.7,7,-24,7\ns-12,0,-12,0c-1.3,-3.3,-3.7,-11.7,-7,-25c-35.3,-125.3,-106.7,-373.3,-214,-744\nc-10,12,-21,25,-33,39s-32,39,-32,39c-6,-5.3,-15,-14,-27,-26s25,-30,25,-30\nc26.7,-32.7,52,-63,76,-91s52,-60,52,-60s208,722,208,722\nc56,-175.3,126.3,-397.3,211,-666c84.7,-268.7,153.8,-488.2,207.5,-658.5\nc53.7,-170.3,84.5,-266.8,92.5,-289.5z\nM1001 80h400000v40h-400000z'/></svg></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.5436em;\"><span></span></span></span></span></span></span></span></span></span>","enumerator":"7","key":"UBSsv8wMZP"},{"type":"paragraph","position":{"start":{"line":247,"column":1},"end":{"line":247,"column":1}},"children":[{"type":"text","value":"où ","position":{"start":{"line":247,"column":1},"end":{"line":247,"column":1}},"key":"peSIzpLV1y"},{"type":"inlineMath","value":"\\Sigma","position":{"start":{"line":247,"column":1},"end":{"line":247,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"normal\">Σ</mi></mrow><annotation encoding=\"application/x-tex\">\\Sigma</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord\">Σ</span></span></span></span>","key":"sVxTy3p14p"},{"type":"text","value":" est la matrice de covariance des données. Pour comprendre cette formule, décomposons-la.","position":{"start":{"line":247,"column":1},"end":{"line":247,"column":1}},"key":"kGFVR2SyAM"}],"key":"r6K3AifZzM"},{"type":"paragraph","position":{"start":{"line":249,"column":1},"end":{"line":249,"column":1}},"children":[{"type":"strong","position":{"start":{"line":249,"column":1},"end":{"line":249,"column":1}},"children":[{"type":"text","value":"La matrice de covariance ","position":{"start":{"line":249,"column":1},"end":{"line":249,"column":1}},"key":"ik77onDbpl"},{"type":"inlineMath","value":"\\Sigma","position":{"start":{"line":249,"column":1},"end":{"line":249,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"normal\">Σ</mi></mrow><annotation encoding=\"application/x-tex\">\\Sigma</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord\">Σ</span></span></span></span>","key":"iohNARkNi7"},{"type":"text","value":".","position":{"start":{"line":249,"column":1},"end":{"line":249,"column":1}},"key":"drbdPAAXqq"}],"key":"SELDqVLz5f"},{"type":"text","value":" Cette matrice ","position":{"start":{"line":249,"column":1},"end":{"line":249,"column":1}},"key":"d9gle8iFt1"},{"type":"inlineMath","value":"d \\times d","position":{"start":{"line":249,"column":1},"end":{"line":249,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>d</mi><mo>×</mo><mi>d</mi></mrow><annotation encoding=\"application/x-tex\">d \\times d</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7778em;vertical-align:-0.0833em;\"></span><span class=\"mord mathnormal\">d</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">×</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\">d</span></span></span></span>","key":"Hg9XoDu3mq"},{"type":"text","value":" capture deux informations: sur la diagonale, les variances de chaque variable; hors diagonale, les covariances (corrélations) entre variables. Si ","position":{"start":{"line":249,"column":1},"end":{"line":249,"column":1}},"key":"ssU4Tu2DeH"},{"type":"inlineMath","value":"\\Sigma = \\begin{pmatrix} 4 & 0 \\\\ 0 & 1 \\end{pmatrix}","position":{"start":{"line":249,"column":1},"end":{"line":249,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"normal\">Σ</mi><mo>=</mo><mrow><mo fence=\"true\">(</mo><mtable rowspacing=\"0.16em\" columnalign=\"center center\" columnspacing=\"1em\"><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>4</mn></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>0</mn></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>1</mn></mstyle></mtd></mtr></mtable><mo fence=\"true\">)</mo></mrow></mrow><annotation encoding=\"application/x-tex\">\\Sigma = \\begin{pmatrix} 4 &amp; 0 \\\\ 0 &amp; 1 \\end{pmatrix}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord\">Σ</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.4em;vertical-align:-0.95em;\"></span><span class=\"minner\"><span class=\"mopen delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size3\">(</span></span><span class=\"mord\"><span class=\"mtable\"><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.45em;\"><span style=\"top:-3.61em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">4</span></span></span><span style=\"top:-2.41em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">0</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.95em;\"><span></span></span></span></span></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.45em;\"><span style=\"top:-3.61em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">0</span></span></span><span style=\"top:-2.41em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.95em;\"><span></span></span></span></span></span></span></span><span class=\"mclose delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size3\">)</span></span></span></span></span></span>","key":"fsXdB1ovXU"},{"type":"text","value":", la première variable a une variance 4 fois plus grande que la seconde, et elles sont indépendantes.","position":{"start":{"line":249,"column":1},"end":{"line":249,"column":1}},"key":"DC1F0L1eQk"}],"key":"NEJc1qZ9Ov"},{"type":"paragraph","position":{"start":{"line":251,"column":1},"end":{"line":251,"column":1}},"children":[{"type":"strong","position":{"start":{"line":251,"column":1},"end":{"line":251,"column":1}},"children":[{"type":"text","value":"Calcul concret.","position":{"start":{"line":251,"column":1},"end":{"line":251,"column":1}},"key":"RObuVIW0l9"}],"key":"F3XWMSxpoR"},{"type":"text","value":" Soit ","position":{"start":{"line":251,"column":1},"end":{"line":251,"column":1}},"key":"FA9qE4WPOH"},{"type":"inlineMath","value":"X \\in \\mathbb{R}^{N \\times d}","position":{"start":{"line":251,"column":1},"end":{"line":251,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>X</mi><mo>∈</mo><msup><mi mathvariant=\"double-struck\">R</mi><mrow><mi>N</mi><mo>×</mo><mi>d</mi></mrow></msup></mrow><annotation encoding=\"application/x-tex\">X \\in \\mathbb{R}^{N \\times d}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7224em;vertical-align:-0.0391em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">∈</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8491em;\"></span><span class=\"mord\"><span class=\"mord mathbb\">R</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8491em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.10903em;\">N</span><span class=\"mbin mtight\">×</span><span class=\"mord mathnormal mtight\">d</span></span></span></span></span></span></span></span></span></span></span></span>","key":"Tp2hadMOTy"},{"type":"text","value":" la matrice des données (chaque ligne est un exemple). On centre d’abord les données en soustrayant la moyenne de chaque colonne:","position":{"start":{"line":251,"column":1},"end":{"line":251,"column":1}},"key":"GdzkI1Fac2"}],"key":"MbCZ8mXvoS"},{"type":"math","value":"\\bar{x}_j = \\frac{1}{N} \\sum_{i=1}^{N} x_{ij}, \\quad \\tilde{X} = X - \\mathbf{1} \\bar{x}^\\top","position":{"start":{"line":253,"column":1},"end":{"line":255,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><msub><mover accent=\"true\"><mi>x</mi><mo>ˉ</mo></mover><mi>j</mi></msub><mo>=</mo><mfrac><mn>1</mn><mi>N</mi></mfrac><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></munderover><msub><mi>x</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo separator=\"true\">,</mo><mspace width=\"1em\"/><mover accent=\"true\"><mi>X</mi><mo>~</mo></mover><mo>=</mo><mi>X</mi><mo>−</mo><mn mathvariant=\"bold\">1</mn><msup><mover accent=\"true\"><mi>x</mi><mo>ˉ</mo></mover><mi mathvariant=\"normal\">⊤</mi></msup></mrow><annotation encoding=\"application/x-tex\">\\bar{x}_j = \\frac{1}{N} \\sum_{i=1}^{N} x_{ij}, \\quad \\tilde{X} = X - \\mathbf{1} \\bar{x}^\\top</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8539em;vertical-align:-0.2861em;\"></span><span class=\"mord\"><span class=\"mord accent\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.5678em;\"><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord mathnormal\">x</span></span><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"accent-body\" style=\"left:-0.2222em;\"><span class=\"mord\">ˉ</span></span></span></span></span></span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:3.106em;vertical-align:-1.2777em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3214em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mop op-limits\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.8283em;\"><span style=\"top:-1.8723em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mrel mtight\">=</span><span class=\"mord mtight\">1</span></span></span></span><span style=\"top:-3.05em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span><span class=\"mop op-symbol large-op\">∑</span></span></span><span style=\"top:-4.3em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.10903em;\">N</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.2777em;\"><span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">ij</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:1em;\"></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord accent\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.9202em;\"><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span></span><span style=\"top:-3.6023em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"accent-body\" style=\"left:-0.1667em;\"><span class=\"mord\">~</span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7667em;vertical-align:-0.0833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8991em;\"></span><span class=\"mord mathbf\">1</span><span class=\"mord\"><span class=\"mord accent\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.5678em;\"><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord mathnormal\">x</span></span><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"accent-body\" style=\"left:-0.2222em;\"><span class=\"mord\">ˉ</span></span></span></span></span></span></span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8991em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">⊤</span></span></span></span></span></span></span></span></span></span></span></span>","enumerator":"8","key":"W4w746Fz0u"},{"type":"paragraph","position":{"start":{"line":257,"column":1},"end":{"line":257,"column":1}},"children":[{"type":"text","value":"La covariance empirique est alors:","position":{"start":{"line":257,"column":1},"end":{"line":257,"column":1}},"key":"HWlV4UIdEL"}],"key":"wTM6EahNSK"},{"type":"math","value":"\\Sigma = \\frac{1}{N-1} \\tilde{X}^\\top \\tilde{X}","position":{"start":{"line":259,"column":1},"end":{"line":261,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi mathvariant=\"normal\">Σ</mi><mo>=</mo><mfrac><mn>1</mn><mrow><mi>N</mi><mo>−</mo><mn>1</mn></mrow></mfrac><msup><mover accent=\"true\"><mi>X</mi><mo>~</mo></mover><mi mathvariant=\"normal\">⊤</mi></msup><mover accent=\"true\"><mi>X</mi><mo>~</mo></mover></mrow><annotation encoding=\"application/x-tex\">\\Sigma = \\frac{1}{N-1} \\tilde{X}^\\top \\tilde{X}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord\">Σ</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.0908em;vertical-align:-0.7693em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3214em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\">1</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7693em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mord\"><span class=\"mord accent\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.9202em;\"><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span></span><span style=\"top:-3.6023em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"accent-body\" style=\"left:-0.1667em;\"><span class=\"mord\">~</span></span></span></span></span></span></span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8991em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">⊤</span></span></span></span></span></span></span></span><span class=\"mord accent\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.9202em;\"><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span></span><span style=\"top:-3.6023em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"accent-body\" style=\"left:-0.1667em;\"><span class=\"mord\">~</span></span></span></span></span></span></span></span></span></span></span>","enumerator":"9","key":"X5kKiX0unx"},{"type":"paragraph","position":{"start":{"line":263,"column":1},"end":{"line":263,"column":1}},"children":[{"type":"text","value":"L’élément ","position":{"start":{"line":263,"column":1},"end":{"line":263,"column":1}},"key":"Mu5T2LE1fk"},{"type":"inlineMath","value":"(j, k)","position":{"start":{"line":263,"column":1},"end":{"line":263,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">(</mo><mi>j</mi><mo separator=\"true\">,</mo><mi>k</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">(j, k)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.05724em;\">j</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span><span class=\"mclose\">)</span></span></span></span>","key":"LX2Om1mUpO"},{"type":"text","value":" de cette matrice est ","position":{"start":{"line":263,"column":1},"end":{"line":263,"column":1}},"key":"OO0Ut2WZ0A"},{"type":"inlineMath","value":"\\Sigma_{jk} = \\frac{1}{N-1} \\sum_{i=1}^{N} (x_{ij} - \\bar{x}_j)(x_{ik} - \\bar{x}_k)","position":{"start":{"line":263,"column":1},"end":{"line":263,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi mathvariant=\"normal\">Σ</mi><mrow><mi>j</mi><mi>k</mi></mrow></msub><mo>=</mo><mfrac><mn>1</mn><mrow><mi>N</mi><mo>−</mo><mn>1</mn></mrow></mfrac><msubsup><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></msubsup><mo stretchy=\"false\">(</mo><msub><mi>x</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>−</mo><msub><mover accent=\"true\"><mi>x</mi><mo>ˉ</mo></mover><mi>j</mi></msub><mo stretchy=\"false\">)</mo><mo stretchy=\"false\">(</mo><msub><mi>x</mi><mrow><mi>i</mi><mi>k</mi></mrow></msub><mo>−</mo><msub><mover accent=\"true\"><mi>x</mi><mo>ˉ</mo></mover><mi>k</mi></msub><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">\\Sigma_{jk} = \\frac{1}{N-1} \\sum_{i=1}^{N} (x_{ij} - \\bar{x}_j)(x_{ik} - \\bar{x}_k)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.9694em;vertical-align:-0.2861em;\"></span><span class=\"mord\"><span class=\"mord\">Σ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">jk</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.3846em;vertical-align:-0.4033em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8451em;\"><span style=\"top:-2.655em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.10903em;\">N</span><span class=\"mbin mtight\">−</span><span class=\"mord mtight\">1</span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.394em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.4033em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mop\"><span class=\"mop op-symbol small-op\" style=\"position:relative;top:0em;\">∑</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.9812em;\"><span style=\"top:-2.4003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mrel mtight\">=</span><span class=\"mord mtight\">1</span></span></span></span><span style=\"top:-3.2029em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.10903em;\">N</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2997em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">ij</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.0361em;vertical-align:-0.2861em;\"></span><span class=\"mord\"><span class=\"mord accent\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.5678em;\"><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord mathnormal\">x</span></span><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"accent-body\" style=\"left:-0.2222em;\"><span class=\"mord\">ˉ</span></span></span></span></span></span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">ik</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord accent\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.5678em;\"><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord mathnormal\">x</span></span><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"accent-body\" style=\"left:-0.2222em;\"><span class=\"mord\">ˉ</span></span></span></span></span></span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span>","key":"zjb5KF2FR4"},{"type":"text","value":". En Python:","position":{"start":{"line":263,"column":1},"end":{"line":263,"column":1}},"key":"v2tNAz9bev"}],"key":"XLsCx6J2Wm"},{"type":"code","lang":"python","value":"X_centered = X - X.mean(axis=0)\nSigma = (X_centered.T @ X_centered) / (len(X) - 1)\n# ou directement: Sigma = np.cov(X.T)","position":{"start":{"line":265,"column":1},"end":{"line":269,"column":1}},"key":"fsik1s5Npm"},{"type":"paragraph","position":{"start":{"line":271,"column":1},"end":{"line":271,"column":1}},"children":[{"type":"strong","position":{"start":{"line":271,"column":1},"end":{"line":271,"column":1}},"children":[{"type":"text","value":"L’inverse ","position":{"start":{"line":271,"column":1},"end":{"line":271,"column":1}},"key":"VAGOPJCMr5"},{"type":"inlineMath","value":"\\Sigma^{-1}","position":{"start":{"line":271,"column":1},"end":{"line":271,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi mathvariant=\"normal\">Σ</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup></mrow><annotation encoding=\"application/x-tex\">\\Sigma^{-1}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8141em;\"></span><span class=\"mord\"><span class=\"mord\">Σ</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">−</span><span class=\"mord mtight\">1</span></span></span></span></span></span></span></span></span></span></span></span>","key":"egSGmtI5E5"},{"type":"text","value":".","position":{"start":{"line":271,"column":1},"end":{"line":271,"column":1}},"key":"zTPMgpfRu4"}],"key":"i4BGs0GNrD"},{"type":"text","value":" Multiplier par l’inverse de la covariance “blanchit” les données: les directions de forte variance sont comprimées, les corrélations sont supprimées. Après cette transformation, les données ressemblent à un nuage sphérique de variance unitaire.","position":{"start":{"line":271,"column":1},"end":{"line":271,"column":1}},"key":"hkLahh3s6q"}],"key":"ylRMPQ9VZI"},{"type":"paragraph","position":{"start":{"line":273,"column":1},"end":{"line":273,"column":1}},"children":[{"type":"strong","position":{"start":{"line":273,"column":1},"end":{"line":273,"column":1}},"children":[{"type":"text","value":"Interprétation géométrique.","position":{"start":{"line":273,"column":1},"end":{"line":273,"column":1}},"key":"QDVPDkDxKJ"}],"key":"v8Q2admLJU"},{"type":"text","value":" La distance de Mahalanobis mesure “à combien d’écarts-types” un point se trouve d’un autre, en tenant compte de la forme du nuage de données. Deux points éloignés dans une direction de forte variance sont considérés plus proches que deux points également éloignés dans une direction de faible variance.","position":{"start":{"line":273,"column":1},"end":{"line":273,"column":1}},"key":"STZ1g9j4wq"}],"key":"eDDx9Ijxhf"}],"key":"M3Lrk64N8z"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"import numpy as np\nimport matplotlib.pyplot as plt\nfrom matplotlib.patches import Ellipse\n\nnp.random.seed(42)\n\n# Generate correlated 2D data\nn = 200\nmean = [0, 0]\ncov = [[2, 1.5], [1.5, 1.5]]  # Correlated, different variances\nX = np.random.multivariate_normal(mean, cov, n)\n\n# Compute sample covariance\nSigma = np.cov(X.T)\nSigma_inv = np.linalg.inv(Sigma)\n\n# A reference point and a query point\nref = np.array([0, 0])\nquery1 = np.array([2, 0])    # Along high-variance direction\nquery2 = np.array([-0.5, 1]) # Along low-variance direction\n\n# Compute distances\ndef euclidean(a, b):\n    return np.sqrt(np.sum((a - b)**2))\n\ndef mahalanobis(a, b, Sigma_inv):\n    diff = a - b\n    return np.sqrt(diff @ Sigma_inv @ diff)\n\nd_euc1 = euclidean(ref, query1)\nd_euc2 = euclidean(ref, query2)\nd_mah1 = mahalanobis(ref, query1, Sigma_inv)\nd_mah2 = mahalanobis(ref, query2, Sigma_inv)\n\nfig, axes = plt.subplots(1, 2, figsize=(12, 5))\n\n# Left: Euclidean view\nax = axes[0]\nax.scatter(X[:, 0], X[:, 1], alpha=0.3, s=20, c='gray')\nax.scatter([ref[0]], [ref[1]], s=100, c='black', zorder=5, label='Référence')\nax.scatter([query1[0]], [query1[1]], s=100, c='C0', zorder=5, marker='s')\nax.scatter([query2[0]], [query2[1]], s=100, c='C1', zorder=5, marker='^')\n\n# Draw circles for Euclidean distance\ncircle1 = plt.Circle(ref, d_euc1, fill=False, color='C0', linestyle='--', linewidth=2)\ncircle2 = plt.Circle(ref, d_euc2, fill=False, color='C1', linestyle='--', linewidth=2)\nax.add_patch(circle1)\nax.add_patch(circle2)\n\nax.annotate(f'$d_{{euc}} = {d_euc1:.2f}$', query1, textcoords='offset points', \n            xytext=(10, 10), fontsize=10, color='C0')\nax.annotate(f'$d_{{euc}} = {d_euc2:.2f}$', query2, textcoords='offset points', \n            xytext=(10, 10), fontsize=10, color='C1')\n\nax.set_xlim(-4, 4)\nax.set_ylim(-4, 4)\nax.set_aspect('equal')\nax.set_xlabel('$x_1$')\nax.set_ylabel('$x_2$')\nax.set_title('Distance Euclidienne\\n(ignore la structure des données)')\n\n# Right: Mahalanobis view\nax = axes[1]\nax.scatter(X[:, 0], X[:, 1], alpha=0.3, s=20, c='gray')\nax.scatter([ref[0]], [ref[1]], s=100, c='black', zorder=5, label='Référence')\nax.scatter([query1[0]], [query1[1]], s=100, c='C0', zorder=5, marker='s')\nax.scatter([query2[0]], [query2[1]], s=100, c='C1', zorder=5, marker='^')\n\n# Draw ellipses for Mahalanobis distance (iso-distance contours)\n# Eigendecomposition for ellipse orientation\neigenvalues, eigenvectors = np.linalg.eigh(Sigma)\nangle = np.degrees(np.arctan2(eigenvectors[1, 1], eigenvectors[0, 1]))\n\nfor d_mah, color in [(d_mah1, 'C0'), (d_mah2, 'C1')]:\n    width = 2 * d_mah * np.sqrt(eigenvalues[1])\n    height = 2 * d_mah * np.sqrt(eigenvalues[0])\n    ellipse = Ellipse(ref, width, height, angle=angle, fill=False, \n                      color=color, linestyle='--', linewidth=2)\n    ax.add_patch(ellipse)\n\nax.annotate(f'$d_{{mah}} = {d_mah1:.2f}$', query1, textcoords='offset points', \n            xytext=(10, 10), fontsize=10, color='C0')\nax.annotate(f'$d_{{mah}} = {d_mah2:.2f}$', query2, textcoords='offset points', \n            xytext=(10, 10), fontsize=10, color='C1')\n\nax.set_xlim(-4, 4)\nax.set_ylim(-4, 4)\nax.set_aspect('equal')\nax.set_xlabel('$x_1$')\nax.set_ylabel('$x_2$')\nax.set_title('Distance de Mahalanobis\\n(tient compte de la covariance)')\n\nplt.tight_layout()","visibility":"hide","key":"w1ZwXYPSiZ"},{"type":"outputs","id":"XP0CATJHMpQ-FYzVvOKdc","children":[{"type":"output","children":[],"jupyter_data":{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"<Figure size 1200x500 with 2 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"1d3c22f547d6ab53249d78770d55b254","path":"/mlbook/build/1d3c22f547d6ab53249d78770d55b254.png"}}},"key":"LiNcLcinrX"}],"visibility":"show","key":"gMFfRdWvev"}],"data":{"tags":[]},"visibility":"show","key":"c9djUnnpf9"},{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":373,"column":1},"end":{"line":373,"column":1}},"children":[{"type":"text","value":"Dans cet exemple, le point bleu (carré) est plus loin en distance euclidienne, mais plus proche en distance de Mahalanobis. Cela s’explique par le fait qu’il se trouve dans la direction où les données varient naturellement. Le point orange (triangle), bien que plus proche en euclidien, est “surprenant” par rapport à la distribution et donc plus loin en Mahalanobis.","position":{"start":{"line":373,"column":1},"end":{"line":373,"column":1}},"key":"uA8J1rNNeb"}],"key":"i1L79rEJZl"},{"type":"paragraph","position":{"start":{"line":375,"column":1},"end":{"line":375,"column":1}},"children":[{"type":"text","value":"En pratique, on utilise rarement Mahalanobis directement pour les k-ppv. La normalisation standard (centrer et réduire chaque variable) capture l’essentiel. Mahalanobis devient utile quand les corrélations entre variables sont fortes et informatives.","position":{"start":{"line":375,"column":1},"end":{"line":375,"column":1}},"key":"tJ5oIFRCZP"}],"key":"eeJiM8Kiwz"},{"type":"heading","depth":3,"position":{"start":{"line":377,"column":1},"end":{"line":377,"column":1}},"children":[{"type":"text","value":"Au-delà des vecteurs numériques","position":{"start":{"line":377,"column":1},"end":{"line":377,"column":1}},"key":"LtoE3FP4hL"}],"identifier":"au-del-des-vecteurs-num-riques","label":"Au-delà des vecteurs numériques","html_id":"au-del-des-vecteurs-num-riques","implicit":true,"key":"vU76vvKFqK"},{"type":"paragraph","position":{"start":{"line":379,"column":1},"end":{"line":379,"column":1}},"children":[{"type":"text","value":"Les k-ppv ne se limitent pas aux vecteurs dans ","position":{"start":{"line":379,"column":1},"end":{"line":379,"column":1}},"key":"r5FdtOsWbl"},{"type":"inlineMath","value":"\\mathbb{R}^d","position":{"start":{"line":379,"column":1},"end":{"line":379,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi mathvariant=\"double-struck\">R</mi><mi>d</mi></msup></mrow><annotation encoding=\"application/x-tex\">\\mathbb{R}^d</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8491em;\"></span><span class=\"mord\"><span class=\"mord mathbb\">R</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8491em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">d</span></span></span></span></span></span></span></span></span></span></span>","key":"zP5mRnI3ZW"},{"type":"text","value":". Toute fonction de distance valide permet d’appliquer l’algorithme.","position":{"start":{"line":379,"column":1},"end":{"line":379,"column":1}},"key":"BkgLnJ3Pz1"}],"key":"dElD9ACazz"},{"type":"paragraph","position":{"start":{"line":381,"column":1},"end":{"line":381,"column":1}},"children":[{"type":"strong","position":{"start":{"line":381,"column":1},"end":{"line":381,"column":1}},"children":[{"type":"text","value":"Chaînes de caractères et ADN.","position":{"start":{"line":381,"column":1},"end":{"line":381,"column":1}},"key":"NpuSF6cNtd"}],"key":"KAy7g7gStF"},{"type":"text","value":" La ","position":{"start":{"line":381,"column":1},"end":{"line":381,"column":1}},"key":"fqFVfqzuJx"},{"type":"strong","position":{"start":{"line":381,"column":1},"end":{"line":381,"column":1}},"children":[{"type":"text","value":"distance d’édition","position":{"start":{"line":381,"column":1},"end":{"line":381,"column":1}},"key":"E4oWU8eSLH"}],"key":"JI6AtKkIgI"},{"type":"text","value":" (ou distance de Levenshtein) compte le nombre minimum d’opérations (insertion, suppression, substitution) pour transformer une chaîne en une autre:","position":{"start":{"line":381,"column":1},"end":{"line":381,"column":1}},"key":"yfKb7gz3nx"}],"key":"RljpKazyHA"},{"type":"math","value":"d_{\\text{edit}}(\\texttt{\"chat\"}, \\texttt{\"chien\"}) = 3","position":{"start":{"line":383,"column":1},"end":{"line":385,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><msub><mi>d</mi><mtext>edit</mtext></msub><mo stretchy=\"false\">(</mo><mtext mathvariant=\"monospace\">&quot;chat&quot;</mtext><mo separator=\"true\">,</mo><mtext mathvariant=\"monospace\">&quot;chien&quot;</mtext><mo stretchy=\"false\">)</mo><mo>=</mo><mn>3</mn></mrow><annotation encoding=\"application/x-tex\">d_{\\text{edit}}(\\texttt{&quot;chat&quot;}, \\texttt{&quot;chien&quot;}) = 3</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">d</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord text mtight\"><span class=\"mord mtight\">edit</span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord text\"><span class=\"mord texttt\">&quot;chat&quot;</span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord text\"><span class=\"mord texttt\">&quot;chien&quot;</span></span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">3</span></span></span></span></span>","enumerator":"10","key":"NeTsmnRuWQ"},{"type":"paragraph","position":{"start":{"line":387,"column":1},"end":{"line":387,"column":1}},"children":[{"type":"text","value":"Cette distance est utilisée pour la correction orthographique, l’alignement de séquences ADN, et la détection de plagiat. Pour comparer des séquences génétiques, on peut aussi utiliser des distances spécialisées qui tiennent compte de la biologie des mutations.","position":{"start":{"line":387,"column":1},"end":{"line":387,"column":1}},"key":"XkDPjA6m8w"}],"key":"aOsAGWcvpv"},{"type":"paragraph","position":{"start":{"line":389,"column":1},"end":{"line":389,"column":1}},"children":[{"type":"strong","position":{"start":{"line":389,"column":1},"end":{"line":389,"column":1}},"children":[{"type":"text","value":"Documents et texte.","position":{"start":{"line":389,"column":1},"end":{"line":389,"column":1}},"key":"PCKsDxLuiU"}],"key":"cNpvyzAk7P"},{"type":"text","value":" Pour comparer des documents, on les représente souvent comme des vecteurs de fréquences de mots (bag-of-words). La ","position":{"start":{"line":389,"column":1},"end":{"line":389,"column":1}},"key":"uHc3DTIBFK"},{"type":"strong","position":{"start":{"line":389,"column":1},"end":{"line":389,"column":1}},"children":[{"type":"text","value":"similarité cosinus","position":{"start":{"line":389,"column":1},"end":{"line":389,"column":1}},"key":"DJ1CEDcBnC"}],"key":"syAbgLq6CQ"},{"type":"text","value":" mesure l’angle entre ces vecteurs:","position":{"start":{"line":389,"column":1},"end":{"line":389,"column":1}},"key":"HoGofpj7La"}],"key":"AF4pEp5LF5"},{"type":"math","value":"\\text{sim}_{\\cos}(x, y) = \\frac{x \\cdot y}{\\|x\\| \\|y\\|}","position":{"start":{"line":391,"column":1},"end":{"line":393,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><msub><mtext>sim</mtext><mi>cos</mi><mo>⁡</mo></msub><mo stretchy=\"false\">(</mo><mi>x</mi><mo separator=\"true\">,</mo><mi>y</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mfrac><mrow><mi>x</mi><mo>⋅</mo><mi>y</mi></mrow><mrow><mi mathvariant=\"normal\">∥</mi><mi>x</mi><mi mathvariant=\"normal\">∥</mi><mi mathvariant=\"normal\">∥</mi><mi>y</mi><mi mathvariant=\"normal\">∥</mi></mrow></mfrac></mrow><annotation encoding=\"application/x-tex\">\\text{sim}_{\\cos}(x, y) = \\frac{x \\cdot y}{\\|x\\| \\|y\\|}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord text\"><span class=\"mord\">sim</span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mop mtight\"><span class=\"mtight\">c</span><span class=\"mtight\">o</span><span class=\"mtight\">s</span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.0574em;vertical-align:-0.936em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.1214em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">∥</span><span class=\"mord mathnormal\">x</span><span class=\"mord\">∥∥</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mord\">∥</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">⋅</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.936em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span></span>","enumerator":"11","key":"DvzVzXYV1n"},{"type":"paragraph","position":{"start":{"line":395,"column":1},"end":{"line":395,"column":1}},"children":[{"type":"text","value":"On convertit en distance par ","position":{"start":{"line":395,"column":1},"end":{"line":395,"column":1}},"key":"NSlzCz4RFU"},{"type":"inlineMath","value":"d = 1 - \\text{sim}_{\\cos}","position":{"start":{"line":395,"column":1},"end":{"line":395,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>d</mi><mo>=</mo><mn>1</mn><mo>−</mo><msub><mtext>sim</mtext><mi>cos</mi><mo>⁡</mo></msub></mrow><annotation encoding=\"application/x-tex\">d = 1 - \\text{sim}_{\\cos}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\">d</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7278em;vertical-align:-0.0833em;\"></span><span class=\"mord\">1</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8179em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord text\"><span class=\"mord\">sim</span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mop mtight\"><span class=\"mtight\">c</span><span class=\"mtight\">o</span><span class=\"mtight\">s</span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"sxWmrRT3Bk"},{"type":"text","value":". Cette mesure ignore la longueur des documents et se concentre sur leur contenu thématique. C’est le choix standard pour la recherche d’information et la classification de texte.","position":{"start":{"line":395,"column":1},"end":{"line":395,"column":1}},"key":"uOxRCQg6NC"}],"key":"uuZgSTTsNA"},{"type":"paragraph","position":{"start":{"line":397,"column":1},"end":{"line":397,"column":1}},"children":[{"type":"strong","position":{"start":{"line":397,"column":1},"end":{"line":397,"column":1}},"children":[{"type":"text","value":"Ensembles et données binaires.","position":{"start":{"line":397,"column":1},"end":{"line":397,"column":1}},"key":"omVoZ9xgIp"}],"key":"A20mSZMEnZ"},{"type":"text","value":" Pour des données représentées comme des ensembles (mots-clés, tags, gènes exprimés), la ","position":{"start":{"line":397,"column":1},"end":{"line":397,"column":1}},"key":"cauFyCpWRm"},{"type":"strong","position":{"start":{"line":397,"column":1},"end":{"line":397,"column":1}},"children":[{"type":"text","value":"distance de Jaccard","position":{"start":{"line":397,"column":1},"end":{"line":397,"column":1}},"key":"a2QjPriHKd"}],"key":"niaoo6Un7q"},{"type":"text","value":" mesure le chevauchement:","position":{"start":{"line":397,"column":1},"end":{"line":397,"column":1}},"key":"dKqwJMuD4p"}],"key":"ln0nZoSIg2"},{"type":"math","value":"d_{\\text{Jaccard}}(A, B) = 1 - \\frac{|A \\cap B|}{|A \\cup B|}","position":{"start":{"line":399,"column":1},"end":{"line":401,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><msub><mi>d</mi><mtext>Jaccard</mtext></msub><mo stretchy=\"false\">(</mo><mi>A</mi><mo separator=\"true\">,</mo><mi>B</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mn>1</mn><mo>−</mo><mfrac><mrow><mi mathvariant=\"normal\">∣</mi><mi>A</mi><mo>∩</mo><mi>B</mi><mi mathvariant=\"normal\">∣</mi></mrow><mrow><mi mathvariant=\"normal\">∣</mi><mi>A</mi><mo>∪</mo><mi>B</mi><mi mathvariant=\"normal\">∣</mi></mrow></mfrac></mrow><annotation encoding=\"application/x-tex\">d_{\\text{Jaccard}}(A, B) = 1 - \\frac{|A \\cap B|}{|A \\cup B|}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">d</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord text mtight\"><span class=\"mord mtight\">Jaccard</span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">A</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05017em;\">B</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7278em;vertical-align:-0.0833em;\"></span><span class=\"mord\">1</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.363em;vertical-align:-0.936em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.427em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">∣</span><span class=\"mord mathnormal\">A</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">∪</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05017em;\">B</span><span class=\"mord\">∣</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">∣</span><span class=\"mord mathnormal\">A</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">∩</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05017em;\">B</span><span class=\"mord\">∣</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.936em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span></span>","enumerator":"12","key":"rPOoQCNU3U"},{"type":"paragraph","position":{"start":{"line":403,"column":1},"end":{"line":403,"column":1}},"children":[{"type":"text","value":"Deux documents partageant 80% de leurs mots-clés ont une distance de 0.2. Pour des vecteurs binaires (présence/absence), la ","position":{"start":{"line":403,"column":1},"end":{"line":403,"column":1}},"key":"vyzlUQAWfI"},{"type":"strong","position":{"start":{"line":403,"column":1},"end":{"line":403,"column":1}},"children":[{"type":"text","value":"distance de Hamming","position":{"start":{"line":403,"column":1},"end":{"line":403,"column":1}},"key":"r9gPbd8ZuP"}],"key":"bcxsLvlp1u"},{"type":"text","value":" compte les positions différentes.","position":{"start":{"line":403,"column":1},"end":{"line":403,"column":1}},"key":"eld4io4PBD"}],"key":"sQSzA11w4L"},{"type":"paragraph","position":{"start":{"line":405,"column":1},"end":{"line":405,"column":1}},"children":[{"type":"strong","position":{"start":{"line":405,"column":1},"end":{"line":405,"column":1}},"children":[{"type":"text","value":"Images.","position":{"start":{"line":405,"column":1},"end":{"line":405,"column":1}},"key":"Dc50bdBVXk"}],"key":"OpeckCSFTV"},{"type":"text","value":" Les pixels bruts donnent des distances peu informatives. Par exemple, deux images du même objet décalé d’un pixel seraient très “différentes”. En pratique, on extrait des représentations (embeddings) via des réseaux de neurones pré-entraînés, puis on applique la distance euclidienne ou cosinus dans cet espace de représentation.","position":{"start":{"line":405,"column":1},"end":{"line":405,"column":1}},"key":"lYACmEZPfQ"}],"key":"PgnLXoW3p7"},{"type":"heading","depth":3,"position":{"start":{"line":407,"column":1},"end":{"line":407,"column":1}},"children":[{"type":"text","value":"Guide pratique: quelle distance choisir?","position":{"start":{"line":407,"column":1},"end":{"line":407,"column":1}},"key":"vvf89Xvx3H"}],"identifier":"guide-pratique-quelle-distance-choisir","label":"Guide pratique: quelle distance choisir?","html_id":"guide-pratique-quelle-distance-choisir","implicit":true,"key":"Juf6hs59Li"},{"type":"table","position":{"start":{"line":409,"column":1},"end":{"line":417,"column":1}},"children":[{"type":"tableRow","position":{"start":{"line":409,"column":1},"end":{"line":409,"column":1}},"children":[{"type":"tableCell","header":true,"position":{"start":{"line":409,"column":1},"end":{"line":409,"column":1}},"children":[{"type":"text","value":"Type de données","position":{"start":{"line":409,"column":1},"end":{"line":409,"column":1}},"key":"cEKE0wrZfY"}],"key":"Z4LWmBNlIY"},{"type":"tableCell","header":true,"position":{"start":{"line":409,"column":1},"end":{"line":409,"column":1}},"children":[{"type":"text","value":"Distance recommandée","position":{"start":{"line":409,"column":1},"end":{"line":409,"column":1}},"key":"WAkGKM5VKl"}],"key":"U9XTAmQbFi"},{"type":"tableCell","header":true,"position":{"start":{"line":409,"column":1},"end":{"line":409,"column":1}},"children":[{"type":"text","value":"Pourquoi","position":{"start":{"line":409,"column":1},"end":{"line":409,"column":1}},"key":"yk702sMPeM"}],"key":"gMlS9WEoKX"}],"key":"KqBdegZ7e3"},{"type":"tableRow","position":{"start":{"line":411,"column":1},"end":{"line":411,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":411,"column":1},"end":{"line":411,"column":1}},"children":[{"type":"text","value":"Vecteurs numériques","position":{"start":{"line":411,"column":1},"end":{"line":411,"column":1}},"key":"E1ada9evWV"}],"key":"q63tfR47A7"},{"type":"tableCell","position":{"start":{"line":411,"column":1},"end":{"line":411,"column":1}},"children":[{"type":"text","value":"Euclidienne (après normalisation)","position":{"start":{"line":411,"column":1},"end":{"line":411,"column":1}},"key":"lxXOT9Ddkl"}],"key":"YZPoceXaus"},{"type":"tableCell","position":{"start":{"line":411,"column":1},"end":{"line":411,"column":1}},"children":[{"type":"text","value":"Simple, efficace, interprétable","position":{"start":{"line":411,"column":1},"end":{"line":411,"column":1}},"key":"fatEwvAfVH"}],"key":"eNGzklYdXx"}],"key":"TpoaOAlXFA"},{"type":"tableRow","position":{"start":{"line":412,"column":1},"end":{"line":412,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":412,"column":1},"end":{"line":412,"column":1}},"children":[{"type":"text","value":"Données avec corrélations fortes","position":{"start":{"line":412,"column":1},"end":{"line":412,"column":1}},"key":"r2t5A9281B"}],"key":"od0isZ8E0o"},{"type":"tableCell","position":{"start":{"line":412,"column":1},"end":{"line":412,"column":1}},"children":[{"type":"text","value":"Mahalanobis ou PCA + Euclidienne","position":{"start":{"line":412,"column":1},"end":{"line":412,"column":1}},"key":"s1pu0oXL5y"}],"key":"gR5C4bf7kX"},{"type":"tableCell","position":{"start":{"line":412,"column":1},"end":{"line":412,"column":1}},"children":[{"type":"text","value":"Tient compte de la structure","position":{"start":{"line":412,"column":1},"end":{"line":412,"column":1}},"key":"bpNNm346GN"}],"key":"yRCaXPBUVL"}],"key":"NRZbE3dm9z"},{"type":"tableRow","position":{"start":{"line":413,"column":1},"end":{"line":413,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":413,"column":1},"end":{"line":413,"column":1}},"children":[{"type":"text","value":"Texte / documents","position":{"start":{"line":413,"column":1},"end":{"line":413,"column":1}},"key":"dMO2mEbbC2"}],"key":"D1jDcKhV22"},{"type":"tableCell","position":{"start":{"line":413,"column":1},"end":{"line":413,"column":1}},"children":[{"type":"text","value":"Cosinus sur TF-IDF ou embeddings","position":{"start":{"line":413,"column":1},"end":{"line":413,"column":1}},"key":"Z9boLR7EPi"}],"key":"ifiEQHkaYd"},{"type":"tableCell","position":{"start":{"line":413,"column":1},"end":{"line":413,"column":1}},"children":[{"type":"text","value":"Invariant à la longueur","position":{"start":{"line":413,"column":1},"end":{"line":413,"column":1}},"key":"IEo9unyzPl"}],"key":"cO447h5RQM"}],"key":"LqdjFCYDQf"},{"type":"tableRow","position":{"start":{"line":414,"column":1},"end":{"line":414,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":414,"column":1},"end":{"line":414,"column":1}},"children":[{"type":"text","value":"Séquences (ADN, protéines)","position":{"start":{"line":414,"column":1},"end":{"line":414,"column":1}},"key":"TYEeS871ji"}],"key":"vbA49cuxS3"},{"type":"tableCell","position":{"start":{"line":414,"column":1},"end":{"line":414,"column":1}},"children":[{"type":"text","value":"Distance d’édition ou alignement","position":{"start":{"line":414,"column":1},"end":{"line":414,"column":1}},"key":"w7OoaznZwk"}],"key":"pLFVaWT96k"},{"type":"tableCell","position":{"start":{"line":414,"column":1},"end":{"line":414,"column":1}},"children":[{"type":"text","value":"Capture les mutations/insertions","position":{"start":{"line":414,"column":1},"end":{"line":414,"column":1}},"key":"RMccQ2EGiX"}],"key":"p7iAko7jQe"}],"key":"tHQNazOMRw"},{"type":"tableRow","position":{"start":{"line":415,"column":1},"end":{"line":415,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":415,"column":1},"end":{"line":415,"column":1}},"children":[{"type":"text","value":"Ensembles, tags","position":{"start":{"line":415,"column":1},"end":{"line":415,"column":1}},"key":"sO44WyTMfo"}],"key":"UNCuamzIzt"},{"type":"tableCell","position":{"start":{"line":415,"column":1},"end":{"line":415,"column":1}},"children":[{"type":"text","value":"Jaccard","position":{"start":{"line":415,"column":1},"end":{"line":415,"column":1}},"key":"QyluyGeqG9"}],"key":"au36PPsxDM"},{"type":"tableCell","position":{"start":{"line":415,"column":1},"end":{"line":415,"column":1}},"children":[{"type":"text","value":"Mesure le chevauchement","position":{"start":{"line":415,"column":1},"end":{"line":415,"column":1}},"key":"kUFvLXpnqS"}],"key":"oJ8b2LRKBv"}],"key":"QLHqek7QQv"},{"type":"tableRow","position":{"start":{"line":416,"column":1},"end":{"line":416,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":416,"column":1},"end":{"line":416,"column":1}},"children":[{"type":"text","value":"Vecteurs binaires","position":{"start":{"line":416,"column":1},"end":{"line":416,"column":1}},"key":"LhD3EvQak9"}],"key":"HGeeNzAZ5x"},{"type":"tableCell","position":{"start":{"line":416,"column":1},"end":{"line":416,"column":1}},"children":[{"type":"text","value":"Hamming","position":{"start":{"line":416,"column":1},"end":{"line":416,"column":1}},"key":"VgTbMmDU9c"}],"key":"DmNH8kQRaY"},{"type":"tableCell","position":{"start":{"line":416,"column":1},"end":{"line":416,"column":1}},"children":[{"type":"text","value":"Compte les différences","position":{"start":{"line":416,"column":1},"end":{"line":416,"column":1}},"key":"nDLsxPxLMj"}],"key":"rV3jtAMbhf"}],"key":"JVF323UsMm"},{"type":"tableRow","position":{"start":{"line":417,"column":1},"end":{"line":417,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":417,"column":1},"end":{"line":417,"column":1}},"children":[{"type":"text","value":"Images","position":{"start":{"line":417,"column":1},"end":{"line":417,"column":1}},"key":"XoxzQng6nW"}],"key":"cdV6B98Ln7"},{"type":"tableCell","position":{"start":{"line":417,"column":1},"end":{"line":417,"column":1}},"children":[{"type":"text","value":"Cosinus sur embeddings CNN","position":{"start":{"line":417,"column":1},"end":{"line":417,"column":1}},"key":"uhWPFlefSe"}],"key":"LobEmPusIq"},{"type":"tableCell","position":{"start":{"line":417,"column":1},"end":{"line":417,"column":1}},"children":[{"type":"text","value":"Les pixels bruts sont peu informatifs","position":{"start":{"line":417,"column":1},"end":{"line":417,"column":1}},"key":"FU1By6Boyp"}],"key":"h8vi80XwAm"}],"key":"O6Glc0f5EN"}],"key":"aRSUz98LQ0"},{"type":"paragraph","position":{"start":{"line":419,"column":1},"end":{"line":419,"column":1}},"children":[{"type":"strong","position":{"start":{"line":419,"column":1},"end":{"line":419,"column":1}},"children":[{"type":"text","value":"Le choix de la distance encode vos hypothèses.","position":{"start":{"line":419,"column":1},"end":{"line":419,"column":1}},"key":"KrVKPe4L47"}],"key":"gJRNXZ9kyr"},{"type":"text","value":" Si deux clients ayant acheté les mêmes produits sont “similaires”, utilisez Jaccard sur les paniers. Si deux clients ayant dépensé des montants similaires sont “proches”, utilisez la distance euclidienne sur les dépenses. La distance définit ce que “voisin” signifie: c’est une décision de modélisation, pas un détail technique.","position":{"start":{"line":419,"column":1},"end":{"line":419,"column":1}},"key":"Hf0wfmsTqg"}],"key":"MoF0XpSpec"},{"type":"heading","depth":2,"position":{"start":{"line":421,"column":1},"end":{"line":421,"column":1}},"children":[{"type":"text","value":"L’effet du paramètre k","position":{"start":{"line":421,"column":1},"end":{"line":421,"column":1}},"key":"kGRK1J70NH"}],"identifier":"leffet-du-param-tre-k","label":"L’effet du paramètre k","html_id":"leffet-du-param-tre-k","implicit":true,"key":"iQentvwP1Z"},{"type":"paragraph","position":{"start":{"line":423,"column":1},"end":{"line":423,"column":1}},"children":[{"type":"text","value":"Le paramètre ","position":{"start":{"line":423,"column":1},"end":{"line":423,"column":1}},"key":"qJO7NMhrML"},{"type":"inlineMath","value":"k","position":{"start":{"line":423,"column":1},"end":{"line":423,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>k</mi></mrow><annotation encoding=\"application/x-tex\">k</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span></span></span></span>","key":"k2C65FvXeb"},{"type":"text","value":" contrôle la complexité du modèle. Avec ","position":{"start":{"line":423,"column":1},"end":{"line":423,"column":1}},"key":"Eq9hgYpONe"},{"type":"inlineMath","value":"k = 1","position":{"start":{"line":423,"column":1},"end":{"line":423,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>k</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">k = 1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span>","key":"v15LgQD6oE"},{"type":"text","value":", chaque point est classifié selon son plus proche voisin. La frontière de décision est très irrégulière et s’adapte étroitement aux données. L’erreur d’entraînement est exactement zéro: chaque point est son propre plus proche voisin. Mais cette adaptation excessive aux données d’entraînement nuit à la généralisation.","position":{"start":{"line":423,"column":1},"end":{"line":423,"column":1}},"key":"GDbWRmh7EK"}],"key":"sQ9mBREop8"},{"type":"paragraph","position":{"start":{"line":425,"column":1},"end":{"line":425,"column":1}},"children":[{"type":"text","value":"Avec un grand ","position":{"start":{"line":425,"column":1},"end":{"line":425,"column":1}},"key":"nveuO6S9Ds"},{"type":"inlineMath","value":"k","position":{"start":{"line":425,"column":1},"end":{"line":425,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>k</mi></mrow><annotation encoding=\"application/x-tex\">k</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span></span></span></span>","key":"pRCWCyqfdk"},{"type":"text","value":", la prédiction moyenne sur plus de voisins et la frontière devient plus lisse. Le cas extrême ","position":{"start":{"line":425,"column":1},"end":{"line":425,"column":1}},"key":"kCUgjVR9Uf"},{"type":"inlineMath","value":"k = N","position":{"start":{"line":425,"column":1},"end":{"line":425,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>k</mi><mo>=</mo><mi>N</mi></mrow><annotation encoding=\"application/x-tex\">k = N</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span></span></span></span>","key":"rYVxKZF7SL"},{"type":"text","value":" prédit toujours la classe majoritaire globale, ignorant complètement l’entrée.","position":{"start":{"line":425,"column":1},"end":{"line":425,"column":1}},"key":"GU5F4DomSo"}],"key":"J538qylKNJ"}],"key":"taAeQcwiCO"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"import numpy as np\nimport matplotlib.pyplot as plt\nfrom matplotlib.colors import ListedColormap\n\n# Generate 2D classification data\nnp.random.seed(0)\nn_samples = 100\n\n# Two interleaved half circles\nfrom sklearn.datasets import make_moons\nX, y = make_moons(n_samples=n_samples, noise=0.25, random_state=42)\n\ndef knn_predict(X_train, y_train, X_test, k):\n    predictions = []\n    for x in X_test:\n        distances = np.sqrt(np.sum((X_train - x)**2, axis=1))\n        k_nearest_idx = np.argsort(distances)[:k]\n        k_nearest_labels = y_train[k_nearest_idx]\n        predictions.append(np.round(np.mean(k_nearest_labels)))\n    return np.array(predictions)\n\n# Create mesh for decision boundary\nx_min, x_max = X[:, 0].min() - 0.5, X[:, 0].max() + 0.5\ny_min, y_max = X[:, 1].min() - 0.5, X[:, 1].max() + 0.5\nxx, yy = np.meshgrid(np.linspace(x_min, x_max, 150),\n                     np.linspace(y_min, y_max, 150))\nX_mesh = np.c_[xx.ravel(), yy.ravel()]\n\nfig, axes = plt.subplots(1, 3, figsize=(12, 4))\nk_values = [1, 5, 50]\ncmap_light = ListedColormap(['#FFAAAA', '#AAAAFF'])\ncmap_bold = ListedColormap(['#FF0000', '#0000FF'])\n\nfor ax, k in zip(axes, k_values):\n    Z = knn_predict(X, y, X_mesh, k)\n    Z = Z.reshape(xx.shape)\n    \n    ax.contourf(xx, yy, Z, alpha=0.4, cmap=cmap_light)\n    ax.scatter(X[y == 0, 0], X[y == 0, 1], c='C0', s=30, edgecolors='k', linewidths=0.5)\n    ax.scatter(X[y == 1, 0], X[y == 1, 1], c='C1', s=30, edgecolors='k', linewidths=0.5)\n    ax.set_xlim(x_min, x_max)\n    ax.set_ylim(y_min, y_max)\n    ax.set_title(f'$k = {k}$')\n    ax.set_xlabel('$x_1$')\n    ax.set_ylabel('$x_2$')\n\nplt.tight_layout()","visibility":"hide","key":"lAizqQuesb"},{"type":"outputs","id":"BREQ9ZDxvrA8YM29yN6JS","children":[{"type":"output","children":[],"jupyter_data":{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"<Figure size 1200x400 with 3 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"ae266e59339a97b6856e998a1c6d5d8b","path":"/mlbook/build/ae266e59339a97b6856e998a1c6d5d8b.png"}}},"key":"OHZEwXBxNV"}],"visibility":"show","key":"ThFzSGYeEP"}],"data":{"tags":[]},"visibility":"show","key":"L9MI4kzOSi"},{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":479,"column":1},"end":{"line":479,"column":1}},"children":[{"type":"text","value":"Entre ces deux extrêmes se trouve le compromis biais-variance. Un petit ","position":{"start":{"line":479,"column":1},"end":{"line":479,"column":1}},"key":"dimDbPUgsA"},{"type":"inlineMath","value":"k","position":{"start":{"line":479,"column":1},"end":{"line":479,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>k</mi></mrow><annotation encoding=\"application/x-tex\">k</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span></span></span></span>","key":"Kadn9vxuhb"},{"type":"text","value":" donne un modèle à faible biais mais haute variance: les prédictions sont sensibles aux fluctuations des données. Un grand ","position":{"start":{"line":479,"column":1},"end":{"line":479,"column":1}},"key":"TeRsKYg785"},{"type":"inlineMath","value":"k","position":{"start":{"line":479,"column":1},"end":{"line":479,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>k</mi></mrow><annotation encoding=\"application/x-tex\">k</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span></span></span></span>","key":"IX5a6o1HvT"},{"type":"text","value":" donne un modèle à haute biais mais faible variance: les prédictions sont stables mais peuvent manquer des structures locales.","position":{"start":{"line":479,"column":1},"end":{"line":479,"column":1}},"key":"U8ldSZwbKV"}],"key":"kBYZaCRfZO"},{"type":"paragraph","position":{"start":{"line":481,"column":1},"end":{"line":481,"column":1}},"children":[{"type":"text","value":"Le choix de ","position":{"start":{"line":481,"column":1},"end":{"line":481,"column":1}},"key":"xU2wE2wayK"},{"type":"inlineMath","value":"k","position":{"start":{"line":481,"column":1},"end":{"line":481,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>k</mi></mrow><annotation encoding=\"application/x-tex\">k</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span></span></span></span>","key":"qum5xExIBp"},{"type":"text","value":" se fait par validation. On trace l’erreur sur un ensemble de validation en fonction de ","position":{"start":{"line":481,"column":1},"end":{"line":481,"column":1}},"key":"hV3pe5noYy"},{"type":"inlineMath","value":"k","position":{"start":{"line":481,"column":1},"end":{"line":481,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>k</mi></mrow><annotation encoding=\"application/x-tex\">k</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span></span></span></span>","key":"XuRiHSIlfr"},{"type":"text","value":" et on retient la valeur qui minimise cette erreur. Des valeurs impaires évitent les égalités dans les votes.","position":{"start":{"line":481,"column":1},"end":{"line":481,"column":1}},"key":"p7hXZNocBk"}],"key":"n1AGe2yVbt"}],"key":"RcRYvVUj3I"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"import numpy as np\nimport matplotlib.pyplot as plt\n\nnp.random.seed(42)\n\n# Generate a larger dataset for smoother curves\nn_samples = 500\nX = np.random.randn(n_samples, 2)\n# Create a non-linear boundary\ny = ((X[:, 0]**2 + X[:, 1]**2) > 1.5).astype(int)\n# Add label noise\nnoise_idx = np.random.choice(n_samples, size=int(0.1 * n_samples), replace=False)\ny[noise_idx] = 1 - y[noise_idx]\n\n# Split into train and test\nn_train = 350\nX_train, X_test = X[:n_train], X[n_train:]\ny_train, y_test = y[:n_train], y[n_train:]\n\ndef knn_predict(X_train, y_train, X_test, k):\n    predictions = []\n    for x in X_test:\n        distances = np.sqrt(np.sum((X_train - x)**2, axis=1))\n        k_nearest_idx = np.argsort(distances)[:k]\n        k_nearest_labels = y_train[k_nearest_idx]\n        predictions.append(np.round(np.mean(k_nearest_labels)))\n    return np.array(predictions)\n\n# Compute train and test error for different k\n# Use 1/k on x-axis (model complexity decreases as k increases)\nk_values = list(range(1, 100, 2))  # Odd values to avoid ties\ntrain_errors = []\ntest_errors = []\n\nfor k in k_values:\n    y_pred_train = knn_predict(X_train, y_train, X_train, k)\n    y_pred_test = knn_predict(X_train, y_train, X_test, k)\n    train_errors.append(np.mean(y_pred_train != y_train))\n    test_errors.append(np.mean(y_pred_test != y_test))\n\nfig, ax = plt.subplots(figsize=(8, 4.5))\n\nax.plot(k_values, train_errors, 'C0-', linewidth=2, label='Erreur entraînement')\nax.plot(k_values, test_errors, 'C1-', linewidth=2, label='Erreur test')\n\n# Mark optimal k\nbest_idx = np.argmin(test_errors)\nbest_k = k_values[best_idx]\nax.scatter([best_k], [test_errors[best_idx]], s=100, c='C1', zorder=5, edgecolors='black')\nax.axvline(best_k, color='gray', linestyle='--', alpha=0.5)\n\n# Add annotations for the regions - positioned to avoid overlapping curves\nax.text(10, 0.45, 'Surapprentissage\\n(haute variance)', fontsize=10, \n        ha='center', va='top', color='gray', alpha=0.8)\nax.text(85, 0.1, 'Sous-apprentissage\\n(haut biais)', fontsize=10, \n        ha='center', va='bottom', color='gray', alpha=0.8)\n\n# Mark optimal k with an arrow from above\nax.annotate(f'Meilleur $k = {best_k}$', xy=(best_k, test_errors[best_idx]), \n            xytext=(best_k, test_errors[best_idx] + 0.1),\n            fontsize=10, ha='center',\n            arrowprops=dict(arrowstyle='->', connectionstyle='arc3,rad=0', color='black'))\n\nax.set_xlabel('$k$ (nombre de voisins)')\nax.set_ylabel('Taux d\\'erreur')\nax.legend(loc='upper center', bbox_to_anchor=(0.5, 1.15), ncol=2, frameon=False)\nax.set_xlim(0, 100)\nax.set_ylim(0, 0.5)\n\n# Add complexity arrow at the bottom\nax.text(0.5, -0.15, r'$\\longleftarrow$ complexité du modèle', transform=ax.transAxes, \n        ha='center', va='top', fontsize=9, color='gray')\n\nplt.tight_layout()","visibility":"hide","key":"tSYdryXn8E"},{"type":"outputs","id":"R3ImnzyXnujPyfVjsmOGw","children":[{"type":"output","children":[],"jupyter_data":{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"<Figure size 800x450 with 1 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"4b4d2c325e1eb0eaef7b41e60f18d4df","path":"/mlbook/build/4b4d2c325e1eb0eaef7b41e60f18d4df.png"}}},"key":"zns40OWlIk"}],"visibility":"show","key":"JldTqKbQ2p"}],"data":{"tags":[]},"visibility":"show","key":"PPe0o3YZou"},{"type":"block","children":[{"type":"heading","depth":2,"position":{"start":{"line":562,"column":1},"end":{"line":562,"column":1}},"children":[{"type":"text","value":"Diagramme de Voronoï","position":{"start":{"line":562,"column":1},"end":{"line":562,"column":1}},"key":"TrSZENVIHn"}],"identifier":"diagramme-de-vorono","label":"Diagramme de Voronoï","html_id":"diagramme-de-vorono","implicit":true,"key":"SINbw0eyYf"},{"type":"paragraph","position":{"start":{"line":564,"column":1},"end":{"line":564,"column":1}},"children":[{"type":"text","value":"Le cas ","position":{"start":{"line":564,"column":1},"end":{"line":564,"column":1}},"key":"ktNZYNl9HO"},{"type":"inlineMath","value":"k = 1","position":{"start":{"line":564,"column":1},"end":{"line":564,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>k</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">k = 1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span>","key":"rEre6fmdUR"},{"type":"text","value":" induit une partition de l’espace en cellules. La cellule ","position":{"start":{"line":564,"column":1},"end":{"line":564,"column":1}},"key":"FYRyrtnS8g"},{"type":"inlineMath","value":"V_i","position":{"start":{"line":564,"column":1},"end":{"line":564,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>V</mi><mi>i</mi></msub></mrow><annotation encoding=\"application/x-tex\">V_i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.22222em;\">V</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.2222em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"gZKU8uskAk"},{"type":"text","value":" associée au point ","position":{"start":{"line":564,"column":1},"end":{"line":564,"column":1}},"key":"osQDbg0Gfi"},{"type":"inlineMath","value":"x_i","position":{"start":{"line":564,"column":1},"end":{"line":564,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>x</mi><mi>i</mi></msub></mrow><annotation encoding=\"application/x-tex\">x_i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"DjASpmIFKl"},{"type":"text","value":" contient tous les points plus proches de ","position":{"start":{"line":564,"column":1},"end":{"line":564,"column":1}},"key":"URPG1xpP55"},{"type":"inlineMath","value":"x_i","position":{"start":{"line":564,"column":1},"end":{"line":564,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>x</mi><mi>i</mi></msub></mrow><annotation encoding=\"application/x-tex\">x_i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"vkMqkqgap1"},{"type":"text","value":" que de tout autre point d’entraînement:","position":{"start":{"line":564,"column":1},"end":{"line":564,"column":1}},"key":"JwrC9dd5Xx"}],"key":"GZ53KByJI5"},{"type":"math","value":"V_i = \\{x \\in \\mathbb{R}^d : d(x, x_i) \\leq d(x, x_j) \\text{ pour tout } j \\neq i\\}","position":{"start":{"line":566,"column":1},"end":{"line":568,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><msub><mi>V</mi><mi>i</mi></msub><mo>=</mo><mo stretchy=\"false\">{</mo><mi>x</mi><mo>∈</mo><msup><mi mathvariant=\"double-struck\">R</mi><mi>d</mi></msup><mo>:</mo><mi>d</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo separator=\"true\">,</mo><msub><mi>x</mi><mi>i</mi></msub><mo stretchy=\"false\">)</mo><mo>≤</mo><mi>d</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo separator=\"true\">,</mo><msub><mi>x</mi><mi>j</mi></msub><mo stretchy=\"false\">)</mo><mtext> pour tout </mtext><mi>j</mi><mo mathvariant=\"normal\">≠</mo><mi>i</mi><mo stretchy=\"false\">}</mo></mrow><annotation encoding=\"application/x-tex\">V_i = \\{x \\in \\mathbb{R}^d : d(x, x_i) \\leq d(x, x_j) \\text{ pour tout } j \\neq i\\}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.22222em;\">V</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.2222em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">{</span><span class=\"mord mathnormal\">x</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">∈</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8991em;\"></span><span class=\"mord\"><span class=\"mord mathbb\">R</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8991em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">d</span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">:</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">d</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">≤</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.0361em;vertical-align:-0.2861em;\"></span><span class=\"mord mathnormal\">d</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span><span class=\"mord text\"><span class=\"mord\"> pour tout </span></span><span class=\"mord mathnormal\" style=\"margin-right:0.05724em;\">j</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\"><span class=\"mrel\"><span class=\"mord vbox\"><span class=\"thinbox\"><span class=\"rlap\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"inner\"><span class=\"mord\"><span class=\"mrel\"></span></span></span><span class=\"fix\"></span></span></span></span></span><span class=\"mrel\">=</span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">i</span><span class=\"mclose\">}</span></span></span></span></span>","enumerator":"13","key":"Hz0FJJhiOk"},{"type":"paragraph","position":{"start":{"line":570,"column":1},"end":{"line":570,"column":1}},"children":[{"type":"text","value":"Cette partition s’appelle le ","position":{"start":{"line":570,"column":1},"end":{"line":570,"column":1}},"key":"ervWk1ZnVH"},{"type":"strong","position":{"start":{"line":570,"column":1},"end":{"line":570,"column":1}},"children":[{"type":"text","value":"diagramme de Voronoï","position":{"start":{"line":570,"column":1},"end":{"line":570,"column":1}},"key":"ZbPW2aztGD"}],"key":"oQInxlsi4g"},{"type":"text","value":". Les frontières entre cellules sont des hyperplans en dimension ","position":{"start":{"line":570,"column":1},"end":{"line":570,"column":1}},"key":"pIyhPS01E1"},{"type":"inlineMath","value":"d","position":{"start":{"line":570,"column":1},"end":{"line":570,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>d</mi></mrow><annotation encoding=\"application/x-tex\">d</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\">d</span></span></span></span>","key":"ZzxBeutdah"},{"type":"text","value":". Avec le 1-ppv, la frontière de décision suit exactement ce diagramme.","position":{"start":{"line":570,"column":1},"end":{"line":570,"column":1}},"key":"pqolJvd7Tl"}],"key":"OhJE63wqiy"},{"type":"heading","depth":3,"position":{"start":{"line":572,"column":1},"end":{"line":572,"column":1}},"children":[{"type":"text","value":"Pourquoi s’intéresser au diagramme de Voronoï?","position":{"start":{"line":572,"column":1},"end":{"line":572,"column":1}},"key":"KZgqpfLUTe"}],"identifier":"pourquoi-sint-resser-au-diagramme-de-vorono","label":"Pourquoi s’intéresser au diagramme de Voronoï?","html_id":"pourquoi-sint-resser-au-diagramme-de-vorono","implicit":true,"key":"vWz6dZcN2F"},{"type":"paragraph","position":{"start":{"line":574,"column":1},"end":{"line":574,"column":1}},"children":[{"type":"text","value":"Cette représentation géométrique révèle des propriétés importantes du classifieur 1-ppv.","position":{"start":{"line":574,"column":1},"end":{"line":574,"column":1}},"key":"i5B0wMnVFt"}],"key":"oVSAZipdLm"},{"type":"paragraph","position":{"start":{"line":576,"column":1},"end":{"line":576,"column":1}},"children":[{"type":"strong","position":{"start":{"line":576,"column":1},"end":{"line":576,"column":1}},"children":[{"type":"text","value":"Sensibilité au bruit.","position":{"start":{"line":576,"column":1},"end":{"line":576,"column":1}},"key":"vpSM29fC6e"}],"key":"oYHWqTficA"},{"type":"text","value":" Un point mal étiqueté dans l’ensemble d’entraînement crée une cellule entière où les prédictions seront incorrectes. La taille de cette cellule dépend de la densité locale des données: dans une région peu dense, un seul point erroné peut contaminer une grande partie de l’espace.","position":{"start":{"line":576,"column":1},"end":{"line":576,"column":1}},"key":"ntqKzq1iw5"}],"key":"Ebaj9QZNoh"},{"type":"paragraph","position":{"start":{"line":578,"column":1},"end":{"line":578,"column":1}},"children":[{"type":"strong","position":{"start":{"line":578,"column":1},"end":{"line":578,"column":1}},"children":[{"type":"text","value":"Borne sur l’erreur.","position":{"start":{"line":578,"column":1},"end":{"line":578,"column":1}},"key":"L4JdMwpmDY"}],"key":"vM67RiFjlA"},{"type":"text","value":" Le théorème de Cover et Hart (1967) établit un résultat remarquable: lorsque ","position":{"start":{"line":578,"column":1},"end":{"line":578,"column":1}},"key":"gDpmDlXDCH"},{"type":"inlineMath","value":"N \\to \\infty","position":{"start":{"line":578,"column":1},"end":{"line":578,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>N</mi><mo>→</mo><mi mathvariant=\"normal\">∞</mi></mrow><annotation encoding=\"application/x-tex\">N \\to \\infty</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">→</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord\">∞</span></span></span></span>","key":"ZvqYobSBlY"},{"type":"text","value":", l’erreur du classifieur 1-ppv est bornée par","position":{"start":{"line":578,"column":1},"end":{"line":578,"column":1}},"key":"amoihieJyb"}],"key":"v22XZzJEw7"},{"type":"math","value":"R^* \\leq R_{1\\text{-ppv}} \\leq 2R^*\\left(1 - \\frac{R^*}{C}\\right)","position":{"start":{"line":580,"column":1},"end":{"line":582,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><msup><mi>R</mi><mo>∗</mo></msup><mo>≤</mo><msub><mi>R</mi><mrow><mn>1</mn><mtext>-ppv</mtext></mrow></msub><mo>≤</mo><mn>2</mn><msup><mi>R</mi><mo>∗</mo></msup><mrow><mo fence=\"true\">(</mo><mn>1</mn><mo>−</mo><mfrac><msup><mi>R</mi><mo>∗</mo></msup><mi>C</mi></mfrac><mo fence=\"true\">)</mo></mrow></mrow><annotation encoding=\"application/x-tex\">R^* \\leq R_{1\\text{-ppv}} \\leq 2R^*\\left(1 - \\frac{R^*}{C}\\right)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8747em;vertical-align:-0.136em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.00773em;\">R</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7387em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mbin mtight\">∗</span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">≤</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.9694em;vertical-align:-0.2861em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.00773em;\">R</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0077em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">1</span><span class=\"mord text mtight\"><span class=\"mord mtight\">-ppv</span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">≤</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.4em;vertical-align:-0.95em;\"></span><span class=\"mord\">2</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.00773em;\">R</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7387em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mbin mtight\">∗</span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"minner\"><span class=\"mopen delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size3\">(</span></span><span class=\"mord\">1</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3657em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">C</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.00773em;\">R</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6887em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mbin mtight\">∗</span></span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mclose delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size3\">)</span></span></span></span></span></span></span>","enumerator":"14","key":"P6urlnDLmn"},{"type":"paragraph","position":{"start":{"line":584,"column":1},"end":{"line":584,"column":1}},"children":[{"type":"text","value":"où ","position":{"start":{"line":584,"column":1},"end":{"line":584,"column":1}},"key":"zMIW0W2xUC"},{"type":"inlineMath","value":"R^*","position":{"start":{"line":584,"column":1},"end":{"line":584,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>R</mi><mo>∗</mo></msup></mrow><annotation encoding=\"application/x-tex\">R^*</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6887em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.00773em;\">R</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6887em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mbin mtight\">∗</span></span></span></span></span></span></span></span></span></span></span>","key":"IH5rm4chVO"},{"type":"text","value":" est l’erreur de Bayes (le minimum atteignable par tout classifieur) et ","position":{"start":{"line":584,"column":1},"end":{"line":584,"column":1}},"key":"uXKS6y3mAU"},{"type":"inlineMath","value":"C","position":{"start":{"line":584,"column":1},"end":{"line":584,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>C</mi></mrow><annotation encoding=\"application/x-tex\">C</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">C</span></span></span></span>","key":"b5JngnguON"},{"type":"text","value":" le nombre de classes. Pour un problème binaire, l’erreur du 1-ppv est au plus le double de l’erreur optimale. Sans aucune hypothèse sur la forme de la frontière de décision, le 1-ppv atteint une performance raisonnable. Ce résultat a d’ailleurs surpris la communauté statistique à l’époque.","position":{"start":{"line":584,"column":1},"end":{"line":584,"column":1}},"key":"qQp0ivup7e"}],"key":"LwUPM3JeLD"},{"type":"paragraph","position":{"start":{"line":586,"column":1},"end":{"line":586,"column":1}},"children":[{"type":"strong","position":{"start":{"line":586,"column":1},"end":{"line":586,"column":1}},"children":[{"type":"text","value":"Applications au-delà de la classification.","position":{"start":{"line":586,"column":1},"end":{"line":586,"column":1}},"key":"pFnsmdMz3j"}],"key":"FKnMHSYWBV"},{"type":"text","value":" Les diagrammes de Voronoï apparaissent naturellement dans de nombreux domaines: modélisation des zones de chalandise en géographie (quel est le magasin le plus proche?), segmentation cellulaire en biologie, génération de maillages en simulation numérique. L’algorithme k-means, que nous verrons plus tard, converge vers une partition de Voronoï autour des centroïdes.","position":{"start":{"line":586,"column":1},"end":{"line":586,"column":1}},"key":"SQVdj4y03n"}],"key":"XsMhpC54cX"}],"key":"IPH9DACy3D"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"import numpy as np\nimport matplotlib.pyplot as plt\nfrom scipy.spatial import Voronoi, voronoi_plot_2d\n\n# Generate points\nnp.random.seed(123)\nn_points = 20\nX = np.random.randn(n_points, 2) * 1.5\ny = (X[:, 0] + X[:, 1] + np.random.randn(n_points) * 0.5 > 0).astype(int)\n\n# Compute Voronoi diagram\nvor = Voronoi(X)\n\nfig, ax = plt.subplots(figsize=(7, 6))\n\n# Plot Voronoi regions with colors based on class\nfrom matplotlib.patches import Polygon\nfrom matplotlib.collections import PatchCollection\n\n# Create colored regions\nfor region_idx, point_idx in enumerate(vor.point_region):\n    region = vor.regions[point_idx]\n    if -1 not in region and len(region) > 0:\n        polygon = [vor.vertices[i] for i in region]\n        poly = Polygon(polygon, alpha=0.3, \n                      facecolor='C0' if y[region_idx] == 0 else 'C1',\n                      edgecolor='gray', linewidth=0.5)\n        ax.add_patch(poly)\n\n# Plot Voronoi edges\nvoronoi_plot_2d(vor, ax=ax, show_vertices=False, show_points=False, \n                line_colors='gray', line_width=1, line_alpha=0.6)\n\n# Plot points\nax.scatter(X[y == 0, 0], X[y == 0, 1], c='C0', s=80, edgecolors='k', \n           linewidths=1, zorder=5, label='Classe 0')\nax.scatter(X[y == 1, 0], X[y == 1, 1], c='C1', s=80, edgecolors='k', \n           linewidths=1, zorder=5, label='Classe 1')\n\nax.set_xlim(-4, 4)\nax.set_ylim(-4, 4)\nax.set_xlabel('$x_1$')\nax.set_ylabel('$x_2$')\nax.legend(loc='upper left')\nax.set_aspect('equal')\nplt.tight_layout()","visibility":"hide","key":"FQuI4vSZYD"},{"type":"outputs","id":"kJefjdWiWLQDWExmzFf5c","children":[{"type":"output","children":[],"jupyter_data":{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"<Figure size 700x600 with 1 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"ab2031b32e520b7207e0f9e5c5678345","path":"/mlbook/build/ab2031b32e520b7207e0f9e5c5678345.png"}}},"key":"FC2fFUcoPP"}],"visibility":"show","key":"MWS4hmzNaA"}],"data":{"tags":[]},"visibility":"show","key":"rklG83c6d4"},{"type":"block","children":[{"type":"heading","depth":2,"position":{"start":{"line":639,"column":1},"end":{"line":639,"column":1}},"children":[{"type":"text","value":"Le fléau de la dimensionnalité","position":{"start":{"line":639,"column":1},"end":{"line":639,"column":1}},"key":"uPcg2uEByd"}],"identifier":"le-fl-au-de-la-dimensionnalit","label":"Le fléau de la dimensionnalité","html_id":"le-fl-au-de-la-dimensionnalit","implicit":true,"key":"GrYQEq9bjZ"},{"type":"paragraph","position":{"start":{"line":641,"column":1},"end":{"line":641,"column":1}},"children":[{"type":"text","value":"Les k-ppv fonctionnent bien en basse dimension mais souffrent en haute dimension. Ce phénomène, le ","position":{"start":{"line":641,"column":1},"end":{"line":641,"column":1}},"key":"IJiqIjHPOR"},{"type":"strong","position":{"start":{"line":641,"column":1},"end":{"line":641,"column":1}},"children":[{"type":"text","value":"fléau de la dimensionnalité","position":{"start":{"line":641,"column":1},"end":{"line":641,"column":1}},"key":"Z33wLYtwxe"}],"key":"luYwIXEGTV"},{"type":"text","value":", affecte toutes les méthodes basées sur la localité. Le problème n’est pas principalement calculatoire: le coût ","position":{"start":{"line":641,"column":1},"end":{"line":641,"column":1}},"key":"ZzKaM4xF9I"},{"type":"inlineMath","value":"O(Nd)","position":{"start":{"line":641,"column":1},"end":{"line":641,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mo stretchy=\"false\">(</mo><mi>N</mi><mi>d</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">O(Nd)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"mord mathnormal\">d</span><span class=\"mclose\">)</span></span></span></span>","key":"v4XqMtijOn"},{"type":"text","value":" croît linéairement en ","position":{"start":{"line":641,"column":1},"end":{"line":641,"column":1}},"key":"y8QJYfdD7C"},{"type":"inlineMath","value":"d","position":{"start":{"line":641,"column":1},"end":{"line":641,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>d</mi></mrow><annotation encoding=\"application/x-tex\">d</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\">d</span></span></span></span>","key":"Etwpz9hvQD"},{"type":"text","value":", mais il est fondamentalement ","position":{"start":{"line":641,"column":1},"end":{"line":641,"column":1}},"key":"k0RecLfvz6"},{"type":"emphasis","position":{"start":{"line":641,"column":1},"end":{"line":641,"column":1}},"children":[{"type":"text","value":"statistique","position":{"start":{"line":641,"column":1},"end":{"line":641,"column":1}},"key":"QVVvuheLSr"}],"key":"DA1uFB32b6"},{"type":"text","value":".","position":{"start":{"line":641,"column":1},"end":{"line":641,"column":1}},"key":"IxsivQfttu"}],"key":"j41wWwBiwR"},{"type":"heading","depth":3,"position":{"start":{"line":643,"column":1},"end":{"line":643,"column":1}},"children":[{"type":"text","value":"La notion de voisinage s’effondre","position":{"start":{"line":643,"column":1},"end":{"line":643,"column":1}},"key":"Uz1l5fUXFe"}],"identifier":"la-notion-de-voisinage-seffondre","label":"La notion de voisinage s’effondre","html_id":"la-notion-de-voisinage-seffondre","implicit":true,"key":"LwZXMB5tME"},{"type":"paragraph","position":{"start":{"line":645,"column":1},"end":{"line":645,"column":1}},"children":[{"type":"text","value":"Considérons des points uniformément distribués dans ","position":{"start":{"line":645,"column":1},"end":{"line":645,"column":1}},"key":"MmTTTGMSKM"},{"type":"inlineMath","value":"[0, 1]^d","position":{"start":{"line":645,"column":1},"end":{"line":645,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">[</mo><mn>0</mn><mo separator=\"true\">,</mo><mn>1</mn><msup><mo stretchy=\"false\">]</mo><mi>d</mi></msup></mrow><annotation encoding=\"application/x-tex\">[0, 1]^d</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0991em;vertical-align:-0.25em;\"></span><span class=\"mopen\">[</span><span class=\"mord\">0</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">1</span><span class=\"mclose\"><span class=\"mclose\">]</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8491em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">d</span></span></span></span></span></span></span></span></span></span></span>","key":"CsC60tfOmi"},{"type":"text","value":". Pour capturer une fraction ","position":{"start":{"line":645,"column":1},"end":{"line":645,"column":1}},"key":"TyKrcqCSw8"},{"type":"inlineMath","value":"p","position":{"start":{"line":645,"column":1},"end":{"line":645,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>p</mi></mrow><annotation encoding=\"application/x-tex\">p</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\">p</span></span></span></span>","key":"DDYGDzhAGr"},{"type":"text","value":" des points dans un hypercube, le côté doit être ","position":{"start":{"line":645,"column":1},"end":{"line":645,"column":1}},"key":"ADqA2WOKDN"},{"type":"inlineMath","value":"r = p^{1/d}","position":{"start":{"line":645,"column":1},"end":{"line":645,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>r</mi><mo>=</mo><msup><mi>p</mi><mrow><mn>1</mn><mi mathvariant=\"normal\">/</mi><mi>d</mi></mrow></msup></mrow><annotation encoding=\"application/x-tex\">r = p^{1/d}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.0824em;vertical-align:-0.1944em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">p</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.888em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">1/</span><span class=\"mord mathnormal mtight\">d</span></span></span></span></span></span></span></span></span></span></span></span>","key":"OV0q2bwra4"},{"type":"text","value":". En dimension 1, capturer 10% des points requiert un intervalle de longueur 0.1. En dimension 100, il faut un hypercube de côté ","position":{"start":{"line":645,"column":1},"end":{"line":645,"column":1}},"key":"l4Vd0QjrqP"},{"type":"inlineMath","value":"0.1^{1/100} \\approx 0.98","position":{"start":{"line":645,"column":1},"end":{"line":645,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>0.</mn><msup><mn>1</mn><mrow><mn>1</mn><mi mathvariant=\"normal\">/</mi><mn>100</mn></mrow></msup><mo>≈</mo><mn>0.98</mn></mrow><annotation encoding=\"application/x-tex\">0.1^{1/100} \\approx 0.98</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.888em;\"></span><span class=\"mord\">0.</span><span class=\"mord\"><span class=\"mord\">1</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.888em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">1/100</span></span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">≈</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0.98</span></span></span></span>","key":"UZ8sewFQ7l"},{"type":"text","value":", couvrant presque tout l’espace.","position":{"start":{"line":645,"column":1},"end":{"line":645,"column":1}},"key":"TSdLwqw3Uc"}],"key":"XkaZgUBxAZ"}],"key":"dib1L65gE5"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"import numpy as np\nimport matplotlib.pyplot as plt\n\np = 0.1  # fraction of points to capture\ndimensions = np.arange(1, 101)\nside_length = p ** (1 / dimensions)\n\nfig, ax = plt.subplots(figsize=(7, 4))\nax.plot(dimensions, side_length, 'C0-', linewidth=2)\nax.axhline(1, color='gray', linestyle='--', alpha=0.5)\n\n# Mark specific points\nfor d in [1, 2, 10, 50, 100]:\n    r = p ** (1/d)\n    ax.plot(d, r, 'ko', markersize=6)\n    if d == 1:\n        ax.annotate(f'd={d}\\nr={r:.2f}', (d, r), textcoords='offset points', \n                   xytext=(10, -15), fontsize=9)\n    elif d == 100:\n        ax.annotate(f'd={d}\\nr={r:.2f}', (d, r), textcoords='offset points', \n                   xytext=(-40, -20), fontsize=9)\n\nax.set_xlabel('Dimension $d$')\nax.set_ylabel('Côté de l\\'hypercube $r$')\nax.set_title(f'Côté nécessaire pour capturer {int(p*100)}% des points: $r = p^{{1/d}}$')\nax.set_xlim(0, 105)\nax.set_ylim(0, 1.1)\nplt.tight_layout()","visibility":"hide","key":"SQovSXH2R1"},{"type":"outputs","id":"L8IOZVYC7Q_5po-2KyItk","children":[{"type":"output","children":[],"jupyter_data":{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"<Figure size 700x400 with 1 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"9f7eeb0f7d1477bfa1225a8287941934","path":"/mlbook/build/9f7eeb0f7d1477bfa1225a8287941934.png"}}},"key":"wLiTJpP6AV"}],"visibility":"show","key":"GsRMxSWJvE"}],"data":{"tags":[]},"visibility":"show","key":"K9P4w5YG2W"},{"type":"block","children":[{"type":"heading","depth":3,"position":{"start":{"line":680,"column":1},"end":{"line":680,"column":1}},"children":[{"type":"text","value":"Concentration des distances","position":{"start":{"line":680,"column":1},"end":{"line":680,"column":1}},"key":"qYiw1uAceW"}],"identifier":"concentration-des-distances","label":"Concentration des distances","html_id":"concentration-des-distances","implicit":true,"key":"kYPQ9I8sla"},{"type":"paragraph","position":{"start":{"line":682,"column":1},"end":{"line":682,"column":1}},"children":[{"type":"text","value":"En haute dimension, un phénomène contre-intuitif se produit: les distances entre points se concentrent autour d’une même valeur. Le ratio entre la distance au plus proche voisin et au plus éloigné tend vers 1:","position":{"start":{"line":682,"column":1},"end":{"line":682,"column":1}},"key":"rALdee54D9"}],"key":"A9Rc3NSHAP"},{"type":"math","value":"\\frac{d_{\\min}}{d_{\\max}} \\xrightarrow{d \\to \\infty} 1","position":{"start":{"line":684,"column":1},"end":{"line":686,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mfrac><msub><mi>d</mi><mi>min</mi><mo>⁡</mo></msub><msub><mi>d</mi><mi>max</mi><mo>⁡</mo></msub></mfrac><mover><mo stretchy=\"true\" minsize=\"3.0em\">→</mo><mpadded width=\"+0.6em\" lspace=\"0.3em\"><mrow><mi>d</mi><mo>→</mo><mi mathvariant=\"normal\">∞</mi></mrow></mpadded></mover><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">\\frac{d_{\\min}}{d_{\\max}} \\xrightarrow{d \\to \\infty} 1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:2.2074em;vertical-align:-0.836em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3714em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\">d</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mop mtight\"><span class=\"mtight\">m</span><span class=\"mtight\">a</span><span class=\"mtight\">x</span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\">d</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3175em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mop mtight\"><span class=\"mtight\">m</span><span class=\"mtight\">i</span><span class=\"mtight\">n</span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.836em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel x-arrow\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.1081em;\"><span style=\"top:-3.322em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight x-arrow-pad\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">d</span><span class=\"mrel mtight\">→</span><span class=\"mord mtight\">∞</span></span></span></span><span class=\"svg-align\" style=\"top:-2.689em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"hide-tail\" style=\"height:0.522em;min-width:1.469em;\"><svg xmlns=\"http://www.w3.org/2000/svg\" width='400em' height='0.522em' viewBox='0 0 400000 522' preserveAspectRatio='xMaxYMin slice'><path d='M0 241v40h399891c-47.3 35.3-84 78-110 128\n-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20\n 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7\n 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85\n-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5\n-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67\n 151.7 139 205zm0 0v40h399900v-40z'/></svg></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.011em;\"><span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span></span>","enumerator":"15","key":"ZBxlmKxUWI"},{"type":"paragraph","position":{"start":{"line":688,"column":1},"end":{"line":688,"column":1}},"children":[{"type":"text","value":"Tous les points deviennent approximativement équidistants. La notion même de “plus proche voisin” perd son sens: si tous les points sont à la même distance, lequel choisir?","position":{"start":{"line":688,"column":1},"end":{"line":688,"column":1}},"key":"zOeUf2IswI"}],"key":"LZVftNe6V2"},{"type":"heading","depth":3,"position":{"start":{"line":690,"column":1},"end":{"line":690,"column":1}},"children":[{"type":"text","value":"Conséquences sur le biais","position":{"start":{"line":690,"column":1},"end":{"line":690,"column":1}},"key":"ut3IZQP4Qf"}],"identifier":"cons-quences-sur-le-biais","label":"Conséquences sur le biais","html_id":"cons-quences-sur-le-biais","implicit":true,"key":"x5lRmwdmHk"},{"type":"paragraph","position":{"start":{"line":692,"column":1},"end":{"line":692,"column":1}},"children":[{"type":"text","value":"Rappelons que les k-ppv estiment ","position":{"start":{"line":692,"column":1},"end":{"line":692,"column":1}},"key":"ZmQjSE8FzN"},{"type":"inlineMath","value":"\\mathbb{E}[Y \\mid X = x]","position":{"start":{"line":692,"column":1},"end":{"line":692,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"double-struck\">E</mi><mo stretchy=\"false\">[</mo><mi>Y</mi><mo>∣</mo><mi>X</mi><mo>=</mo><mi>x</mi><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">\\mathbb{E}[Y \\mid X = x]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathbb\">E</span><span class=\"mopen\">[</span><span class=\"mord mathnormal\" style=\"margin-right:0.22222em;\">Y</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">∣</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">]</span></span></span></span>","key":"CXTSf3mmsZ"},{"type":"text","value":" par une moyenne locale. En haute dimension, cette moyenne n’est plus locale car elle inclut des points qui, bien que “voisins” au sens de la distance, peuvent être très différents de ","position":{"start":{"line":692,"column":1},"end":{"line":692,"column":1}},"key":"X1gT8prnPg"},{"type":"inlineMath","value":"x","position":{"start":{"line":692,"column":1},"end":{"line":692,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi></mrow><annotation encoding=\"application/x-tex\">x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span></span></span></span>","key":"iwQPJxCdGq"},{"type":"text","value":" dans l’espace d’entrée. Le biais augmente: nous moyennons sur des régions trop vastes pour capturer les variations locales de la fonction cible.","position":{"start":{"line":692,"column":1},"end":{"line":692,"column":1}},"key":"GZTkrvKsrb"}],"key":"yzz1gi70bF"},{"type":"paragraph","position":{"start":{"line":694,"column":1},"end":{"line":694,"column":1}},"children":[{"type":"text","value":"Pour maintenir une densité constante de voisins dans une boule de rayon fixe, le nombre d’exemples requis croît exponentiellement avec la dimension: ","position":{"start":{"line":694,"column":1},"end":{"line":694,"column":1}},"key":"AP4h7Sxkod"},{"type":"inlineMath","value":"N \\propto r^{-d}","position":{"start":{"line":694,"column":1},"end":{"line":694,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>N</mi><mo>∝</mo><msup><mi>r</mi><mrow><mo>−</mo><mi>d</mi></mrow></msup></mrow><annotation encoding=\"application/x-tex\">N \\propto r^{-d}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">∝</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8491em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8491em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">−</span><span class=\"mord mathnormal mtight\">d</span></span></span></span></span></span></span></span></span></span></span></span>","key":"Onn77cuKsZ"},{"type":"text","value":". Avec 1000 points en dimension 10, la densité locale est déjà très faible.","position":{"start":{"line":694,"column":1},"end":{"line":694,"column":1}},"key":"nnu0TAaoY8"}],"key":"G2BjYgXyVP"},{"type":"heading","depth":3,"position":{"start":{"line":696,"column":1},"end":{"line":696,"column":1}},"children":[{"type":"text","value":"Que faire?","position":{"start":{"line":696,"column":1},"end":{"line":696,"column":1}},"key":"icAwjEYUPo"}],"identifier":"que-faire","label":"Que faire?","html_id":"que-faire","implicit":true,"key":"D1WLFnQJ1y"},{"type":"paragraph","position":{"start":{"line":698,"column":1},"end":{"line":698,"column":1}},"children":[{"type":"text","value":"La réduction de dimension (PCA, autoencodeurs) projette les données dans un espace de plus basse dimension avant d’appliquer les k-ppv. Les distances adaptatives comme Mahalanobis peuvent aider si certaines dimensions sont plus informatives. Mais fondamentalement, les méthodes de voisinage ne sont pas adaptées aux problèmes en très haute dimension, ce qui motive l’étude des méthodes paramétriques dans les chapitres suivants.","position":{"start":{"line":698,"column":1},"end":{"line":698,"column":1}},"key":"WgsCFEgWnS"}],"key":"wI9gGCmIQr"},{"type":"heading","depth":2,"position":{"start":{"line":700,"column":1},"end":{"line":700,"column":1}},"children":[{"type":"text","value":"Régression","position":{"start":{"line":700,"column":1},"end":{"line":700,"column":1}},"key":"gkDT7exrvM"}],"identifier":"r-gression","label":"Régression","html_id":"r-gression","implicit":true,"key":"RqBdWKFFx6"},{"type":"paragraph","position":{"start":{"line":702,"column":1},"end":{"line":702,"column":1}},"children":[{"type":"text","value":"En classification, nous avons combiné les étiquettes des voisins par vote majoritaire. Pour la régression, où ","position":{"start":{"line":702,"column":1},"end":{"line":702,"column":1}},"key":"SpV66nBxBx"},{"type":"inlineMath","value":"y_i \\in \\mathbb{R}","position":{"start":{"line":702,"column":1},"end":{"line":702,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>y</mi><mi>i</mi></msub><mo>∈</mo><mi mathvariant=\"double-struck\">R</mi></mrow><annotation encoding=\"application/x-tex\">y_i \\in \\mathbb{R}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7335em;vertical-align:-0.1944em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">∈</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6889em;\"></span><span class=\"mord mathbb\">R</span></span></span></span>","key":"Tg03X6MNbn"},{"type":"text","value":", la combinaison naturelle est une moyenne:","position":{"start":{"line":702,"column":1},"end":{"line":702,"column":1}},"key":"NKJuo83jx5"}],"key":"fCgdq6rFa1"},{"type":"math","value":"\\hat{y} = \\frac{1}{k} \\sum_{i \\in \\mathcal{N}_k(x)} y_i","position":{"start":{"line":704,"column":1},"end":{"line":706,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mover accent=\"true\"><mi>y</mi><mo>^</mo></mover><mo>=</mo><mfrac><mn>1</mn><mi>k</mi></mfrac><munder><mo>∑</mo><mrow><mi>i</mi><mo>∈</mo><msub><mi mathvariant=\"script\">N</mi><mi>k</mi></msub><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow></munder><msub><mi>y</mi><mi>i</mi></msub></mrow><annotation encoding=\"application/x-tex\">\\hat{y} = \\frac{1}{k} \\sum_{i \\in \\mathcal{N}_k(x)} y_i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord accent\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6944em;\"><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span></span><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"accent-body\" style=\"left:-0.1944em;\"><span class=\"mord\">^</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1944em;\"><span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.8374em;vertical-align:-1.516em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3214em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mop op-limits\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.05em;\"><span style=\"top:-1.809em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mrel mtight\">∈</span><span class=\"mord mtight\"><span class=\"mord mathcal mtight\" style=\"margin-right:0.14736em;\">N</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3448em;\"><span style=\"top:-2.3488em;margin-left:-0.1474em;margin-right:0.0714em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1512em;\"><span></span></span></span></span></span></span><span class=\"mopen mtight\">(</span><span class=\"mord mathnormal mtight\">x</span><span class=\"mclose mtight\">)</span></span></span></span><span style=\"top:-3.05em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span><span class=\"mop op-symbol large-op\">∑</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.516em;\"><span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span></span>","enumerator":"16","key":"uTNLqUo1TI"},{"type":"paragraph","position":{"start":{"line":708,"column":1},"end":{"line":708,"column":1}},"children":[{"type":"text","value":"Cette moyenne locale estime l’espérance conditionnelle ","position":{"start":{"line":708,"column":1},"end":{"line":708,"column":1}},"key":"rgaq8fA3GK"},{"type":"inlineMath","value":"\\mathbb{E}[Y \\mid X = x]","position":{"start":{"line":708,"column":1},"end":{"line":708,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"double-struck\">E</mi><mo stretchy=\"false\">[</mo><mi>Y</mi><mo>∣</mo><mi>X</mi><mo>=</mo><mi>x</mi><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">\\mathbb{E}[Y \\mid X = x]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathbb\">E</span><span class=\"mopen\">[</span><span class=\"mord mathnormal\" style=\"margin-right:0.22222em;\">Y</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">∣</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">]</span></span></span></span>","key":"Sgdri0YRwo"},{"type":"text","value":". L’intuition est simple: si nous voulons prédire la température demain et que nous avons des données historiques, regarder les jours passés qui ressemblaient à aujourd’hui et moyenner leurs températures du lendemain semble raisonnable.","position":{"start":{"line":708,"column":1},"end":{"line":708,"column":1}},"key":"WmvENtxKjr"}],"key":"DV5DaeO6M6"}],"key":"jVRsz0nudo"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"import numpy as np\nimport matplotlib.pyplot as plt\n\n# Generate 1D regression data\nnp.random.seed(42)\nn = 50\nX_train = np.sort(np.random.uniform(0, 10, n))\ny_train = np.sin(X_train) + np.random.randn(n) * 0.3\n\ndef knn_regression(X_train, y_train, X_test, k):\n    predictions = []\n    for x in X_test:\n        distances = np.abs(X_train - x)\n        k_nearest_idx = np.argsort(distances)[:k]\n        predictions.append(np.mean(y_train[k_nearest_idx]))\n    return np.array(predictions)\n\nX_test = np.linspace(0, 10, 200)\n\nfig, axes = plt.subplots(1, 3, figsize=(12, 3.5))\nk_values = [1, 5, 15]\n\nfor ax, k in zip(axes, k_values):\n    y_pred = knn_regression(X_train, y_train, X_test, k)\n    \n    ax.scatter(X_train, y_train, c='C0', s=30, alpha=0.6, label='Données')\n    ax.plot(X_test, y_pred, 'C1-', linewidth=2, label=f'k-ppv ($k={k}$)')\n    ax.plot(X_test, np.sin(X_test), 'k--', alpha=0.5, label=r'$\\sin(x)$')\n    ax.set_xlabel('$x$')\n    ax.set_ylabel('$y$')\n    ax.set_title(f'$k = {k}$')\n    ax.legend(loc='upper right', fontsize=8)\n    ax.set_xlim(0, 10)\n\nplt.tight_layout()","visibility":"hide","key":"LBMjLpePTT"},{"type":"outputs","id":"W-wIVunIVGyXg5nVdYkpH","children":[{"type":"output","children":[],"jupyter_data":{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"<Figure size 1200x350 with 3 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"385a20c6fa1d50c2145619b725615319","path":"/mlbook/build/385a20c6fa1d50c2145619b725615319.png"}}},"key":"BdW8Wyqs1N"}],"visibility":"show","key":"gypC37Zpp0"}],"data":{"tags":[]},"visibility":"show","key":"U6yf8Az9W4"},{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":750,"column":1},"end":{"line":750,"column":1}},"children":[{"type":"text","value":"Avec ","position":{"start":{"line":750,"column":1},"end":{"line":750,"column":1}},"key":"tq6CGTYWfG"},{"type":"inlineMath","value":"k = 1","position":{"start":{"line":750,"column":1},"end":{"line":750,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>k</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">k = 1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span>","key":"lhQV11OJlZ"},{"type":"text","value":", la prédiction saute d’un point à l’autre, créant une fonction en escalier. Augmenter ","position":{"start":{"line":750,"column":1},"end":{"line":750,"column":1}},"key":"X21zSmwaO6"},{"type":"inlineMath","value":"k","position":{"start":{"line":750,"column":1},"end":{"line":750,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>k</mi></mrow><annotation encoding=\"application/x-tex\">k</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span></span></span></span>","key":"t60EYl4qVZ"},{"type":"text","value":" lisse la prédiction, mais un ","position":{"start":{"line":750,"column":1},"end":{"line":750,"column":1}},"key":"lXMGLDk8hj"},{"type":"inlineMath","value":"k","position":{"start":{"line":750,"column":1},"end":{"line":750,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>k</mi></mrow><annotation encoding=\"application/x-tex\">k</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span></span></span></span>","key":"ToCR0dI5mW"},{"type":"text","value":" trop grand écrase les variations locales.","position":{"start":{"line":750,"column":1},"end":{"line":750,"column":1}},"key":"REINBay1yG"}],"key":"YDRyq5CVFf"},{"type":"heading","depth":2,"position":{"start":{"line":752,"column":1},"end":{"line":752,"column":1}},"children":[{"type":"text","value":"Estimation de densité par noyaux","position":{"start":{"line":752,"column":1},"end":{"line":752,"column":1}},"key":"KtbgzQfxgN"}],"identifier":"estimation-de-densit-par-noyaux","label":"Estimation de densité par noyaux","html_id":"estimation-de-densit-par-noyaux","implicit":true,"key":"i0N3k7YqlW"},{"type":"paragraph","position":{"start":{"line":754,"column":1},"end":{"line":754,"column":1}},"children":[{"type":"text","value":"Avant d’aller plus loin dans la régression, introduisons un outil fondamental: l’","position":{"start":{"line":754,"column":1},"end":{"line":754,"column":1}},"key":"tzRZUgIkGw"},{"type":"strong","position":{"start":{"line":754,"column":1},"end":{"line":754,"column":1}},"children":[{"type":"text","value":"estimation de densité par noyaux","position":{"start":{"line":754,"column":1},"end":{"line":754,"column":1}},"key":"sW7k1jC8c2"}],"key":"cLP3Il4o3w"},{"type":"text","value":" (kernel density estimation, ou fenêtres de Parzen).","position":{"start":{"line":754,"column":1},"end":{"line":754,"column":1}},"key":"TdppMKhPYh"}],"key":"mRwGFKBvvP"},{"type":"paragraph","position":{"start":{"line":756,"column":1},"end":{"line":756,"column":1}},"children":[{"type":"text","value":"Supposons que nous observons des points ","position":{"start":{"line":756,"column":1},"end":{"line":756,"column":1}},"key":"FLZl0GWfbt"},{"type":"inlineMath","value":"x_1, \\ldots, x_N","position":{"start":{"line":756,"column":1},"end":{"line":756,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>x</mi><mn>1</mn></msub><mo separator=\"true\">,</mo><mo>…</mo><mo separator=\"true\">,</mo><msub><mi>x</mi><mi>N</mi></msub></mrow><annotation encoding=\"application/x-tex\">x_1, \\ldots, x_N</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"minner\">…</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3283em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.10903em;\">N</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"PDXH15phvo"},{"type":"text","value":" tirés d’une densité inconnue ","position":{"start":{"line":756,"column":1},"end":{"line":756,"column":1}},"key":"jrCru1TquK"},{"type":"inlineMath","value":"p(x)","position":{"start":{"line":756,"column":1},"end":{"line":756,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>p</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">p(x)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">p</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span></span></span></span>","key":"qnJBGo8h6x"},{"type":"text","value":". Comment estimer cette densité? Une approche naïve serait de construire un histogramme, mais les histogrammes dépendent du choix arbitraire des intervalles et produisent des estimations discontinues.","position":{"start":{"line":756,"column":1},"end":{"line":756,"column":1}},"key":"ewjXY46ffm"}],"key":"lVQFav3rEL"},{"type":"paragraph","position":{"start":{"line":758,"column":1},"end":{"line":758,"column":1}},"children":[{"type":"text","value":"L’idée des fenêtres de Parzen est de placer un petit “noyau” sur chaque observation et de sommer ces contributions:","position":{"start":{"line":758,"column":1},"end":{"line":758,"column":1}},"key":"uaCZ1lPEPo"}],"key":"s6hKniufHE"},{"type":"math","value":"\\hat{p}(x) = \\frac{1}{N} \\sum_{i=1}^{N} K_\\lambda(x - x_i)","position":{"start":{"line":760,"column":1},"end":{"line":762,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mover accent=\"true\"><mi>p</mi><mo>^</mo></mover><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mfrac><mn>1</mn><mi>N</mi></mfrac><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></munderover><msub><mi>K</mi><mi>λ</mi></msub><mo stretchy=\"false\">(</mo><mi>x</mi><mo>−</mo><msub><mi>x</mi><mi>i</mi></msub><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">\\hat{p}(x) = \\frac{1}{N} \\sum_{i=1}^{N} K_\\lambda(x - x_i)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord accent\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6944em;\"><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord mathnormal\">p</span></span><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"accent-body\" style=\"left:-0.1667em;\"><span class=\"mord\">^</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1944em;\"><span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:3.106em;vertical-align:-1.2777em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3214em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mop op-limits\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.8283em;\"><span style=\"top:-1.8723em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mrel mtight\">=</span><span class=\"mord mtight\">1</span></span></span></span><span style=\"top:-3.05em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span><span class=\"mop op-symbol large-op\">∑</span></span></span><span style=\"top:-4.3em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.10903em;\">N</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.2777em;\"><span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">K</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">λ</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span></span>","enumerator":"17","key":"stEjLi3k0A"},{"type":"paragraph","position":{"start":{"line":764,"column":1},"end":{"line":764,"column":1}},"children":[{"type":"text","value":"Le ","position":{"start":{"line":764,"column":1},"end":{"line":764,"column":1}},"key":"QgmxDH7CuQ"},{"type":"strong","position":{"start":{"line":764,"column":1},"end":{"line":764,"column":1}},"children":[{"type":"text","value":"noyau","position":{"start":{"line":764,"column":1},"end":{"line":764,"column":1}},"key":"ix3mxpWRdI"}],"key":"b3dQr3xJyU"},{"type":"text","value":" ","position":{"start":{"line":764,"column":1},"end":{"line":764,"column":1}},"key":"P0HtVd6kHH"},{"type":"inlineMath","value":"K_\\lambda","position":{"start":{"line":764,"column":1},"end":{"line":764,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>K</mi><mi>λ</mi></msub></mrow><annotation encoding=\"application/x-tex\">K_\\lambda</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">K</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">λ</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"Ef8BbFHptq"},{"type":"text","value":" est une fonction qui satisfait ","position":{"start":{"line":764,"column":1},"end":{"line":764,"column":1}},"key":"sSvO1gRPuE"},{"type":"inlineMath","value":"\\int K_\\lambda(u) \\, du = 1","position":{"start":{"line":764,"column":1},"end":{"line":764,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo>∫</mo><msub><mi>K</mi><mi>λ</mi></msub><mo stretchy=\"false\">(</mo><mi>u</mi><mo stretchy=\"false\">)</mo><mtext> </mtext><mi>d</mi><mi>u</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">\\int K_\\lambda(u) \\, du = 1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.1111em;vertical-align:-0.3061em;\"></span><span class=\"mop op-symbol small-op\" style=\"margin-right:0.19445em;position:relative;top:-0.0006em;\">∫</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">K</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">λ</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">u</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">d</span><span class=\"mord mathnormal\">u</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span>","key":"TkDSzInLWB"},{"type":"text","value":" et ","position":{"start":{"line":764,"column":1},"end":{"line":764,"column":1}},"key":"pgJlbCSskN"},{"type":"inlineMath","value":"K_\\lambda(u) = K_\\lambda(-u)","position":{"start":{"line":764,"column":1},"end":{"line":764,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>K</mi><mi>λ</mi></msub><mo stretchy=\"false\">(</mo><mi>u</mi><mo stretchy=\"false\">)</mo><mo>=</mo><msub><mi>K</mi><mi>λ</mi></msub><mo stretchy=\"false\">(</mo><mo>−</mo><mi>u</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">K_\\lambda(u) = K_\\lambda(-u)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">K</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">λ</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">u</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">K</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">λ</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord\">−</span><span class=\"mord mathnormal\">u</span><span class=\"mclose\">)</span></span></span></span>","key":"uNAi2idyHq"},{"type":"text","value":". Le paramètre ","position":{"start":{"line":764,"column":1},"end":{"line":764,"column":1}},"key":"xd6EzTnDa6"},{"type":"inlineMath","value":"\\lambda","position":{"start":{"line":764,"column":1},"end":{"line":764,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>λ</mi></mrow><annotation encoding=\"application/x-tex\">\\lambda</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\">λ</span></span></span></span>","key":"pxbwO5jWVQ"},{"type":"text","value":" contrôle la ","position":{"start":{"line":764,"column":1},"end":{"line":764,"column":1}},"key":"kS90RWGv3z"},{"type":"strong","position":{"start":{"line":764,"column":1},"end":{"line":764,"column":1}},"children":[{"type":"text","value":"largeur de bande","position":{"start":{"line":764,"column":1},"end":{"line":764,"column":1}},"key":"ae8gI7t6E2"}],"key":"DrzChUautt"},{"type":"text","value":" (bandwidth): plus ","position":{"start":{"line":764,"column":1},"end":{"line":764,"column":1}},"key":"No0DD59XXY"},{"type":"inlineMath","value":"\\lambda","position":{"start":{"line":764,"column":1},"end":{"line":764,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>λ</mi></mrow><annotation encoding=\"application/x-tex\">\\lambda</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\">λ</span></span></span></span>","key":"OdOpJ7uAoq"},{"type":"text","value":" est grand, plus le noyau est étalé, plus l’estimation est lisse.","position":{"start":{"line":764,"column":1},"end":{"line":764,"column":1}},"key":"o8lPzqhP8u"}],"key":"iibiRf4qYe"},{"type":"paragraph","position":{"start":{"line":766,"column":1},"end":{"line":766,"column":1}},"children":[{"type":"text","value":"Le noyau le plus courant est le noyau gaussien:","position":{"start":{"line":766,"column":1},"end":{"line":766,"column":1}},"key":"Z3BM2rmjI2"}],"key":"rdnvT3vwlu"},{"type":"math","value":"K_\\lambda(u) = \\frac{1}{\\lambda \\sqrt{2\\pi}} \\exp\\left(-\\frac{u^2}{2\\lambda^2}\\right)","position":{"start":{"line":768,"column":1},"end":{"line":770,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><msub><mi>K</mi><mi>λ</mi></msub><mo stretchy=\"false\">(</mo><mi>u</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mfrac><mn>1</mn><mrow><mi>λ</mi><msqrt><mrow><mn>2</mn><mi>π</mi></mrow></msqrt></mrow></mfrac><mi>exp</mi><mo>⁡</mo><mrow><mo fence=\"true\">(</mo><mo>−</mo><mfrac><msup><mi>u</mi><mn>2</mn></msup><mrow><mn>2</mn><msup><mi>λ</mi><mn>2</mn></msup></mrow></mfrac><mo fence=\"true\">)</mo></mrow></mrow><annotation encoding=\"application/x-tex\">K_\\lambda(u) = \\frac{1}{\\lambda \\sqrt{2\\pi}} \\exp\\left(-\\frac{u^2}{2\\lambda^2}\\right)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">K</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">λ</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">u</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.4411em;vertical-align:-0.95em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3214em;\"><span style=\"top:-2.2028em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">λ</span><span class=\"mord sqrt\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.9072em;\"><span class=\"svg-align\" style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\" style=\"padding-left:0.833em;\"><span class=\"mord\">2</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">π</span></span></span><span style=\"top:-2.8672em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"hide-tail\" style=\"min-width:0.853em;height:1.08em;\"><svg xmlns=\"http://www.w3.org/2000/svg\" width='400em' height='1.08em' viewBox='0 0 400000 1080' preserveAspectRatio='xMinYMin slice'><path d='M95,702\nc-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14\nc0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54\nc44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10\ns173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429\nc69,-144,104.5,-217.7,106.5,-221\nl0 -0\nc5.3,-9.3,12,-14,20,-14\nH400000v40H845.2724\ns-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7\nc-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z\nM834 80h400000v40h-400000z'/></svg></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1328em;\"><span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.93em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mop\">exp</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"minner\"><span class=\"mopen delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size3\">(</span></span><span class=\"mord\">−</span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.4911em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">2</span><span class=\"mord\"><span class=\"mord mathnormal\">λ</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7401em;\"><span style=\"top:-2.989em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\">u</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mclose delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size3\">)</span></span></span></span></span></span></span>","enumerator":"18","key":"STAKQqY5xI"}],"key":"SGT3lySuWl"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"import numpy as np\nimport matplotlib.pyplot as plt\n\n# Generate samples from a mixture of Gaussians\nnp.random.seed(42)\nn = 100\nsamples = np.concatenate([\n    np.random.randn(n//2) * 0.5 + 2,\n    np.random.randn(n//2) * 0.8 + 5\n])\n\ndef gaussian_kernel(u, bandwidth):\n    return np.exp(-u**2 / (2 * bandwidth**2)) / (bandwidth * np.sqrt(2 * np.pi))\n\ndef kde(x_query, samples, bandwidth):\n    density = np.zeros_like(x_query)\n    for xi in samples:\n        density += gaussian_kernel(x_query - xi, bandwidth)\n    return density / len(samples)\n\nx = np.linspace(-1, 9, 500)\n\nfig, axes = plt.subplots(1, 3, figsize=(12, 3.5))\nbandwidths = [0.2, 0.5, 1.5]\n\nfor ax, bw in zip(axes, bandwidths):\n    density = kde(x, samples, bw)\n    \n    ax.fill_between(x, density, alpha=0.3, color='C0')\n    ax.plot(x, density, 'C0-', linewidth=2, label=f'KDE ($\\\\lambda={bw}$)')\n    ax.scatter(samples, np.zeros_like(samples) - 0.02, c='k', s=10, alpha=0.5, marker='|')\n    ax.set_xlabel('$x$')\n    ax.set_ylabel(r'$\\hat{p}(x)$')\n    ax.set_title(f'Largeur de bande $\\\\lambda = {bw}$')\n    ax.set_xlim(-1, 9)\n    ax.set_ylim(-0.05, 0.6)\n\nplt.tight_layout()","visibility":"hide","key":"sE36iRSzUv"},{"type":"outputs","id":"EtQ7unrojOguEuz_JaPa1","children":[{"type":"output","children":[],"jupyter_data":{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"<Figure size 1200x350 with 3 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"c1c875dabd6006d993b11a10c3db8626","path":"/mlbook/build/c1c875dabd6006d993b11a10c3db8626.png"}}},"key":"rmsH4b4saB"}],"visibility":"show","key":"RemxFIjnYn"}],"data":{"tags":[]},"visibility":"show","key":"H0Xjya3wH9"},{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":815,"column":1},"end":{"line":815,"column":1}},"children":[{"type":"text","value":"Avec une petite largeur de bande (","position":{"start":{"line":815,"column":1},"end":{"line":815,"column":1}},"key":"AQgidqW98m"},{"type":"inlineMath","value":"\\lambda = 0.2","position":{"start":{"line":815,"column":1},"end":{"line":815,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>λ</mi><mo>=</mo><mn>0.2</mn></mrow><annotation encoding=\"application/x-tex\">\\lambda = 0.2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\">λ</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0.2</span></span></span></span>","key":"RX4iVewKTy"},{"type":"text","value":"), chaque observation crée un pic distinct et l’estimation est très variable. Avec une grande largeur de bande (","position":{"start":{"line":815,"column":1},"end":{"line":815,"column":1}},"key":"DkKzJmyy9u"},{"type":"inlineMath","value":"\\lambda = 1.5","position":{"start":{"line":815,"column":1},"end":{"line":815,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>λ</mi><mo>=</mo><mn>1.5</mn></mrow><annotation encoding=\"application/x-tex\">\\lambda = 1.5</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\">λ</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1.5</span></span></span></span>","key":"wcWW0CZNZi"},{"type":"text","value":"), les détails sont perdus et la structure bimodale des données est masquée. Le choix de ","position":{"start":{"line":815,"column":1},"end":{"line":815,"column":1}},"key":"pn04yhhr2L"},{"type":"inlineMath","value":"\\lambda","position":{"start":{"line":815,"column":1},"end":{"line":815,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>λ</mi></mrow><annotation encoding=\"application/x-tex\">\\lambda</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\">λ</span></span></span></span>","key":"kz0guE7YIq"},{"type":"text","value":" incarne encore une fois le compromis biais-variance.","position":{"start":{"line":815,"column":1},"end":{"line":815,"column":1}},"key":"dOskMkrtOr"}],"key":"DKyF8ibzCw"},{"type":"heading","depth":2,"position":{"start":{"line":817,"column":1},"end":{"line":817,"column":1}},"children":[{"type":"text","value":"Régression de Nadaraya-Watson","position":{"start":{"line":817,"column":1},"end":{"line":817,"column":1}},"key":"ao4rjhLqTV"}],"identifier":"r-gression-de-nadaraya-watson","label":"Régression de Nadaraya-Watson","html_id":"r-gression-de-nadaraya-watson","implicit":true,"key":"iPPmLNAWU0"},{"type":"paragraph","position":{"start":{"line":819,"column":1},"end":{"line":819,"column":1}},"children":[{"type":"text","value":"L’estimation de densité par noyaux mène naturellement à une forme de régression plus souple que les k-ppv. Plutôt que de sélectionner exactement ","position":{"start":{"line":819,"column":1},"end":{"line":819,"column":1}},"key":"aai73RtJpD"},{"type":"inlineMath","value":"k","position":{"start":{"line":819,"column":1},"end":{"line":819,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>k</mi></mrow><annotation encoding=\"application/x-tex\">k</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span></span></span></span>","key":"X5pkFE8NYf"},{"type":"text","value":" voisins et de les traiter également, nous pouvons pondérer ","position":{"start":{"line":819,"column":1},"end":{"line":819,"column":1}},"key":"d1vQLKA9nN"},{"type":"emphasis","position":{"start":{"line":819,"column":1},"end":{"line":819,"column":1}},"children":[{"type":"text","value":"tous","position":{"start":{"line":819,"column":1},"end":{"line":819,"column":1}},"key":"GmdNci4iR1"}],"key":"gUprERReZ7"},{"type":"text","value":" les points selon leur proximité à la requête.","position":{"start":{"line":819,"column":1},"end":{"line":819,"column":1}},"key":"Y12R92uDrO"}],"key":"cR9cQsqEdv"},{"type":"paragraph","position":{"start":{"line":821,"column":1},"end":{"line":821,"column":1}},"children":[{"type":"text","value":"L’","position":{"start":{"line":821,"column":1},"end":{"line":821,"column":1}},"key":"huLEp7Tzoe"},{"type":"strong","position":{"start":{"line":821,"column":1},"end":{"line":821,"column":1}},"children":[{"type":"text","value":"estimateur de Nadaraya-Watson","position":{"start":{"line":821,"column":1},"end":{"line":821,"column":1}},"key":"xzrZ0YmKFc"}],"key":"xi756pRKBe"},{"type":"text","value":" définit la prédiction comme une moyenne pondérée:","position":{"start":{"line":821,"column":1},"end":{"line":821,"column":1}},"key":"QlXI5Iiprm"}],"key":"j7x7iKmjhh"},{"type":"math","value":"\\hat{y}(x) = \\frac{\\sum_{i=1}^{N} K_\\lambda(x - x_i) \\, y_i}{\\sum_{i=1}^{N} K_\\lambda(x - x_i)} = \\sum_{i=1}^{N} w_i(x) \\, y_i","position":{"start":{"line":823,"column":1},"end":{"line":825,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mover accent=\"true\"><mi>y</mi><mo>^</mo></mover><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mfrac><mrow><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></munderover><msub><mi>K</mi><mi>λ</mi></msub><mo stretchy=\"false\">(</mo><mi>x</mi><mo>−</mo><msub><mi>x</mi><mi>i</mi></msub><mo stretchy=\"false\">)</mo><mtext> </mtext><msub><mi>y</mi><mi>i</mi></msub></mrow><mrow><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></munderover><msub><mi>K</mi><mi>λ</mi></msub><mo stretchy=\"false\">(</mo><mi>x</mi><mo>−</mo><msub><mi>x</mi><mi>i</mi></msub><mo stretchy=\"false\">)</mo></mrow></mfrac><mo>=</mo><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></munderover><msub><mi>w</mi><mi>i</mi></msub><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo><mtext> </mtext><msub><mi>y</mi><mi>i</mi></msub></mrow><annotation encoding=\"application/x-tex\">\\hat{y}(x) = \\frac{\\sum_{i=1}^{N} K_\\lambda(x - x_i) \\, y_i}{\\sum_{i=1}^{N} K_\\lambda(x - x_i)} = \\sum_{i=1}^{N} w_i(x) \\, y_i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord accent\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6944em;\"><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span></span><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"accent-body\" style=\"left:-0.1944em;\"><span class=\"mord\">^</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1944em;\"><span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.8419em;vertical-align:-1.1709em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.6709em;\"><span style=\"top:-2.1288em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mop\"><span class=\"mop op-symbol small-op\" style=\"position:relative;top:0em;\">∑</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.9812em;\"><span style=\"top:-2.4003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mrel mtight\">=</span><span class=\"mord mtight\">1</span></span></span></span><span style=\"top:-3.2029em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.10903em;\">N</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2997em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">K</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">λ</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.6897em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mop\"><span class=\"mop op-symbol small-op\" style=\"position:relative;top:0em;\">∑</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.9812em;\"><span style=\"top:-2.4003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mrel mtight\">=</span><span class=\"mord mtight\">1</span></span></span></span><span style=\"top:-3.2029em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.10903em;\">N</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2997em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">K</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">λ</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.1709em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:3.106em;vertical-align:-1.2777em;\"></span><span class=\"mop op-limits\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.8283em;\"><span style=\"top:-1.8723em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mrel mtight\">=</span><span class=\"mord mtight\">1</span></span></span></span><span style=\"top:-3.05em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span><span class=\"mop op-symbol large-op\">∑</span></span></span><span style=\"top:-4.3em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.10903em;\">N</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.2777em;\"><span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span></span>","enumerator":"19","key":"n5H2vNw3ii"},{"type":"paragraph","position":{"start":{"line":827,"column":1},"end":{"line":827,"column":1}},"children":[{"type":"text","value":"où les poids sont normalisés:","position":{"start":{"line":827,"column":1},"end":{"line":827,"column":1}},"key":"luczMKpqEj"}],"key":"cJr6d4OYCL"},{"type":"math","value":"w_i(x) = \\frac{K_\\lambda(x - x_i)}{\\sum_{j=1}^{N} K_\\lambda(x - x_j)}","position":{"start":{"line":829,"column":1},"end":{"line":831,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><msub><mi>w</mi><mi>i</mi></msub><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mfrac><mrow><msub><mi>K</mi><mi>λ</mi></msub><mo stretchy=\"false\">(</mo><mi>x</mi><mo>−</mo><msub><mi>x</mi><mi>i</mi></msub><mo stretchy=\"false\">)</mo></mrow><mrow><munderover><mo>∑</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></munderover><msub><mi>K</mi><mi>λ</mi></msub><mo stretchy=\"false\">(</mo><mi>x</mi><mo>−</mo><msub><mi>x</mi><mi>j</mi></msub><mo stretchy=\"false\">)</mo></mrow></mfrac></mrow><annotation encoding=\"application/x-tex\">w_i(x) = \\frac{K_\\lambda(x - x_i)}{\\sum_{j=1}^{N} K_\\lambda(x - x_j)}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.734em;vertical-align:-1.307em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.427em;\"><span style=\"top:-2.1288em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mop\"><span class=\"mop op-symbol small-op\" style=\"position:relative;top:0em;\">∑</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.9812em;\"><span style=\"top:-2.4003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span><span class=\"mrel mtight\">=</span><span class=\"mord mtight\">1</span></span></span></span><span style=\"top:-3.2029em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.10903em;\">N</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.4358em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">K</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">λ</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">K</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">λ</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.307em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span></span>","enumerator":"20","key":"uLCeqBRsYK"},{"type":"paragraph","position":{"start":{"line":833,"column":1},"end":{"line":833,"column":1}},"children":[{"type":"text","value":"Chaque point d’entraînement contribue à la prédiction, mais les points éloignés ont un poids négligeable. Le noyau agit comme une fenêtre qui détermine l’influence locale.","position":{"start":{"line":833,"column":1},"end":{"line":833,"column":1}},"key":"zewXPr3FTK"}],"key":"R3WCzLv27L"}],"key":"ItuRXdI5AX"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"import numpy as np\nimport matplotlib.pyplot as plt\n\n# Generate 1D regression data\nnp.random.seed(42)\nn = 50\nX_train = np.sort(np.random.uniform(0, 10, n))\ny_train = np.sin(X_train) + np.random.randn(n) * 0.3\n\ndef gaussian_kernel(u, bandwidth):\n    return np.exp(-u**2 / (2 * bandwidth**2))\n\ndef nadaraya_watson(X_train, y_train, X_test, bandwidth):\n    predictions = []\n    for x in X_test:\n        weights = gaussian_kernel(X_train - x, bandwidth)\n        if np.sum(weights) > 1e-10:\n            predictions.append(np.sum(weights * y_train) / np.sum(weights))\n        else:\n            predictions.append(0)\n    return np.array(predictions)\n\nX_test = np.linspace(0, 10, 200)\n\nfig, axes = plt.subplots(1, 3, figsize=(12, 3.5))\nbandwidths = [0.2, 0.5, 1.5]\n\nfor ax, bw in zip(axes, bandwidths):\n    y_pred = nadaraya_watson(X_train, y_train, X_test, bw)\n    \n    ax.scatter(X_train, y_train, c='C0', s=30, alpha=0.6, label='Données')\n    ax.plot(X_test, y_pred, 'C1-', linewidth=2, label=f'Nadaraya-Watson')\n    ax.plot(X_test, np.sin(X_test), 'k--', alpha=0.5, label=r'$\\sin(x)$')\n    ax.set_xlabel('$x$')\n    ax.set_ylabel('$y$')\n    ax.set_title(f'$\\\\lambda = {bw}$')\n    ax.legend(loc='upper right', fontsize=8)\n    ax.set_xlim(0, 10)\n\nplt.tight_layout()","visibility":"hide","key":"DluJX0U9Ht"},{"type":"outputs","id":"li0ZImWMOVR7EfKObHhcT","children":[{"type":"output","children":[],"jupyter_data":{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"<Figure size 1200x350 with 3 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"da3099cf8a80e137ad7088d1a8ca35d0","path":"/mlbook/build/da3099cf8a80e137ad7088d1a8ca35d0.png"}}},"key":"yB00J5JxpU"}],"visibility":"show","key":"qQKAfmhuCI"}],"data":{"tags":[]},"visibility":"show","key":"RFZ08jykDB"},{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":880,"column":1},"end":{"line":880,"column":1}},"children":[{"type":"text","value":"Comparé aux k-ppv, Nadaraya-Watson produit des prédictions plus lisses car la transition entre voisins est graduelle plutôt qu’abrupte. Le paramètre ","position":{"start":{"line":880,"column":1},"end":{"line":880,"column":1}},"key":"HtgWfVSD9c"},{"type":"inlineMath","value":"\\lambda","position":{"start":{"line":880,"column":1},"end":{"line":880,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>λ</mi></mrow><annotation encoding=\"application/x-tex\">\\lambda</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\">λ</span></span></span></span>","key":"kTHUXaAfYj"},{"type":"text","value":" joue un rôle analogue à ","position":{"start":{"line":880,"column":1},"end":{"line":880,"column":1}},"key":"EeGxElZl1o"},{"type":"inlineMath","value":"k","position":{"start":{"line":880,"column":1},"end":{"line":880,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>k</mi></mrow><annotation encoding=\"application/x-tex\">k</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span></span></span></span>","key":"btkfyqTq5n"},{"type":"text","value":": une petite largeur de bande donne une courbe qui suit de près les données (haute variance), une grande largeur de bande lisse excessivement (haut biais).","position":{"start":{"line":880,"column":1},"end":{"line":880,"column":1}},"key":"X4ooQVlmrA"}],"key":"A4aQGgOCqP"},{"type":"paragraph","position":{"start":{"line":882,"column":1},"end":{"line":882,"column":1}},"children":[{"type":"text","value":"Les deux approches, k-ppv et Nadaraya-Watson, sont des méthodes à ","position":{"start":{"line":882,"column":1},"end":{"line":882,"column":1}},"key":"CkmGJTbgcd"},{"type":"strong","position":{"start":{"line":882,"column":1},"end":{"line":882,"column":1}},"children":[{"type":"text","value":"moyennes locales","position":{"start":{"line":882,"column":1},"end":{"line":882,"column":1}},"key":"gYHQ68NC2H"}],"key":"uBPpTqMzN0"},{"type":"text","value":". Elles estiment ","position":{"start":{"line":882,"column":1},"end":{"line":882,"column":1}},"key":"JVO2rifJiL"},{"type":"inlineMath","value":"\\mathbb{E}[Y \\mid X = x]","position":{"start":{"line":882,"column":1},"end":{"line":882,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"double-struck\">E</mi><mo stretchy=\"false\">[</mo><mi>Y</mi><mo>∣</mo><mi>X</mi><mo>=</mo><mi>x</mi><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">\\mathbb{E}[Y \\mid X = x]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathbb\">E</span><span class=\"mopen\">[</span><span class=\"mord mathnormal\" style=\"margin-right:0.22222em;\">Y</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">∣</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">]</span></span></span></span>","key":"cHk2r8IdHO"},{"type":"text","value":" en faisant une moyenne pondérée des ","position":{"start":{"line":882,"column":1},"end":{"line":882,"column":1}},"key":"R4vsgdijCM"},{"type":"inlineMath","value":"y_i","position":{"start":{"line":882,"column":1},"end":{"line":882,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>y</mi><mi>i</mi></msub></mrow><annotation encoding=\"application/x-tex\">y_i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"ClmjlWdnuN"},{"type":"text","value":" pour les points ","position":{"start":{"line":882,"column":1},"end":{"line":882,"column":1}},"key":"VqbJ1V2YjK"},{"type":"inlineMath","value":"x_i","position":{"start":{"line":882,"column":1},"end":{"line":882,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>x</mi><mi>i</mi></msub></mrow><annotation encoding=\"application/x-tex\">x_i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"ra7tNYCdEb"},{"type":"text","value":" proches de ","position":{"start":{"line":882,"column":1},"end":{"line":882,"column":1}},"key":"qlm8u0hTzR"},{"type":"inlineMath","value":"x","position":{"start":{"line":882,"column":1},"end":{"line":882,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi></mrow><annotation encoding=\"application/x-tex\">x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span></span></span></span>","key":"M4o5pOqrzO"},{"type":"text","value":". La différence réside dans la définition de “proche”: les k-ppv utilisent une frontière nette (les ","position":{"start":{"line":882,"column":1},"end":{"line":882,"column":1}},"key":"Na51WL4Hqy"},{"type":"inlineMath","value":"k","position":{"start":{"line":882,"column":1},"end":{"line":882,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>k</mi></mrow><annotation encoding=\"application/x-tex\">k</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span></span></span></span>","key":"jJrLj7PoQV"},{"type":"text","value":" plus proches), tandis que Nadaraya-Watson utilise une pondération douce (le noyau).","position":{"start":{"line":882,"column":1},"end":{"line":882,"column":1}},"key":"tI9N05bDPk"}],"key":"MTr9ksng1Y"},{"type":"heading","depth":2,"position":{"start":{"line":884,"column":1},"end":{"line":884,"column":1}},"children":[{"type":"text","value":"Complexité","position":{"start":{"line":884,"column":1},"end":{"line":884,"column":1}},"key":"cbwo31avJk"}],"identifier":"complexit","label":"Complexité","html_id":"complexit","implicit":true,"key":"zOpG7cYN8R"},{"type":"paragraph","position":{"start":{"line":886,"column":1},"end":{"line":886,"column":1}},"children":[{"type":"text","value":"L’entraînement consiste à stocker les données: ","position":{"start":{"line":886,"column":1},"end":{"line":886,"column":1}},"key":"yWjhaI2658"},{"type":"inlineMath","value":"O(N)","position":{"start":{"line":886,"column":1},"end":{"line":886,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mo stretchy=\"false\">(</mo><mi>N</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">O(N)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"mclose\">)</span></span></span></span>","key":"O6tdJkbfRa"},{"type":"text","value":". L’inférence requiert de calculer la distance à tous les points et d’identifier les ","position":{"start":{"line":886,"column":1},"end":{"line":886,"column":1}},"key":"VhCxEve7Ar"},{"type":"inlineMath","value":"k","position":{"start":{"line":886,"column":1},"end":{"line":886,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>k</mi></mrow><annotation encoding=\"application/x-tex\">k</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span></span></span></span>","key":"Vgs2rhvAyl"},{"type":"text","value":" plus proches: ","position":{"start":{"line":886,"column":1},"end":{"line":886,"column":1}},"key":"fxHuRWYEHQ"},{"type":"inlineMath","value":"O(Nd)","position":{"start":{"line":886,"column":1},"end":{"line":886,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mo stretchy=\"false\">(</mo><mi>N</mi><mi>d</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">O(Nd)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"mord mathnormal\">d</span><span class=\"mclose\">)</span></span></span></span>","key":"q6FfC79HXI"},{"type":"text","value":" par requête. Pour de grands ensembles, des structures comme les arbres k-d ou le hachage sensible à la localité (LSH) réduisent ce coût.","position":{"start":{"line":886,"column":1},"end":{"line":886,"column":1}},"key":"StCaPhPmTG"}],"key":"UJCbz9vpqu"},{"type":"heading","depth":2,"position":{"start":{"line":888,"column":1},"end":{"line":888,"column":1}},"children":[{"type":"text","value":"Passage à l’échelle","position":{"start":{"line":888,"column":1},"end":{"line":888,"column":1}},"key":"Vx2uIrBJEb"}],"identifier":"passage-l-chelle","label":"Passage à l’échelle","html_id":"passage-l-chelle","implicit":true,"key":"xOp7DIX6k5"},{"type":"paragraph","position":{"start":{"line":890,"column":1},"end":{"line":890,"column":1}},"children":[{"type":"text","value":"L’implémentation naïve des k-ppv calcule la distance entre la requête et chaque point d’entraînement: ","position":{"start":{"line":890,"column":1},"end":{"line":890,"column":1}},"key":"vXhXmO0Pom"},{"type":"inlineMath","value":"O(Nd)","position":{"start":{"line":890,"column":1},"end":{"line":890,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mo stretchy=\"false\">(</mo><mi>N</mi><mi>d</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">O(Nd)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"mord mathnormal\">d</span><span class=\"mclose\">)</span></span></span></span>","key":"enztXho6Fq"},{"type":"text","value":" par requête. Pour un million de points en dimension 100, chaque prédiction requiert 100 millions d’opérations. Cette complexité linéaire en ","position":{"start":{"line":890,"column":1},"end":{"line":890,"column":1}},"key":"SQ7S023dlU"},{"type":"inlineMath","value":"N","position":{"start":{"line":890,"column":1},"end":{"line":890,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>N</mi></mrow><annotation encoding=\"application/x-tex\">N</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span></span></span></span>","key":"tWjOsWQ5Zs"},{"type":"text","value":" rend la méthode impraticable pour de grands ensembles de données.","position":{"start":{"line":890,"column":1},"end":{"line":890,"column":1}},"key":"BCsKhtkLED"}],"key":"u2eaBLTPdD"},{"type":"heading","depth":3,"position":{"start":{"line":892,"column":1},"end":{"line":892,"column":1}},"children":[{"type":"text","value":"Arbres k-d","position":{"start":{"line":892,"column":1},"end":{"line":892,"column":1}},"key":"nd3mN6BFsi"}],"identifier":"arbres-k-d","label":"Arbres k-d","html_id":"arbres-k-d","implicit":true,"key":"JBLHWqHfw2"},{"type":"paragraph","position":{"start":{"line":894,"column":1},"end":{"line":894,"column":1}},"children":[{"type":"text","value":"Les ","position":{"start":{"line":894,"column":1},"end":{"line":894,"column":1}},"key":"ncJL6LitxZ"},{"type":"strong","position":{"start":{"line":894,"column":1},"end":{"line":894,"column":1}},"children":[{"type":"text","value":"arbres k-d","position":{"start":{"line":894,"column":1},"end":{"line":894,"column":1}},"key":"yS5GaK1yvv"}],"key":"qdseCiAcgD"},{"type":"text","value":" (k-dimensional trees) partitionnent récursivement l’espace en régions. À chaque nœud, l’espace est divisé selon une dimension, alternant entre les dimensions à chaque niveau.","position":{"start":{"line":894,"column":1},"end":{"line":894,"column":1}},"key":"hmNNpXyJbg"}],"key":"qgXVXfm1D6"}],"key":"pZUZ842tyv"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"import numpy as np\nimport matplotlib.pyplot as plt\nfrom matplotlib.patches import Rectangle\n\nnp.random.seed(42)\n\n# Generate points\npoints = np.random.rand(15, 2) * 10\n\n# Build k-d tree splits manually for visualization\n# We'll store splits as (dimension, value, depth, bounds)\nsplits = []\n\ndef build_kdtree_splits(points_idx, depth, x_min, x_max, y_min, y_max):\n    if len(points_idx) <= 1:\n        return\n    \n    dim = depth % 2\n    pts = points[points_idx]\n    \n    # Split at median\n    sorted_idx = np.argsort(pts[:, dim])\n    median_pos = len(sorted_idx) // 2\n    median_val = pts[sorted_idx[median_pos], dim]\n    \n    splits.append((dim, median_val, depth, x_min, x_max, y_min, y_max))\n    \n    left_idx = points_idx[sorted_idx[:median_pos]]\n    right_idx = points_idx[sorted_idx[median_pos:]]\n    \n    if dim == 0:  # vertical split\n        build_kdtree_splits(left_idx, depth + 1, x_min, median_val, y_min, y_max)\n        build_kdtree_splits(right_idx, depth + 1, median_val, x_max, y_min, y_max)\n    else:  # horizontal split\n        build_kdtree_splits(left_idx, depth + 1, x_min, x_max, y_min, median_val)\n        build_kdtree_splits(right_idx, depth + 1, x_min, x_max, median_val, y_max)\n\nbuild_kdtree_splits(np.arange(len(points)), 0, 0, 10, 0, 10)\n\nfig, ax = plt.subplots(figsize=(7, 6))\n\n# Draw splits\ncolors = ['C0', 'C1', 'C2', 'C3']\nfor dim, val, depth, x_min, x_max, y_min, y_max in splits:\n    color = colors[min(depth, len(colors)-1)]\n    alpha = 0.8 - depth * 0.15\n    if dim == 0:  # vertical line\n        ax.plot([val, val], [y_min, y_max], color=color, linewidth=2, alpha=alpha)\n    else:  # horizontal line\n        ax.plot([x_min, x_max], [val, val], color=color, linewidth=2, alpha=alpha)\n\n# Draw points\nax.scatter(points[:, 0], points[:, 1], s=80, c='black', zorder=5)\n\nax.set_xlim(-0.5, 10.5)\nax.set_ylim(-0.5, 10.5)\nax.set_xlabel('$x_1$')\nax.set_ylabel('$x_2$')\nax.set_aspect('equal')\n\n# Legend for depth\nfrom matplotlib.lines import Line2D\nlegend_elements = [Line2D([0], [0], color=colors[i], linewidth=2, label=f'Profondeur {i}') \n                   for i in range(4)]\nax.legend(handles=legend_elements, loc='upper right')","visibility":"hide","key":"QYxEROJ1sR"},{"type":"outputs","id":"iGwmgPkDblMspTjSj56MP","children":[{"type":"output","children":[],"jupyter_data":{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"<Figure size 700x600 with 1 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"63e21c361393259600d1a119b767fb1c","path":"/mlbook/build/63e21c361393259600d1a119b767fb1c.png"}}},"key":"oe6wUYzt5Y"}],"visibility":"show","key":"vecC1egGRK"}],"data":{"tags":[]},"visibility":"show","key":"sRXmIUds9L"},{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":966,"column":1},"end":{"line":966,"column":1}},"children":[{"type":"text","value":"La recherche du plus proche voisin exploite cette structure: si la requête est loin de la frontière de division, des sous-arbres entiers peuvent être élagués sans examiner leurs points.","position":{"start":{"line":966,"column":1},"end":{"line":966,"column":1}},"key":"P4H4D2FGNs"}],"key":"HdWjC1dj9K"}],"key":"f2kxNhQTOi"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"import numpy as np\nimport matplotlib.pyplot as plt\nfrom matplotlib.patches import Circle, Rectangle\n\nnp.random.seed(42)\npoints = np.random.rand(15, 2) * 10\n\n# Query point\nquery = np.array([7.5, 3.0])\n\n# Find true nearest neighbor\ndistances = np.sqrt(np.sum((points - query)**2, axis=1))\nnn_idx = np.argmin(distances)\nnn_dist = distances[nn_idx]\n\n# Rebuild splits for this visualization\nsplits = []\ndef build_kdtree_splits(points_idx, depth, x_min, x_max, y_min, y_max):\n    if len(points_idx) <= 1:\n        return\n    dim = depth % 2\n    pts = points[points_idx]\n    sorted_idx = np.argsort(pts[:, dim])\n    median_pos = len(sorted_idx) // 2\n    median_val = pts[sorted_idx[median_pos], dim]\n    splits.append((dim, median_val, depth, x_min, x_max, y_min, y_max))\n    left_idx = points_idx[sorted_idx[:median_pos]]\n    right_idx = points_idx[sorted_idx[median_pos:]]\n    if dim == 0:\n        build_kdtree_splits(left_idx, depth + 1, x_min, median_val, y_min, y_max)\n        build_kdtree_splits(right_idx, depth + 1, median_val, x_max, y_min, y_max)\n    else:\n        build_kdtree_splits(left_idx, depth + 1, x_min, x_max, y_min, median_val)\n        build_kdtree_splits(right_idx, depth + 1, x_min, x_max, median_val, y_max)\n\nbuild_kdtree_splits(np.arange(len(points)), 0, 0, 10, 0, 10)\n\nfig, ax = plt.subplots(figsize=(7, 6))\n\n# Shade pruned regions (regions that don't intersect the search circle)\n# For simplicity, we'll manually identify some pruned regions\npruned_regions = [\n    (0, 4.5, 0, 10),      # Left side of first split\n]\n\nfor x_min, x_max, y_min, y_max in pruned_regions:\n    rect = Rectangle((x_min, y_min), x_max - x_min, y_max - y_min, \n                     facecolor='gray', alpha=0.3, edgecolor='none')\n    ax.add_patch(rect)\n\n# Draw splits\nfor dim, val, depth, x_min, x_max, y_min, y_max in splits:\n    alpha = 0.6\n    if dim == 0:\n        ax.plot([val, val], [y_min, y_max], color='gray', linewidth=1.5, alpha=alpha)\n    else:\n        ax.plot([x_min, x_max], [val, val], color='gray', linewidth=1.5, alpha=alpha)\n\n# Draw search radius\ncircle = Circle(query, nn_dist, fill=False, color='C1', linewidth=2, linestyle='--')\nax.add_patch(circle)\n\n# Draw points\nax.scatter(points[:, 0], points[:, 1], s=80, c='C0', zorder=5, label='Points')\nax.scatter(points[nn_idx, 0], points[nn_idx, 1], s=120, c='C2', zorder=6, \n           edgecolors='black', linewidths=2, label='Plus proche voisin')\n\n# Draw query\nax.scatter(query[0], query[1], s=150, c='red', marker='*', zorder=7, label='Requête')\n\n# Draw line to nearest neighbor\nax.plot([query[0], points[nn_idx, 0]], [query[1], points[nn_idx, 1]], \n        'C2--', linewidth=1.5, alpha=0.7)\n\nax.set_xlim(-0.5, 10.5)\nax.set_ylim(-0.5, 10.5)\nax.set_xlabel('$x_1$')\nax.set_ylabel('$x_2$')\nax.set_aspect('equal')\nax.legend(loc='upper left')\n\n# Add annotation for pruned region\nax.annotate('Région élaguée\\n(pas explorée)', xy=(2, 5), fontsize=10, \n            ha='center', color='gray')","visibility":"hide","key":"o6QsZBTq2C"},{"type":"outputs","id":"w_ejmyq59kd9skS1Wck3V","children":[{"type":"output","children":[],"jupyter_data":{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"<Figure size 700x600 with 1 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"2ce3bb728094ab1f11ea5fa9aeac7f0b","path":"/mlbook/build/2ce3bb728094ab1f11ea5fa9aeac7f0b.png"}}},"key":"KpJZySI0gM"}],"visibility":"show","key":"r2j5ziGZP0"}],"data":{"tags":[]},"visibility":"show","key":"kr5aKyepdh"},{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":1057,"column":1},"end":{"line":1057,"column":1}},"children":[{"type":"text","value":"En basse dimension, les arbres k-d réduisent la complexité moyenne à ","position":{"start":{"line":1057,"column":1},"end":{"line":1057,"column":1}},"key":"CaJBppJ7mu"},{"type":"inlineMath","value":"O(\\log N)","position":{"start":{"line":1057,"column":1},"end":{"line":1057,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mo stretchy=\"false\">(</mo><mi>log</mi><mo>⁡</mo><mi>N</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">O(\\log N)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mop\">lo<span style=\"margin-right:0.01389em;\">g</span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"mclose\">)</span></span></span></span>","key":"GWSPxFO7JY"},{"type":"text","value":" par requête. Mais leur efficacité se dégrade rapidement avec la dimension. Au-delà de ","position":{"start":{"line":1057,"column":1},"end":{"line":1057,"column":1}},"key":"MHxLjqiAIo"},{"type":"inlineMath","value":"d \\approx 20","position":{"start":{"line":1057,"column":1},"end":{"line":1057,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>d</mi><mo>≈</mo><mn>20</mn></mrow><annotation encoding=\"application/x-tex\">d \\approx 20</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\">d</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">≈</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">20</span></span></span></span>","key":"W92zJdSqaB"},{"type":"text","value":", la structure arborescente n’offre plus d’avantage significatif sur la recherche exhaustive. C’est là une autre manifestation du fléau de la dimensionnalité.","position":{"start":{"line":1057,"column":1},"end":{"line":1057,"column":1}},"key":"Y9H69uQmkS"}],"key":"Gb9IcHMxYe"},{"type":"heading","depth":3,"position":{"start":{"line":1059,"column":1},"end":{"line":1059,"column":1}},"children":[{"type":"text","value":"Recherche approximative","position":{"start":{"line":1059,"column":1},"end":{"line":1059,"column":1}},"key":"yV8EQrOarb"}],"identifier":"recherche-approximative","label":"Recherche approximative","html_id":"recherche-approximative","implicit":true,"key":"JA5wPLDslY"},{"type":"paragraph","position":{"start":{"line":1061,"column":1},"end":{"line":1061,"column":1}},"children":[{"type":"text","value":"Quand la recherche exacte est trop coûteuse, on peut accepter des voisins ","position":{"start":{"line":1061,"column":1},"end":{"line":1061,"column":1}},"key":"a4Zi45woW9"},{"type":"emphasis","position":{"start":{"line":1061,"column":1},"end":{"line":1061,"column":1}},"children":[{"type":"text","value":"approximatifs","position":{"start":{"line":1061,"column":1},"end":{"line":1061,"column":1}},"key":"LdHKiOjFH1"}],"key":"drlunVcZAN"},{"type":"text","value":". Les méthodes de ","position":{"start":{"line":1061,"column":1},"end":{"line":1061,"column":1}},"key":"iApokWv1mL"},{"type":"strong","position":{"start":{"line":1061,"column":1},"end":{"line":1061,"column":1}},"children":[{"type":"text","value":"recherche approximative des plus proches voisins","position":{"start":{"line":1061,"column":1},"end":{"line":1061,"column":1}},"key":"lCgZ96L0QR"}],"key":"vDL8gq35iP"},{"type":"text","value":" (approximate nearest neighbors, ANN) garantissent de trouver des points qui sont proches, sans garantir qu’ils soient les plus proches.","position":{"start":{"line":1061,"column":1},"end":{"line":1061,"column":1}},"key":"zShzN5Eqln"}],"key":"ThzgwrQZ82"},{"type":"paragraph","position":{"start":{"line":1063,"column":1},"end":{"line":1063,"column":1}},"children":[{"type":"text","value":"Le ","position":{"start":{"line":1063,"column":1},"end":{"line":1063,"column":1}},"key":"MrJMI3lGF6"},{"type":"strong","position":{"start":{"line":1063,"column":1},"end":{"line":1063,"column":1}},"children":[{"type":"text","value":"hachage sensible à la localité","position":{"start":{"line":1063,"column":1},"end":{"line":1063,"column":1}},"key":"TEC8tqC9KU"}],"key":"kBSaaDs4Ej"},{"type":"text","value":" (locality-sensitive hashing, LSH) projette les points dans un espace de hachage où les points proches ont une forte probabilité de collision. Plusieurs tables de hachage avec des fonctions différentes permettent d’atteindre un bon rappel. La complexité devient sous-linéaire en ","position":{"start":{"line":1063,"column":1},"end":{"line":1063,"column":1}},"key":"NJtCYXoCHZ"},{"type":"inlineMath","value":"N","position":{"start":{"line":1063,"column":1},"end":{"line":1063,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>N</mi></mrow><annotation encoding=\"application/x-tex\">N</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span></span></span></span>","key":"pgVdhUfBCx"},{"type":"text","value":", au prix d’une approximation.","position":{"start":{"line":1063,"column":1},"end":{"line":1063,"column":1}},"key":"VKTs9NFA0o"}],"key":"bCf2IeIIs4"},{"type":"paragraph","position":{"start":{"line":1065,"column":1},"end":{"line":1065,"column":1}},"children":[{"type":"text","value":"Des bibliothèques comme ","position":{"start":{"line":1065,"column":1},"end":{"line":1065,"column":1}},"key":"AkaOVZ8ooi"},{"type":"strong","position":{"start":{"line":1065,"column":1},"end":{"line":1065,"column":1}},"children":[{"type":"text","value":"FAISS","position":{"start":{"line":1065,"column":1},"end":{"line":1065,"column":1}},"key":"gfGEbYGw1S"}],"key":"sZXF6iCx7W"},{"type":"text","value":" (Facebook AI Similarity Search) et ","position":{"start":{"line":1065,"column":1},"end":{"line":1065,"column":1}},"key":"a0ryfXzoYJ"},{"type":"strong","position":{"start":{"line":1065,"column":1},"end":{"line":1065,"column":1}},"children":[{"type":"text","value":"Annoy","position":{"start":{"line":1065,"column":1},"end":{"line":1065,"column":1}},"key":"fQrXgEGPGX"}],"key":"Mps3YkviBE"},{"type":"text","value":" (Approximate Nearest Neighbors Oh Yeah) implémentent ces algorithmes et permettent de chercher parmi des milliards de vecteurs. Ces outils sont essentiels pour les systèmes de recommandation et la recherche sémantique à grande échelle, où les représentations vectorielles (embeddings) de documents, images ou produits sont comparées par similarité.","position":{"start":{"line":1065,"column":1},"end":{"line":1065,"column":1}},"key":"Nod4NoaEds"}],"key":"XX2vMh93b2"}],"key":"c9QHwqLyEM"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"import numpy as np\nimport matplotlib.pyplot as plt\n\nnp.random.seed(123)\n\n# Generate points in 2D\nn_points = 40\npoints = np.random.randn(n_points, 2)\n\n# Query point\nquery = np.array([0.5, 0.3])\n\n# Find true 5 nearest neighbors\nk = 5\ndistances = np.sqrt(np.sum((points - query)**2, axis=1))\ntrue_nn_idx = np.argsort(distances)[:k]\n\n# Simulate approximate nearest neighbors (miss one, include one wrong)\napprox_nn_idx = np.array([true_nn_idx[0], true_nn_idx[1], true_nn_idx[2], \n                          true_nn_idx[4], np.argsort(distances)[k+1]])\n\n# Points that are in both\ncommon_idx = np.intersect1d(true_nn_idx, approx_nn_idx)\n# Only in true\nonly_true = np.setdiff1d(true_nn_idx, approx_nn_idx)\n# Only in approx\nonly_approx = np.setdiff1d(approx_nn_idx, true_nn_idx)\n\nfig, axes = plt.subplots(1, 2, figsize=(11, 5))\n\n# Left: Exact search\nax = axes[0]\nax.scatter(points[:, 0], points[:, 1], s=50, c='lightgray', alpha=0.7)\nax.scatter(points[true_nn_idx, 0], points[true_nn_idx, 1], s=100, c='C2', \n           edgecolors='black', linewidths=1.5, label=f'{k} plus proches (vrais)')\nax.scatter(query[0], query[1], s=200, c='red', marker='*', zorder=10, label='Requête')\n\n# Draw circle for k-th distance\nkth_dist = distances[true_nn_idx[-1]]\ncircle = plt.Circle(query, kth_dist, fill=False, color='C2', linestyle='--', linewidth=1.5)\nax.add_patch(circle)\n\nax.set_xlim(-3, 3)\nax.set_ylim(-3, 3)\nax.set_aspect('equal')\nax.set_xlabel('$x_1$')\nax.set_ylabel('$x_2$')\nax.set_title('Recherche exacte')\nax.legend(loc='upper left', fontsize=9)\n\n# Right: Approximate search\nax = axes[1]\nax.scatter(points[:, 0], points[:, 1], s=50, c='lightgray', alpha=0.7)\n\n# Common points (found by both)\nax.scatter(points[common_idx, 0], points[common_idx, 1], s=100, c='C2', \n           edgecolors='black', linewidths=1.5, label='Trouvés (corrects)')\n\n# Missed by approximate\nax.scatter(points[only_true, 0], points[only_true, 1], s=100, c='C3', \n           edgecolors='black', linewidths=1.5, marker='s', label='Manqués')\n\n# False positives from approximate\nax.scatter(points[only_approx, 0], points[only_approx, 1], s=100, c='C1', \n           edgecolors='black', linewidths=1.5, marker='^', label='Faux positifs')\n\nax.scatter(query[0], query[1], s=200, c='red', marker='*', zorder=10, label='Requête')\n\nax.set_xlim(-3, 3)\nax.set_ylim(-3, 3)\nax.set_aspect('equal')\nax.set_xlabel('$x_1$')\nax.set_ylabel('$x_2$')\nax.set_title(f'Recherche approximative (rappel = {len(common_idx)}/{k})')\nax.legend(loc='upper left', fontsize=9)\n\nplt.tight_layout()","visibility":"hide","key":"Y9Wv4YpNXL"},{"type":"outputs","id":"tZnG_L53IfKvN5tI1R7_q","children":[{"type":"output","children":[],"jupyter_data":{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"<Figure size 1100x500 with 2 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"8c7bc88f9dfb41162cbccfa098eb8ad3","path":"/mlbook/build/8c7bc88f9dfb41162cbccfa098eb8ad3.png"}}},"key":"jtatTmYoIh"}],"visibility":"show","key":"JkLHk6WkS8"}],"data":{"tags":[]},"visibility":"show","key":"siOrdP7flq"},{"type":"block","children":[{"type":"heading","depth":3,"position":{"start":{"line":1149,"column":1},"end":{"line":1149,"column":1}},"children":[{"type":"text","value":"Compromis précision-vitesse","position":{"start":{"line":1149,"column":1},"end":{"line":1149,"column":1}},"key":"IjhdY79jG7"}],"identifier":"compromis-pr-cision-vitesse","label":"Compromis précision-vitesse","html_id":"compromis-pr-cision-vitesse","implicit":true,"key":"aPu3l4dFTD"},{"type":"paragraph","position":{"start":{"line":1151,"column":1},"end":{"line":1151,"column":1}},"children":[{"type":"text","value":"Le choix entre recherche exacte et approximative dépend de l’application. Pour un diagnostic médical, une erreur dans l’identification des cas similaires peut avoir des conséquences graves: la recherche exacte est préférable. Pour suggérer des vidéos similaires sur une plateforme de streaming, quelques voisins manqués importent peu si les suggestions restent pertinentes.","position":{"start":{"line":1151,"column":1},"end":{"line":1151,"column":1}},"key":"gPHxCkU9Xm"}],"key":"hoc15IvrA3"},{"type":"table","position":{"start":{"line":1153,"column":1},"end":{"line":1158,"column":1}},"children":[{"type":"tableRow","position":{"start":{"line":1153,"column":1},"end":{"line":1153,"column":1}},"children":[{"type":"tableCell","header":true,"position":{"start":{"line":1153,"column":1},"end":{"line":1153,"column":1}},"children":[{"type":"text","value":"Méthode","position":{"start":{"line":1153,"column":1},"end":{"line":1153,"column":1}},"key":"KrpF1fX059"}],"key":"FdKLQyNvly"},{"type":"tableCell","header":true,"position":{"start":{"line":1153,"column":1},"end":{"line":1153,"column":1}},"children":[{"type":"text","value":"Complexité requête","position":{"start":{"line":1153,"column":1},"end":{"line":1153,"column":1}},"key":"IxyqhN4AS7"}],"key":"rJTXWPQyVW"},{"type":"tableCell","header":true,"position":{"start":{"line":1153,"column":1},"end":{"line":1153,"column":1}},"children":[{"type":"text","value":"Exacte","position":{"start":{"line":1153,"column":1},"end":{"line":1153,"column":1}},"key":"FgHuaPBa32"}],"key":"uLYHKLK4cZ"},{"type":"tableCell","header":true,"position":{"start":{"line":1153,"column":1},"end":{"line":1153,"column":1}},"children":[{"type":"text","value":"Dimension","position":{"start":{"line":1153,"column":1},"end":{"line":1153,"column":1}},"key":"oJC82lZwyX"}],"key":"dhmtLjNEFg"}],"key":"A0OtQdo4jW"},{"type":"tableRow","position":{"start":{"line":1155,"column":1},"end":{"line":1155,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":1155,"column":1},"end":{"line":1155,"column":1}},"children":[{"type":"text","value":"Force brute","position":{"start":{"line":1155,"column":1},"end":{"line":1155,"column":1}},"key":"FwOWXogPUN"}],"key":"BYwZpcns2U"},{"type":"tableCell","position":{"start":{"line":1155,"column":1},"end":{"line":1155,"column":1}},"children":[{"type":"inlineMath","value":"O(Nd)","position":{"start":{"line":1155,"column":1},"end":{"line":1155,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mo stretchy=\"false\">(</mo><mi>N</mi><mi>d</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">O(Nd)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"mord mathnormal\">d</span><span class=\"mclose\">)</span></span></span></span>","key":"fui9mBX4Ox"}],"key":"bIydUGsGIg"},{"type":"tableCell","position":{"start":{"line":1155,"column":1},"end":{"line":1155,"column":1}},"children":[{"type":"text","value":"Oui","position":{"start":{"line":1155,"column":1},"end":{"line":1155,"column":1}},"key":"B8pG2GVEZJ"}],"key":"mNgkWlpWlV"},{"type":"tableCell","position":{"start":{"line":1155,"column":1},"end":{"line":1155,"column":1}},"children":[{"type":"text","value":"Toute","position":{"start":{"line":1155,"column":1},"end":{"line":1155,"column":1}},"key":"qIQOxWvQXy"}],"key":"ML347pUx5u"}],"key":"dLgHBczQ9h"},{"type":"tableRow","position":{"start":{"line":1156,"column":1},"end":{"line":1156,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":1156,"column":1},"end":{"line":1156,"column":1}},"children":[{"type":"text","value":"Arbre k-d","position":{"start":{"line":1156,"column":1},"end":{"line":1156,"column":1}},"key":"M5KdBIpxeJ"}],"key":"LbubXQVQfM"},{"type":"tableCell","position":{"start":{"line":1156,"column":1},"end":{"line":1156,"column":1}},"children":[{"type":"inlineMath","value":"O(\\log N)","position":{"start":{"line":1156,"column":1},"end":{"line":1156,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mo stretchy=\"false\">(</mo><mi>log</mi><mo>⁡</mo><mi>N</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">O(\\log N)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mop\">lo<span style=\"margin-right:0.01389em;\">g</span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"mclose\">)</span></span></span></span>","key":"QaNmwgXmri"},{"type":"text","value":" à ","position":{"start":{"line":1156,"column":1},"end":{"line":1156,"column":1}},"key":"djw0WqVMDl"},{"type":"inlineMath","value":"O(N)","position":{"start":{"line":1156,"column":1},"end":{"line":1156,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mo stretchy=\"false\">(</mo><mi>N</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">O(N)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"mclose\">)</span></span></span></span>","key":"QEA2J02pX0"}],"key":"SoykcVyeoc"},{"type":"tableCell","position":{"start":{"line":1156,"column":1},"end":{"line":1156,"column":1}},"children":[{"type":"text","value":"Oui","position":{"start":{"line":1156,"column":1},"end":{"line":1156,"column":1}},"key":"bRrAqENhij"}],"key":"AvKkLsZ2Ac"},{"type":"tableCell","position":{"start":{"line":1156,"column":1},"end":{"line":1156,"column":1}},"children":[{"type":"inlineMath","value":"d \\lesssim 20","position":{"start":{"line":1156,"column":1},"end":{"line":1156,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>d</mi><mo>≲</mo><mn>20</mn></mrow><annotation encoding=\"application/x-tex\">d \\lesssim 20</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.9592em;vertical-align:-0.2296em;\"></span><span class=\"mord mathnormal\">d</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel amsrm\">≲</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">20</span></span></span></span>","key":"fkjG7VSmfs"}],"key":"YZuF2A6sU5"}],"key":"TIgoizyGzJ"},{"type":"tableRow","position":{"start":{"line":1157,"column":1},"end":{"line":1157,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":1157,"column":1},"end":{"line":1157,"column":1}},"children":[{"type":"text","value":"LSH","position":{"start":{"line":1157,"column":1},"end":{"line":1157,"column":1}},"key":"tNig21cxlO"}],"key":"FCyvdyJc6Q"},{"type":"tableCell","position":{"start":{"line":1157,"column":1},"end":{"line":1157,"column":1}},"children":[{"type":"inlineMath","value":"O(1)","position":{"start":{"line":1157,"column":1},"end":{"line":1157,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mo stretchy=\"false\">(</mo><mn>1</mn><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">O(1)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord\">1</span><span class=\"mclose\">)</span></span></span></span>","key":"WNMiSOBBEY"},{"type":"text","value":" à ","position":{"start":{"line":1157,"column":1},"end":{"line":1157,"column":1}},"key":"eBX0nd6UVP"},{"type":"inlineMath","value":"O(N^{\\rho})","position":{"start":{"line":1157,"column":1},"end":{"line":1157,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mo stretchy=\"false\">(</mo><msup><mi>N</mi><mi>ρ</mi></msup><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">O(N^{\\rho})</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6644em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">ρ</span></span></span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span>","key":"SPTZQgJKai"}],"key":"PRel6stIF6"},{"type":"tableCell","position":{"start":{"line":1157,"column":1},"end":{"line":1157,"column":1}},"children":[{"type":"text","value":"Non","position":{"start":{"line":1157,"column":1},"end":{"line":1157,"column":1}},"key":"IUSpsT25hJ"}],"key":"yJes2Pn60X"},{"type":"tableCell","position":{"start":{"line":1157,"column":1},"end":{"line":1157,"column":1}},"children":[{"type":"text","value":"Haute","position":{"start":{"line":1157,"column":1},"end":{"line":1157,"column":1}},"key":"kNUGx7sWzB"}],"key":"QJNbH14nCH"}],"key":"XTUjlj35tz"},{"type":"tableRow","position":{"start":{"line":1158,"column":1},"end":{"line":1158,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":1158,"column":1},"end":{"line":1158,"column":1}},"children":[{"type":"text","value":"Graphes de proximité","position":{"start":{"line":1158,"column":1},"end":{"line":1158,"column":1}},"key":"cDYOtkO4J0"}],"key":"QCjIOqjzsG"},{"type":"tableCell","position":{"start":{"line":1158,"column":1},"end":{"line":1158,"column":1}},"children":[{"type":"inlineMath","value":"O(\\log N)","position":{"start":{"line":1158,"column":1},"end":{"line":1158,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mo stretchy=\"false\">(</mo><mi>log</mi><mo>⁡</mo><mi>N</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">O(\\log N)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mop\">lo<span style=\"margin-right:0.01389em;\">g</span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"mclose\">)</span></span></span></span>","key":"NGEoeCi8PW"}],"key":"ZfaO4rc3mv"},{"type":"tableCell","position":{"start":{"line":1158,"column":1},"end":{"line":1158,"column":1}},"children":[{"type":"text","value":"Non","position":{"start":{"line":1158,"column":1},"end":{"line":1158,"column":1}},"key":"VW8HuPaVQw"}],"key":"y9IsFbkv6e"},{"type":"tableCell","position":{"start":{"line":1158,"column":1},"end":{"line":1158,"column":1}},"children":[{"type":"text","value":"Haute","position":{"start":{"line":1158,"column":1},"end":{"line":1158,"column":1}},"key":"HWJ8q86AbJ"}],"key":"M2wURJjXZW"}],"key":"Hh1ZEMngkh"}],"key":"vamGj7NurH"}],"key":"WEoKrIGxN4"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"import numpy as np\nimport matplotlib.pyplot as plt\n\n# Simulated query times for different methods\nN = np.logspace(2, 7, 50)  # 100 to 10 million points\n\n# Brute force: O(N)\nbrute_force = N * 1e-7\n\n# k-d tree: O(log N) in low dim, degrades to O(N) in high dim\n# We show the ideal low-dim case\nkd_tree = np.log2(N) * 1e-5\n\n# ANN (e.g., HNSW): nearly constant with slight log factor\nann = np.log2(N) * 5e-6 + 1e-4\n\nfig, ax = plt.subplots(figsize=(8, 5))\n\nax.loglog(N, brute_force, 'C0-', linewidth=2, label='Force brute $O(N)$')\nax.loglog(N, kd_tree, 'C1-', linewidth=2, label=r'Arbre k-d $O(\\log N)$')\nax.loglog(N, ann, 'C2-', linewidth=2, label=r'ANN $O(\\log N)$')\n\n# Add shaded regions for practical regimes\nax.axvspan(100, 1e4, alpha=0.1, color='C0')\nax.axvspan(1e4, 1e6, alpha=0.1, color='C1')\nax.axvspan(1e6, 1e7, alpha=0.1, color='C2')\n\nax.set_xlabel('Taille de l\\'ensemble $N$')\nax.set_ylabel('Temps par requête (s)')\nax.legend(loc='upper left')\nax.set_xlim(100, 1e7)\nax.grid(True, alpha=0.3, which='both')\n\n# Annotations\nax.annotate('Petit\\nensemble', xy=(500, 1e-3), fontsize=9, ha='center', alpha=0.7)\nax.annotate('Moyen', xy=(1e5, 1e-3), fontsize=9, ha='center', alpha=0.7)\nax.annotate('Grande\\néchelle', xy=(3e6, 1e-3), fontsize=9, ha='center', alpha=0.7)\n\nplt.tight_layout()","visibility":"hide","key":"IQVsLylvqn"},{"type":"outputs","id":"6ZoDY8kW3yAOFEhBd4myC","children":[{"type":"output","children":[],"jupyter_data":{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"<Figure size 800x500 with 1 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"0d8d03288f9d174653fb158b5195834e","path":"/mlbook/build/0d8d03288f9d174653fb158b5195834e.png"}}},"key":"Bm4RwWE1g1"}],"visibility":"show","key":"KvZhpsr6x9"}],"data":{"tags":[]},"visibility":"show","key":"s5x0VxoYZM"},{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":1204,"column":1},"end":{"line":1204,"column":1}},"children":[{"type":"text","value":"La figure illustre comment le temps de requête évolue avec la taille de l’ensemble. La force brute devient rapidement prohibitive. Les méthodes approximatives maintiennent des temps de réponse acceptables même pour des millions de points.","position":{"start":{"line":1204,"column":1},"end":{"line":1204,"column":1}},"key":"LSR56WQYVK"}],"key":"SL8D6EHI26"},{"type":"heading","depth":2,"position":{"start":{"line":1206,"column":1},"end":{"line":1206,"column":1}},"children":[{"type":"text","value":"Méthodes paramétriques et non paramétriques","position":{"start":{"line":1206,"column":1},"end":{"line":1206,"column":1}},"key":"CTKK32QcJq"}],"identifier":"m-thodes-param-triques-et-non-param-triques","label":"Méthodes paramétriques et non paramétriques","html_id":"m-thodes-param-triques-et-non-param-triques","implicit":true,"key":"AzSwSfIXAy"},{"type":"paragraph","position":{"start":{"line":1208,"column":1},"end":{"line":1208,"column":1}},"children":[{"type":"text","value":"Les k-ppv sont une méthode ","position":{"start":{"line":1208,"column":1},"end":{"line":1208,"column":1}},"key":"FnUaI0rp1K"},{"type":"strong","position":{"start":{"line":1208,"column":1},"end":{"line":1208,"column":1}},"children":[{"type":"text","value":"non paramétrique","position":{"start":{"line":1208,"column":1},"end":{"line":1208,"column":1}},"key":"jJ7a6R42dB"}],"key":"rtSPPezrb7"},{"type":"text","value":": les données sont le modèle. Il n’y a pas de paramètres appris; les prédictions consultent directement l’ensemble d’entraînement. La complexité du modèle croît avec ","position":{"start":{"line":1208,"column":1},"end":{"line":1208,"column":1}},"key":"Meab3V9Ajt"},{"type":"inlineMath","value":"N","position":{"start":{"line":1208,"column":1},"end":{"line":1208,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>N</mi></mrow><annotation encoding=\"application/x-tex\">N</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span></span></span></span>","key":"QgXVND3nh4"},{"type":"text","value":".","position":{"start":{"line":1208,"column":1},"end":{"line":1208,"column":1}},"key":"SYjBWWJe8C"}],"key":"kZVZgIYBBF"},{"type":"table","position":{"start":{"line":1210,"column":1},"end":{"line":1214,"column":1}},"children":[{"type":"tableRow","position":{"start":{"line":1210,"column":1},"end":{"line":1210,"column":1}},"children":[{"type":"tableCell","header":true,"position":{"start":{"line":1210,"column":1},"end":{"line":1210,"column":1}},"children":[],"key":"PvNUVQhdSB"},{"type":"tableCell","header":true,"position":{"start":{"line":1210,"column":1},"end":{"line":1210,"column":1}},"children":[{"type":"text","value":"Non paramétrique","position":{"start":{"line":1210,"column":1},"end":{"line":1210,"column":1}},"key":"ofJ05BrqKr"}],"key":"cPllvxI7NU"},{"type":"tableCell","header":true,"position":{"start":{"line":1210,"column":1},"end":{"line":1210,"column":1}},"children":[{"type":"text","value":"Paramétrique","position":{"start":{"line":1210,"column":1},"end":{"line":1210,"column":1}},"key":"pCRGT8TkUm"}],"key":"mrpleMRzBN"}],"key":"g0nPYaJHt8"},{"type":"tableRow","position":{"start":{"line":1212,"column":1},"end":{"line":1212,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":1212,"column":1},"end":{"line":1212,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1212,"column":1},"end":{"line":1212,"column":1}},"children":[{"type":"text","value":"Modèle","position":{"start":{"line":1212,"column":1},"end":{"line":1212,"column":1}},"key":"MQdf1vFn9K"}],"key":"QW28qP2PdE"}],"key":"qKmgkGsxW0"},{"type":"tableCell","position":{"start":{"line":1212,"column":1},"end":{"line":1212,"column":1}},"children":[{"type":"text","value":"Les données","position":{"start":{"line":1212,"column":1},"end":{"line":1212,"column":1}},"key":"RbhcsnZzVd"}],"key":"Zc1onkzNdK"},{"type":"tableCell","position":{"start":{"line":1212,"column":1},"end":{"line":1212,"column":1}},"children":[{"type":"text","value":"Un vecteur ","position":{"start":{"line":1212,"column":1},"end":{"line":1212,"column":1}},"key":"MO0ic6eAg5"},{"type":"inlineMath","value":"\\theta \\in \\mathbb{R}^p","position":{"start":{"line":1212,"column":1},"end":{"line":1212,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>θ</mi><mo>∈</mo><msup><mi mathvariant=\"double-struck\">R</mi><mi>p</mi></msup></mrow><annotation encoding=\"application/x-tex\">\\theta \\in \\mathbb{R}^p</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7335em;vertical-align:-0.0391em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">θ</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">∈</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6889em;\"></span><span class=\"mord\"><span class=\"mord mathbb\">R</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6644em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">p</span></span></span></span></span></span></span></span></span></span></span>","key":"khxvVGz66c"}],"key":"Q3oBBJZuYD"}],"key":"ttX0zU7ybk"},{"type":"tableRow","position":{"start":{"line":1213,"column":1},"end":{"line":1213,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":1213,"column":1},"end":{"line":1213,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1213,"column":1},"end":{"line":1213,"column":1}},"children":[{"type":"text","value":"Complexité","position":{"start":{"line":1213,"column":1},"end":{"line":1213,"column":1}},"key":"YlmSEYhlLD"}],"key":"AHFdODI1rZ"}],"key":"X6UzDB6e6d"},{"type":"tableCell","position":{"start":{"line":1213,"column":1},"end":{"line":1213,"column":1}},"children":[{"type":"text","value":"Croît avec ","position":{"start":{"line":1213,"column":1},"end":{"line":1213,"column":1}},"key":"tRHpoBYlMK"},{"type":"inlineMath","value":"N","position":{"start":{"line":1213,"column":1},"end":{"line":1213,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>N</mi></mrow><annotation encoding=\"application/x-tex\">N</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span></span></span></span>","key":"EWV3L5ZowO"}],"key":"LU3otxdqNj"},{"type":"tableCell","position":{"start":{"line":1213,"column":1},"end":{"line":1213,"column":1}},"children":[{"type":"text","value":"Fixe","position":{"start":{"line":1213,"column":1},"end":{"line":1213,"column":1}},"key":"o1OypSB1ni"}],"key":"rRCGD9NxOr"}],"key":"Ln0UeHSym4"},{"type":"tableRow","position":{"start":{"line":1214,"column":1},"end":{"line":1214,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":1214,"column":1},"end":{"line":1214,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1214,"column":1},"end":{"line":1214,"column":1}},"children":[{"type":"text","value":"Inférence","position":{"start":{"line":1214,"column":1},"end":{"line":1214,"column":1}},"key":"JfSnVv8Xqx"}],"key":"z1qtozhFZS"}],"key":"gwQoX6vvAu"},{"type":"tableCell","position":{"start":{"line":1214,"column":1},"end":{"line":1214,"column":1}},"children":[{"type":"text","value":"Requiert les données","position":{"start":{"line":1214,"column":1},"end":{"line":1214,"column":1}},"key":"DBBxhTbdRY"}],"key":"CaqMuOTm2q"},{"type":"tableCell","position":{"start":{"line":1214,"column":1},"end":{"line":1214,"column":1}},"children":[{"type":"text","value":"Requiert seulement ","position":{"start":{"line":1214,"column":1},"end":{"line":1214,"column":1}},"key":"sc8n33obrC"},{"type":"inlineMath","value":"\\theta","position":{"start":{"line":1214,"column":1},"end":{"line":1214,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>θ</mi></mrow><annotation encoding=\"application/x-tex\">\\theta</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">θ</span></span></span></span>","key":"dd0wp1G6gl"}],"key":"G60TSV6Y4Q"}],"key":"osVL0AJBS5"}],"key":"vMLyXuko0N"},{"type":"paragraph","position":{"start":{"line":1216,"column":1},"end":{"line":1216,"column":1}},"children":[{"type":"text","value":"Les méthodes ","position":{"start":{"line":1216,"column":1},"end":{"line":1216,"column":1}},"key":"C57OJYDOux"},{"type":"strong","position":{"start":{"line":1216,"column":1},"end":{"line":1216,"column":1}},"children":[{"type":"text","value":"paramétriques","position":{"start":{"line":1216,"column":1},"end":{"line":1216,"column":1}},"key":"qNZaKqhF08"}],"key":"qSCEEA0LWC"},{"type":"text","value":" distillent l’information dans un vecteur de paramètres de taille fixe. Un réseau de neurones entraîné sur des milliards d’exemples n’a besoin que de ses poids pour faire des prédictions, pas des données d’entraînement.","position":{"start":{"line":1216,"column":1},"end":{"line":1216,"column":1}},"key":"LQhkzpcLEs"}],"key":"xkrmC9URz9"},{"type":"heading","depth":2,"position":{"start":{"line":1218,"column":1},"end":{"line":1218,"column":1}},"children":[{"type":"text","value":"Résumé","position":{"start":{"line":1218,"column":1},"end":{"line":1218,"column":1}},"key":"DHIbThjIut"}],"identifier":"r-sum","label":"Résumé","html_id":"r-sum","implicit":true,"key":"pxizPixP15"},{"type":"paragraph","position":{"start":{"line":1220,"column":1},"end":{"line":1220,"column":1}},"children":[{"type":"text","value":"Les k plus proches voisins classifient un point par vote majoritaire parmi ses ","position":{"start":{"line":1220,"column":1},"end":{"line":1220,"column":1}},"key":"GnO5q7lxvU"},{"type":"inlineMath","value":"k","position":{"start":{"line":1220,"column":1},"end":{"line":1220,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>k</mi></mrow><annotation encoding=\"application/x-tex\">k</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span></span></span></span>","key":"Fy0NfKQ102"},{"type":"text","value":" voisins les plus proches. Le paramètre ","position":{"start":{"line":1220,"column":1},"end":{"line":1220,"column":1}},"key":"cuWR6AX0Zc"},{"type":"inlineMath","value":"k","position":{"start":{"line":1220,"column":1},"end":{"line":1220,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>k</mi></mrow><annotation encoding=\"application/x-tex\">k</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span></span></span></span>","key":"CxElCOEFyc"},{"type":"text","value":" contrôle le compromis biais-variance. Le choix de la distance encode les hypothèses sur la similarité. Le fléau de la dimensionnalité limite l’efficacité en haute dimension.","position":{"start":{"line":1220,"column":1},"end":{"line":1220,"column":1}},"key":"CI3pVG2zVV"}],"key":"etg8rNokQl"},{"type":"paragraph","position":{"start":{"line":1222,"column":1},"end":{"line":1222,"column":1}},"children":[{"type":"text","value":"La méthode illustre la tension entre mémorisation et généralisation: avec ","position":{"start":{"line":1222,"column":1},"end":{"line":1222,"column":1}},"key":"jJoGLGdkaH"},{"type":"inlineMath","value":"k=1","position":{"start":{"line":1222,"column":1},"end":{"line":1222,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>k</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">k=1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span>","key":"UqkbQEDdsT"},{"type":"text","value":", l’erreur d’entraînement est nulle mais la généralisation est mauvaise. Elle illustre aussi la distinction entre approches non paramétriques (les données sont le modèle) et paramétriques (un vecteur de paramètres résume les données).","position":{"start":{"line":1222,"column":1},"end":{"line":1222,"column":1}},"key":"Lg2cTtCpyT"}],"key":"QKvfYoDQmq"},{"type":"paragraph","position":{"start":{"line":1224,"column":1},"end":{"line":1224,"column":1}},"children":[{"type":"text","value":"Le chapitre suivant développe l’approche paramétrique: l’apprentissage comme problème d’optimisation, où nous cherchons les paramètres qui minimisent une fonction de perte.","position":{"start":{"line":1224,"column":1},"end":{"line":1224,"column":1}},"key":"be7kVnov3K"}],"key":"OrxlHqhenc"},{"type":"heading","depth":2,"position":{"start":{"line":1226,"column":1},"end":{"line":1226,"column":1}},"children":[{"type":"text","value":"Exercices","position":{"start":{"line":1226,"column":1},"end":{"line":1226,"column":1}},"key":"QIN2Ba9IgT"}],"identifier":"exercices","label":"Exercices","html_id":"exercices","implicit":true,"key":"BnPLk9uLyT"},{"type":"admonition","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Exercice 1: Classification manuelle","position":{"start":{"line":1228,"column":1},"end":{"line":1228,"column":1}},"key":"s0pprQp470"}],"key":"xShiI18iGh"},{"type":"paragraph","position":{"start":{"line":1231,"column":1},"end":{"line":1231,"column":1}},"children":[{"type":"text","value":"Considérez les points d’entraînement suivants en 2D:","position":{"start":{"line":1231,"column":1},"end":{"line":1231,"column":1}},"key":"qvAdy46XBs"}],"key":"q0n6ZrooR8"},{"type":"table","position":{"start":{"line":1233,"column":1},"end":{"line":1239,"column":1}},"children":[{"type":"tableRow","position":{"start":{"line":1233,"column":1},"end":{"line":1233,"column":1}},"children":[{"type":"tableCell","header":true,"position":{"start":{"line":1233,"column":1},"end":{"line":1233,"column":1}},"children":[{"type":"text","value":"Point","position":{"start":{"line":1233,"column":1},"end":{"line":1233,"column":1}},"key":"oIcyhpJ1b6"}],"key":"LnOKU95SGm"},{"type":"tableCell","header":true,"position":{"start":{"line":1233,"column":1},"end":{"line":1233,"column":1}},"children":[{"type":"inlineMath","value":"x_1","position":{"start":{"line":1233,"column":1},"end":{"line":1233,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>x</mi><mn>1</mn></msub></mrow><annotation encoding=\"application/x-tex\">x_1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"YzKRQCdhqx"}],"key":"EqAD3KIlZ2"},{"type":"tableCell","header":true,"position":{"start":{"line":1233,"column":1},"end":{"line":1233,"column":1}},"children":[{"type":"inlineMath","value":"x_2","position":{"start":{"line":1233,"column":1},"end":{"line":1233,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>x</mi><mn>2</mn></msub></mrow><annotation encoding=\"application/x-tex\">x_2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"Wk0sdF9Aew"}],"key":"WVOjzTSnRO"},{"type":"tableCell","header":true,"position":{"start":{"line":1233,"column":1},"end":{"line":1233,"column":1}},"children":[{"type":"text","value":"Classe","position":{"start":{"line":1233,"column":1},"end":{"line":1233,"column":1}},"key":"xmCyeIilWp"}],"key":"Y1cFRv7Pxu"}],"key":"ajpWb8ORDh"},{"type":"tableRow","position":{"start":{"line":1235,"column":1},"end":{"line":1235,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":1235,"column":1},"end":{"line":1235,"column":1}},"children":[{"type":"text","value":"A","position":{"start":{"line":1235,"column":1},"end":{"line":1235,"column":1}},"key":"beDbVAOM3S"}],"key":"tlp19dymg1"},{"type":"tableCell","position":{"start":{"line":1235,"column":1},"end":{"line":1235,"column":1}},"children":[{"type":"text","value":"0","position":{"start":{"line":1235,"column":1},"end":{"line":1235,"column":1}},"key":"pfeSsGrQbS"}],"key":"kLGKlOzeP6"},{"type":"tableCell","position":{"start":{"line":1235,"column":1},"end":{"line":1235,"column":1}},"children":[{"type":"text","value":"0","position":{"start":{"line":1235,"column":1},"end":{"line":1235,"column":1}},"key":"h9k1lPeC59"}],"key":"JKBdhu2Bms"},{"type":"tableCell","position":{"start":{"line":1235,"column":1},"end":{"line":1235,"column":1}},"children":[{"type":"text","value":"0","position":{"start":{"line":1235,"column":1},"end":{"line":1235,"column":1}},"key":"hoNMwXUs4C"}],"key":"bLn6lTZiQE"}],"key":"fPk4dGf6b0"},{"type":"tableRow","position":{"start":{"line":1236,"column":1},"end":{"line":1236,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":1236,"column":1},"end":{"line":1236,"column":1}},"children":[{"type":"text","value":"B","position":{"start":{"line":1236,"column":1},"end":{"line":1236,"column":1}},"key":"WVmuWXWM68"}],"key":"GFbpUD5P5w"},{"type":"tableCell","position":{"start":{"line":1236,"column":1},"end":{"line":1236,"column":1}},"children":[{"type":"text","value":"1","position":{"start":{"line":1236,"column":1},"end":{"line":1236,"column":1}},"key":"wipLVa4R2V"}],"key":"VLxu7ZNfaA"},{"type":"tableCell","position":{"start":{"line":1236,"column":1},"end":{"line":1236,"column":1}},"children":[{"type":"text","value":"0","position":{"start":{"line":1236,"column":1},"end":{"line":1236,"column":1}},"key":"DSCy2Gxeyn"}],"key":"oUzfDw9PG1"},{"type":"tableCell","position":{"start":{"line":1236,"column":1},"end":{"line":1236,"column":1}},"children":[{"type":"text","value":"0","position":{"start":{"line":1236,"column":1},"end":{"line":1236,"column":1}},"key":"I84u7oTOzd"}],"key":"laCUWVLzm8"}],"key":"cbHznSHke1"},{"type":"tableRow","position":{"start":{"line":1237,"column":1},"end":{"line":1237,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":1237,"column":1},"end":{"line":1237,"column":1}},"children":[{"type":"text","value":"C","position":{"start":{"line":1237,"column":1},"end":{"line":1237,"column":1}},"key":"Didx4XNBCw"}],"key":"boPTMEUI7N"},{"type":"tableCell","position":{"start":{"line":1237,"column":1},"end":{"line":1237,"column":1}},"children":[{"type":"text","value":"0","position":{"start":{"line":1237,"column":1},"end":{"line":1237,"column":1}},"key":"V9nB73xQHe"}],"key":"UbkAYIzJYV"},{"type":"tableCell","position":{"start":{"line":1237,"column":1},"end":{"line":1237,"column":1}},"children":[{"type":"text","value":"1","position":{"start":{"line":1237,"column":1},"end":{"line":1237,"column":1}},"key":"u0BTLwkC8B"}],"key":"BvNCCv0LFZ"},{"type":"tableCell","position":{"start":{"line":1237,"column":1},"end":{"line":1237,"column":1}},"children":[{"type":"text","value":"1","position":{"start":{"line":1237,"column":1},"end":{"line":1237,"column":1}},"key":"k1EI8zAqJM"}],"key":"tXDuS35Tpt"}],"key":"Ye51sYvnKM"},{"type":"tableRow","position":{"start":{"line":1238,"column":1},"end":{"line":1238,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":1238,"column":1},"end":{"line":1238,"column":1}},"children":[{"type":"text","value":"D","position":{"start":{"line":1238,"column":1},"end":{"line":1238,"column":1}},"key":"UoB5y9uoQB"}],"key":"sS6jUqYjxV"},{"type":"tableCell","position":{"start":{"line":1238,"column":1},"end":{"line":1238,"column":1}},"children":[{"type":"text","value":"2","position":{"start":{"line":1238,"column":1},"end":{"line":1238,"column":1}},"key":"LU9a4YRZ10"}],"key":"QxkoXTN8Rv"},{"type":"tableCell","position":{"start":{"line":1238,"column":1},"end":{"line":1238,"column":1}},"children":[{"type":"text","value":"2","position":{"start":{"line":1238,"column":1},"end":{"line":1238,"column":1}},"key":"Ydypi312sI"}],"key":"HaFY4xpQin"},{"type":"tableCell","position":{"start":{"line":1238,"column":1},"end":{"line":1238,"column":1}},"children":[{"type":"text","value":"1","position":{"start":{"line":1238,"column":1},"end":{"line":1238,"column":1}},"key":"ysd8r0Lcnr"}],"key":"pGXfVRjUlp"}],"key":"edkQfJxPVr"},{"type":"tableRow","position":{"start":{"line":1239,"column":1},"end":{"line":1239,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":1239,"column":1},"end":{"line":1239,"column":1}},"children":[{"type":"text","value":"E","position":{"start":{"line":1239,"column":1},"end":{"line":1239,"column":1}},"key":"FIcFiW1LfG"}],"key":"lR0TEJ8hCH"},{"type":"tableCell","position":{"start":{"line":1239,"column":1},"end":{"line":1239,"column":1}},"children":[{"type":"text","value":"3","position":{"start":{"line":1239,"column":1},"end":{"line":1239,"column":1}},"key":"eA1wsI6Tsz"}],"key":"Xg7fKyce3d"},{"type":"tableCell","position":{"start":{"line":1239,"column":1},"end":{"line":1239,"column":1}},"children":[{"type":"text","value":"1","position":{"start":{"line":1239,"column":1},"end":{"line":1239,"column":1}},"key":"zxpWfHYyHs"}],"key":"Q5PUiCuYG1"},{"type":"tableCell","position":{"start":{"line":1239,"column":1},"end":{"line":1239,"column":1}},"children":[{"type":"text","value":"1","position":{"start":{"line":1239,"column":1},"end":{"line":1239,"column":1}},"key":"mJPlnzoRGV"}],"key":"r5mY0TBqiu"}],"key":"HqLgLjKzuy"}],"key":"dl4C2fEFS9"},{"type":"list","ordered":true,"start":1,"spread":false,"position":{"start":{"line":1241,"column":1},"end":{"line":1245,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":1241,"column":1},"end":{"line":1242,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":1241,"column":1},"end":{"line":1241,"column":1}},"children":[{"type":"text","value":"Pour le point requête ","position":{"start":{"line":1241,"column":1},"end":{"line":1241,"column":1}},"key":"u2QDnDUxA8"},{"type":"inlineMath","value":"x = (1, 1)","position":{"start":{"line":1241,"column":1},"end":{"line":1241,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi><mo>=</mo><mo stretchy=\"false\">(</mo><mn>1</mn><mo separator=\"true\">,</mo><mn>1</mn><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">x = (1, 1)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord\">1</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">1</span><span class=\"mclose\">)</span></span></span></span>","key":"PvkWjS3KHP"},{"type":"text","value":", identifiez les 3 plus proches voisins avec la distance euclidienne. Quelle est la prédiction du 3-ppv?","position":{"start":{"line":1241,"column":1},"end":{"line":1241,"column":1}},"key":"VdlOG4COyj"}],"key":"CBgFbRBIMv"}],"key":"alSO5AMlh1"},{"type":"listItem","spread":true,"position":{"start":{"line":1243,"column":1},"end":{"line":1244,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":1243,"column":1},"end":{"line":1243,"column":1}},"children":[{"type":"text","value":"Répétez avec ","position":{"start":{"line":1243,"column":1},"end":{"line":1243,"column":1}},"key":"RSSbwv2Vhg"},{"type":"inlineMath","value":"k = 1","position":{"start":{"line":1243,"column":1},"end":{"line":1243,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>k</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">k = 1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span>","key":"gxowyARXoU"},{"type":"text","value":" et ","position":{"start":{"line":1243,"column":1},"end":{"line":1243,"column":1}},"key":"K1tXRvPYqP"},{"type":"inlineMath","value":"k = 5","position":{"start":{"line":1243,"column":1},"end":{"line":1243,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>k</mi><mo>=</mo><mn>5</mn></mrow><annotation encoding=\"application/x-tex\">k = 5</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">5</span></span></span></span>","key":"gAKQ5UYw0x"},{"type":"text","value":". Les prédictions changent-elles?","position":{"start":{"line":1243,"column":1},"end":{"line":1243,"column":1}},"key":"bcgiied5gY"}],"key":"ugHTWyNhkb"}],"key":"sCKWv21o4L"},{"type":"listItem","spread":true,"position":{"start":{"line":1245,"column":1},"end":{"line":1245,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":1245,"column":1},"end":{"line":1245,"column":1}},"children":[{"type":"text","value":"Calculez les distances avec la norme ","position":{"start":{"line":1245,"column":1},"end":{"line":1245,"column":1}},"key":"BZvmWnQGJA"},{"type":"inlineMath","value":"\\ell_1","position":{"start":{"line":1245,"column":1},"end":{"line":1245,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi mathvariant=\"normal\">ℓ</mi><mn>1</mn></msub></mrow><annotation encoding=\"application/x-tex\">\\ell_1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8444em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord\">ℓ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"lTMuE2SRb5"},{"type":"text","value":" (Manhattan). Les 3 plus proches voisins sont-ils les mêmes?","position":{"start":{"line":1245,"column":1},"end":{"line":1245,"column":1}},"key":"ixWSoEmggY"}],"key":"YGzwVtn1Ty"}],"key":"DMp6nLwFX8"}],"key":"giSlDvuk38"}],"class":"hint dropdown","key":"MuLXxGgQwb"},{"type":"admonition","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Exercice 2: Effet de la normalisation","position":{"start":{"line":1248,"column":1},"end":{"line":1248,"column":1}},"key":"LAo9ULu6WN"}],"key":"RepAaQPBjo"},{"type":"paragraph","position":{"start":{"line":1251,"column":1},"end":{"line":1251,"column":1}},"children":[{"type":"text","value":"Un dataset contient deux variables: l’âge (entre 20 et 70 ans) et le revenu annuel (entre 20 000 et 200 000 euros).","position":{"start":{"line":1251,"column":1},"end":{"line":1251,"column":1}},"key":"NQGyhiNJSa"}],"key":"CwTab5pSW8"},{"type":"list","ordered":true,"start":1,"spread":false,"position":{"start":{"line":1253,"column":1},"end":{"line":1259,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":1253,"column":1},"end":{"line":1254,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":1253,"column":1},"end":{"line":1253,"column":1}},"children":[{"type":"text","value":"Calculez la distance euclidienne entre les points ","position":{"start":{"line":1253,"column":1},"end":{"line":1253,"column":1}},"key":"ZwFNehf6Cz"},{"type":"inlineMath","value":"x_1 = (30, 50000)","position":{"start":{"line":1253,"column":1},"end":{"line":1253,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>x</mi><mn>1</mn></msub><mo>=</mo><mo stretchy=\"false\">(</mo><mn>30</mn><mo separator=\"true\">,</mo><mn>50000</mn><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">x_1 = (30, 50000)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord\">30</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">50000</span><span class=\"mclose\">)</span></span></span></span>","key":"QhGlxovQIs"},{"type":"text","value":" et ","position":{"start":{"line":1253,"column":1},"end":{"line":1253,"column":1}},"key":"mChH38SgTI"},{"type":"inlineMath","value":"x_2 = (35, 51000)","position":{"start":{"line":1253,"column":1},"end":{"line":1253,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>x</mi><mn>2</mn></msub><mo>=</mo><mo stretchy=\"false\">(</mo><mn>35</mn><mo separator=\"true\">,</mo><mn>51000</mn><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">x_2 = (35, 51000)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord\">35</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">51000</span><span class=\"mclose\">)</span></span></span></span>","key":"GSTF77vbYg"},{"type":"text","value":".","position":{"start":{"line":1253,"column":1},"end":{"line":1253,"column":1}},"key":"HDLJNSiBAs"}],"key":"u0S9LFk99w"}],"key":"l2xuqZiD90"},{"type":"listItem","spread":true,"position":{"start":{"line":1255,"column":1},"end":{"line":1256,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":1255,"column":1},"end":{"line":1255,"column":1}},"children":[{"type":"text","value":"Calculez la distance entre ","position":{"start":{"line":1255,"column":1},"end":{"line":1255,"column":1}},"key":"YrrCVtfUOE"},{"type":"inlineMath","value":"x_1 = (30, 50000)","position":{"start":{"line":1255,"column":1},"end":{"line":1255,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>x</mi><mn>1</mn></msub><mo>=</mo><mo stretchy=\"false\">(</mo><mn>30</mn><mo separator=\"true\">,</mo><mn>50000</mn><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">x_1 = (30, 50000)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord\">30</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">50000</span><span class=\"mclose\">)</span></span></span></span>","key":"m3L8ulI2SR"},{"type":"text","value":" et ","position":{"start":{"line":1255,"column":1},"end":{"line":1255,"column":1}},"key":"B1GjyspL3S"},{"type":"inlineMath","value":"x_3 = (31, 150000)","position":{"start":{"line":1255,"column":1},"end":{"line":1255,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>x</mi><mn>3</mn></msub><mo>=</mo><mo stretchy=\"false\">(</mo><mn>31</mn><mo separator=\"true\">,</mo><mn>150000</mn><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">x_3 = (31, 150000)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">3</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord\">31</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">150000</span><span class=\"mclose\">)</span></span></span></span>","key":"lYhEOLbO3g"},{"type":"text","value":".","position":{"start":{"line":1255,"column":1},"end":{"line":1255,"column":1}},"key":"cwt2bikWln"}],"key":"GIDYoeQfrw"}],"key":"YcZi2H4dZp"},{"type":"listItem","spread":true,"position":{"start":{"line":1257,"column":1},"end":{"line":1258,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":1257,"column":1},"end":{"line":1257,"column":1}},"children":[{"type":"text","value":"Laquelle des deux paires est “plus proche”? Ce résultat est-il intuitivement raisonnable?","position":{"start":{"line":1257,"column":1},"end":{"line":1257,"column":1}},"key":"rv0AdiZt1q"}],"key":"Pokv6Keapt"}],"key":"OFPAHEh0dK"},{"type":"listItem","spread":true,"position":{"start":{"line":1259,"column":1},"end":{"line":1259,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":1259,"column":1},"end":{"line":1259,"column":1}},"children":[{"type":"text","value":"Proposez une transformation des données qui rendrait les deux variables comparables. Recalculez les distances après transformation.","position":{"start":{"line":1259,"column":1},"end":{"line":1259,"column":1}},"key":"FZVpieOTCj"}],"key":"mApT3uHGiP"}],"key":"AcDGqE3hqC"}],"key":"DLyKEPYahu"}],"class":"hint dropdown","key":"xpi6L0IxdX"},{"type":"admonition","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Exercice 3: Compromis biais-variance","position":{"start":{"line":1262,"column":1},"end":{"line":1262,"column":1}},"key":"pvUxvicAlQ"}],"key":"LdfTc86TCU"},{"type":"paragraph","position":{"start":{"line":1265,"column":1},"end":{"line":1265,"column":1}},"children":[{"type":"text","value":"Soit un problème de régression 1D où la vraie fonction est ","position":{"start":{"line":1265,"column":1},"end":{"line":1265,"column":1}},"key":"VsTCDkw9m9"},{"type":"inlineMath","value":"f(x) = \\sin(2\\pi x)","position":{"start":{"line":1265,"column":1},"end":{"line":1265,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>f</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mi>sin</mi><mo>⁡</mo><mo stretchy=\"false\">(</mo><mn>2</mn><mi>π</mi><mi>x</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">f(x) = \\sin(2\\pi x)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mop\">sin</span><span class=\"mopen\">(</span><span class=\"mord\">2</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">π</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span></span></span></span>","key":"RzJ7JRV9HV"},{"type":"text","value":" et les observations sont bruitées: ","position":{"start":{"line":1265,"column":1},"end":{"line":1265,"column":1}},"key":"PAp0lCxGWP"},{"type":"inlineMath","value":"y = f(x) + \\varepsilon","position":{"start":{"line":1265,"column":1},"end":{"line":1265,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>y</mi><mo>=</mo><mi>f</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo><mo>+</mo><mi>ε</mi></mrow><annotation encoding=\"application/x-tex\">y = f(x) + \\varepsilon</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">ε</span></span></span></span>","key":"sq0AcnTevd"},{"type":"text","value":" avec ","position":{"start":{"line":1265,"column":1},"end":{"line":1265,"column":1}},"key":"NuOjzdsuzn"},{"type":"inlineMath","value":"\\varepsilon \\sim \\mathcal{N}(0, 0.1)","position":{"start":{"line":1265,"column":1},"end":{"line":1265,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>ε</mi><mo>∼</mo><mi mathvariant=\"script\">N</mi><mo stretchy=\"false\">(</mo><mn>0</mn><mo separator=\"true\">,</mo><mn>0.1</mn><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">\\varepsilon \\sim \\mathcal{N}(0, 0.1)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">ε</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">∼</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathcal\" style=\"margin-right:0.14736em;\">N</span><span class=\"mopen\">(</span><span class=\"mord\">0</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">0.1</span><span class=\"mclose\">)</span></span></span></span>","key":"e0HkrzXkQC"},{"type":"text","value":".","position":{"start":{"line":1265,"column":1},"end":{"line":1265,"column":1}},"key":"RJNA9y9UTf"}],"key":"VptynLOmfH"},{"type":"list","ordered":true,"start":1,"spread":false,"position":{"start":{"line":1267,"column":1},"end":{"line":1275,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":1267,"column":1},"end":{"line":1268,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":1267,"column":1},"end":{"line":1267,"column":1}},"children":[{"type":"text","value":"Générez 50 points d’entraînement uniformément répartis sur ","position":{"start":{"line":1267,"column":1},"end":{"line":1267,"column":1}},"key":"PHhpRdeKQT"},{"type":"inlineMath","value":"[0, 1]","position":{"start":{"line":1267,"column":1},"end":{"line":1267,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">[</mo><mn>0</mn><mo separator=\"true\">,</mo><mn>1</mn><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">[0, 1]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">[</span><span class=\"mord\">0</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">1</span><span class=\"mclose\">]</span></span></span></span>","key":"ot0F86Yaz7"},{"type":"text","value":".","position":{"start":{"line":1267,"column":1},"end":{"line":1267,"column":1}},"key":"Fo0yOTbTgR"}],"key":"oYccGZZzFv"}],"key":"gTpUYzyZ1N"},{"type":"listItem","spread":true,"position":{"start":{"line":1269,"column":1},"end":{"line":1270,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":1269,"column":1},"end":{"line":1269,"column":1}},"children":[{"type":"text","value":"Implémentez la régression k-ppv et tracez les prédictions pour ","position":{"start":{"line":1269,"column":1},"end":{"line":1269,"column":1}},"key":"QZI1Hb0adk"},{"type":"inlineMath","value":"k = 1, 5, 20, 50","position":{"start":{"line":1269,"column":1},"end":{"line":1269,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>k</mi><mo>=</mo><mn>1</mn><mo separator=\"true\">,</mo><mn>5</mn><mo separator=\"true\">,</mo><mn>20</mn><mo separator=\"true\">,</mo><mn>50</mn></mrow><annotation encoding=\"application/x-tex\">k = 1, 5, 20, 50</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8389em;vertical-align:-0.1944em;\"></span><span class=\"mord\">1</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">5</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">20</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">50</span></span></span></span>","key":"L6CJMxgxQZ"},{"type":"text","value":".","position":{"start":{"line":1269,"column":1},"end":{"line":1269,"column":1}},"key":"j0ynzUp9TD"}],"key":"j6g2qixoGM"}],"key":"eflPUBxzoQ"},{"type":"listItem","spread":true,"position":{"start":{"line":1271,"column":1},"end":{"line":1272,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":1271,"column":1},"end":{"line":1271,"column":1}},"children":[{"type":"text","value":"Calculez l’erreur quadratique moyenne (MSE) sur un ensemble de test de 200 points pour chaque valeur de ","position":{"start":{"line":1271,"column":1},"end":{"line":1271,"column":1}},"key":"pcZkHutsh2"},{"type":"inlineMath","value":"k","position":{"start":{"line":1271,"column":1},"end":{"line":1271,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>k</mi></mrow><annotation encoding=\"application/x-tex\">k</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span></span></span></span>","key":"L6iSqN9rB7"},{"type":"text","value":".","position":{"start":{"line":1271,"column":1},"end":{"line":1271,"column":1}},"key":"NqPVV8kCMm"}],"key":"jSKTosAtSt"}],"key":"aQC5EmMvUA"},{"type":"listItem","spread":true,"position":{"start":{"line":1273,"column":1},"end":{"line":1274,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":1273,"column":1},"end":{"line":1273,"column":1}},"children":[{"type":"text","value":"Tracez le MSE en fonction de ","position":{"start":{"line":1273,"column":1},"end":{"line":1273,"column":1}},"key":"vpkKBRpAzK"},{"type":"inlineMath","value":"k","position":{"start":{"line":1273,"column":1},"end":{"line":1273,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>k</mi></mrow><annotation encoding=\"application/x-tex\">k</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span></span></span></span>","key":"JeKngGIoaA"},{"type":"text","value":". Quelle valeur de ","position":{"start":{"line":1273,"column":1},"end":{"line":1273,"column":1}},"key":"QvCAR3XBk6"},{"type":"inlineMath","value":"k","position":{"start":{"line":1273,"column":1},"end":{"line":1273,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>k</mi></mrow><annotation encoding=\"application/x-tex\">k</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span></span></span></span>","key":"z3L2jplTlk"},{"type":"text","value":" minimise l’erreur de test?","position":{"start":{"line":1273,"column":1},"end":{"line":1273,"column":1}},"key":"TTB6LhJbLG"}],"key":"ZPXjwMCq7j"}],"key":"L9MuBjWbx4"},{"type":"listItem","spread":true,"position":{"start":{"line":1275,"column":1},"end":{"line":1275,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":1275,"column":1},"end":{"line":1275,"column":1}},"children":[{"type":"text","value":"Que se passe-t-il quand ","position":{"start":{"line":1275,"column":1},"end":{"line":1275,"column":1}},"key":"LAHwG8Rui3"},{"type":"inlineMath","value":"k = N","position":{"start":{"line":1275,"column":1},"end":{"line":1275,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>k</mi><mo>=</mo><mi>N</mi></mrow><annotation encoding=\"application/x-tex\">k = N</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span></span></span></span>","key":"UdwN9Xwyw2"},{"type":"text","value":" (nombre total de points d’entraînement)?","position":{"start":{"line":1275,"column":1},"end":{"line":1275,"column":1}},"key":"IiObNXRNev"}],"key":"pwG60SfsP2"}],"key":"KHwVDciwWh"}],"key":"DnJQ4CTqas"}],"class":"hint dropdown","key":"bK65Rt2t3S"},{"type":"admonition","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Exercice 4: Fléau de la dimensionnalité","position":{"start":{"line":1278,"column":1},"end":{"line":1278,"column":1}},"key":"GQcwBWhEpq"}],"key":"NSecIDBrvs"},{"type":"paragraph","position":{"start":{"line":1281,"column":1},"end":{"line":1281,"column":1}},"children":[{"type":"text","value":"Considérez ","position":{"start":{"line":1281,"column":1},"end":{"line":1281,"column":1}},"key":"WFf9QMb85Z"},{"type":"inlineMath","value":"N = 1000","position":{"start":{"line":1281,"column":1},"end":{"line":1281,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>N</mi><mo>=</mo><mn>1000</mn></mrow><annotation encoding=\"application/x-tex\">N = 1000</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1000</span></span></span></span>","key":"FdfAe3RfaC"},{"type":"text","value":" points uniformément distribués dans l’hypercube ","position":{"start":{"line":1281,"column":1},"end":{"line":1281,"column":1}},"key":"nXVumY8IkI"},{"type":"inlineMath","value":"[0, 1]^d","position":{"start":{"line":1281,"column":1},"end":{"line":1281,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">[</mo><mn>0</mn><mo separator=\"true\">,</mo><mn>1</mn><msup><mo stretchy=\"false\">]</mo><mi>d</mi></msup></mrow><annotation encoding=\"application/x-tex\">[0, 1]^d</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0991em;vertical-align:-0.25em;\"></span><span class=\"mopen\">[</span><span class=\"mord\">0</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">1</span><span class=\"mclose\"><span class=\"mclose\">]</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8491em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">d</span></span></span></span></span></span></span></span></span></span></span>","key":"WUxC5XKz63"},{"type":"text","value":".","position":{"start":{"line":1281,"column":1},"end":{"line":1281,"column":1}},"key":"fMo2QtC5Cn"}],"key":"JnIrBGsvKz"},{"type":"list","ordered":true,"start":1,"spread":false,"position":{"start":{"line":1283,"column":1},"end":{"line":1289,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":1283,"column":1},"end":{"line":1284,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":1283,"column":1},"end":{"line":1283,"column":1}},"children":[{"type":"text","value":"Pour ","position":{"start":{"line":1283,"column":1},"end":{"line":1283,"column":1}},"key":"SBmNntSQqU"},{"type":"inlineMath","value":"d = 1, 2, 5, 10, 20, 50, 100","position":{"start":{"line":1283,"column":1},"end":{"line":1283,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>d</mi><mo>=</mo><mn>1</mn><mo separator=\"true\">,</mo><mn>2</mn><mo separator=\"true\">,</mo><mn>5</mn><mo separator=\"true\">,</mo><mn>10</mn><mo separator=\"true\">,</mo><mn>20</mn><mo separator=\"true\">,</mo><mn>50</mn><mo separator=\"true\">,</mo><mn>100</mn></mrow><annotation encoding=\"application/x-tex\">d = 1, 2, 5, 10, 20, 50, 100</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\">d</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8389em;vertical-align:-0.1944em;\"></span><span class=\"mord\">1</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">2</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">5</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">10</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">20</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">50</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">100</span></span></span></span>","key":"uKJ7FJvao4"},{"type":"text","value":", calculez la distance moyenne au plus proche voisin parmi ces points. Utilisez la simulation Monte Carlo.","position":{"start":{"line":1283,"column":1},"end":{"line":1283,"column":1}},"key":"gnQXFqVj9z"}],"key":"QcjZPuBlqi"}],"key":"adXnsGZW6G"},{"type":"listItem","spread":true,"position":{"start":{"line":1285,"column":1},"end":{"line":1286,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":1285,"column":1},"end":{"line":1285,"column":1}},"children":[{"type":"text","value":"Tracez cette distance en fonction de ","position":{"start":{"line":1285,"column":1},"end":{"line":1285,"column":1}},"key":"h0zdnwY4Ud"},{"type":"inlineMath","value":"d","position":{"start":{"line":1285,"column":1},"end":{"line":1285,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>d</mi></mrow><annotation encoding=\"application/x-tex\">d</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\">d</span></span></span></span>","key":"TMfLlApQWP"},{"type":"text","value":". Que constatez-vous?","position":{"start":{"line":1285,"column":1},"end":{"line":1285,"column":1}},"key":"S9JTgd0i72"}],"key":"O6NMxWrh4c"}],"key":"eS8FnZaWfM"},{"type":"listItem","spread":true,"position":{"start":{"line":1287,"column":1},"end":{"line":1288,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":1287,"column":1},"end":{"line":1287,"column":1}},"children":[{"type":"text","value":"Pour capturer les 10 plus proches voisins (soit 1% des données), quel est le rayon de la boule centrée sur un point arbitraire? Calculez ce rayon pour différentes dimensions.","position":{"start":{"line":1287,"column":1},"end":{"line":1287,"column":1}},"key":"CpgxM469C3"}],"key":"kdMyMxnhef"}],"key":"Rw370Uzu6b"},{"type":"listItem","spread":true,"position":{"start":{"line":1289,"column":1},"end":{"line":1289,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":1289,"column":1},"end":{"line":1289,"column":1}},"children":[{"type":"text","value":"Expliquez pourquoi les k-ppv deviennent inefficaces en haute dimension, même avec beaucoup de données.","position":{"start":{"line":1289,"column":1},"end":{"line":1289,"column":1}},"key":"E0id9r2duY"}],"key":"exxc7JvAR1"}],"key":"DXY9v2anqJ"}],"key":"kYMIZYCDo7"}],"class":"hint dropdown","key":"TdcYen9HtH"},{"type":"admonition","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Exercice 5: Distances pour texte","position":{"start":{"line":1292,"column":1},"end":{"line":1292,"column":1}},"key":"yQ1wQ3nfAy"}],"key":"RKKttwVDjE"},{"type":"paragraph","position":{"start":{"line":1295,"column":1},"end":{"line":1295,"column":1}},"children":[{"type":"text","value":"Considérez trois documents représentés par leurs vecteurs de fréquence de mots (bag-of-words) sur un vocabulaire de 5 mots:","position":{"start":{"line":1295,"column":1},"end":{"line":1295,"column":1}},"key":"f847Zv1x3i"}],"key":"y3WgllkPjB"},{"type":"table","position":{"start":{"line":1297,"column":1},"end":{"line":1301,"column":1}},"children":[{"type":"tableRow","position":{"start":{"line":1297,"column":1},"end":{"line":1297,"column":1}},"children":[{"type":"tableCell","header":true,"position":{"start":{"line":1297,"column":1},"end":{"line":1297,"column":1}},"children":[{"type":"text","value":"Document","position":{"start":{"line":1297,"column":1},"end":{"line":1297,"column":1}},"key":"o8Dioxh2oy"}],"key":"MX0X3hqd7u"},{"type":"tableCell","header":true,"position":{"start":{"line":1297,"column":1},"end":{"line":1297,"column":1}},"children":[{"type":"text","value":"chat","position":{"start":{"line":1297,"column":1},"end":{"line":1297,"column":1}},"key":"pPPwbEE4eR"}],"key":"q4oJy9eyTM"},{"type":"tableCell","header":true,"position":{"start":{"line":1297,"column":1},"end":{"line":1297,"column":1}},"children":[{"type":"text","value":"chien","position":{"start":{"line":1297,"column":1},"end":{"line":1297,"column":1}},"key":"d9SciX4tlB"}],"key":"G9EtNpk364"},{"type":"tableCell","header":true,"position":{"start":{"line":1297,"column":1},"end":{"line":1297,"column":1}},"children":[{"type":"text","value":"maison","position":{"start":{"line":1297,"column":1},"end":{"line":1297,"column":1}},"key":"m5Uwi9q4CT"}],"key":"CFKlTTyLRs"},{"type":"tableCell","header":true,"position":{"start":{"line":1297,"column":1},"end":{"line":1297,"column":1}},"children":[{"type":"text","value":"voiture","position":{"start":{"line":1297,"column":1},"end":{"line":1297,"column":1}},"key":"vi76C3aIAx"}],"key":"EyghnBfIQW"},{"type":"tableCell","header":true,"position":{"start":{"line":1297,"column":1},"end":{"line":1297,"column":1}},"children":[{"type":"text","value":"arbre","position":{"start":{"line":1297,"column":1},"end":{"line":1297,"column":1}},"key":"m56rToutvJ"}],"key":"gpB3AyjRPy"}],"key":"xJYSC9Fuys"},{"type":"tableRow","position":{"start":{"line":1299,"column":1},"end":{"line":1299,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":1299,"column":1},"end":{"line":1299,"column":1}},"children":[{"type":"inlineMath","value":"d_1","position":{"start":{"line":1299,"column":1},"end":{"line":1299,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>d</mi><mn>1</mn></msub></mrow><annotation encoding=\"application/x-tex\">d_1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8444em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">d</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"PO28OxRvhI"}],"key":"OtL4Rwxrh0"},{"type":"tableCell","position":{"start":{"line":1299,"column":1},"end":{"line":1299,"column":1}},"children":[{"type":"text","value":"3","position":{"start":{"line":1299,"column":1},"end":{"line":1299,"column":1}},"key":"sPnaB6U1vW"}],"key":"PFM1Fc32fL"},{"type":"tableCell","position":{"start":{"line":1299,"column":1},"end":{"line":1299,"column":1}},"children":[{"type":"text","value":"0","position":{"start":{"line":1299,"column":1},"end":{"line":1299,"column":1}},"key":"JoHdpjYpOW"}],"key":"BNG57MLFwU"},{"type":"tableCell","position":{"start":{"line":1299,"column":1},"end":{"line":1299,"column":1}},"children":[{"type":"text","value":"1","position":{"start":{"line":1299,"column":1},"end":{"line":1299,"column":1}},"key":"ClUZ5npwnC"}],"key":"pPKlqqP64j"},{"type":"tableCell","position":{"start":{"line":1299,"column":1},"end":{"line":1299,"column":1}},"children":[{"type":"text","value":"0","position":{"start":{"line":1299,"column":1},"end":{"line":1299,"column":1}},"key":"YNLZHbvGXk"}],"key":"dXG6MzCq6f"},{"type":"tableCell","position":{"start":{"line":1299,"column":1},"end":{"line":1299,"column":1}},"children":[{"type":"text","value":"2","position":{"start":{"line":1299,"column":1},"end":{"line":1299,"column":1}},"key":"o4Ml5AfqqO"}],"key":"CjTjAzCL6O"}],"key":"xxzryZKFIX"},{"type":"tableRow","position":{"start":{"line":1300,"column":1},"end":{"line":1300,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":1300,"column":1},"end":{"line":1300,"column":1}},"children":[{"type":"inlineMath","value":"d_2","position":{"start":{"line":1300,"column":1},"end":{"line":1300,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>d</mi><mn>2</mn></msub></mrow><annotation encoding=\"application/x-tex\">d_2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8444em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">d</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"tzN1irAW8G"}],"key":"pEYMMkTxCK"},{"type":"tableCell","position":{"start":{"line":1300,"column":1},"end":{"line":1300,"column":1}},"children":[{"type":"text","value":"2","position":{"start":{"line":1300,"column":1},"end":{"line":1300,"column":1}},"key":"Kj4kzdr1yv"}],"key":"zEtTgEFytZ"},{"type":"tableCell","position":{"start":{"line":1300,"column":1},"end":{"line":1300,"column":1}},"children":[{"type":"text","value":"1","position":{"start":{"line":1300,"column":1},"end":{"line":1300,"column":1}},"key":"ORUrls4iFs"}],"key":"PswbPoxm2k"},{"type":"tableCell","position":{"start":{"line":1300,"column":1},"end":{"line":1300,"column":1}},"children":[{"type":"text","value":"0","position":{"start":{"line":1300,"column":1},"end":{"line":1300,"column":1}},"key":"tCuUmGDilR"}],"key":"Fo8FXqbcgj"},{"type":"tableCell","position":{"start":{"line":1300,"column":1},"end":{"line":1300,"column":1}},"children":[{"type":"text","value":"0","position":{"start":{"line":1300,"column":1},"end":{"line":1300,"column":1}},"key":"UtkCnix3VJ"}],"key":"Kt1XHDwqkw"},{"type":"tableCell","position":{"start":{"line":1300,"column":1},"end":{"line":1300,"column":1}},"children":[{"type":"text","value":"1","position":{"start":{"line":1300,"column":1},"end":{"line":1300,"column":1}},"key":"Yy3hk8mB44"}],"key":"sA5NOBt7vQ"}],"key":"KuGERzo72a"},{"type":"tableRow","position":{"start":{"line":1301,"column":1},"end":{"line":1301,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":1301,"column":1},"end":{"line":1301,"column":1}},"children":[{"type":"inlineMath","value":"d_3","position":{"start":{"line":1301,"column":1},"end":{"line":1301,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>d</mi><mn>3</mn></msub></mrow><annotation encoding=\"application/x-tex\">d_3</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8444em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">d</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">3</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"s0Gzwh8BwX"}],"key":"d9yv0epLtQ"},{"type":"tableCell","position":{"start":{"line":1301,"column":1},"end":{"line":1301,"column":1}},"children":[{"type":"text","value":"0","position":{"start":{"line":1301,"column":1},"end":{"line":1301,"column":1}},"key":"WP3k9CCCvT"}],"key":"h6aTS2io5B"},{"type":"tableCell","position":{"start":{"line":1301,"column":1},"end":{"line":1301,"column":1}},"children":[{"type":"text","value":"0","position":{"start":{"line":1301,"column":1},"end":{"line":1301,"column":1}},"key":"D24gpOeucm"}],"key":"tSg95aV4sz"},{"type":"tableCell","position":{"start":{"line":1301,"column":1},"end":{"line":1301,"column":1}},"children":[{"type":"text","value":"2","position":{"start":{"line":1301,"column":1},"end":{"line":1301,"column":1}},"key":"JQi2bR9zhT"}],"key":"FAbkGQnv1L"},{"type":"tableCell","position":{"start":{"line":1301,"column":1},"end":{"line":1301,"column":1}},"children":[{"type":"text","value":"3","position":{"start":{"line":1301,"column":1},"end":{"line":1301,"column":1}},"key":"ZjOo7CMPzS"}],"key":"pfCIJgoKFA"},{"type":"tableCell","position":{"start":{"line":1301,"column":1},"end":{"line":1301,"column":1}},"children":[{"type":"text","value":"0","position":{"start":{"line":1301,"column":1},"end":{"line":1301,"column":1}},"key":"JUJGnr65q1"}],"key":"Tk0v1MlqU4"}],"key":"pq27i0xDJB"}],"key":"E8iiFWvEuc"},{"type":"list","ordered":true,"start":1,"spread":false,"position":{"start":{"line":1303,"column":1},"end":{"line":1309,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":1303,"column":1},"end":{"line":1304,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":1303,"column":1},"end":{"line":1303,"column":1}},"children":[{"type":"text","value":"Calculez la distance euclidienne entre chaque paire de documents.","position":{"start":{"line":1303,"column":1},"end":{"line":1303,"column":1}},"key":"IVCHEHkPYg"}],"key":"CQCb9jbbKW"}],"key":"tp8GSKvAmi"},{"type":"listItem","spread":true,"position":{"start":{"line":1305,"column":1},"end":{"line":1306,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":1305,"column":1},"end":{"line":1305,"column":1}},"children":[{"type":"text","value":"Calculez la similarité cosinus entre chaque paire, puis convertissez en distance (","position":{"start":{"line":1305,"column":1},"end":{"line":1305,"column":1}},"key":"oaXR9OJ0p4"},{"type":"inlineMath","value":"d = 1 - \\text{sim}","position":{"start":{"line":1305,"column":1},"end":{"line":1305,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>d</mi><mo>=</mo><mn>1</mn><mo>−</mo><mtext>sim</mtext></mrow><annotation encoding=\"application/x-tex\">d = 1 - \\text{sim}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\">d</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7278em;vertical-align:-0.0833em;\"></span><span class=\"mord\">1</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6679em;\"></span><span class=\"mord text\"><span class=\"mord\">sim</span></span></span></span></span>","key":"dfnc4HFobP"},{"type":"text","value":").","position":{"start":{"line":1305,"column":1},"end":{"line":1305,"column":1}},"key":"utfHvaN00n"}],"key":"lt5I6MRkuB"}],"key":"JG8uPh0S6q"},{"type":"listItem","spread":true,"position":{"start":{"line":1307,"column":1},"end":{"line":1308,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":1307,"column":1},"end":{"line":1307,"column":1}},"children":[{"type":"text","value":"Selon chaque mesure, quels sont les deux documents les plus similaires?","position":{"start":{"line":1307,"column":1},"end":{"line":1307,"column":1}},"key":"dB9KRSUGi3"}],"key":"TbWwJyj1Pf"}],"key":"OQTxYZypkI"},{"type":"listItem","spread":true,"position":{"start":{"line":1309,"column":1},"end":{"line":1309,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":1309,"column":1},"end":{"line":1309,"column":1}},"children":[{"type":"text","value":"Pourquoi la similarité cosinus est-elle souvent préférée pour les documents textuels?","position":{"start":{"line":1309,"column":1},"end":{"line":1309,"column":1}},"key":"JlFELOT1Lw"}],"key":"rYg9GNGOLp"}],"key":"Wyh0KcKXEr"}],"key":"Iuyi4kY00f"}],"class":"hint dropdown","key":"GeVRlO0chR"},{"type":"admonition","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Exercice 6: Nadaraya-Watson","position":{"start":{"line":1312,"column":1},"end":{"line":1312,"column":1}},"key":"dRaag5204k"}],"key":"GjQNW8KgMl"},{"type":"paragraph","position":{"start":{"line":1315,"column":1},"end":{"line":1315,"column":1}},"children":[{"type":"text","value":"Soit les données d’entraînement: ","position":{"start":{"line":1315,"column":1},"end":{"line":1315,"column":1}},"key":"oVXGbtx74b"},{"type":"inlineMath","value":"x = [0, 1, 2, 3]","position":{"start":{"line":1315,"column":1},"end":{"line":1315,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi><mo>=</mo><mo stretchy=\"false\">[</mo><mn>0</mn><mo separator=\"true\">,</mo><mn>1</mn><mo separator=\"true\">,</mo><mn>2</mn><mo separator=\"true\">,</mo><mn>3</mn><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">x = [0, 1, 2, 3]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">[</span><span class=\"mord\">0</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">1</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">2</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">3</span><span class=\"mclose\">]</span></span></span></span>","key":"CZ8M9PjRjy"},{"type":"text","value":" et ","position":{"start":{"line":1315,"column":1},"end":{"line":1315,"column":1}},"key":"fc8p9ycGvo"},{"type":"inlineMath","value":"y = [1, 2, 1.5, 3]","position":{"start":{"line":1315,"column":1},"end":{"line":1315,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>y</mi><mo>=</mo><mo stretchy=\"false\">[</mo><mn>1</mn><mo separator=\"true\">,</mo><mn>2</mn><mo separator=\"true\">,</mo><mn>1.5</mn><mo separator=\"true\">,</mo><mn>3</mn><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">y = [1, 2, 1.5, 3]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">[</span><span class=\"mord\">1</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">2</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">1.5</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">3</span><span class=\"mclose\">]</span></span></span></span>","key":"yQxnaYoSmC"},{"type":"text","value":".","position":{"start":{"line":1315,"column":1},"end":{"line":1315,"column":1}},"key":"lYUyD2B62Y"}],"key":"JW1FQQgSdA"},{"type":"list","ordered":true,"start":1,"spread":false,"position":{"start":{"line":1317,"column":1},"end":{"line":1323,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":1317,"column":1},"end":{"line":1318,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":1317,"column":1},"end":{"line":1317,"column":1}},"children":[{"type":"text","value":"Avec un noyau gaussien ","position":{"start":{"line":1317,"column":1},"end":{"line":1317,"column":1}},"key":"Qh4X0CqqSd"},{"type":"inlineMath","value":"K_\\lambda(u) = \\exp(-u^2 / 2\\lambda^2)","position":{"start":{"line":1317,"column":1},"end":{"line":1317,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>K</mi><mi>λ</mi></msub><mo stretchy=\"false\">(</mo><mi>u</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mi>exp</mi><mo>⁡</mo><mo stretchy=\"false\">(</mo><mo>−</mo><msup><mi>u</mi><mn>2</mn></msup><mi mathvariant=\"normal\">/</mi><mn>2</mn><msup><mi>λ</mi><mn>2</mn></msup><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">K_\\lambda(u) = \\exp(-u^2 / 2\\lambda^2)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">K</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">λ</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">u</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.0641em;vertical-align:-0.25em;\"></span><span class=\"mop\">exp</span><span class=\"mopen\">(</span><span class=\"mord\">−</span><span class=\"mord\"><span class=\"mord mathnormal\">u</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mord\">/2</span><span class=\"mord\"><span class=\"mord mathnormal\">λ</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span>","key":"R7EPnV35b7"},{"type":"text","value":" et ","position":{"start":{"line":1317,"column":1},"end":{"line":1317,"column":1}},"key":"M7wlFlOSUY"},{"type":"inlineMath","value":"\\lambda = 0.5","position":{"start":{"line":1317,"column":1},"end":{"line":1317,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>λ</mi><mo>=</mo><mn>0.5</mn></mrow><annotation encoding=\"application/x-tex\">\\lambda = 0.5</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\">λ</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0.5</span></span></span></span>","key":"fiTTUwlQMY"},{"type":"text","value":", calculez manuellement la prédiction de Nadaraya-Watson pour ","position":{"start":{"line":1317,"column":1},"end":{"line":1317,"column":1}},"key":"yRfsuro4Ca"},{"type":"inlineMath","value":"x^* = 1.5","position":{"start":{"line":1317,"column":1},"end":{"line":1317,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>x</mi><mo>∗</mo></msup><mo>=</mo><mn>1.5</mn></mrow><annotation encoding=\"application/x-tex\">x^* = 1.5</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6887em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6887em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mbin mtight\">∗</span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1.5</span></span></span></span>","key":"B1IoMaYGjo"},{"type":"text","value":".","position":{"start":{"line":1317,"column":1},"end":{"line":1317,"column":1}},"key":"sHrOlE5Uq3"}],"key":"s36QN0rCnZ"}],"key":"YLA3aEWRZr"},{"type":"listItem","spread":true,"position":{"start":{"line":1319,"column":1},"end":{"line":1320,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":1319,"column":1},"end":{"line":1319,"column":1}},"children":[{"type":"text","value":"Répétez avec ","position":{"start":{"line":1319,"column":1},"end":{"line":1319,"column":1}},"key":"bnbO6kKbhl"},{"type":"inlineMath","value":"\\lambda = 2","position":{"start":{"line":1319,"column":1},"end":{"line":1319,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>λ</mi><mo>=</mo><mn>2</mn></mrow><annotation encoding=\"application/x-tex\">\\lambda = 2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\">λ</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">2</span></span></span></span>","key":"MrcnSMb3RJ"},{"type":"text","value":". Comment la prédiction change-t-elle?","position":{"start":{"line":1319,"column":1},"end":{"line":1319,"column":1}},"key":"tQPkeQTfGq"}],"key":"oYef24IBsH"}],"key":"x7FaJskVaG"},{"type":"listItem","spread":true,"position":{"start":{"line":1321,"column":1},"end":{"line":1322,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":1321,"column":1},"end":{"line":1321,"column":1}},"children":[{"type":"text","value":"Implémentez l’estimateur et tracez les prédictions pour ","position":{"start":{"line":1321,"column":1},"end":{"line":1321,"column":1}},"key":"wUFlCBFjTw"},{"type":"inlineMath","value":"\\lambda = 0.2, 0.5, 1, 2","position":{"start":{"line":1321,"column":1},"end":{"line":1321,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>λ</mi><mo>=</mo><mn>0.2</mn><mo separator=\"true\">,</mo><mn>0.5</mn><mo separator=\"true\">,</mo><mn>1</mn><mo separator=\"true\">,</mo><mn>2</mn></mrow><annotation encoding=\"application/x-tex\">\\lambda = 0.2, 0.5, 1, 2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\">λ</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8389em;vertical-align:-0.1944em;\"></span><span class=\"mord\">0.2</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">0.5</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">1</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">2</span></span></span></span>","key":"aqRn3f8er0"},{"type":"text","value":" sur l’intervalle ","position":{"start":{"line":1321,"column":1},"end":{"line":1321,"column":1}},"key":"HonpdIqJqC"},{"type":"inlineMath","value":"[0, 3]","position":{"start":{"line":1321,"column":1},"end":{"line":1321,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">[</mo><mn>0</mn><mo separator=\"true\">,</mo><mn>3</mn><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">[0, 3]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">[</span><span class=\"mord\">0</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">3</span><span class=\"mclose\">]</span></span></span></span>","key":"IjBXGFCZcx"},{"type":"text","value":".","position":{"start":{"line":1321,"column":1},"end":{"line":1321,"column":1}},"key":"x7bB8XDvQ3"}],"key":"w080thGjPA"}],"key":"vvmgajHhIo"},{"type":"listItem","spread":true,"position":{"start":{"line":1323,"column":1},"end":{"line":1323,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":1323,"column":1},"end":{"line":1323,"column":1}},"children":[{"type":"text","value":"Comparez visuellement avec la régression k-ppv pour ","position":{"start":{"line":1323,"column":1},"end":{"line":1323,"column":1}},"key":"xdwJ0dXkKM"},{"type":"inlineMath","value":"k = 1, 2, 3","position":{"start":{"line":1323,"column":1},"end":{"line":1323,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>k</mi><mo>=</mo><mn>1</mn><mo separator=\"true\">,</mo><mn>2</mn><mo separator=\"true\">,</mo><mn>3</mn></mrow><annotation encoding=\"application/x-tex\">k = 1, 2, 3</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8389em;vertical-align:-0.1944em;\"></span><span class=\"mord\">1</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">2</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">3</span></span></span></span>","key":"q7imqhhgru"},{"type":"text","value":". Quelle méthode produit des prédictions plus lisses?","position":{"start":{"line":1323,"column":1},"end":{"line":1323,"column":1}},"key":"NGCQn44qFo"}],"key":"DPFmLHTCYt"}],"key":"iiSlF54NyN"}],"key":"bk9R7YGgV5"}],"class":"hint dropdown","key":"ykNsU4lODq"},{"type":"admonition","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Exercice 7: Complexité computationnelle","position":{"start":{"line":1326,"column":1},"end":{"line":1326,"column":1}},"key":"dwAuHVCGdy"}],"key":"RHuI5xYYwn"},{"type":"paragraph","position":{"start":{"line":1329,"column":1},"end":{"line":1329,"column":1}},"children":[{"type":"text","value":"Vous développez un système de recommandation pour une plateforme avec 10 millions d’utilisateurs. Chaque utilisateur est représenté par un vecteur de 100 dimensions (embeddings).","position":{"start":{"line":1329,"column":1},"end":{"line":1329,"column":1}},"key":"B5gIdmkkdO"}],"key":"x9SvjXrzox"},{"type":"list","ordered":true,"start":1,"spread":false,"position":{"start":{"line":1331,"column":1},"end":{"line":1339,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":1331,"column":1},"end":{"line":1332,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":1331,"column":1},"end":{"line":1331,"column":1}},"children":[{"type":"text","value":"Combien d’opérations (multiplications et additions) faut-il pour trouver le plus proche voisin d’un utilisateur par force brute?","position":{"start":{"line":1331,"column":1},"end":{"line":1331,"column":1}},"key":"FfRp0oN4hs"}],"key":"QZSxlfSS7D"}],"key":"iMfyGJKl78"},{"type":"listItem","spread":true,"position":{"start":{"line":1333,"column":1},"end":{"line":1334,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":1333,"column":1},"end":{"line":1333,"column":1}},"children":[{"type":"text","value":"Si chaque opération prend 1 nanoseconde, quel est le temps de réponse pour une requête?","position":{"start":{"line":1333,"column":1},"end":{"line":1333,"column":1}},"key":"GMhYzzucDq"}],"key":"kS2L55q6P3"}],"key":"vJENwH1N1r"},{"type":"listItem","spread":true,"position":{"start":{"line":1335,"column":1},"end":{"line":1336,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":1335,"column":1},"end":{"line":1335,"column":1}},"children":[{"type":"text","value":"Si vous devez traiter 1000 requêtes par seconde, cette approche est-elle viable?","position":{"start":{"line":1335,"column":1},"end":{"line":1335,"column":1}},"key":"hpIjzmIxVp"}],"key":"Kkd31DoMDX"}],"key":"PnOzVkE5yD"},{"type":"listItem","spread":true,"position":{"start":{"line":1337,"column":1},"end":{"line":1338,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":1337,"column":1},"end":{"line":1337,"column":1}},"children":[{"type":"text","value":"Un arbre k-d réduit la complexité à ","position":{"start":{"line":1337,"column":1},"end":{"line":1337,"column":1}},"key":"hpw72srvru"},{"type":"inlineMath","value":"O(\\log N)","position":{"start":{"line":1337,"column":1},"end":{"line":1337,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mo stretchy=\"false\">(</mo><mi>log</mi><mo>⁡</mo><mi>N</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">O(\\log N)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mop\">lo<span style=\"margin-right:0.01389em;\">g</span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"mclose\">)</span></span></span></span>","key":"gLxCKfmDyU"},{"type":"text","value":" en basse dimension. Pourquoi cette structure n’est-elle pas efficace pour ","position":{"start":{"line":1337,"column":1},"end":{"line":1337,"column":1}},"key":"kxOyFrzlO1"},{"type":"inlineMath","value":"d = 100","position":{"start":{"line":1337,"column":1},"end":{"line":1337,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>d</mi><mo>=</mo><mn>100</mn></mrow><annotation encoding=\"application/x-tex\">d = 100</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\">d</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">100</span></span></span></span>","key":"AIGSMIS7w7"},{"type":"text","value":"?","position":{"start":{"line":1337,"column":1},"end":{"line":1337,"column":1}},"key":"FLR2nnfHfV"}],"key":"eEdzRes5Zs"}],"key":"byjo1PrA8r"},{"type":"listItem","spread":true,"position":{"start":{"line":1339,"column":1},"end":{"line":1339,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":1339,"column":1},"end":{"line":1339,"column":1}},"children":[{"type":"text","value":"Proposez une stratégie pour ce problème à grande échelle.","position":{"start":{"line":1339,"column":1},"end":{"line":1339,"column":1}},"key":"YPj2PbW7R5"}],"key":"SaUTBGgnSc"}],"key":"WCS3XLzDNO"}],"key":"yeoTVlXn2C"}],"class":"hint dropdown","key":"WVXUmqHo7b"}],"key":"Vkf2PngFoZ"}],"key":"XrqZlboBs0"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"Fondements de l'apprentissage machine","url":"/","group":"Fondements de l'apprentissage machine"},"next":{"title":"Le problème d’apprentissage","url":"/learning-problem","group":"Fondements de l'apprentissage machine"}}},"domain":"http://localhost:3000"}